<?php

if (!defined('BASEPATH'))
    exit('No direct script access allowed');

class Akuntansi extends CI_Controller
{

    function __contruct(){
        parent::__construct();

    }
	
    function rekal(){
        $data['page_title'] = 'REKAL TRANSAKSI';
        $this->template->set('title', 'REKAL TRANSAKSI');
        $this->template->load('template', 'akuntansi/rekal', $data);
    }
    
/*     function neraca_saldo(){
        $data['page_title']= 'Neraca Saldo';
        $this->template->set('title', 'Neraca Saldo');   
        $this->template->load('template','akuntansi/neraca_saldo',$data) ; 
    } */

    function proses_rekalx(){

        $this->db->query(" delete from trhrekal ");
        $this->db->query(" delete from trdrekal ");
        //sp2d
        $sql = " SELECT a.kd_skpd,b.nm_skpd,a.kd_kegiatan,a.nm_kegiatan,a.kd_rek5,a.nm_rek5,a.nilai,b.keperluan,d.status,d.tgl_kas,d.no_kas,b.jns_spp,d.no_sp2d FROM trdspp a
				 LEFT JOIN trhspp b ON a.no_spp=b.no_spp
				 LEFT JOIN trhspm c ON c.no_spp=b.no_spp
				 LEFT JOIN trhsp2d d ON d.no_spm=c.no_spm
				 WHERE d.status='1' ";
        $query1 = $this->db->query($sql);
        $tnosp2d = '';
        foreach ($query1->result_array() as $res)
        {
            $nosp2d = trim($res['no_sp2d']);
            $nokas = $res['no_kas'];
            $tglkas = $res['tgl_kas'];
            $uraian = $res['keperluan'];
            $kdskpd = $res['kd_skpd'];
            $nmskpd = $res['nm_skpd'];
            $jns = $res['jns_spp'];
            $kdgiat = $res['kd_kegiatan'];
            $nmgiat = $res['nm_kegiatan'];
            $nilai = $res['nilai'];
            $kdrek5 = $res['kd_rek5'];
            $nmrek5 = $res['nm_rek5'];

            if ($tnosp2d != $nosp2d)
            {
                $this->db->query(" insert into trhrekal(no_kas,tgl_kas,uraian,kd_skpd,nm_skpd,jns_trans) 
				  values('$nokas','$tglkas','$uraian','$kdskpd','$nmskpd','1') ");
            }

            $this->db->query(" insert into trdrekal(no_kas,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,terima,keluar,jns_trans) 
			  values('$nokas','$kdgiat','$nmgiat','$kdrek5','$nmrek5',$nilai,0,'1') ");

            $tnosp2d = $nosp2d;
        }

        //transout
        $sql = " SELECT a.no_bukti,b.kd_skpd,b.nm_skpd,b.ket,a.kd_kegiatan,a.nm_kegiatan,a.kd_rek5,a.nm_rek5,a.nilai,b.tgl_bukti  
				 FROM trdtransout a LEFT JOIN trhtransout b ON a.no_bukti=b.no_bukti; ";
        $query1 = $this->db->query($sql);
        $tnokas = '';
        foreach ($query1->result_array() as $res)
        {
            $nokas = trim($res['no_bukti']);
            $tglkas = trim($res['tgl_bukti']);
            $uraian = trim($res['ket']);
            $kdskpd = trim($res['kd_skpd']);
            $nmskpd = trim($res['nm_skpd']);

            $kdgiat = trim($res['kd_kegiatan']);
            $nmgiat = trim($res['nm_kegiatan']);
            $kdrek5 = trim($res['kd_rek5']);
            $nmrek5 = trim($res['nm_rek5']);
            $nilai = trim($res['nilai']);

            if ($tnokas != $nokas)
            {
                $this->db->query(" insert into trhrekal(no_kas,tgl_kas,uraian,kd_skpd,nm_skpd,jns_trans) 
				                     values('$nokas','$tglkas','$uraian','$kdskpd','$nmskpd','2') ");
            }

            $this->db->query(" insert into trdrekal(no_kas,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,terima,keluar,jns_trans) 
								 values('$nokas','$kdgiat','$nmgiat','$kdrek5','$nmrek5',0,$nilai,'2') ");
            $tnokas = $nokas;
        }


        //potongan trm pot
        $sql = " SELECT a.no_bukti,a.kd_rek5,a.nm_rek5,a.nilai,b.kd_skpd,b.nm_skpd,b.ket,b.tgl_bukti FROM trdtrmpot a 
				 LEFT JOIN trhtrmpot b ON a.no_bukti=b.no_bukti ";
        $query1 = $this->db->query($sql);
        $tnosp2d = '';
        foreach ($query1->result_array() as $res)
        {
            $nosp2d = trim($res['no_bukti']);
            $nokas = $res['no_bukti'];
            $tglkas = $res['tgl_bukti'];
            $uraian = $res['ket'];
            $kdskpd = $res['kd_skpd'];
            $nmskpd = $res['nm_skpd'];
            $kdgiat = '';
            $nmgiat = '';
            $nilai = $res['nilai'];
            $kdrek5 = $res['kd_rek5'];
            $nmrek5 = $res['nm_rek5'];

            if ($tnosp2d != $nosp2d)
            {
                $this->db->query(" insert into trhrekal(no_kas,tgl_kas,uraian,kd_skpd,nm_skpd,jns_trans) 
				  values('$nokas','$tglkas','$uraian','$kdskpd','$nmskpd','3') ");
            }

            $this->db->query(" insert into trdrekal(no_kas,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,terima,keluar,jns_trans) 
			  values('$nokas','$kdgiat','$nmgiat','$kdrek5','$nmrek5',$nilai,0,'3') ");

            $tnosp2d = $nosp2d;
        }

        //potongan out pot
        $sql = " SELECT a.no_bukti,a.kd_rek5,a.nm_rek5,a.nilai,b.kd_skpd,b.nm_skpd,b.ket,b.tgl_bukti FROM trdstrpot a 
				 LEFT JOIN trhstrpot b ON a.no_bukti=b.no_bukti ";
        $query1 = $this->db->query($sql);
        $tnosp2d = '';
        foreach ($query1->result_array() as $res)
        {
            $nosp2d = trim($res['no_bukti']);
            $nokas = $res['no_bukti'];
            $tglkas = $res['tgl_bukti'];
            $uraian = $res['ket'];
            $kdskpd = $res['kd_skpd'];
            $nmskpd = $res['nm_skpd'];
            $kdgiat = '';
            $nmgiat = '';
            $nilai = $res['nilai'];
            $kdrek5 = $res['kd_rek5'];
            $nmrek5 = $res['nm_rek5'];

            if ($tnosp2d != $nosp2d)
            {
                $this->db->query(" insert into trhrekal(no_kas,tgl_kas,uraian,kd_skpd,nm_skpd,jns_trans) 
				  values('$nokas','$tglkas','$uraian','$kdskpd','$nmskpd','4') ");
            }

            $this->db->query(" insert into trdrekal(no_kas,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,terima,keluar,jns_trans) 
			  values('$nokas','$kdgiat','$nmgiat','$kdrek5','$nmrek5',0,$nilai,'4') ");

            $tnosp2d = $nosp2d;
        }

        echo '1';
    }
	
	function proses_rekal(){
        $skpdx=$this->session->userdata('kdskpd');
		$bulan = $_REQUEST['bulan'];
        //demansyah
       $this->db->query(" DELETE FROM trdrekal, trhrekal USING trdrekal INNER JOIN trhrekal ON (trdrekal.no_kas=trhrekal.no_kas) and (trdrekal.kd_skpd=trhrekal.kd_skpd)
                            WHERE MONTH(trhrekal.tgl_kas)='$bulan' AND trhrekal.kd_skpd='$skpdx'");
		//sp2d kepala
		$sql = " SELECT a.kd_skpd,b.nm_skpd,a.kd_kegiatan,a.nm_kegiatan,a.kd_rek5,a.nm_rek5,a.nilai,b.keperluan,d.status,d.tgl_kas,d.no_kas,b.jns_spp,d.no_sp2d FROM trdspp a
				 LEFT JOIN trhspp b ON a.no_spp=b.no_spp
				 LEFT JOIN trhspm c ON c.no_spp=b.no_spp
				 LEFT JOIN trhsp2d d ON d.no_spm=c.no_spm
				 WHERE d.status='1' AND MONTH(d.tgl_kas)='$bulan' and d.kd_skpd='$skpdx' group by d.no_sp2d  ";
        $query1 = $this->db->query($sql);  
        $tnosp2d = '';
        foreach($query1->result() as $res){
			  $nosp2d=$res->no_sp2d;
			  $nokas=$res->no_kas;
			  $tglkas=$res->tgl_kas;
			  $uraian=$res->keperluan;
			  $kdskpd=$res->kd_skpd;
			  $nmskpd=$res->nm_skpd;
			  $jns=$res->jns_spp;	
			  $kdgiat=$res->kd_kegiatan;
			  $nmgiat=$res->nm_kegiatan;
			  $nilai=$res->nilai;
			  $kdrek5=$res->kd_rek5;
			  $nmrek5=$res->nm_rek5;
			  
			  $this->db->query(" insert into trhrekal(no_kas,tgl_kas,uraian,kd_skpd,nm_skpd,jns_trans) 
			  values('$nokas','$tglkas','$uraian','$kdskpd','$nmskpd','1') ");	
			  //sp2d detail
				$sql = " SELECT a.kd_skpd,b.nm_skpd,a.kd_kegiatan,a.nm_kegiatan,a.kd_rek5,a.nm_rek5,SUM(a.nilai) AS nilai,b.keperluan,d.status,d.tgl_kas,d.no_kas,b.jns_spp,d.no_sp2d 
				FROM trdspp a
				LEFT JOIN trhspp b ON a.no_spp=b.no_spp
				LEFT JOIN trhspm c ON c.no_spp=b.no_spp
				LEFT JOIN trhsp2d d ON d.no_spm=c.no_spm
				WHERE d.status='1' AND d.kd_skpd='$kdskpd' AND MONTH(d.tgl_kas)='$bulan' AND d.no_sp2d='$nosp2d' GROUP BY a.kd_kegiatan,a.kd_rek5 order by a.kd_kegiatan,a.kd_rek5";
				$query1 = $this->db->query($sql);  
			  
				foreach($query1->result() as $res){
					  $nosp2d=trim($res->no_sp2d);
					  $nokas=$res->no_kas;
					  $tglkas=$res->tgl_kas;
					  $uraian=$res->keperluan;
					  $kdskpd=$res->kd_skpd;
					  $nmskpd=$res->nm_skpd;
					  $jns=$res->jns_spp;	
					  $kdgiat=$res->kd_kegiatan;
					  $nmgiat=$res->nm_kegiatan;
					  $nilai=$res->nilai;
					  $kdrek5=$res->kd_rek5;
					  $nmrek5=$res->nm_rek5;
					  
					  
					  $this->db->query(" insert into trdrekal(no_kas,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,terima,keluar,jns_trans,kd_skpd) 
					  values('$nokas','$kdgiat','$nmgiat','$kdrek5','$nmrek5',$nilai,0,'1','$kdskpd') ");			  			  
					  
					  
				}
			  
		}	
		

		//transout header
		$sql = " SELECT b.no_kas,a.no_bukti,b.kd_skpd,b.nm_skpd,b.ket,a.kd_kegiatan,a.nm_kegiatan,a.kd_rek5,a.nm_rek5,a.nilai,b.tgl_bukti  
				 FROM trdtransout a LEFT JOIN trhtransout b ON a.no_bukti=b.no_bukti where b.kd_skpd='$skpdx' AND MONTH(b.tgl_kas)='$bulan' GROUP BY a.no_bukti,b.kd_skpd  ";
        $query1 = $this->db->query($sql);  
        $tnokas = '';
        foreach($query1->result() as $res){
			  //$nokas =trim($res->no_kas);
			  $nokas =trim($res->no_bukti);
			  $tglkas=trim($res->tgl_bukti);
			  $uraian=trim($res->ket);
			  $kdskpd=trim($res->kd_skpd);
			  $nmskpd=trim($res->nm_skpd);

			  $kdgiat=trim($res->kd_kegiatan);
			  $nmgiat=trim($res->nm_kegiatan);
			  $kdrek5=trim($res->kd_rek5);
			  $nmrek5=trim($res->nm_rek5);
			  $nilai =trim($res->nilai);
			 
				  $this->db->query(" insert into trhrekal(no_kas,tgl_kas,uraian,kd_skpd,nm_skpd,jns_trans) 
				                     values('$nokas','$tglkas','$uraian','$kdskpd','$nmskpd','2') ");			  
		
			  //transout detail
			$sql = " SELECT b.no_kas,a.no_bukti,b.kd_skpd,b.nm_skpd,b.ket,a.kd_kegiatan,a.nm_kegiatan,a.kd_rek5,a.nm_rek5,a.nilai,b.tgl_bukti  
					 FROM trdtransout a LEFT JOIN trhtransout b ON a.no_bukti=b.no_bukti where b.kd_skpd='$kdskpd' and b.no_bukti='$nokas' ";
			$query1 = $this->db->query($sql);  
			$tnokas = '';
			foreach($query1->result() as $res){
				  //$nokas =trim($res->no_kas);
				  $nokas =trim($res->no_bukti);
				  $tglkas=trim($res->tgl_bukti);
				  $uraian=trim($res->ket);
				  $kdskpd=trim($res->kd_skpd);
				  $nmskpd=trim($res->nm_skpd);

				  $kdgiat=trim($res->kd_kegiatan);
				  $nmgiat=trim($res->nm_kegiatan);
				  $kdrek5=trim($res->kd_rek5);
				  $nmrek5=trim($res->nm_rek5);
				  $nilai =trim($res->nilai);
				  
				  $this->db->query(" insert into trdrekal(no_kas,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,terima,keluar,jns_trans,kd_skpd) 
									 values('$nokas','$kdgiat','$nmgiat','$kdrek5','$nmrek5',0,$nilai,'2','$kdskpd') ");			  			  
			}
						  			  
		}
		

//======================pengembalian belanja pake rek 5=================================================================================
		//pngembalian header
		$sql = " SELECT b.no_kas,a.no_sts,b.kd_skpd,c.nm_skpd,b.keterangan,b.kd_kegiatan,c.nm_kegiatan,a.kd_rek5,d.nm_rek5,b.total,b.tgl_sts  
				FROM trdkasin_pkd a 
				LEFT JOIN trhkasin_pkd b ON a.no_sts=b.no_sts AND a.kd_skpd=b.kd_skpd 
				INNER JOIN trskpd c ON b.kd_skpd=c.kd_skpd 
				INNER JOIN ms_rek5 d ON a.kd_rek5=d.kd_rek5
				WHERE b.kd_skpd='$skpdx' AND MONTH(b.tgl_sts)='$bulan' AND b.jns_trans in ('5') GROUP BY a.no_sts,b.kd_skpd ";
        $query1 = $this->db->query($sql);  
        $tnokas = '';
        foreach($query1->result() as $res){
			  $nokas =trim($res->no_kas);
			  $nosts =trim($res->no_sts);
			  $tglkas=trim($res->tgl_sts);
			  $uraian=trim($res->keterangan);
			  $kdskpd=trim($res->kd_skpd);
			  $nmskpd=trim($res->nm_skpd);
			 
				$this->db->query(" insert into trhrekal(no_kas,tgl_kas,uraian,kd_skpd,nm_skpd,jns_trans) 
				                     values('$nokas','$tglkas','$uraian','$kdskpd','$nmskpd','9') ");			  
			  //pengembalian detail
				$sqlz = " SELECT b.no_kas,a.no_sts,b.kd_skpd,c.nm_skpd,b.keterangan,b.kd_kegiatan,c.nm_kegiatan,a.kd_rek5,d.nm_rek5,a.rupiah,b.tgl_sts  
						FROM trdkasin_pkd a 
						LEFT JOIN trhkasin_pkd b ON a.no_sts=b.no_sts AND a.kd_skpd=b.kd_skpd 
						INNER JOIN trskpd c ON b.kd_skpd=c.kd_skpd AND b.kd_kegiatan=c.kd_kegiatan
						INNER JOIN ms_rek5 d ON a.kd_rek5=d.kd_rek5
						WHERE b.kd_skpd='$kdskpd' and  b.no_kas='$nokas' and a.no_sts='$nosts' AND b.jns_trans='5'";
				  $query2 = $this->db->query($sqlz);  
				$tnokas = '';
				foreach($query2->result() as $res2){
					  $nokas =trim($res2->no_kas);
					  // $nokas =trim($res->no_sts);
					  $tglkas=trim($res2->tgl_sts);
					  $uraian=trim($res2->keterangan);
					  $kdskpd=trim($res2->kd_skpd);
					  $nmskpd=trim($res2->nm_skpd);

					  $kdgiat=trim($res2->kd_kegiatan);
					  $nmgiat=trim($res2->nm_kegiatan);
					  $kdrek5=trim($res2->kd_rek5);
					  $nmrek5=trim($res2->nm_rek5);
					  $nilai =trim($res2->rupiah);
					  
					  $this->db->query(" insert into trdrekal(no_kas,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,terima,keluar,jns_trans,kd_skpd) 
										 values('$nokas','$kdgiat','$nmgiat','$kdrek5','$nmrek5',0,$nilai,'9','$kdskpd') ");			  			  
				}
						  			  
		}

		
//========================================================================================================================

		//potongan header trm pot
		$sql = " SELECT a.no_bukti,a.kd_rek5,a.nm_rek5,a.nilai,b.kd_skpd,b.nm_skpd,b.ket,b.tgl_bukti FROM trdtrmpot a 
				 LEFT JOIN trhtrmpot b ON a.no_bukti=b.no_bukti where b.kd_skpd='$skpdx' AND MONTH(b.tgl_bukti)='$bulan' GROUP BY a.no_bukti,b.kd_skpd";
        $query1 = $this->db->query($sql);  
        $tnosp2d = '';
        foreach($query1->result_array() as $res){
			  $nosp2d=trim($res['no_bukti']);
			  $nokas=$res['no_bukti'];
			  $tglkas=$res['tgl_bukti'];
			  $uraian=$res['ket'];
			  $kdskpd=$res['kd_skpd'];
			  $nmskpd=$res['nm_skpd'];
			  $kdgiat='';
			  $nmgiat='';
			  $nilai=$res['nilai'];
			  $kdrek5=$res['kd_rek5'];
			  $nmrek5=$res['nm_rek5'];
			  
			  $this->db->query(" insert into trhrekal(no_kas,tgl_kas,uraian,kd_skpd,nm_skpd,jns_trans) 
				  values('$nokas','$tglkas','$uraian','$kdskpd','$nmskpd','3') ");			  
			  		  			  
		}
		
		//potongan detail trm pot
		$sql = " SELECT a.no_bukti,a.kd_rek5,a.nm_rek5,a.nilai,b.kd_skpd,b.nm_skpd,b.ket,b.tgl_bukti FROM trdtrmpot a 
				 LEFT JOIN trhtrmpot b ON a.no_bukti=b.no_bukti  where b.kd_skpd='$skpdx' and MONTH(b.tgl_bukti)='$bulan'";
        $query1 = $this->db->query($sql);  
        $tnosp2d = '';
        foreach($query1->result_array() as $res){
			  $nosp2d=trim($res['no_bukti']);
			  $nokas=$res['no_bukti'];
			  $tglkas=$res['tgl_bukti'];
			  $uraian=$res['ket'];
			  $kdskpd=$res['kd_skpd'];
			  $nmskpd=$res['nm_skpd'];
			  $kdgiat='';
			  $nmgiat='';
			  $nilai=$res['nilai'];
			  $kdrek5=$res['kd_rek5'];
			  $nmrek5=$res['nm_rek5'];		  
			  
			  $this->db->query(" insert into trdrekal(no_kas,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,terima,keluar,jns_trans,kd_skpd) 
			  values('$nokas','$kdgiat','$nmgiat','$kdrek5','$nmrek5',$nilai,0,'3','$kdskpd') ");			  			  
			  
			
		}

		//potongan header out pot
		$sql = " SELECT a.no_bukti,a.kd_rek5,a.nm_rek5,a.nilai,b.kd_skpd,b.nm_skpd,b.ket,b.tgl_bukti FROM trdstrpot a 
				 LEFT JOIN trhstrpot b ON a.no_bukti=b.no_bukti  where b.kd_skpd='$skpdx' AND MONTH(b.tgl_bukti)='$bulan' group by a.no_bukti,b.kd_skpd ";
        $query1 = $this->db->query($sql);  
        $tnosp2d = '';
        foreach($query1->result_array() as $res){
			  $nosp2d=trim($res['no_bukti']);
			  $nokas=$res['no_bukti'];
			  $tglkas=$res['tgl_bukti'];
			  $uraian=$res['ket'];
			  $kdskpd=$res['kd_skpd'];
			  $nmskpd=$res['nm_skpd'];
			  $kdgiat='';
			  $nmgiat='';
			  $nilai=$res['nilai'];
			  $kdrek5=$res['kd_rek5'];
			  $nmrek5=$res['nm_rek5'];

			  $this->db->query(" insert into trhrekal(no_kas,tgl_kas,uraian,kd_skpd,nm_skpd,jns_trans) 
			  values('$nokas','$tglkas','$uraian','$kdskpd','$nmskpd','4') ");			  
			
		}
        
		//potongan detail out pot
		$sql = " SELECT a.no_bukti,a.kd_rek5,a.nm_rek5,a.nilai,b.kd_skpd,b.nm_skpd,b.ket,b.tgl_bukti FROM trdstrpot a 
				 LEFT JOIN trhstrpot b ON a.no_bukti=b.no_bukti  where b.kd_skpd='$skpdx' AND MONTH(b.tgl_bukti)='$bulan'";
        $query1 = $this->db->query($sql);  
        $tnosp2d = '';
        foreach($query1->result_array() as $res){
			  $nosp2d=trim($res['no_bukti']);
			  $nokas=$res['no_bukti'];
			  $tglkas=$res['tgl_bukti'];
			  $uraian=$res['ket'];
			  $kdskpd=$res['kd_skpd'];
			  $nmskpd=$res['nm_skpd'];
			  $kdgiat='';
			  $nmgiat='';
			  $nilai=$res['nilai'];
			  $kdrek5=$res['kd_rek5'];
			  $nmrek5=$res['nm_rek5'];
			  
			  $this->db->query(" insert into trdrekal(no_kas,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,terima,keluar,jns_trans,kd_skpd) 
			  values('$nokas','$kdgiat','$nmgiat','$kdrek5','$nmrek5',0,$nilai,'4','$kdskpd') ");			  			  
			  
			  
		}

       	//ambil header simpanan
		$sql = " SELECT a.no_kas,a.nilai,a.kd_skpd,a.keterangan,a.tgl_kas FROM tr_ambilsimpanan a  where a.kd_skpd='$skpdx' AND MONTH(a.tgl_kas)='$bulan'";
        $query1 = $this->db->query($sql);  
        $tkas = '';
		$tskpd='';
        foreach($query1->result_array() as $res){
			  $nosp2d=trim($res['no_kas']);
			  $tglkas=$res['tgl_kas'];
			  $uraian=$res['keterangan'];
			  $kdskpd=$res['kd_skpd'];
			  $nilai=$res['nilai'];

			  $this->db->query(" insert into trhrekal(no_kas,tgl_kas,uraian,kd_skpd,nm_skpd,jns_trans) 
			  values('$nosp2d','$tglkas','$uraian','$kdskpd','','1') ");			  
 
		}
        
	  //ambil detail simpanan
		$sql = " SELECT a.no_kas,a.nilai,a.kd_skpd,a.keterangan,a.tgl_kas FROM tr_ambilsimpanan a  where a.kd_skpd='$skpdx' AND MONTH(a.tgl_kas)='$bulan'";
        $query1 = $this->db->query($sql);  
        $tkas = '';
		$tskpd='';
        foreach($query1->result_array() as $res){
			  $nosp2d=trim($res['no_kas']);
			  $tglkas=$res['tgl_kas'];
			  $uraian=$res['keterangan'];
			  $kdskpd=$res['kd_skpd'];
			  $nilai=$res['nilai'];			  
			  $this->db->query(" insert into trdrekal(no_kas,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,terima,keluar,jns_trans,kd_skpd) 
			  values('$nosp2d','','','','Ambil Simpanan Bank',0,$nilai,'1','$kdskpd') ");			  			    
		}

		//ambil header stor simpanan
		$sql = " SELECT a.no_kas,a.nilai,a.kd_skpd,a.keterangan,a.tgl_kas FROM tr_setorsimpanan a where a.kd_skpd='$skpdx' AND MONTH(a.tgl_kas)='$bulan'";
        $query1 = $this->db->query($sql);  
        $tkas = '';
		$tskpd='';
        foreach($query1->result_array() as $res){
			  $nosp2d=trim($res['no_kas']);
			  $tglkas=$res['tgl_kas'];
			  $uraian=$res['keterangan'];
			  $kdskpd=$res['kd_skpd'];
			  $nilai=$res['nilai'];

			  $this->db->query(" insert into trhrekal(no_kas,tgl_kas,uraian,kd_skpd,nm_skpd,jns_trans) 
			  values('$nosp2d','$tglkas','$uraian','$kdskpd','','1') ");			  
 
		}
        
	  //ambil detail setor simpanan
		$sql = " SELECT a.no_kas,a.nilai,a.kd_skpd,a.keterangan,a.tgl_kas FROM tr_setorsimpanan a where a.kd_skpd='$skpdx' AND MONTH(a.tgl_kas)='$bulan'";
        $query1 = $this->db->query($sql);  
        $tkas = '';
		$tskpd='';
        foreach($query1->result_array() as $res){
			  $nosp2d=trim($res['no_kas']);
			  $tglkas=$res['tgl_kas'];
			  $uraian=$res['keterangan'];
			  $kdskpd=$res['kd_skpd'];
			  $nilai=$res['nilai'];			  
			  $this->db->query(" insert into trdrekal(no_kas,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,terima,keluar,jns_trans,kd_skpd) 
			  values('$nosp2d','','','','Setor Simpanan Bank',0,$nilai,'1','$kdskpd') ");			  			    
		}
//cek kembali
        //ambil header tunai
		$sql = " SELECT a.no_kas,a.nilai,a.kd_skpd,a.keterangan,a.tgl_kas FROM tr_ambilsimpanan a where a.kd_skpd='$skpdx' AND MONTH(a.tgl_kas)='$bulan' GROUP BY a.no_kas,a.kd_skpd";
        $query1 = $this->db->query($sql);  
        $tkas1 = '';
		$tskpd='';
        foreach($query1->result_array() as $res){
			  $nosp2d=trim($res['no_kas']);
			  $tglkas=$res['tgl_kas'];
			  $uraian=$res['keterangan'];
			  $kdskpd=$res['kd_skpd'];
			  $nilai=$res['nilai'];

			  $this->db->query(" insert into trhrekal(no_kas,tgl_kas,uraian,kd_skpd,nm_skpd,jns_trans) 
			  values('$nosp2d','$tglkas','$uraian','$kdskpd','','2') ");			  
			  
		}

		//ambil detail tunai
		$sql = " SELECT a.no_kas,a.nilai,a.kd_skpd,a.keterangan,a.tgl_kas FROM tr_ambilsimpanan a where a.kd_skpd='$skpdx' AND MONTH(a.tgl_kas)='$bulan'";
        $query1 = $this->db->query($sql);  
        $tkas1 = '';
		$tskpd='';
        foreach($query1->result_array() as $res){
			  $nosp2d=trim($res['no_kas']);
			  $tglkas=$res['tgl_kas'];
			  $uraian=$res['keterangan'];
			  $kdskpd=$res['kd_skpd'];
			  $nilai=$res['nilai'];
			  $this->db->query(" insert into trdrekal(no_kas,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,terima,keluar,jns_trans,kd_skpd) 
			  values('$nosp2d','','','','Penerimaan Kas Tunai',$nilai,0,'2','$kdskpd') ");			  			  
			  
		}
//masih harus di cek kebawah
		//ambil header Panjar
		$sql = " SELECT a.no_kas,a.nilai,a.kd_skpd,CONCAT('Diberikan Pajar Kepada ',a.pengguna,' Untuk ',a.keterangan) AS keterangan,a.tgl_kas FROM tr_panjar a where a.kd_skpd='$skpdx' AND MONTH(a.tgl_kas)='$bulan' group by a.no_kas,a.kd_skpd";
        $query1 = $this->db->query($sql);  
        $tkas = '';
		$tskpd='';
        foreach($query1->result_array() as $res){
			  $nosp2d=trim($res['no_kas']);
			  $tglkas=$res['tgl_kas'];
			  $uraian=$res['keterangan'];
			  $kdskpd=$res['kd_skpd'];
			  $nilai=$res['nilai'];
			
				  $this->db->query(" insert into trhrekal(no_kas,tgl_kas,uraian,kd_skpd,nm_skpd,jns_trans) 
				  values('$nosp2d','$tglkas','$uraian','$kdskpd','','1') ");			  
			  
		}
		
		//ambil detail Panjar
		$sql = " SELECT a.no_kas,a.nilai,a.kd_skpd,CONCAT('Diberikan Pajar Kepada ',a.pengguna,' Untuk ',a.keterangan) AS keterangan,a.tgl_kas FROM tr_panjar a where a.kd_skpd='$skpdx' AND MONTH(a.tgl_kas)='$bulan'";
        $query1 = $this->db->query($sql);  
        $tkas = '';
		$tskpd='';
        foreach($query1->result_array() as $res){
			  $nosp2d=trim($res['no_kas']);
			  $tglkas=$res['tgl_kas'];
			  $uraian=$res['keterangan'];
			  $kdskpd=$res['kd_skpd'];
			  $nilai=$res['nilai'];
			  
			  $this->db->query(" insert into trdrekal(no_kas,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,terima,keluar,jns_trans,kd_skpd) 
			  values('$nosp2d','','','','Pemberian Panjar',0,$nilai,'1','$kdskpd') ");			  			  
	  
		}


		 //Jawab header panjar
		$sql = " SELECT a.no_kas,a.nilai,a.kd_skpd,CONCAT('Pertanggunjawaban Pajar Oleh ',a.pengguna,' Untuk ',a.keterangan) AS keterangan,a.tgl_kas FROM tr_jpanjar a where a.kd_skpd='$skpdx' AND MONTH(a.tgl_kas)='$bulan' group by a.no_kas,a.kd_skpd";
        $query1 = $this->db->query($sql);  
        $tkas1 = '';
		$tskpd='';
        foreach($query1->result_array() as $res){
			  $nosp2d=trim($res['no_kas']);
			  $tglkas=$res['tgl_kas'];
			  $uraian=$res['keterangan'];
			  $kdskpd=$res['kd_skpd'];
			  $nilai=$res['nilai'];

				  $this->db->query(" insert into trhrekal(no_kas,tgl_kas,uraian,kd_skpd,nm_skpd,jns_trans) 
				  values('$nosp2d','$tglkas','$uraian','$kdskpd','','2') ");			  
			  
		}

		 //Jawab detail panjar
		$sql = " SELECT a.no_kas,a.nilai,a.kd_skpd,CONCAT('Pertanggunjawaban Pajar Oleh ',a.pengguna,' Untuk ',a.keterangan) AS keterangan,a.tgl_kas FROM tr_jpanjar a where a.kd_skpd='$skpdx' AND MONTH(a.tgl_kas)='$bulan'";
        $query1 = $this->db->query($sql);  
        $tkas1 = '';
		$tskpd='';
        foreach($query1->result_array() as $res){
			  $nosp2d=trim($res['no_kas']);
			  $tglkas=$res['tgl_kas'];
			  $uraian=$res['keterangan'];
			  $kdskpd=$res['kd_skpd'];
			  $nilai=$res['nilai'];
			  
			  $this->db->query(" insert into trdrekal(no_kas,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,terima,keluar,jns_trans,kd_skpd) 
			  values('$nosp2d','','','','Pertanggungjawaban Panjar',$nilai,0,'2','$kdskpd') ");			  			  
			  
			  
		}

		// ambil header Sesuai
		$sql = " select * from trhsesuai where kd_skpd='$skpdx' and month(tgl_voucher)='$bulan' group by no_voucher";
        $query1 = $this->db->query($sql);  
        foreach($query1->result_array() as $res){
			  $nosp2d=trim($res['no_voucher']);
			  $tglkas=$res['tgl_voucher'];
			  $uraian=$res['ket'];
			  $kdskpd=$res['kd_skpd'];
			  $nmskpd=$res['nm_skpd'];

			  $this->db->query(" insert into trhrekal(no_kas,tgl_kas,uraian,kd_skpd,nm_skpd,jns_trans) 
			  values('$nosp2d','$tglkas','$uraian','$kdskpd','$nmskpd','2') ");			  
 
		}
        
	  //ambil detail Sesuai
		$sql = " SELECT a.no_voucher,b.tgl_voucher,b.ket,a.kd_skpd,b.nm_skpd,a.kd_kegiatan,a.nm_kegiatan,a.kd_rek5,LTRIM(a.nm_rek5)AS nm_rek5,a.debet,
		a.kredit,a.rk FROM trdsesuai a LEFT JOIN trhsesuai b ON a.kd_skpd=b.kd_skpd AND a.no_voucher=b.no_voucher
		WHERE a.kd_skpd='$skpdx' AND LEFT(a.kd_rek5,1)='5' and month(b.tgl_voucher)='$bulan'";
        $query1 = $this->db->query($sql);  
        foreach($query1->result_array() as $res){
			  $nosp2d=trim($res['no_voucher']);
			  $tglkas=$res['tgl_voucher'];
			  $uraian=$res['ket'];
			  $kdskpd=$res['kd_skpd'];
			  $nmskpd=$res['nm_skpd'];
			  $kdgiat=$res['kd_kegiatan'];
			  $nmgiat=$res['nm_kegiatan'];
			  $kdrek5=$res['kd_rek5'];
			  $nmrek5=$res['nm_rek5'];
			  $debet =$res['debet'];
			  $kredit=$res['kredit'];	
			  $rk	 =$res['rk'];	
			  //get_nama($kode,$hasil,$tabel,$field)
			  //$kd_rek5=$this->tukd_model->get_nama($kdrek5,'kd_rek5','ms_rek5','kd_rek64');

			  if($rk=='D'){
					 $this->db->query(" insert into trdrekal(no_kas,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,terima,keluar,jns_trans,kd_skpd) 
								 values('$nosp2d','$kdgiat','$nmgiat','$kdrek5','$nmrek5',0,$debet,'2','$kdskpd') ");	
			  }else{
				 $this->db->query(" insert into trdrekal(no_kas,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,terima,keluar,jns_trans,kd_skpd) 
								 values('$nosp2d','$kdgiat','$nmgiat','$kdrek5','$nmrek5','$kredit',0,'2','$kdskpd') ");		
			  }
		  			    
		}

		echo '1';	
	}

    function mapping(){
        $data['page_title'] = 'MAPPING REALISASI';
        $this->template->set('title', 'MAPPING REALISASI');
        $this->template->load('template', 'akuntansi/mapping', $data);
    }
    
    function proses_mappingx(){
		$this->db->query(" delete from realisasi_anggaran  where left(kd_rek5,1) in('4','5','6')  ");

        $sql = " select * from trdrka order by kd_skpd,kd_kegiatan,kd_rek5 ";
        $query1 = $this->db->query($sql);
        $ii = 0;
        foreach ($query1->result_array() as $res)
        {

            $real_in = 0;
            $real_out = 0;

            $kd_skpd = $res['kd_skpd'];
            $kd_kegiatan = $res['kd_kegiatan'];
            $kd_rek5 = $res['kd_rek5'];
            $anggaran = $res['nilai_ubah'];

            $gt = substr($kd_kegiatan, 5, strlen($kd_kegiatan) - 5);

            //get_nama($kode,$hasil,$tabel,$field)
            $nm_skpd = $this->tukd_model->get_nama($kd_skpd, 'nm_skpd', 'ms_skpd', 'kd_skpd');
            //$nm_kegiatan=$this->tukd_model->get_nama($gt,'nm_kegiatan','m_giat','kd_kegiatan');
            $nm_rek5 = $this->tukd_model->get_nama($kd_rek5, 'nm_rek5', 'ms_rek5', 'kd_rek5');
            //$nm_skpd="";
            $nm_kegiatan = "";
            //$nm_rek5	="";

            //hitung pengeluaran / kas out
            $query2 = $this->db->query(" SELECT IF(SUM(a.debet) IS NULL,0,SUM(a.debet)) AS debet FROM trdju a INNER JOIN trhju b ON a.no_voucher = b.no_voucher and a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$kd_skpd' AND a.kd_kegiatan='$kd_kegiatan' AND a.kd_rek5='$kd_rek5' ");
            foreach ($query2->result_array() as $res2)
            {
                $debet = $res2['debet'];

            }
            $query3 = $this->db->query(" SELECT IF(SUM(a.kredit) IS NULL,0,SUM(a.kredit)) AS kredit FROM trdju a INNER JOIN trhju b ON a.no_voucher = b.no_voucher and a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$kd_skpd' AND a.kd_kegiatan='$kd_kegiatan' AND a.kd_rek5='$kd_rek5' ");
            foreach ($query3->result_array() as $res3)
            {
                $kredit = $res3['kredit'];

            }
          
            $real_in = $kredit  - $debet;
            $real_out = $debet - $kredit ;
          

            if (((substr($kd_rek5, 0, 1) == '4') or (substr($kd_rek5, 0, 2) == '61')))
            {
                $this->db->query(" insert into realisasi_anggaran(kd_skpd,kd_kegiatan,kd_rek5,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5) values('$kd_skpd','$kd_kegiatan','$kd_rek5',$anggaran,$real_in,'$nm_skpd','$nm_kegiatan','$nm_rek5') ");
            } else
            {
                $this->db->query(" insert into realisasi_anggaran(kd_skpd,kd_kegiatan,kd_rek5,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5) values('$kd_skpd','$kd_kegiatan','$kd_rek5',$anggaran,$real_out,'$nm_skpd','$nm_kegiatan','$nm_rek5') ");
            }
        }
		
		 $this->db->query(" delete from realisasi_anggaran where left(kd_rek5,1) in('7','8','9') ");

        $sql3 = " SELECT  a.kd_skpd AS kd_skpd,b.kd_rek5 AS kd_rek5 FROM trdju b INNER JOIN trhju a ON a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_skpd WHERE LEFT(b.kd_rek5,1) IN('7','8','9') 
                  GROUP BY a.kd_skpd,b.kd_rek5  ORDER BY a.kd_skpd";
        $query5 = $this->db->query($sql3);
        //$ii = 0;
        foreach ($query5->result_array() as $res1)
        {
            //hitung pengeluaran / kas out
			$real=0;
            $kd_skpd = $res1['kd_skpd'];
            $kd_rek5 = $res1['kd_rek5'];
            $query6 = $this->db->query(" SELECT IF(SUM(a.debet) IS NULL,0,SUM(a.debet)) AS debet FROM trdju a INNER JOIN trhju b ON a.no_voucher = b.no_voucher and a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$kd_skpd' AND a.kd_rek5='$kd_rek5' ");
            foreach ($query6->result_array() as $res6)
            {
                $debet = $res6['debet'];

            }
            $query7 = $this->db->query(" SELECT IF(SUM(a.kredit) IS NULL,0,SUM(a.kredit))AS kredit FROM trdju a INNER JOIN trhju b ON a.no_voucher = b.no_voucher and a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$kd_skpd'  AND a.kd_rek5='$kd_rek5' ");

            foreach ($query7->result_array() as $res7)
            {
                //echo 'dsdsd';
                $kredit = $res7['kredit'];

            }

            
            if (substr($kd_rek5, 0, 2) == '71' || substr($kd_rek5, 0, 1) == '8')
            {
                $real = $kredit  - $debet ;
            } else
            {
                $real = $debet - $kredit;
                //$real_ppkd=$debet_ppkd- $kredit_ppkd;
            }
            $this->db->query(" insert into realisasi_anggaran(kd_skpd,kd_rek5,real_spj) values('$kd_skpd','$kd_rek5','$real') ");
            //$this->db->query(" insert into realisasi_ppkd(kd_skpd,kd_rek5,real_spj) values('$kd_skpd','$kd_rek5','$real_ppkd') ");
        }

        $zz=$this->db->query(" delete from realisasi where left(kd_rek5,1) IN ('4','5','6')");
        $sql = $this->db->query(" select kd_skpd,kd_kegiatan,nm_kegiatan,kd_rek5,nilai_ubah from trdrka order by kd_skpd,kd_kegiatan,kd_rek5 ");
		
        foreach($sql->result() as $row){
			$kd_skpd	=$row->kd_skpd;
			$kd_kegiatan=$row->kd_kegiatan;
			$kd_rek5	=$row->kd_rek5;
			$anggaran	=$row->nilai_ubah;
			$nm_kegiatan=$row->nm_kegiatan;
			
			$real_out=0;$real_in=0;

			$nm_skpd	=$this->tukd_model->get_nama($kd_skpd,'nm_skpd','ms_skpd','kd_skpd');
			$nm_rek5	=$this->tukd_model->get_nama($kd_rek5,'nm_rek5','ms_rek5','kd_rek5');
            
            $kd_rek5_64	=$this->tukd_model->get_nama($kd_rek5,'kd_rek64','ms_rek5','kd_rek5');
			
			//ambil rek5 1 digit and 2 digit
			$kdrek51=substr($kd_rek5,0,1);
			$kdrek52=substr($kd_rek5,0,2);

           //hitung pengeluaran / kas out
			$query2 = $this->db->query(" SELECT IF(SUM(a.debet) IS NULL,0,SUM(a.debet)) AS debet FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher = b.no_voucher and a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$kd_skpd' AND a.kd_kegiatan='$kd_kegiatan' AND a.kd_rek5='$kd_rek5_64' ");  
	        foreach($query2->result() as $row2){
				 $debet=$row2->debet;
                 				 
			}

            $query3 = $this->db->query(" SELECT IF(SUM(a.kredit) IS NULL,0,SUM(a.kredit)) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher = b.no_voucher and a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$kd_skpd' AND a.kd_kegiatan='$kd_kegiatan' AND a.kd_rek5='$kd_rek5_64' ");  
	        foreach($query3->result() as $row3){
				 $kredit=$row3->kredit;
                 				 
			}

            $real_in=$kredit - $debet; 
			$real_out=$debet - $kredit; 

            if (((substr($kd_rek5, 0, 1) == '4') or (substr($kd_rek5, 0, 2) == '61'))){
               $this->db->query(" insert into realisasi(kd_skpd,nm_skpd,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,anggaran,real_sp2d,real_spj) VALUES ('$kd_skpd','$nm_skpd','$kd_kegiatan','$nm_kegiatan','$kd_rek5','$nm_rek5','$anggaran','0','$real_in') ");
            }else{
              $this->db->query(" insert into realisasi(kd_skpd,nm_skpd,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,anggaran,real_sp2d,real_spj) VALUES ('$kd_skpd','$nm_skpd','$kd_kegiatan','$nm_kegiatan','$kd_rek5','$nm_rek5','$anggaran','0','$real_out') "); 
		
            }
		
         }
		
		$ww= $this->db->query(" delete from realisasi where left(kd_rek5,1) IN ('7','8','9') ");
		
        $sql3 = " SELECT a.kd_skpd,a.nm_skpd,b.kd_rek5 FROM trdju_pkd b LEFT JOIN trhju_pkd a ON a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_skpd WHERE LEFT(b.kd_rek5,1) IN('7','8','9') GROUP BY a.kd_skpd,b.kd_rek5 ORDER BY  b.kd_rek5";
        $query5 = $this->db->query($sql3);  
        foreach($query5->result() as $res1){
			$real =0;
            $kdskpd = $res1->kd_skpd;
			$nmskpd  = $res1->nm_skpd;
            $kdrek5 = $res1->kd_rek5;
			$query3 = $this->db->query(" SELECT if(SUM(a.debet) is NULL ,0,SUM(a.debet) )AS debet FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher = b.no_voucher and a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$kdskpd' AND a.kd_rek5='$kdrek5' ");  
	        foreach($query3->result_array() as $res2){
				 $debet=$res2['debet'];
                 				 
			}
            $query4 = $this->db->query(" SELECT if(SUM(a.kredit) is NULL,0,SUM(a.kredit)) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher = b.no_voucher and a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$kdskpd' AND a.kd_rek5='$kdrek5' ");  
	            
            foreach($query4->result_array() as $res3){
				 $kredit=$res3['kredit'];
                 				 
			}
            if (substr($kdrek5,0,2)=='71' || substr($kdrek5,0,1)=='8' ){
               $real=$kredit-$debet;   
            }else{
				$real=$debet-$kredit;
            } 
            $this->db->query(" insert into realisasi(kd_skpd,nm_skpd,kd_rek5,real_spj) values('$kdskpd','$nmskpd','$kdrek5','$real') "); 
        }
		echo '1';
	}

    function proses_mapping(){
		$skpd= $this->session->userdata('kdskpd');
        $this->db->query(" delete from realisasi  where left(kd_rek5,1) in('4','5','6') and kd_skpd='$skpd' ");
        $sql = " select * from trdrka where kd_skpd='$skpd' order by kd_skpd,kd_kegiatan,kd_rek5 ";
        $query1 = $this->db->query($sql);  
        $ii = 0;
        foreach($query1->result_array() as $res){
			
			$in =0;
			$out=0;
			$cp =0;
            $real_in=0;
            $real_out=0;

			$kd_skpd	=$res['kd_skpd'];
			$kd_kegiatan=$res['kd_kegiatan'];
			$kd_rek5	=$res['kd_rek5'];
			$anggaran	=$res['nilai_ubah'];
			$nm_kegiatan=$res['nm_kegiatan'];

			$gt = substr($kd_kegiatan,5,strlen($kd_kegiatan)-5);

			//get_nama($kode,$hasil,$tabel,$field)
			$nm_skpd	=$this->tukd_model->get_nama($kd_skpd,'nm_skpd','ms_skpd','kd_skpd');
			//$nm_kegiatan=$this->tukd_model->get_nama($gt,'nm_kegiatan','m_giat','kd_kegiatan');
			$nm_rek5	=$this->tukd_model->get_nama($kd_rek5,'nm_rek5','ms_rek5','kd_rek5');
            
            $kd_rek5_64	=$this->tukd_model->get_nama($kd_rek5,'kd_rek64','ms_rek5','kd_rek5');
			//$nm_skpd="";
			//$nm_rek5	="";


			//hitung pendapatan / kas in
		//	$query2 = $this->db->query(" SELECT SUM(a.rupiah) AS nilai FROM trdkasin_pkd a LEFT JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE a.kd_skpd='$kd_skpd' AND b.kd_kegiatan='$kd_kegiatan' AND a.kd_rek5='$kd_rek5_64' ");  
//	        foreach($query2->result_array() as $res2){
//	      
//				 if (((substr($kd_rek5,0,1)=='4') or (substr($kd_rek5,0,2)=='61'))){
//					 $in=$res2['nilai'];
//				 }else{
//					 $cp=$res2['nilai'];				 
//				 } 						
//			}
			
			//hitung pengeluaran / kas out
			$query2 = $this->db->query(" SELECT SUM(a.debet) AS debet FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher = b.no_voucher and a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$kd_skpd' AND a.kd_kegiatan='$kd_kegiatan' AND a.kd_rek5='$kd_rek5_64' ");  
	        foreach($query2->result_array() as $res2){
				 $debet=$res2['debet'];
                 				 
			}
            $query3 = $this->db->query(" SELECT SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher = b.no_voucher and a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$kd_skpd' AND a.kd_kegiatan='$kd_kegiatan' AND a.kd_rek5='$kd_rek5_64' ");  
	        foreach($query3->result_array() as $res3){
				 $kredit=$res3['kredit'];
                 				 
			}
            
            if(((substr($kd_rek5,0,1)=='4') or (substr($kd_rek5,0,2)=='61'))){
              $real_in=$kredit-$debet;  
              $this->db->query(" insert into realisasi(kd_skpd,kd_kegiatan,kd_rek5,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5) values('$kd_skpd','$kd_kegiatan','$kd_rek5',$anggaran,$real_in,'$nm_skpd','$nm_kegiatan','$nm_rek5') ");
            }else{
              $real_out=$debet-$kredit; 
              $this->db->query(" insert into realisasi(kd_skpd,kd_kegiatan,kd_rek5,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5) values('$kd_skpd','$kd_kegiatan','$kd_rek5',$anggaran,$real_out,'$nm_skpd','$nm_kegiatan','$nm_rek5') "); 
            }
		
		}
        $this->db->query(" delete from realisasi where left(kd_rek5,1) in ('7','8','9')  and kd_skpd='$skpd' ");
		
        $sql3 = " SELECT a.kd_skpd,b.kd_rek5 FROM trdju_pkd b LEFT JOIN trhju_pkd a ON a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_skpd WHERE LEFT(b.kd_rek5,1) IN('7','8','9')  and a.kd_skpd='$skpd' GROUP BY a.kd_skpd,b.kd_rek5 ORDER BY  b.kd_rek5";
        $query5 = $this->db->query($sql3);  
        //$ii = 0;
        foreach($query5->result_array() as $res1){
            $kd_skpd = $res1['kd_skpd'];
            $kd_rek5 = $res1['kd_rek5'];
			$query3 = $this->db->query(" SELECT SUM(a.debet) AS debet FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher = b.no_voucher and a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$kd_skpd' AND a.kd_rek5='$kd_rek5' ");  
	        foreach($query3->result_array() as $res2){
				 $debet=$res2['debet'];
                 				 
			}
            $query4 = $this->db->query(" SELECT SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher = b.no_voucher and a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$kd_skpd' AND a.kd_rek5='$kd_rek5' ");  
	            
            foreach($query4->result_array() as $res3){
				 $kredit=$res3['kredit'];
                 				 
			}
            if (substr($kd_rek5,0,2)=='71' || substr($kd_rek5,0,1)=='8' ){
               $real=$kredit-$debet;   
            }else{
				$real=$debet-$kredit;
            } 
            $this->db->query(" insert into realisasi(kd_skpd,kd_rek5,real_spj) values('$kd_skpd','$kd_rek5','$real') "); 
        }
		echo '1';
	}

	function titik($str){
		$panjang=105;
		if($panjang>=strlen($str)){
			$selisih=$panjang-strlen($str);
			for($i=1;$i<=$selisih;$i++){
				$str .='.';
			}
			$hasil=$str;
		}else{
			$hasil=substr($str,0,105);
		} 
		return $hasil;
	}

	function hitrecord(){
		$this->db->query("delete from realisasi_bulan");	
		$query =$this->db->query("select * from trdrka order by kd_skpd,kd_kegiatan,kd_rek5");  
		$rec   = count($query->result_array());
		$data=array("jumlah"=>$rec);
		echo json_encode($data);
		$query->free_result();
	}

/*	function proses_mapping_lra_bulan(){
		$bulan = $this->input->post('bulan');
		$baris =$this->input->post('baris');
		$cek =$this->input->post('ccek');
	    $where='';
		if($cek=='1'){
			$where='nilai';
		}else if($cek=='0'){
			$where='nilai_ubah';
		}

		$sql = " select kd_skpd,nm_skpd,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,$where as nilai,IF((LEFT(kd_rek5,3)='523' or LEFT(kd_rek5,3)='521'),LEFT(kd_rek5,3),LEFT(kd_rek5,3)) AS kd_akun from trdrka ORDER BY kd_kegiatan,kd_rek5 limit $baris,1";
        $query1 = $this->db->query($sql);  
		   foreach($query1->result_array() as $res){
				
				$in =0;
				$out=0;
				$cp =0;
				$real_in=0;
				$real_out=0;
				$skpd       =$res['kd_skpd'];
				$nm_skpd    =$res['nm_skpd'];
				$kd_kegiatan=$res['kd_kegiatan'];
				$nm_kegiatan=$res['nm_kegiatan'];
				$kd_rek5	=$res['kd_rek5'];
				$anggaran	=$res['nilai'];
				$kd_akun    =$res['kd_akun'];
				//$nm_rek5	=$res['nm_rek5'];
				
				$stsubah=$this->rka_model->get_nama($skpd,'status_ubah','trhrka','kd_skpd');
		        $nm_skpd=$this->rka_model->get_nama($skpd,'nm_skpd','ms_skpd','kd_skpd');

				$gt = substr($kd_kegiatan,5,strlen($kd_kegiatan)-5);
				//$nm_kegiatan="";
				//get_nama($kode,$hasil,$tabel,$field)
				$kd_rek5_64	=$this->tukd_model->get_nama($kd_rek5,'kd_rek64','ms_rek5','kd_rek5');
				$nm_rek5	=$this->tukd_model->get_nama($kd_rek5,'nm_rek5','ms_rek5','kd_rek5');
				if(strlen($kd_akun) <=4){
					$akun=substr($kd_rek5_64,0,3);
				}else{
					$akun=substr($kd_rek5_64,0,5);
				}
				//Rekening 4 
			
				if(substr($kd_rek5,0,2)=='41'){
					$query7 = $this->db->query("SELECT SUM(nilai) as nilai FROM tr_terima WHERE kd_rek5 ='$kd_rek5' AND MONTH(tgl_terima)<='$bulan' and kd_skpd='$skpd' ");
					foreach($query7->result_array() as $res7){
						 $nilai4=$res7['nilai'];
					}
					$this->db->query(" insert into realisasi_bulan(kd_skpd,kd_kegiatan,kd_rek5,kd_rek64,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5,kd_akun64,kd_akun5) values('$skpd','$kd_kegiatan','$kd_rek5','$kd_rek5_64','$anggaran','$nilai4','$nm_skpd','$nm_kegiatan','$nm_rek5','$akun','$kd_akun') ");
				  $baris=$baris+1;
				  if($nilai4==null){$nilaix=0;}else{$nilaix=number_format($nilai4,2);};
				  $isi  ='['.$baris.']'.'.'.$this->titik($kd_kegiatan.'.'.$kd_rek5.'-'.$nm_rek5).'['.$nilaix.']';
				  $datx=array("isi"=>$isi,"baris"=>($baris),"pesan"=>'0');
				  echo json_encode($datx); 

				}else if(substr($kd_rek5,0,2)=='42'){
					$query7 = $this->db->query("SELECT SUM(nilai) as nilai FROM tr_terima_ppkd WHERE kd_rek5 = '$kd_rek5' AND MONTH(tgl_terima)<='$bulan' and kd_skpd='$skpd' ");
					foreach($query7->result_array() as $res7){
						 $nilai4=$res7['nilai'];
					}
					$this->db->query(" insert into realisasi_bulan(kd_skpd,kd_kegiatan,kd_rek5,kd_rek64,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5,kd_akun64,kd_akun5) values('$skpd','$kd_kegiatan','$kd_rek5','$kd_rek5_64','$anggaran','$nilai4','$nm_skpd','$nm_kegiatan','$nm_rek5','$akun','$kd_akun') ");
				  $baris=$baris+1;
				  if($nilai4==null){$nilaix=0;}else{$nilaix=number_format($nilai4,2);};
				  $isi  ='['.$baris.']'.'.'.$this->titik($kd_kegiatan.'.'.$kd_rek5.'-'.$nm_rek5).'['.$nilaix.']';
				  $datx=array("isi"=>$isi,"baris"=>($baris),"pesan"=>'0');
				  echo json_encode($datx); 

				}else if(substr($kd_rek5,0,2)=='61'){
					$query7 = $this->db->query("SELECT SUM(nilai) as nilai FROM tr_terima_ppkd WHERE kd_rek5 = '$kd_rek5' AND MONTH(tgl_terima)<='$bulan' and kd_skpd='$skpd' ");
					foreach($query7->result_array() as $res7){
						 $nilai4=$res7['nilai'];
					}
					$this->db->query(" insert into realisasi_bulan(kd_skpd,kd_kegiatan,kd_rek5,kd_rek64,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5,kd_akun64,kd_akun5) values('$skpd','$kd_kegiatan','$kd_rek5','$kd_rek5_64','$anggaran','$nilai4','$nm_skpd','$nm_kegiatan','$nm_rek5','$akun','$kd_akun') ");
				  $baris=$baris+1;
				  if($nilai4==null){$nilaix=0;}else{$nilaix=number_format($nilai4,2);};
				  $isi  ='['.$baris.']'.'.'.$this->titik($kd_kegiatan.'.'.$kd_rek5.'-'.$nm_rek5).'['.$nilaix.']';
				  $datx=array("isi"=>$isi,"baris"=>($baris),"pesan"=>'0');
				  echo json_encode($datx); 

				  				}else if(substr($kd_rek5,0,2)=='43'){
					$query7 = $this->db->query("SELECT SUM(nilai) as nilai FROM tr_terima_ppkd WHERE kd_rek5 = '$kd_rek5' AND MONTH(tgl_terima)<='$bulan' and kd_skpd='$skpd' ");
					foreach($query7->result_array() as $res7){
						 $nilai4=$res7['nilai'];
					}
					$this->db->query(" insert into realisasi_bulan(kd_skpd,kd_kegiatan,kd_rek5,kd_rek64,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5,kd_akun64,kd_akun5) values('$skpd','$kd_kegiatan','$kd_rek5','$kd_rek5_64','$anggaran','$nilai4','$nm_skpd','$nm_kegiatan','$nm_rek5','$akun','$kd_akun') ");
				  $baris=$baris+1;
				  if($nilai4==null){$nilaix=0;}else{$nilaix=number_format($nilai4,2);};
				  $isi  ='['.$baris.']'.'.'.$this->titik($kd_kegiatan.'.'.$kd_rek5.'-'.$nm_rek5).'['.$nilaix.']';
				  $datx=array("isi"=>$isi,"baris"=>($baris),"pesan"=>'0');
				  echo json_encode($datx);
				  
				}else{
				$query2 = $this->db->query("SELECT 
												IFNULL((SELECT SUM(a.nilai) AS nilai FROM trdspp a INNER JOIN trhsp2d b ON a.no_spp=b.no_spp
												WHERE no_sp2d<>'' AND MONTH(tgl_sp2d)<='$bulan' AND b.jns_spp IN('4','5','6')
												AND b.kd_skpd='$skpd' AND a.kd_kegiatan='$kd_kegiatan' AND a.kd_rek5='$kd_rek5'),0)+
												IFNULL((SELECT SUM(nilai) AS nilai FROM trdtransout a
												INNER JOIN trhtransout b ON a.no_bukti = b.no_bukti
												WHERE MONTH(b.tgl_bukti) <='$bulan'  AND b.jns_spp IN('1','2','3') AND
												b.kd_skpd='$skpd' AND a.kd_kegiatan='$kd_kegiatan' AND a.kd_rek5='$kd_rek5'),0) AS nilai");
					/*$query2 = $this->db->query("SELECT SUM(nilai) as nilai FROM trdtransout a
											INNER JOIN trhtransout b ON a.no_bukti = b.no_bukti
											WHERE MONTH(b.tgl_bukti) <='$bulan'  AND
											b.kd_skpd='$skpd' AND a.kd_kegiatan='$kd_kegiatan' AND a.kd_rek5='$kd_rek5'");
					foreach($query2->result_array() as $res2){
						 $nilai5=$res2['nilai'];
					}
					$this->db->query(" insert into realisasi_bulan(kd_skpd,kd_kegiatan,kd_rek5,kd_rek64,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5,kd_akun64,kd_akun5) values('$skpd','$kd_kegiatan','$kd_rek5','$kd_rek5_64','$anggaran','$nilai5','$nm_skpd','$nm_kegiatan','$nm_rek5','$akun','$kd_akun') ");
					$baris=$baris+1;
					if($nilai5==null){$nilaix=0;}else{$nilaix=number_format($nilai5,2);};
					  $isi  ='['.$baris.']'.'.'.$this->titik($kd_kegiatan.'.'.$kd_rek5.'-'.$nm_rek5).'['.$nilaix.']';
					  $datx=array("isi"=>$isi,"baris"=>($baris),"pesan"=>'0');
					  echo json_encode($datx); 
				}
				

			}
	}*/
    
    function proses_mapping_lra_bulan(){
		$bulan = $this->input->post('bulan');
		$baris =$this->input->post('baris');
		$cek =$this->input->post('ccek');
	    $where='';
		if($cek=='1'){
			$where='nilai';
		}else if($cek=='0'){
			$where='nilai_ubah';
		}

		$sql = " select kd_skpd,nm_skpd,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,nilai_ubah as nilai,IF((LEFT(kd_rek5,3)='523' or LEFT(kd_rek5,3)='521'),LEFT(kd_rek5,3),LEFT(kd_rek5,3)) AS kd_akun from trdrka ORDER BY kd_kegiatan,kd_rek5 limit $baris,1";
        $query1 = $this->db->query($sql);  
		   foreach($query1->result_array() as $res){
				
				$in =0;
				$out=0;
				$cp =0;
				$real_in=0;
				$real_out=0;
				$skpd       =$res['kd_skpd'];
				$nm_skpd    =$res['nm_skpd'];
				$kd_kegiatan=$res['kd_kegiatan'];
				$nm_kegiatan=$res['nm_kegiatan'];
				$kd_rek5	=$res['kd_rek5'];
				$anggaran	=$res['nilai'];
				$kd_akun    =$res['kd_akun'];
				//$nm_rek5	=$res['nm_rek5'];
				
				$stsubah=$this->rka_model->get_nama($skpd,'status_ubah','trhrka','kd_skpd');
		        $nm_skpd=$this->rka_model->get_nama($skpd,'nm_skpd','ms_skpd','kd_skpd');

				$gt = substr($kd_kegiatan,5,strlen($kd_kegiatan)-5);
				//$nm_kegiatan="";
				//get_nama($kode,$hasil,$tabel,$field)
				$kd_rek5_64	=$this->tukd_model->get_nama($kd_rek5,'kd_rek64','ms_rek5','kd_rek5');
				$nm_rek5	=$this->tukd_model->get_nama($kd_rek5,'nm_rek5','ms_rek5','kd_rek5');
				if(strlen($kd_akun) <=4){
					$akun=substr($kd_rek5_64,0,3);
				}else{
					$akun=substr($kd_rek5_64,0,5);
				}
				//Rekening 4 
			
				if(substr($kd_rek5,0,2)=='41'){
					$query7 = $this->db->query("SELECT SUM(nilai) as nilai FROM tr_terima WHERE kd_rek5 ='$kd_rek5' AND MONTH(tgl_terima)<='$bulan' and kd_skpd='$skpd' ");
					foreach($query7->result_array() as $res7){
						 $nilai4=$res7['nilai'];
					}
					$this->db->query(" insert into realisasi_bulan(kd_skpd,kd_kegiatan,kd_rek5,kd_rek64,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5,kd_akun64,kd_akun5) values('$skpd','$kd_kegiatan','$kd_rek5','$kd_rek5_64','$anggaran','$nilai4','$nm_skpd','$nm_kegiatan','$nm_rek5','$akun','$kd_akun') ");
				  $baris=$baris+1;
				  if($nilai4==null){$nilaix=0;}else{$nilaix=number_format($nilai4,2);};
				  $isi  ='['.$baris.']'.'.'.$this->titik($kd_kegiatan.'.'.$kd_rek5.'-'.$nm_rek5).'['.$nilaix.']';
				  $datx=array("isi"=>$isi,"baris"=>($baris),"pesan"=>'0');
				  echo json_encode($datx); 

				}else if(substr($kd_rek5,0,2)=='42'){
					$query7 = $this->db->query("SELECT SUM(nilai) as nilai FROM tr_terima_ppkd WHERE kd_rek5 = '$kd_rek5' AND MONTH(tgl_terima)<='$bulan' and kd_skpd='$skpd' ");
					foreach($query7->result_array() as $res7){
						 $nilai4=$res7['nilai'];
					}
					$this->db->query(" insert into realisasi_bulan(kd_skpd,kd_kegiatan,kd_rek5,kd_rek64,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5,kd_akun64,kd_akun5) values('$skpd','$kd_kegiatan','$kd_rek5','$kd_rek5_64','$anggaran','$nilai4','$nm_skpd','$nm_kegiatan','$nm_rek5','$akun','$kd_akun') ");
				  $baris=$baris+1;
				  if($nilai4==null){$nilaix=0;}else{$nilaix=number_format($nilai4,2);};
				  $isi  ='['.$baris.']'.'.'.$this->titik($kd_kegiatan.'.'.$kd_rek5.'-'.$nm_rek5).'['.$nilaix.']';
				  $datx=array("isi"=>$isi,"baris"=>($baris),"pesan"=>'0');
				  echo json_encode($datx); 

				}else if(substr($kd_rek5,0,2)=='61'){
					$query7 = $this->db->query("SELECT SUM(nilai) as nilai FROM tr_terima_ppkd WHERE kd_rek5 = '$kd_rek5' AND MONTH(tgl_terima)<='$bulan' and kd_skpd='$skpd' ");
					foreach($query7->result_array() as $res7){
						 $nilai4=$res7['nilai'];
					}
					$this->db->query(" insert into realisasi_bulan(kd_skpd,kd_kegiatan,kd_rek5,kd_rek64,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5,kd_akun64,kd_akun5) values('$skpd','$kd_kegiatan','$kd_rek5','$kd_rek5_64','$anggaran','$nilai4','$nm_skpd','$nm_kegiatan','$nm_rek5','$akun','$kd_akun') ");
				  $baris=$baris+1;
				  if($nilai4==null){$nilaix=0;}else{$nilaix=number_format($nilai4,2);};
				  $isi  ='['.$baris.']'.'.'.$this->titik($kd_kegiatan.'.'.$kd_rek5.'-'.$nm_rek5).'['.$nilaix.']';
				  $datx=array("isi"=>$isi,"baris"=>($baris),"pesan"=>'0');
				  echo json_encode($datx); 

				  				}else if(substr($kd_rek5,0,2)=='43'){
					$query7 = $this->db->query("SELECT SUM(nilai) as nilai FROM tr_terima_ppkd WHERE kd_rek5 = '$kd_rek5' AND MONTH(tgl_terima)<='$bulan' and kd_skpd='$skpd' ");
					foreach($query7->result_array() as $res7){
						 $nilai4=$res7['nilai'];
					}
					$this->db->query(" insert into realisasi_bulan(kd_skpd,kd_kegiatan,kd_rek5,kd_rek64,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5,kd_akun64,kd_akun5) values('$skpd','$kd_kegiatan','$kd_rek5','$kd_rek5_64','$anggaran','$nilai4','$nm_skpd','$nm_kegiatan','$nm_rek5','$akun','$kd_akun') ");
				  $baris=$baris+1;
				  if($nilai4==null){$nilaix=0;}else{$nilaix=number_format($nilai4,2);};
				  $isi  ='['.$baris.']'.'.'.$this->titik($kd_kegiatan.'.'.$kd_rek5.'-'.$nm_rek5).'['.$nilaix.']';
				  $datx=array("isi"=>$isi,"baris"=>($baris),"pesan"=>'0');
				  echo json_encode($datx);
				  
				}else{
				/*$query2 = $this->db->query("SELECT 
												IFNULL((SELECT SUM(a.nilai) AS nilai FROM trdspp a INNER JOIN trhsp2d b ON a.no_spp=b.no_spp
												WHERE no_sp2d<>'' AND MONTH(tgl_sp2d)<='$bulan' AND b.jns_spp IN('4','5','6')
												AND b.kd_skpd='$skpd' AND a.kd_kegiatan='$kd_kegiatan' AND a.kd_rek5='$kd_rek5'),0)+
												IFNULL((SELECT SUM(nilai) AS nilai FROM trdtransout a
												INNER JOIN trhtransout b ON a.no_bukti = b.no_bukti
												WHERE MONTH(b.tgl_bukti) <='$bulan'  AND b.jns_spp IN('1','2','3') AND
												b.kd_skpd='$skpd' AND a.kd_kegiatan='$kd_kegiatan' AND a.kd_rek5='$kd_rek5'),0) AS nilai");*/
					$query2 = $this->db->query("SELECT SUM(nilai) as nilai FROM trdtransout a
											INNER JOIN trhtransout b ON a.no_bukti = b.no_bukti
											WHERE MONTH(b.tgl_bukti) <='$bulan'  AND
											b.kd_skpd='$skpd' AND a.kd_kegiatan='$kd_kegiatan' AND a.kd_rek5='$kd_rek5'");
					foreach($query2->result_array() as $res2){
						 $nilai5=$res2['nilai'];
					}
					$this->db->query(" insert into realisasi_bulan(kd_skpd,kd_kegiatan,kd_rek5,kd_rek64,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5,kd_akun64,kd_akun5) values('$skpd','$kd_kegiatan','$kd_rek5','$kd_rek5_64','$anggaran','$nilai5','$nm_skpd','$nm_kegiatan','$nm_rek5','$akun','$kd_akun') ");
					$baris=$baris+1;
					if($nilai5==null){$nilaix=0;}else{$nilaix=number_format($nilai5,2);};
					  $isi  ='['.$baris.']'.'.'.$this->titik($kd_kegiatan.'.'.$kd_rek5.'-'.$nm_rek5).'['.$nilaix.']';
					  $datx=array("isi"=>$isi,"baris"=>($baris),"pesan"=>'0');
					  echo json_encode($datx); 
				}
				

			}
	}


  function _mpdftn($judul='',$isi='',$lMargin='',$rMargin='',$top='',$orientasi='',$init='') {
        
        ini_set("memory_limit","-1");
        $this->load->library('mpdf');

        $this->mpdf->defaultheaderfontsize = 6; /* in pts */
        $this->mpdf->defaultheaderfontstyle = BI;   /* blank, B, I, or BI */
        $this->mpdf->defaultheaderline = 1;     /* 1 to include line below header/above footer */
        
        $this->mpdf->defaultfooterfontsize = 7; /* in pts */
        $this->mpdf->defaultfooterfontstyle = I;    /* blank, B, I, or BI */
        $this->mpdf->defaultfooterline = 1; 
        $hal='';
        $bMargin='';
        //$kertas='A4';
        $this->mpdf->SetBottomMargin('12');
        $this->mpdf->SetFooter(''.$init.' ||'.$hal.' Halaman  : {PAGENO}| ');

        $this->mpdf->AddPage($orientasi,'',$hal,'1','off',$lMargin,$rMargin,$top,$bMargin);
        if (!empty($judul)) $this->mpdf->writeHTML($judul);
        $this->mpdf->writeHTML($isi);         
        $this->mpdf->Output(); 

                
    }


	function cetak_lra_bulan($cetak='', $bulan='',$hari='',$perkada='',$lcskpd=''){
		$thnx=$this->session->userdata('pcThang');
         
        if($lcskpd==''){
            $lcwhere2 = "";
            $lcwhere1 = "";
        }else{
            $lcwhere1 = " and kd_skpd = '$lcskpd'";
            $lcwhere2 = " and b.kd_skpd = '$lcskpd'";
        }

       
        
		if($bulan==''){
			$b=12;
			$bulanx=$thnx.'-'.$b.'-01';
		}else{
			$bulanx=$thnx.'-'.$bulan.'-01';
		}
		$date=date('Y-m-t',strtotime($bulanx));
		$bubu=date('m');
		$bulanxi=$thnx.'-'.$bubu.'-01';
		$date1=date('Y-m-t',strtotime($bulanxi));
		

		$last= strtoupper($this->tukd_model->tanggal_format_indonesia($date));
       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang, no_qanun, tgl_qanun, no_perbup, tgl_perbup, tgl_ctk_raperda,bupati FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl     = $rowsc->tgl_rka;
                    $tanggal = $this->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                    
                    $bupati     = $rowsc->bupati;
                    $no_qanun   = $rowsc->no_qanun;
                    $tgl_qanun  = $this->tukd_model->tanggal_format_indonesia($rowsc->tgl_qanun);
                    $no_perbup  = $rowsc->no_perbup;
                    $tgl_perbup = $rowsc->tgl_perbup;
					$tgl_ctk_raperda=$rowsc->tgl_ctk_raperda;
					
                } 
				$tgl_qanun='_________________';
        $cRet='';
       if($perkada=="2"){ 
        $cRet .="<table width=\"100%\" align=\"center\" border=\"0\">
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">LAMPIRAN I : PERATURAN BUPATI BIAK NUMFOR</td>
                    </tr>
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">NOMOR : $no_perbup</td>
                    </tr>
                    
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">TANGGAL : ".$this->tukd_model->tanggal_format_indonesia($tgl_perbup)."</td>
                    </tr>

                  </table>
				  <br>";
            
        $cRet .="<table style=\"border-collapse:collapse;  style=\"font-size:12\"\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>LAPORAN REALISASI PENJABARAN ANGGARAN </strong></td>
                    </tr>
                    
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>

                  </table>"; 
				 $tanggal= $this->tukd_model->tanggal_format_indonesia($tgl_perbup);
	   }else{
		$cRet .="<table width=\"100%\" align=\"center\" border=\"0\">
                    <tr>
                         <td colspan=\"4\" width=\"80\" align=\"right\" style=\"font-size:10\">LAMPIRAN I</td>
                         <td align=\"left\" width=\"5\" style=\"font-size:10\">:</td>
                         <td align=\"left\" style=\"font-size:10\">RANCANGAN PERATURAN DAERAH <br> $kab</td>
                    </tr>
                    <tr>
                         <td colspan=\"4\" width=\"80\" align=\"right\" style=\"font-size:10\">NOMOR</td>
                         <td align=\"left\" width=\"5\" style=\"font-size:10\">:</td>
                         <td align=\"left\" style=\"font-size:10\">$no_qanun</td>
                    </tr>
                    
                    <tr>
                         <td colspan=\"4\" width=\"80\" align=\"right\" style=\"font-size:10\">TANGGAL</td>
                         <td align=\"left\" width=\"5\" style=\"font-size:10\">:</td>
                         <td align=\"left\" style=\"font-size:10\">$tgl_qanun</td>
                    </tr>

                  </table>
				  <br>";
            
        $cRet .="<table style=\"border-collapse:collapse;  style=\"font-size:12\"\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>LAPORAN REALISASI ANGGARAN </strong></td>
                    </tr>
                    
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>PER $last</strong></td>
                    </tr>

                  </table>"; 
				  $tanggal= $tgl_qanun;
	   	   }
           
      if($lcskpd<>''){     
         $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$lcskpd'";
                 $sqlskpd=$this->db->query($sqldns)->row();
                 $kd_urusan=$sqlskpd->kd_u;                    
                 $nm_urusan= $sqlskpd->nm_u;
                 $kd_skpd  = $sqlskpd->kd_sk;
                 $nm_skpd  = $sqlskpd->nm_sk;
         
         $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
                            <td width=\"20%\">Urusan Organisasi </td>
                            <td width=\"80%\">: $kd_urusan - $nm_urusan</td>
                        </tr>
                        <tr>
                            <td>Organisasi</td>
                            <td>: $kd_skpd - $nm_skpd </td>
                        </tr>
                    
                    </table>";
        }
           
        
        $cRet .= "<table style=\"border-collapse:collapse; font-size:14;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NOMOR URUT</b></td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"45%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>ANGGARAN</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>REALISASI</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>LEBIH<br>(KURANG)</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"1%\" align=\"center\"><b>%</b></td>
						</tr>
                     </thead>
					  <tfoot>
                        <tr><td style=\"border-bottom: none; border-left:none;border-right:none;\" colspan=\"6\"></td>
                     </tfoot>";
                     
                $csql1 = "SELECT kd_rek1 AS kd_rek,lra AS rek, nm_rek1 AS nm_rek ,'1' as lepel FROM ms_rek1 
                            WHERE LEFT(kd_rek1,1)='4' 
                            UNION 
                            SELECT kd_rek2 AS kd_rek,lra AS rek,nm_rek2 AS nm_rek ,'2' as lepel FROM ms_rek2
                            WHERE LEFT(kd_rek2,1)='4' 
                            UNION 
                            SELECT kd_rek3 AS kd_rek,lra AS rek,nm_rek3 AS nm_rek ,'3' as lepel FROM ms_rek3
                            WHERE LEFT(kd_rek3,1)='4' order by kd_rek";
                
                $query = $this->db->query($csql1);
                                                  
                $lnjmlangpdpt = 0;
                $lnjmlrealpdpt = 0;
                $lnjmlselpdpt = 0;
                                                  
                foreach ($query->result() as $row)
                {
                    
                   
                    
                    $coba1=$row->rek;
                    $coba2=ucwords(strtolower($row->nm_rek));
                    $lckdrek = $row->kd_rek;
                    $lclen = strlen($lckdrek);
                    $csqlang = "select sum(nilai_ubah) as jm from trdrka where left(kd_rek5,$lclen)='$lckdrek' $lcwhere1";
                    $hslang = $this->db->query($csqlang)->row();
                    if($this->db->query($csqlang)->num_rows>0){
                        $lnang = $hslang->jm;
                    }else{
                        $lnang = 0;
                    }
					
					if ($lnang==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$lnang;
						$per1 = 0; 
                    }
                    
                    $csqlreal = "SELECT SUM(real1) AS jmreal1 FROM (

SELECT SUM(nilai) AS real1 FROM tr_terima_ppkd WHERE LEFT(kd_rek5,$lclen)='$lckdrek' $lcwhere1
UNION 
SELECT SUM(rupiah) AS real1 FROM trdkasin_pkd WHERE LEFT(kd_rek5,$lclen)='$lckdrek' $lcwhere1
UNION
SELECT SUM(nilai) AS real1 FROM tr_terima_blud WHERE LEFT(kd_rek5,$lclen)='$lckdrek' $lcwhere1
UNION
SELECT IFNULL(SUM(berkurang)*-1,0) AS real1 FROM raperda  
WHERE LEFT(kd_rek5,$lclen)='$lckdrek' $lcwhere1
UNION
SELECT IFNULL(SUM(bertambah),0) AS real1 FROM raperda  
WHERE LEFT(kd_rek5,$lclen)='$lckdrek' $lcwhere1
)z";
                    
                    //select sum(kredit)-sum(debet) as jmreal1 from trdju_pkd where left(kd_rek5,$lclen)='$lckdrek'";
                    $hslreal = $this->db->query($csqlreal)->row();
                    if($this->db->query($csqlreal)->num_rows>0){
                        $lreal = $hslreal->jmreal1;
                    }else{
                        $lreal = 0;
                    }
                    
                    $lbh = $lnang - $lreal;
                    
                    if ($row->lepel=='3'){
                        $lnjmlangpdpt = $lnjmlangpdpt + $lnang;
                        $lnjmlrealpdpt = $lnjmlrealpdpt + $lreal;
                        $lnjmlselpdpt = $lnjmlselpdpt + $lbh;
                    }
                     
                    if($lnang==0){
                        $persen1 = 0;
                    }else{
                        $persen1 = ($lreal/$lnang)*100;
                    }
                                        
					//$persen1  = number_format($per1,2);
                    
                    if(strlen($coba1)<=3){
                        $coba1_= strtoupper($coba1);
                        $coba2_= strtoupper($coba2);
                        
                        $cRet .= "<tr>
									<td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
                                    <td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
                                    <td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
								</tr>";
                        
                        $cRet    .= " <tr>
										<td   align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba1_</b></td>
										<td  style=\"border-top:none;border-bottom:none;\"><b>$coba2_</b></td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>".$this->angka($lnang)."</b></td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>".$this->angka($lreal)."</b></td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>".$this->angka($lbh)."</b></td>
										<td align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>".$this->angka($persen1)."</b></td>
									</tr>";
                    }else{
                        $cRet    .= " <tr>
										<td  align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba1</td>
										<td  style=\"border-top:none;border-bottom:none;\">$coba2</td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">".$this->angka($lnang)."</td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">".$this->angka($lreal)."</td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">".$this->angka($lbh)."</td>
										<td align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">".$this->angka($persen1)."</td>
									</tr>";
                    }
                    
                }
                 
                   if($lnjmlangpdpt==0){
                        $persentotal = 0;
                    }else{
                 $persentotal = ($lnjmlrealpdpt/$lnjmlangpdpt)*100;
                    }
                    
                    
                 $cRet    .= " <tr><td idth=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td  align=\"right\"><b>JUMLAH PENDAPATAN&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td  align=\"right\"><b>".$this->angka($lnjmlangpdpt)."</b></td>
									 <td  align=\"right\"><b>".$this->angka($lnjmlrealpdpt)."</b></td>
									 <td  align=\"right\"><b>".$this->angka($lnjmlselpdpt)."</b></td>
									 <td align=\"center\"><b>".$this->angka($persentotal)."</b></td>
								  </tr>";
                
                
                // belanja
                
                $csql12 = "SELECT kd_rek1 AS kd_rek,lra AS rek, nm_rek1 AS nm_rek ,'1' as lepel FROM ms_rek1 
                            WHERE LEFT(kd_rek1,1)='5' 
                            UNION 
                            SELECT kd_rek2 AS kd_rek,lra AS rek,nm_rek2 AS nm_rek ,'2' as lepel FROM ms_rek2
                            WHERE LEFT(kd_rek2,1)='5' 
                            UNION 
                            SELECT kd_rek3 AS kd_rek,lra AS rek,nm_rek3 AS nm_rek ,'3' as lepel FROM ms_rek3
                            WHERE LEFT(kd_rek3,1)='5' order by kd_rek";
                
                $query = $this->db->query($csql12);
                                                  
                $lnjmlangblj = 0;
                $lnjmlrealblj = 0;
                $lnjmlselblj = 0;
                                                  
                foreach ($query->result() as $row)
                {
                    $coba1=$row->rek;
                    $coba2=ucwords(strtolower($row->nm_rek));
                    $lckdrek = $row->kd_rek;
                    $lclen = strlen($lckdrek);
                    $csqlang = "select sum(nilai_ubah) as jm from trdrka where left(kd_rek5,$lclen)='$lckdrek' $lcwhere1";
                    $hslang = $this->db->query($csqlang)->row();
                    if($this->db->query($csqlang)->num_rows>0){
                        $lnang = $hslang->jm;
                    }else{
                        $lnang = 0;
                    }
					
					if ($lnang==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$lnang;
						$per1 = 0; 
                    }
                    
                    
                    
                   
                     
                    
                    $csqlreal = "SELECT SUM(real1) AS jmreal1 FROM (
                    SELECT SUM(a.nilai) AS real1 FROM trdtransout a LEFT JOIN trhtransout b
                    ON a.no_bukti = b.no_bukti WHERE (b.jns_spp = '1' OR b.jns_spp = '2' OR b.jns_spp = '3')
                    AND LEFT(a.kd_rek5,$lclen)='$lckdrek' $lcwhere2
                    UNION 
                    SELECT SUM(a.nilai) AS real1  FROM trdspp a LEFT JOIN 
                    trhsp2d b ON a.no_spp = b.no_spp WHERE (b.jns_spp='4' OR b.jns_spp='5' OR b.jns_spp='6' )
                    AND LEFT(a.kd_rek5,$lclen)='$lckdrek' $lcwhere2 and no_kas_bud<>''
                    UNION 
                    SELECT SUM(rupiah)*-1 AS real1 FROM trdkasin_pkd WHERE LEFT(kd_rek5,$lclen)='$lckdrek' $lcwhere1
                    UNION
                    SELECT SUM(a.nilai) AS real1 FROM trdtransout_blud a LEFT JOIN trhtransout_blud b
                    ON a.no_bukti = b.no_bukti WHERE LEFT(a.kd_rek5,$lclen)='$lckdrek' $lcwhere2
                    UNION
SELECT IFNULL(SUM(a.nilaid)*-1,0) AS real1 FROM dkoreksi a 
INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,$lclen)='$lckdrek' $lcwhere2
UNION
SELECT IFNULL(SUM(a.nilaik),0) AS real1 FROM dkoreksi a 
INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,$lclen)='$lckdrek' $lcwhere2
UNION
SELECT IFNULL(SUM(berkurang)*-1,0) AS real1 FROM raperda  
WHERE LEFT(kd_rek5,$lclen)='$lckdrek' $lcwhere1
UNION
SELECT IFNULL(SUM(bertambah),0) AS real1 FROM raperda  
WHERE LEFT(kd_rek5,$lclen)='$lckdrek' $lcwhere1

                    ) z";
                     
                    //select sum(kredit)-sum(debet) as jmreal1 from trdju_pkd where left(kd_rek5,$lclen)='$lckdrek'";
                    $hslreal = $this->db->query($csqlreal)->row();
                    if($this->db->query($csqlreal)->num_rows>0){
                        $lreal = $hslreal->jmreal1;
                    }else{
                        $lreal = 0;
                    }
                            

   $lbh = $lnang - $lreal;							
                    
                    if ($row->lepel=='3'){
                        $lnjmlangblj = $lnjmlangblj + $lnang;
                        $lnjmlrealblj = $lnjmlrealblj + $lreal;
                        $lnjmlselblj = $lnjmlselblj + $lbh;
                    }
                     
                    if($lnang==0){
                        $persen1 = 0;
                    }else{
                        $persen1 = ($lreal/$lnang)*100;
                    }
                    
                    
                    
                    
                    
                    if(strlen($coba1)<=3){
                        $coba1_= strtoupper($coba1);
                        $coba2_= strtoupper($coba2);
                        
                        $cRet .= "<tr>
									<td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
                                    <td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
                                    <td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
								</tr>";
                        
                        $cRet    .= " <tr>
										<td   align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba1_</b></td>
										<td  style=\"border-top:none;border-bottom:none;\"><b>$coba2_</b></td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>".$this->angka($lnang)."</b></td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>".$this->angka($lreal)."</b></td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>".$this->angka($lbh)."</b></td>
										<td align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>".$this->angka($persen1)."</b></td>
									</tr>";
                    }else{
                        $cRet    .= " <tr>
										<td  align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba1</td>
										<td  style=\"border-top:none;border-bottom:none;\">$coba2</td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">".$this->angka($lnang)."</td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">".$this->angka($lreal)."</td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">".$this->angka($lbh)."</td>
										<td align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">".$this->angka($persen1)."</td>
									</tr>";
                    }
                                        
                }
                
                $persentotal = ($lnjmlrealblj/$lnjmlangblj)*100;
                
                $cRet    .= " <tr><td  align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td  align=\"right\"><b>JUMLAH BELANJA&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td  align=\"right\"><b>".$this->angka($lnjmlangblj)."</b></td>
									<td  align=\"right\"><b>".$this->angka($lnjmlrealblj)."</b></td>
									<td  align=\"right\"><b>".$this->angka($lnjmlselblj)."</b></td>
									<td align=\"center\"><b>".$this->angka($persentotal)."</b></td>
								</tr>";
                
                
                                        
                                
                $surpang = $lnjmlangpdpt - $lnjmlangblj;
                $surpreal = $lnjmlrealpdpt - $lnjmlrealblj;
                $surpsel = $surpang - $surpreal;
                
                $persentotal = ($surpang/$surpreal)*100;
                
                $cRet    .= " <tr><td  align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td  align=\"right\"><b>SURPLUS/DEFISIT</b> &nbsp;&nbsp;&nbsp;&nbsp;</td>
                                     <td  align=\"right\"><b>".$this->angka($surpang)."</b></td>
									 <td  align=\"right\"><b>".$this->angka($surpreal)."</b></td>
									 <td  align=\"right\"><b>".$this->angka($surpsel)."</b></td>
									 <td align=\"center\"><b>".$this->angka($persentotal)."</b></td>
									</tr>";
                
                // pembiayaan masuk
                
                $cRet    .= " <tr>
									<td   align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>3</b></td>
									<td  style=\"border-top:none;border-bottom:none;\"><b>PEMBIAYAAN DAERAH</b></td>
									<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b></b></td>
									<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b></b></td>
									<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b></b></td>
									<td align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b></b></td>
								</tr>";
                
                $csql1 = "SELECT kd_rek2 AS kd_rek,lra AS rek,nm_rek2 AS nm_rek ,'2' as lepel FROM ms_rek2
                            WHERE LEFT(kd_rek2,2)='61' 
                            UNION 
                            SELECT kd_rek3 AS kd_rek,lra AS rek,nm_rek3 AS nm_rek ,'3' as lepel FROM ms_rek3
                            WHERE LEFT(kd_rek3,2)='61' order by kd_rek";
                
                $query = $this->db->query($csql1);
                                                  
                $lnjmlangbym = 0;
                $lnjmlrealbym = 0;
                $lnjmlselbym = 0;
                                                  
                foreach ($query->result() as $row)
                {
                    $coba1=$row->rek;
                    $coba2=ucwords(strtolower($row->nm_rek));
                    $lckdrek = $row->kd_rek;
                    $lclen = strlen($lckdrek);
                    $csqlang = "select sum(nilai_ubah) as jm from trdrka where left(kd_rek5,$lclen)='$lckdrek' $lcwhere1";
                    $hslang = $this->db->query($csqlang)->row();
                    if($this->db->query($csqlang)->num_rows>0){
                        $lnang = $hslang->jm;
                    }else{
                        $lnang = 0;
                    }
					
					if ($lnang==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$lnang;
						$per1 = 0; 
                    }
                    
                    $csqlreal = "SELECT SUM(real1) AS jmreal1 FROM (

SELECT SUM(nilai) AS real1 FROM tr_terima_ppkd WHERE LEFT(kd_rek5,$lclen)='$lckdrek' $lcwhere1
UNION 
SELECT SUM(rupiah) AS real1 FROM trdkasin_pkd WHERE LEFT(kd_rek5,$lclen)='$lckdrek' $lcwhere1
UNION
SELECT SUM(nilai) AS real1 FROM tr_terima_blud WHERE LEFT(kd_rek5,$lclen)='$lckdrek' $lcwhere1
UNION
SELECT IFNULL(SUM(berkurang)*-1,0) AS real1 FROM raperda  
WHERE LEFT(kd_rek5,$lclen)='$lckdrek' $lcwhere1
UNION
SELECT IFNULL(SUM(bertambah),0) AS real1 FROM raperda  
WHERE LEFT(kd_rek5,$lclen)='$lckdrek' $lcwhere1
)z";
                    
                    //select sum(kredit)-sum(debet) as jmreal1 from trdju_pkd where left(kd_rek5,$lclen)='$lckdrek'";
                    $hslreal = $this->db->query($csqlreal)->row();
                    if($this->db->query($csqlreal)->num_rows>0){
                        $lreal = $hslreal->jmreal1;
                    }else{
                        $lreal = 0;
                    }
                    
                    $lbh = $lnang - $lreal;
                    
                                       
                    if ($row->lepel=='3'){
                        $lnjmlangbym = $lnjmlangbym + $lnang;
                        $lnjmlrealbym = $lnjmlrealbym + $lreal;
                        $lnjmlselbym = $lnjmlselbym + $lbh;
                    }
                     
                    if($lnang==0){
                        $persen1 = 0;
                    }else{
                        $persen1 = ($lreal/$lnang)*100;
                    }
                                        
					//$persen1  = number_format($per1,2);
                    
                    if(strlen($coba1)<=3){
                        $coba1_= strtoupper($coba1);
                        $coba2_= strtoupper($coba2);
                        
                        $cRet .= "<tr>
									<td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
                                    <td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
                                    <td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
								</tr>";
                        
                        $cRet    .= " <tr>
										<td   align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba1_</b></td>
										<td  style=\"border-top:none;border-bottom:none;\"><b>$coba2_</b></td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>".$this->angka($lnang)."</b></td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>".$this->angka($lreal)."</b></td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>".$this->angka($lbh)."</b></td>
										<td align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>".$this->angka($persen1)."</b></td>
									</tr>";
                    }else{
                        $cRet    .= " <tr>
										<td  align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba1</td>
										<td  style=\"border-top:none;border-bottom:none;\">$coba2</td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">".$this->angka($lnang)."</td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">".$this->angka($lreal)."</td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">".$this->angka($lbh)."</td>
										<td align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">".$this->angka($persen1)."</td>
									</tr>";
                    }
                    
                }
                 
                // $persentotal = ($lnjmlrealbym/$lnjmlangbym)*100;
				
				  if($lnjmlangbym==0){
                        $persentotal = 0;
                    }else{
                 $persentotal = ($lnjmlrealbym/$lnjmlangbym)*100;
                    }
                    
                 $cRet    .= " <tr><td idth=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td  align=\"right\"><b>JUMLAH PEMBIAYAAN MASUK&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td  align=\"right\"><b>".$this->angka($lnjmlangbym)."</b></td>
									 <td  align=\"right\"><b>".$this->angka($lnjmlrealbym)."</b></td>
									 <td  align=\"right\"><b>".$this->angka($lnjmlselbym)."</b></td>
									 <td align=\"center\"><b>".$this->angka($persentotal)."</b></td>
								  </tr>";
                
                
                /// PEMBIAYAAN KELUAR
                
                $csql1 = "SELECT kd_rek2 AS kd_rek,lra AS rek,nm_rek2 AS nm_rek ,'2' as lepel FROM ms_rek2
                            WHERE LEFT(kd_rek2,2)='62' 
                            UNION 
                            SELECT kd_rek3 AS kd_rek,lra AS rek,nm_rek3 AS nm_rek ,'3' as lepel FROM ms_rek3
                            WHERE LEFT(kd_rek3,2)='62' order by kd_rek";
                
                $query = $this->db->query($csql1);
                                                  
                $lnjmlangklr = 0;
                $lnjmlrealklr = 0;
                $lnjmlselklr = 0;
                                                  
                foreach ($query->result() as $row)
                {
                    $coba1=$row->rek;
                    $coba2=ucwords(strtolower($row->nm_rek));
                    $lckdrek = $row->kd_rek;
                    $lclen = strlen($lckdrek);
                    $csqlang = "select sum(nilai_ubah) as jm from trdrka where left(kd_rek5,$lclen)='$lckdrek' $lcwhere1";
                    $hslang = $this->db->query($csqlang)->row();
                    if($this->db->query($csqlang)->num_rows>0){
                        $lnang = $hslang->jm;
                    }else{
                        $lnang = 0;
                    }
					
					if ($lnang==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$lnang;
						$per1 = 0; 
                    }
                    
                    
                    $csqlreal = "SELECT SUM(real1) AS jmreal1 FROM (
                    SELECT SUM(a.nilai) AS real1 FROM trdtransout a LEFT JOIN trhtransout b
                    ON a.no_bukti = b.no_bukti WHERE (b.jns_spp = '1' OR b.jns_spp = '2' OR b.jns_spp = '3')
                    AND LEFT(a.kd_rek5,$lclen)='$lckdrek' $lcwhere2
                    UNION 
                    SELECT SUM(a.nilai) AS real1  FROM trdspp a LEFT JOIN 
                    trhsp2d b ON a.no_spp = b.no_spp WHERE (b.jns_spp='4' OR b.jns_spp='5' OR b.jns_spp='6' )
                    AND LEFT(a.kd_rek5,$lclen)='$lckdrek' $lcwhere2 and no_kas_bud<>''
                    UNION 
                    SELECT SUM(rupiah) AS real1 FROM trdkasin_pkd WHERE LEFT(kd_rek5,$lclen)='$lckdrek' $lcwhere1
					UNION
					SELECT SUM(a.nilai) AS real1 FROM trdtransout_blud a LEFT JOIN trhtransout_blud b
                    ON a.no_bukti = b.no_bukti WHERE LEFT(a.kd_rek5,$lclen)='$lckdrek' $lcwhere2
					UNION
					SELECT IFNULL(SUM(a.nilaid)*-1,0) AS real1 FROM dkoreksi a 
					INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,$lclen)='$lckdrek' $lcwhere2
					UNION
					SELECT IFNULL(SUM(a.nilaik),0) AS real1 FROM dkoreksi a 
					INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,$lclen)='$lckdrek' $lcwhere2
					UNION
SELECT IFNULL(SUM(berkurang)*-1,0) AS real1 FROM raperda  
WHERE LEFT(kd_rek5,$lclen)='$lckdrek' $lcwhere1
UNION
SELECT IFNULL(SUM(bertambah),0) AS real1 FROM raperda  
WHERE LEFT(kd_rek5,$lclen)='$lckdrek' $lcwhere1

                ) z";
                    
                    //select sum(kredit)-sum(debet) as jmreal1 from trdju_pkd where left(kd_rek5,$lclen)='$lckdrek'";
                    $hslreal = $this->db->query($csqlreal)->row();
                    if($this->db->query($csqlreal)->num_rows>0){
                        $lreal = $hslreal->jmreal1;
                    }else{
                        $lreal = 0;
                    }
                    
                    $lbh = $lnang - $lreal;
                    
                                       
                    if ($row->lepel=='3'){
                        $lnjmlangklr = $lnjmlangklr + $lnang;
                        $lnjmlrealklr = $lnjmlrealklr + $lreal;
                        $lnjmlselklr = $lnjmlselklr + $lbh;
                    }
                     
                    if($lnang==0){
                        $persen1 = 0;
                    }else{
                        $persen1 = ($lreal/$lnang)*100;
                    }
                                        
					//$persen1  = number_format($per1,2);
                    
                    if(strlen($coba1)<=3){
                        $coba1_= strtoupper($coba1);
                        $coba2_= strtoupper($coba2);
                        
                        $cRet .= "<tr>
									<td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
                                    <td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
                                    <td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
								</tr>";
                        
                        $cRet    .= " <tr>
										<td   align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba1_</b></td>
										<td  style=\"border-top:none;border-bottom:none;\"><b>$coba2_</b></td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>".$this->angka($lnang)."</b></td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>".$this->angka($lreal)."</b></td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>".$this->angka($lbh)."</b></td>
										<td align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>".$this->angka($persen1)."</b></td>
									</tr>";
                    }else{
                        $cRet    .= " <tr>
										<td  align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba1</td>
										<td  style=\"border-top:none;border-bottom:none;\">$coba2</td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">".$this->angka($lnang)."</td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">".$this->angka($lreal)."</td>
										<td  align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">".$this->angka($lbh)."</td>
										<td align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">".$this->angka($persen1)."</td>
									</tr>";
                    }
                    
                }
                 

                 if($lnjmlangklr <> 0){
						//$per2   = ($totpend!=0)?($totpend /$rowp->totp) * 100:0; 

						$persentotal = ($lnjmlrealklr/$lnjmlangklr)*100;
					}else{
						$persentotal=0;
					}

                 
                    
                 $cRet    .= " <tr><td idth=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td  align=\"right\"><b>JUMLAH PEMBIAYAAN KELUAR&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td  align=\"right\"><b>".$this->angka($lnjmlangklr)."</b></td>
									 <td  align=\"right\"><b>".$this->angka($lnjmlrealklr)."</b></td>
									 <td  align=\"right\"><b>".$this->angka($lnjmlselklr)."</b></td>
									 <td align=\"center\"><b>".$this->angka($persentotal)."</b></td>
								  </tr>";
                
                 
                  $cRet .= "<tr><td  align=\"center\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
									<td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
							  </tr>";
                 
                 $lnangselpem = $lnjmlangbym - $lnjmlangklr;
                 $lnrealselpem = $lnjmlrealbym - $lnjmlrealklr;
                 $lnselpem = $lnjmlselbym - $lnjmlselklr;
				 
				   if($lnangselpem==0){
                        $persentotal = 0;
                    }else{
                 $persentotal = ($lnrealselpem/$lnangselpem)*100;
                    }
                    
                 
                 
                 $cRet    .= " <tr><td  align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td  align=\"right\"><b>PEMBIAYAAN NETTO&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td  align=\"right\"><b>".$this->angka($lnangselpem)."</b></td>
									 <td  align=\"right\"><b>".$this->angka($lnrealselpem)."</b></td>
									 <td  align=\"right\"><b>".$this->angka($lnselpem)."</b></td>
									 <td align=\"center\"><b>".$this->angka($persentotal)."</b></td>
								</tr>";
                 
                 $cRet .= "<tr><td  align=\"center\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
									<td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td  style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
							  </tr>";
                 
                 
                 $lnangsilpa = $surpang + $lnangselpem;
                 $lnrealsilpa = $surpreal + $lnrealselpem;
                 $selsilpa = $lnrealsilpa - $lnangsilpa;
$SUP=$surpsel-$lnselpem;

               //  $persentotal = ($lnrealsilpa/$lnangsilpa)*100;


                 if($lnangsilpa <> 0){
						//$per2   = ($totpend!=0)?($totpend /$rowp->totp) * 100:0; 
                 $persentotal = ($lnrealsilpa/$lnangsilpa)*100;
						//$persentotal = ($lnjmlrealklr/$lnjmlangklr)*100;
					}else{
						$persentotal=0;
					}

                //$persentotal = 0;
                 $cRet    .= " <tr><td  align=\"left\"><b>3.3</b></td>                                     
                                     <td  ><b>SISA LEBIH PEMBIAYAAN ANGGARAN TAHUN BERKENAAN (SILPA)&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td  align=\"right\"><b>".$this->angka($lnangsilpa)."</b></td>
									 <td  align=\"right\"><b>".$this->angka($lnrealsilpa)."</b></td>
									 <td  align=\"right\"><b>".$this->angka($lnangsilpa-$lnrealsilpa)."</b></td>
									 <td align=\"center\"></td>
									</tr>";
                 
                
                    
        $cRet    .= "</table>";
		
		    $cRet .= " <table border=\"0\" cellpading = \"8\" width=\"100%\">
                                                        <tr>
                                                            <td width=\"90%\" align=\"left\">&nbsp;<br>&nbsp;
								<br>&nbsp;
								&nbsp;<br>
                                                                &nbsp;<br>
                                                                &nbsp;<br>
								&nbsp;	
                                                            </td>
                                                            <td width=\"30%\" align=\"center\">".ucwords(strtoupper($daerah)).", ".ucwords(strtolower('__ SEPTEMBER 2016'))."&nbsp;&nbsp;&nbsp;
															".ucwords(strtolower($tgl_ctk_raperda))."
															<br>
															<br>
															
                                                               <p><B>BUPATI BIAK NUMFOR</B></p>
                                                                <p>&nbsp;</p>
                                                                <br><br>
                                                                <br><b>$bupati</b>
                                                                <br>
                                                            </td>
                                                        </tr>
                                                    </table>";
		$init="LAMPIRAN I - RINGKASAN LAPORAN REALISASI ANGGARAN PENDAPATAN DAN BELANJA DAERAH $kab";
        $data['prev']= $cRet;
        $this->template->set('title', 'CETAK PERDA');
       // $this->_mpdf1('',$cRet,25,10,10,'P','',$hal);
        switch($cetak) {
			case 0;
				 echo ("<title>L R A</title>"); 
				 echo $cRet;
			break;		
			case 1;
				 //$this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
				$this->_mpdftn('', $cRet, 10, 10, 10,'P', $init);
			break;
			case 2;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= LRA.xls");
				
				$this->load->view('anggaran/rka/perkadaII', $data);
			break;
			case 3;     
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= LRA.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
			break;
        
        }
    }
	

    function bukubesar(){

        $data['page_title'] = 'CETAK BUKU BESAR';
        $this->template->set('title', 'BUKU BESAR');
        $this->template->load('template', 'akuntansi/bukubesar', $data);

    }

    function skpd(){
        $lccr = $this->input->post('q');
        $sql = "SELECT kd_skpd,upper(nm_skpd) as nm_skpd FROM ms_skpd where upper(kd_skpd) like upper('%$lccr%') or upper(nm_skpd) like upper('%$lccr%') order by kd_skpd ";
        $query1 = $this->db->query($sql);
        $result = array();
        $ii = 0;
        foreach ($query1->result_array() as $resulte)
        {

            $result[] = array(
			'id' => $ii, 
			'kd_skpd' => $resulte['kd_skpd'], 
			'nm_skpd' => $resulte['nm_skpd'] 
			);
            $ii++;
        }

        echo json_encode($result);
    }

    function rekening(){
        $lccr = $this->input->post('q');
		$sql = "SELECT DISTINCT(kd_rek5),nm_rek5 FROM trdju_pkd WHERE kd_rek5 <> '' 
					AND nm_rek5 <> '' AND (kd_rek5 LIKE '$lccr%' OR UPPER(nm_rek5) LIKE UPPER('$lccr%')) ORDER BY kd_rek5";
		
        $query1 = $this->db->query($sql);  
        $result = array();
        $ii = 0;
        foreach($query1->result_array() as $resulte){
            $result[] = array(
				'id' => $ii,        
				'kd_rek5' => $resulte['kd_rek5'],  
				'nm_rek5' => $resulte['nm_rek5'],                   
			);
			$ii++;
        }
        echo json_encode($result);
	} 
    
  

  function cetakbb(){
     $cetak = $this->uri->segment(3);
       $tglttd  = $_REQUEST['tglttd'];
			$dcetak  = $_REQUEST['dcetak'];
			$dcetak2 = $_REQUEST['dcetak2'];
			$skpd 	 = $_REQUEST['skpd'];
			$rek5 	 = $_REQUEST['rek5'];
			$space 	 = $_REQUEST['space'];
			$nip     = $_REQUEST['nip'];		
			$gl     = $_REQUEST['gl'];		
			$nip1    = $_REQUEST['nip1'];	
		
				
        if(substr($rek5,0,3)=='523' || substr($rek5,0,3)=='522' || substr($rek5,0,3)=='524' || substr($rek5,0,3)=='525' || substr($rek5,0,3)=='521'){
			$jabkabid='KEPALA BIDANG ASET';
			$nmkabid ='ALFIUS ADADIKAM, A.Md.Sos';
			$nipkabid='19600404 198603 1 029';
		}else{
			$jabkabid='KEPALA BIDANG AKUNTANSI';
			$nmkabid ='ROMEL TIMISELA,S.Sos., MM';
			$nipkabid='19710501 199703 1 002';
		}    
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                $sqlsclient=$this->db->query($sqlsc);
                foreach ($sqlsclient->result() as $rowsc){
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                }
				       $sqlttd="SELECT jabatan,nip,nama from ms_ttd where kd_skpd='1.20.05.01' and nip='$nip'";
         $z=0;
         $sqlsclient=$this->db->query($sqlttd);
         foreach ($sqlsclient->result() as $rowst)
        {
            $nipt     = $rowst->nip;
            $jabatant  = $rowst->jabatan;
            $namat     = $rowst->nama;
            $z++;
        }

            if($z=='0'){
                $nipt='BELUM ADA NIP';
                $namat='BELUM ADA NAMA';
                $jabatant='BELUM ADA JABATAN';
            
        } 

			$sqlttd1="SELECT jabatan,nip,nama from ms_ttd where kd_skpd='1.20.05.01' and nip='$nip1'";
					 $z=0;
					 $sqlsclient1=$this->db->query($sqlttd1);
					 foreach ($sqlsclient1->result() as $rowst1)
					{
						$nipt1     = $rowst1->nip;
						$jabatant1  = $rowst1->jabatan;
						$namat1     = $rowst1->nama;
						$z++;
					}

						if($z=='0'){
							$nipt1='BELUM ADA NIP';
							$namat1='BELUM ADA NAMA';
							$jabatant1='BELUM ADA JABATAN';
						
					} 				


if($rek5=='0000000'){

	$nmrek="Perubahan Sal";
}else{

		$sqlnm="SELECT nm_rek64 as nm_rek5 FROM ms_rek5 WHERE kd_rek64='$rek5'";
                $sqlnmrek=$this->db->query($sqlnm);
                foreach ($sqlnmrek->result() as $row){
                	$nmrek=$row->nm_rek5;
                	          }

}


		if((substr($rek5,0,1)=='0')||(substr($rek5,0,1)=='1')||(substr($rek5,0,1)=='2')||(substr($rek5,0,1)=='3')
				||(substr($rek5,0,1)=='8')||(substr($rek5,0,1)=='9')){
						$pokok = '0.00';
						$ubah  = '0.00';
		}else{
			/*$sqlpg="SELECT
						IFNULL((SELECT nilai FROM trdrka WHERE kd_skpd='$skpd' AND kd_rek5='$rek5'),0) AS pokok,
						IFNULL((SELECT nilai_ubah FROM trdrka WHERE kd_skpd='$skpd' AND kd_rek5='$rek5'),0) AS ubah";*/
				$sqlpg="SELECT SUM(IF(kd_rek5='$rek5',nilai,0))AS pokok,
						SUM(IF(kd_rek5='$rek5',nilai_ubah,0))AS ubah
						FROM trdrka WHERE kd_skpd='$skpd'";
					$sqlnilpg=$this->db->query($sqlpg);
					foreach ($sqlnilpg->result() as $row){
						if($row->pokok==0.00){
						$pok = '0.00';
						}else{
						$pok = $row->pokok;
						}
						if($row->ubah==0.00){
						$uba = '0.00';
						}else{
						$uba = $row->ubah;
						}
						$pokok = number_format($pok,'2',',','.');
						$ubah  = number_format($uba,'2',',','.');
					}		
		}
		//$cRet .="<TABLE style="border-collapse:collapse;" width="100%" align="center" border="1" cellspacing="0" cellpadding="4">

				$cRet ="<table width=\"100%\" border=\"0\" >
					<tr>
						<td  COLSPAN=\"6\" align=\"RIGHT\" style=\"font-size:8\"><b>PEMERINTAH $kab</b></td>
					</tr>
					<tr>
						<td  COLSPAN=\"6\" align=\"RIGHT\" style=\"font-size:8\"><b>BADAN PENGELOLA KEUANGAN DAN ASET DAERAH</b></td>
					</tr>
					<tr>
						<td  COLSPAN=\"6\"  align=\"RIGHT\" style=\"font-size:8\"><b>BIDANG AKUNTANSI</b></td>
					</tr>
					</table>";
		




			$cRet .="<table width=\"100%\">
					<tr>
						<td COLSPAN=\"6\" align=\"center\" ><b>BUKU BESAR </b></td>
					</tr>
					</table>";
			$cRet .="<br>";
			$cRet .="<table width=\"100%\">
					 <tr>
						<td align=\"left\" width=\"25%\" >SKPD</td>
						<td align=\"left\" width=\"75%\" >: $skpd ".$this->tukd_model->get_nama($skpd,'nm_skpd','ms_skpd','kd_skpd')."</td>
					 </tr>
					 <tr>
						<td align=\"left\" width=\"25%\" >KODE REKENING</td>
						<td align=\"left\" width=\"75%\" >: $rek5</td>
					 </tr>
					 <tr>
						<td align=\"left\" width=\"25%\" >NAMA REKENING</td>
						<td align=\"left\" width=\"75%\" >: $nmrek</td>
					 </tr> 
					 <tr>
						<td align=\"left\" width=\"25%\" >PAGU APBD</td>
						<td align=\"left\" width=\"75%\" >: $pokok</td>
					 </tr>
					 <tr>
						<td align=\"left\" width=\"25%\" >PAGU PERUBAHAN APBD</td>
						<td align=\"left\" width=\"75%\" >: $ubah</td>
					 </tr>                                                              
					 <tr>
						<td align=\"left\" width=\"25%\" >Periode</td>
						<td align=\"left\" width=\"75%\" >: ".$this->tukd_model->tanggal_format_indonesia($dcetak)." s/d ".$this->tukd_model->tanggal_format_indonesia($dcetak2)."</td>
					 </tr>
					 </table>";

			$cRet .='<TABLE style="border-collapse:collapse;" width="100%" align="center" border="1" cellspacing="0" cellpadding="4">
					 <THEAD>
					 <TR>
						<TD width="20%"  bgcolor="#CCCCCC" align="center" >TANGGAL</TD>
						<TD width="30%" bgcolor="#CCCCCC" align="center" >URAIAN</TD>
						<TD width="5%" bgcolor="#CCCCCC" align="center" >REF</TD>
						<TD width="15%" bgcolor="#CCCCCC" align="center" >DEBET</TD>
						<TD width="15%" bgcolor="#CCCCCC" align="center" >KREDIT</TD>
						<TD width="15%" bgcolor="#CCCCCC" align="center" >SALDO</TD>
					 </TR>
					 <TR>
						<TD width="20%"  bgcolor="#CCCCCC" align="center" >1</TD>
						<TD width="30%" bgcolor="#CCCCCC" align="center" >2</TD>
						<TD width="5%" bgcolor="#CCCCCC" align="center" >3</TD>
						<TD width="15%" bgcolor="#CCCCCC" align="center" >4</TD>
						<TD width="15%" bgcolor="#CCCCCC" align="center" >5</TD>
						<TD width="15%" bgcolor="#CCCCCC" align="center" >6</TD>
					 </TR>                     
					 </THEAD>';
					 
			$thn_ang=$this->session->userdata('pcThang')-1;

         $csql3 = "SELECT IF(SUM(a.debet)IS NULL,0,SUM(a.debet)) AS debet,IF(SUM(a.kredit)IS NULL,0,SUM(a.kredit)) AS kredit FROM trdju_pkd a 
                        LEFT JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_skpd WHERE a.kd_rek5='$rek5' AND b.kd_skpd='$skpd' 
                        and b.tgl_voucher <'$dcetak'";
						
         $hasil = $this->db->query($csql3);
         $trh4 = $hasil->row(); 
         $awaldebet = $trh4->debet;
         $awalkredit = $trh4->kredit;
                    if ((substr($rek5,0,1)=='9') or (substr($rek5,0,1)=='5') or (substr($rek5,0,2)=='62') or (substr($rek5,0,2)=='72') or (substr($rek5,0,1)=='1')){					
						$saldo=$awaldebet-$awalkredit;
					}else{
						$saldo=$awalkredit-$awaldebet;
					} 
                    
                    $cRet .='<TR>
								<TD width="20%" align="left" ></TD>
								<TD width="35%" align="left" >saldo awal</TD>
								<TD width="5%" align="left" ></TD>
								<TD width="15%" align="right" ></TD>
								<TD width="15%" align="right" ></TD>
								<TD width="15%" align="right" >'.number_format($saldo,2,',','.').'</TD>
							 </TR>';	      
                
				$idx=1;
				$query = $this->db->query("SELECT a.kd_rek5,a.debet,a.kredit,b.tgl_voucher,b.ket,b.no_voucher FROM trdju_pkd a 
                                                LEFT JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_skpd WHERE a.kd_rek5='$rek5' 
                                                AND b.kd_skpd='$skpd' AND b.tgl_voucher between '$dcetak' AND '$dcetak2'
                                                ORDER BY b.tgl_voucher,a.no_voucher,a.urut"); 
                                                  
				if ($query->num_rows() > 0){
					$jdebet=0;
					$jkredit=0;
					foreach($query->result_array() as $res){
											
						$tgl_voucher=$res['tgl_voucher'];
						$ket=$res['ket'];
						$ref=$res['no_voucher'];
						$debet=$res['debet'];
						$kredit=$res['kredit'];
						$idx++;
						
						$saldo=$saldo;
						if ((substr($rek5,0,1)=='9') or (substr($rek5,0,1)=='5') or (substr($rek5,0,2)=='62') 
                                    or (substr($rek5,0,2)=='72') or (substr($rek5,0,1)=='1')){					
							$saldo=$saldo+$debet-$kredit;
							
						}else{
							$saldo=$saldo+$kredit-$debet;
							
						}
						
						$cRet .='<TR>
									<TD width="20%" align="left" >'.$this->tukd_model->tanggal_format_indonesia($tgl_voucher).'</TD>
									<TD width="35%" align="left" >'.$ket.'</TD>
									<TD width="5%" align="left" >'.$ref.'</TD>
									<TD width="15%" align="right" >'.number_format($debet,2,',','.').'</TD>
									<TD width="15%" align="right" >'.number_format($kredit,2,',','.').'</TD>
									<TD width="15%" align="right" >'.number_format($saldo,2,',','.').'</TD>
								 </TR>';
								 
						$jdebet=$jdebet+$debet;
						$jkredit = $jkredit + $kredit;

					}
					$cRet .='<TR>
                                <TD align="left" ></TD>
        						<TD colspan=\"3\" align="right" ><b>JUMLAH</b></TD>
                                <TD align="left" ></TD>
        						<TD align="right" ><b>'.number_format($jdebet,2,',','.').'</b></TD>
        						<TD align="right" ><b>'.number_format($jkredit,2,',','.').'</b></TD>
        						<TD align="right" ><b>'.number_format($saldo,2,',','.').'</b></TD>
        					 </TR>';
					$cRet .='</TABLE>';				 
				} else{
				$cRet .='</TABLE>';
				}
			

		  $last=date('Y-m-t',strtotime($dcetak2));




		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\"  style=\"font-size:12\" align=\"left\" border=\"0\">";
                           for($i=0;$i<=$space;$i++){
                $cRet .="<tr>
                            <td colspan=\"3\">&nbsp;</td>
                        </tr>";
            }

                        $cRet.="<tr>
							<td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td>
                        </tr>
						<tr>
							<td colspan=\"2\" width=\"41%\" align=\"center\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tglttd)."</td>
                        </tr>
						<tr>
							<td colspan=\"2\" width=\"41%\" align=\"center\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\"><b>DIBUAT OLEH</b></td>
                        </tr>
						
						<tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
						<tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
						<tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
						
						<tr>
							<td colspan=\"2\" width=\"41%\" align=\"center\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\"><b><u>$namat</u></b></td>
                        </tr>
						<tr>
							<td colspan=\"2\" width=\"41%\" align=\"center\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\"><b>NIP : $nipt</b></td>
                        </tr>

                    </table>"; 

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" style=\"font-size:12\" align=\"left\" border=\"0\">
                      	<tr><td colspan=\"3\" width=\"41%\" align=\"center\">MENGETAHUI,</td></tr>
						
						<tr>
							<td width=\"41%\" align=\"center\"><b>$jabkabid</b></td>
                            <td width=\"18%\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\"><b>$jabatant1</b></td>
                        </tr>
							<tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
							<tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
							<tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
						<tr>
							<td width=\"41%\" align=\"center\"><b><u>$nmkabid</u></b></td>
                            <td width=\"18%\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\"><b><u>$namat1</u></b></td>
                        </tr>
						<tr>
							<td width=\"41%\" align=\"center\"><b>NIP : $nipkabid</b></td>
                            <td width=\"18%\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\"><b>NIP : $nipt1</b></td>
                        </tr>

                    </table>"; 
					
					
					if(substr($rek5,0,3)<>'523' and substr($rek5,0,3)<>'522' and substr($rek5,0,3)<>'524' and substr($rek5,0,3)<>'525' and substr($rek5,0,3)<>'521'){
                    		$cRet .="<table style=\"border-collapse:collapse;\" style=\"font-size:12\" width=\"100%\" align=\"left\" border=\"0\">
                      <tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
						<tr>
							<tr><td colspan=\"3\" width=\"41%\" align=\"center\">MENYETUJUI,</td></tr>
                        </tr>
						<tr><td colspan=\"3\" width=\"41%\" align=\"center\"><B>KEPALA BPKAD BIAK NUMFOR</td></B></tr>
						<tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
						<tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
						<tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>";
					

					if($gl==1){
                
						$cRet .="<tr>
							<td colspan=\"3\" width=\"41%\" align=\"center\"><b><u>ENIAS RUMBEWAS,SE.,M.Si</u></b></td>
                       
                        </tr>";
}else{
						$cRet .="<tr>
							<td colspan=\"3\" width=\"41%\" align=\"center\"><b><u>DR. ENIAS RUMBEWAS,SE.,M.Si</u></b></td>
                       
                        </tr>";
}


						$cRet .="<tr>
						<td colspan=\"3\" width=\"41%\" align=\"center\"><b>NIP : 19640623 199610 1 001</b></td>
                        </tr>

                    </table>"; 
					}




			
			 $data['prev']= $cRet;    
        switch($cetak) {
        case 0;
            $this->template->load('template','anggaran/rka/perkadaII',$data);
        break;
        case 1;
			//$skpdx=$kd_skpd.' '.$nm_skpd;
             $this->tukd_model->_mpdf('',$cRet,10,5,10,'0');	
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= BB.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        
        }

			
			
			
			
	}

 

  
    function jukeluar(){
        $data['page_title'] = 'JURNAL PENGELUARAN';
        $this->template->set('title', 'JURNAL PENGELUARAN');
        $this->template->load('template', 'akuntansi/jukeluar', $data);
    }

    function jumasuk()    {
        $data['page_title'] = 'JURNAL PENERIMAAN';
        $this->template->set('title', 'JURNAL PENERIMAAN');
        $this->template->load('template', 'akuntansi/jumasuk', $data);
    }

    function ctk_jukeluar($dcetak = '', $ttd = '', $skpd = '', $dcetak2 = ''){

        $cRet = '<TABLE width="100%">
					<TR>
						<TD align="center" >JURNAL PENGELUARAN</TD>
					</TR>
					</TABLE>';

        $cRet .= '<TABLE width="100%">
					 <TR>
						<TD align="left" width="100" >SKPD</TD>
						<TD align="left" width="100" >: ' . $skpd . ' ' . $this->tukd_model->
            get_nama($skpd, 'nm_skpd', 'ms_skpd', 'kd_skpd') . '</TD>
					 </TR>
					 <TR>
						<TD  align="left" width="100" >PERIODE</TD>
						<TD align="left" width="100" >: ' . $this->tukd_model->
            tanggal_format_indonesia($dcetak) . ' s/d ' . $this->tukd_model->
            tanggal_format_indonesia($dcetak2) . '</TD>
					 </TR>
					 </TABLE>';

        $cRet .= '<TABLE border="1" cellspacing="0" cellpadding="0" >
					 <TR>
						<TD width="90" align="center" rowspan="2" >TANGGAL</TD>
						<TD width="200" align="center" colspan="2" >NOMOR</TD>
						<TD width="100" align="center" rowspan="2" >KODE REKENING</TD>
						<TD width="200" align="center" rowspan="2" >URAIAN</TD>
						<TD width="80" align="center"  rowspan="2" >REF</TD>
						<TD width="100" align="center" rowspan="2" >JUMLAH</TD>
						<TD width="100" align="center" rowspan="2" >AKUMULASI</TD>
					 </TR>';

        $cRet .= '<TR>
						<TD width="100" align="center" >No.Bukti</TD>
						<TD width="100" align="center" >Bukti Lain</TD>
					 </TR>';

        $idx = 1;
        $saldo = 0;
        $tbukti = '';
        $tgl = '';
        $query = $this->db->query(" SELECT a.kd_rek5,a.nilai,a.nm_rek5,b.tgl_kas,b.ket,b.no_kas FROM trdkasout_pkd a LEFT JOIN trhkasout_pkd b ON a.no_kas=b.no_kas WHERE b.kd_skpd='$skpd' and b.tgl_kas>='$dcetak' and b.tgl_kas<='$dcetak2' order by b.tgl_kas ");
        foreach ($query->result_array() as $res)
        {
            if ($tbukti != $res['no_kas'])
            {
                $nokas = $res['no_kas'];
            } else
            {
                $nokas = '';
            }
            if ($tgl != $res['tgl_kas'])
            {
                $tanggal = $res['tgl_kas'];
            } else
            {
                $tanggal = '';
            }
            $saldo = $saldo + $res['nilai'];
            $cRet .= '<TR>
								<TD  align="left" >' . $this->tukd_model->rev_date($res['tgl_kas']) .
                '</TD>
								<TD  align="left" >' . $nokas . '</TD>
								<TD  align="left" ></TD>
								<TD  align="center" >' . $res['kd_rek5'] . '</TD>
								<TD  align="left" >' . $res['nm_rek5'] . '</TD>
								<TD  align="left" ></TD>
								<TD  align="right" >' . number_format($res['nilai']) . '</TD>
								<TD  align="right" >' . number_format($saldo) . '</TD>
							 </TR>';
            $idx++;
            $tbukti = $res['no_kas'];
            $tgl = $res['tgl_kas'];
        }


        $cRet .= '</TABLE>';

        $data['prev'] = 'JURNAL PENGELUARAN';
        $this->tukd_model->_mpdf('', $cRet, 5, 5, 10, '0');

    }

    function ctk_jumasuk($dcetak = '', $ttd = '', $skpd = '', $dcetak2 = ''){
        $cRet = '<TABLE width="100%">
					<TR>
						<TD align="center" >JURNAL PENERIMAAN</TD>
					</TR>
					</TABLE>';

        $cRet .= '<TABLE width="100%">
					 <TR>
						<TD align="left" width="100" >SKPD</TD>
						<TD align="left" width="100" >: ' . $skpd . ' ' . $this->tukd_model->
            get_nama($skpd, 'nm_skpd', 'ms_skpd', 'kd_skpd') . '</TD>
					 </TR>
					 <TR>
						<TD  align="left" width="100" >PERIODE</TD>
						<TD align="left" width="100" >: ' . $this->tukd_model->
            tanggal_format_indonesia($dcetak) . ' s/d ' . $this->tukd_model->
            tanggal_format_indonesia($dcetak2) . '</TD>
					 </TR>
					 </TABLE>';

        $cRet .= '<TABLE border="1" cellspacing="0" cellpadding="0" >
					 <TR>
						<TD width="90" align="center" rowspan="2" >TANGGAL</TD>
						<TD width="200" align="center" colspan="2" >NOMOR</TD>
						<TD width="100" align="center" rowspan="2" >KODE REKENING</TD>
						<TD width="200" align="center" rowspan="2" >URAIAN</TD>
						<TD width="80" align="center"  rowspan="2" >REF</TD>
						<TD width="100" align="center" rowspan="2" >JUMLAH</TD>
						<TD width="100" align="center" rowspan="2" >AKUMULASI</TD>
					 </TR>';

        $cRet .= '<TR>
						<TD width="100" align="center" >No.Bukti</TD>
						<TD width="100" align="center" >Bukti Lain</TD>
					 </TR>';

        $idx = 1;
        $saldo = 0;
        $tbukti = '';
        $query = $this->db->query(" SELECT a.kd_rek5,a.rupiah AS nilai,c.nm_rek5,b.tgl_sts,b.no_sts as no_kas FROM trdkasin_pkd a LEFT JOIN trhkasin_pkd b ON a.no_sts=b.no_sts LEFT JOIN ms_rek5 c ON a.kd_rek5=c.kd_rek5 WHERE  b.kd_skpd='$skpd' and b.tgl_sts>='$dcetak' and b.tgl_sts<='$dcetak2' ");
        foreach ($query->result_array() as $res)
        {
            if ($tbukti != $res['no_kas'])
            {
                $nokas = $res['no_kas'];
            } else
            {
                $nokas = '';
            }
            $saldo = $saldo + $res['nilai'];
            $cRet .= '<TR>
								<TD  align="left" >' . $this->tukd_model->rev_date($res['tgl_sts']) .
                '</TD>
								<TD  align="left" >' . $nokas . '</TD>
								<TD  align="left" ></TD>
								<TD  align="center" >' . $res['kd_rek5'] . '</TD>
								<TD  align="left" >' . $res['nm_rek5'] . '</TD>
								<TD  align="left" ></TD>
								<TD  align="right" >' . number_format($res['nilai']) . '</TD>
								<TD  align="right" >' . number_format($saldo) . '</TD>
							 </TR>';
            $idx++;
            $tbukti = $res['no_kas'];
        }


        $cRet .= '</TABLE>';

        $data['prev'] = 'JURNAL PENERIMAAN';
        $this->tukd_model->_mpdf('', $cRet, 5, 5, 10, '0');

    }

    function jumum(){
        $data['page_title'] = 'INPUT JURNAL UMUM';
        $this->template->set('title', 'INPUT JURNAL UMUM');
        $this->template->load('template', 'akuntansi/jumum', $data);
    }

    function jumum_ppkd(){
        $data['page_title'] = 'INPUT JURNAL UMUM';
        $this->template->set('title', 'INPUT JURNAL UMUM');
        $this->template->load('template', 'akuntansi/jumum_ppkd', $data);
    }

    function load_ju(){
        $result = array();
        $row = array();
        $page = isset($_POST['page']) ? intval($_POST['page']) : 1;
        $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
        $offset = ($page - 1) * $rows;
        $kriteria = $this->input->post('cari');
        $where = "where tabel='1'";
        if ($kriteria <> '')
        {
            $where = "where tabel='1' and (upper(no_voucher) like upper('%$kriteria%') or tgl_voucher like '%$kriteria%' or upper(ket) like upper('%$kriteria%')) ";
        }

        $sql = "SELECT count(*) as total from trhju_pkd $where";
        $query1 = $this->db->query($sql);
        $total = $query1->row();
        $result["total"] = $total->total;
        $query1->free_result();

        $sql = " select * from trhju_pkd $where order by tgl_voucher,no_voucher,kd_skpd limit $offset,$rows";
        $query1 = $this->db->query($sql);
        $ii = 0;
        foreach ($query1->result_array() as $resulte)
        {
            $row[] = array('no_voucher' => $resulte['no_voucher'], 'tgl_voucher' => $resulte['tgl_voucher'],
                'kd_skpd' => $resulte['kd_skpd'], 'nm_skpd' => $resulte['nm_skpd'], 'ket' =>
                trim($resulte['ket']), 'total_d' => $resulte['total_d'], 'total_k' => $resulte['total_k']);
            $ii++;
        }
        $result["rows"] = $row;
        echo json_encode($result);
        $query1->free_result();
    }
	
	
	 function load_ju_ppkd(){
        $result = array();
        $row = array();
        $page = isset($_POST['page']) ? intval($_POST['page']) : 1;
        $rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
        $offset = ($page - 1) * $rows;
        $kriteria = $this->input->post('cari');
        $where ='';
        if ($kriteria <> '')
        {
            $where = "AND (UPPER(no_voucher) LIKE UPPER('%$kriteria%') OR tgl_voucher LIKE '%$kriteria%' OR UPPER(ket) LIKE UPPER('%$kriteria%' ) OR UPPER(kd_skpd) LIKE UPPER('%$kriteria%'))";
        }

        $sql = "SELECT count(*) as total from trhju_pkd WHERE tabel='1' $where";
        $query1 = $this->db->query($sql);
        $total = $query1->row();
        $result["total"] = $total->total;
        $query1->free_result();

        $sql = "SELECT LEFT(no_voucher,4)AS satu,SUBSTR(no_voucher,5,30) AS dua,a.*  FROM trhju_pkd a WHERE tabel='1'  $where ORDER BY tgl_voucher,no_voucher,kd_skpd limit $offset,$rows";
        $query1 = $this->db->query($sql);
        $ii = 0;
        foreach ($query1->result_array() as $resulte)
        {
            $row[] = array(
            	'satu' => $resulte['satu'], 
            	'dua' => $resulte['dua'], 
            	'no_voucher' => $resulte['no_voucher'], 
            	'tgl_voucher' => $resulte['tgl_voucher'],
                'kd_skpd' => $resulte['kd_skpd'], 
                'nm_skpd' => $resulte['nm_skpd'], 
                'ket' =>trim($resulte['ket']), 
                'total_d' => $resulte['total_d'], 
                'total_k' => $resulte['total_k'],
				'j' => $resulte['kd_unit'],
				'identitas' => $resulte['identitas']
                );
            $ii++;
        }
        $result["rows"] = $row;
        echo json_encode($result);
        $query1->free_result();
    }

	
    function load_dju(){
        $nomor = $this->input->post('no');
        $sql = "SELECT a.no_voucher,b.kd_kegiatan,b.nm_kegiatan,b.kd_rek5,IF(rk='D',b.nm_rek5,CONCAT(SPACE(4),b.nm_rek5)) AS nm_rek5,b.debet,b.kredit,b.rk,b.jns,b.pos FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher WHERE a.no_voucher='$nomor'";
        $query1 = $this->db->query($sql);
        $result = array();
        $ii = 0;
        foreach ($query1->result_array() as $resulte)
        {
            $result[] = array('no_voucher' => $resulte['no_voucher'], 'kd_kegiatan' => $resulte['kd_kegiatan'],
                'nm_kegiatan' => $resulte['nm_kegiatan'], 'kd_rek5' => $resulte['kd_rek5'],
                'nm_rek5' => $resulte['nm_rek5'], 'debet' => $resulte['debet'], 'kredit' => $resulte['kredit'],
                'rk' => $resulte['rk'], 'jns' => $resulte['jns'], 'post' => $resulte['pos']);
            $ii++;
        }
        echo json_encode($result);
        $query1->free_result();
    }
	
	
  function load_dju_ppkd(){
        $nomor = $this->input->post('no');
        $sql = "SELECT a.no_voucher,b.kd_kegiatan,b.nm_kegiatan,b.kd_rek5,IF(rk='D',b.nm_rek5,CONCAT(SPACE(4),b.nm_rek5)) AS nm_rek5,b.debet,b.kredit,b.rk,b.jns,b.pos FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher WHERE a.no_voucher='$nomor'";
        $query1 = $this->db->query($sql);
        $result = array();
        $ii = 0;
        foreach ($query1->result_array() as $resulte)
        {
            $result[] = array('no_voucher' => $resulte['no_voucher'], 'kd_kegiatan' => $resulte['kd_kegiatan'],
                'nm_kegiatan' => $resulte['nm_kegiatan'], 'kd_rek5' => $resulte['kd_rek5'],
                'nm_rek5' => $resulte['nm_rek5'], 'debet' => $resulte['debet'], 'kredit' => $resulte['kredit'],
                'rk' => $resulte['rk'], 'jns' => $resulte['jns'], 'post' => $resulte['pos']);
            $ii++;
        }
        echo json_encode($result);
        $query1->free_result();
    }

  function load_ju_trskpd(){
        $jenis = $this->input->post('jenis');
        $len = strlen($jenis);
        $giat = $this->input->post('giat');
        $cskpd = $this->input->post('kd');
$skpd     =$this->input->post('kd');
        $jns_beban = '';
        $cgiat = '';
        if ($jenis != '')
        {
            $jns_beban = "and left(a.jns_kegiatan,$len)='$jenis'";
        }
        if ($giat != '')
        {
            $cgiat = " and a.kd_kegiatan not in ($giat) ";
        }



        $lccr = $this->input->post('q');
        $sql = "SELECT a.kd_kegiatan,b.nm_kegiatan,a.kd_program,(select nm_program from m_prog where kd_program=a.kd_program) as nm_program,a.total FROM trskpd a INNER JOIN m_giat b ON a.kd_kegiatan1=b.kd_kegiatan
                WHERE LEFT(a.kd_kegiatan,4)= LEFT('$cskpd',4) $jns_beban and a.kd_skpd='$skpd' $cgiat AND (UPPER(a.kd_kegiatan) LIKE UPPER('%$lccr%') OR UPPER(b.nm_kegiatan) LIKE UPPER('%$lccr%'))";
        $query1 = $this->db->query($sql);
        $result = array();
        $ii = 0;
        foreach ($query1->result_array() as $resulte)
        {

            $result[] = array('id' => $ii, 'kd_kegiatan' => $resulte['kd_kegiatan'],
                'nm_kegiatan' => $resulte['nm_kegiatan'], 'kd_program' => $resulte['kd_program'],
                'nm_program' => $resulte['nm_program'], 'total' => $resulte['total']);
            $ii++;
        }

        echo json_encode($result);
        $query1->free_result();
    }
	
 
    function load_ju_rek() {     
        $jenis  = $this->input->post('jenis');        
        $len    = strlen($jenis);        
        $giat   = $this->input->post('giat');  
        $kode   = $this->input->post('kd');       
        $rek    = $this->input->post('rek');  
		$nm_rek = $this->input->post('cnm_rek');
        $lccr   = $this->input->post('q');    
        
       
            
        if ($rek !=''){
            $notIn = " and kd_rek64 not in ($rek) " ;
			$notIn2 = " and b.kd_rek64 not in ($rek) " ;
        }else{
            $notIn  = "";
			$notIn2  = "";
        }
        
     /*    if ($jenis == '4' || $jenis == '5'  ||  $jenis == '6'){
            $sql = "SELECT b.kd_rek64,a.nm_rek5 FROM trdrka a LEFT JOIN ms_rek5 b ON a.kd_rek5=b.kd_rek5 WHERE a.kd_kegiatan= '$giat' AND a.kd_skpd = '$kode' $notIn2 AND (UPPER(a.kd_rek5) LIKE UPPER('%$lccr%') OR UPPER(a.nm_rek5) LIKE UPPER('%$lccr%')) ";                    
        } else */ if($jenis=='0'){   
                        $sql = "SELECT '0000000' as kd_rek64,'Perubahan SAL' as nm_rek5  ";                    
        }else{
$sql = "SELECT kd_rek64,nm_rek5 FROM ms_rek5 where left(kd_rek64,$len)='$jenis' $notIn AND (UPPER(kd_rek64) LIKE UPPER('%$lccr%') OR UPPER(nm_rek5) LIKE UPPER('%$lccr%'))";

        }                       
        $query1 = $this->db->query($sql);  
        $result = array();
        $ii = 0;
        foreach($query1->result_array() as $resulte)
        {            
            $result[] = array(                          
                        'kd_rek5' => $resulte['kd_rek64'],  
                        'nm_rek5' => $resulte['nm_rek5']
                        );
                        $ii++;
        }                   
       echo json_encode($result);    
       $query1->free_result();       	   
	}

	

 function simpan_ju(){
        $tabel = $this->input->post('tabel');
        $nomor = $this->input->post('no');
        $tgl = $this->input->post('tgl');
        $skpd = $this->input->post('skpd');
        $nmskpd = $this->input->post('nmskpd');
        $ket = $this->input->post('ket');
        $total_d = $this->input->post('total_d');
        $total_k = $this->input->post('total_k');
        $csql = $this->input->post('sql');

        $usernm = $this->session->userdata('pcNama');
        $update = date('y-m-d H:i:s');
        $msg = array();

        if ($tabel == 'trhju_pkd')
        {
            $sql = "delete from trhju_pkd where kd_skpd='$skpd' and no_voucher='$nomor'";
            $asg = $this->db->query($sql);
            if ($asg)
            {
                $sql = "insert into trhju_pkd(no_voucher,tgl_voucher,ket,username,tgl_update,kd_skpd,nm_skpd,total_d,total_k,tabel) 
                        values('$nomor','$tgl','$ket','$usernm','$update','$skpd','$nmskpd','$total_d','$total_k','1')";
                $asg = $this->db->query($sql);
                if (!($asg))
                {
                    $msg = array('pesan' => '0');
                    echo json_encode($msg);
                    exit();
                } else
                {
                    $msg = array('pesan' => '1');
                    echo json_encode($msg);
                }
            } else
            {
                $msg = array('pesan' => '0');
                echo json_encode($msg);
                exit();
            }

        } else
            if ($tabel == 'trdju_pkd')
            {

                // Simpan Detail //
                $sql = "delete from trdju_pkd where no_voucher='$nomor'";
                $asg = $this->db->query($sql);
                if (!($asg))
                {
                    $msg = array('pesan' => '0');
                    echo json_encode($msg);
                    exit();
                } else
                {
                    $sql = "insert into trdju_pkd(no_voucher,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,debet,kredit,rk,jns,pos,urut)";

                    $asg = $this->db->query($sql . $csql);
                    if (!($asg))
                    {
                        $msg = array('pesan' => '0');
                        echo json_encode($msg);
                        exit();
                    } else
                    {
                        $msg = array('pesan' => '1');
                        echo json_encode($msg);
                    }
                }
            }
    }
 

 function simpan_ju_ppkd(){
        $tabel = $this->input->post('tabel');
        $nomor = $this->input->post('no');
        $tgl = $this->input->post('tgl');
        $skpd = $this->input->post('skpd');
        $nmskpd = $this->input->post('nmskpd');
        $ket = $this->input->post('ket');
        $total_d = $this->input->post('total_d');
        $total_k = $this->input->post('total_k');
        $jurnal = $this->input->post('jurnal');
        $csql = $this->input->post('sql');
        $jns_jurnal = $this->input->post('jns_jurnal');

        $usernm = $this->session->userdata('pcNama');
        $update = date('y-m-d H:i:s');
        $msg = array();

        if ($tabel == 'trhju_pkd')
        {
            $sql = "delete from trhju_pkd where kd_skpd='$skpd' and no_voucher='$nomor'";
            $asg = $this->db->query($sql);
            if ($asg)
            {
                $sql = "insert into trhju_pkd(no_voucher,tgl_voucher,ket,username,tgl_update,kd_skpd,nm_skpd,total_d,total_k,tabel,kd_unit,identitas) 
                        values('$nomor','$tgl','$ket','$usernm','$update','$skpd','$nmskpd','$total_d','$total_k','1','$jurnal','$jns_jurnal')";
                $asg = $this->db->query($sql);
                if (!($asg))
                {
                    $msg = array('pesan' => '0');
                    echo json_encode($msg);
                    exit();
                } else
                {
                    $msg = array('pesan' => '1');
                    echo json_encode($msg);
                }
            } else
            {
                $msg = array('pesan' => '0');
                echo json_encode($msg);
                exit();
            }

        } else
            if ($tabel == 'trdju_pkd')
            {

                // Simpan Detail //
                $sql = "delete from trdju_pkd where no_voucher='$nomor'";
                $asg = $this->db->query($sql);
                if (!($asg))
                {
                    $msg = array('pesan' => '0');
                    echo json_encode($msg);
                    exit();
                } else
                {
                    $sql = "insert into trdju_pkd(no_voucher,kd_skpd,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,debet,kredit,rk,jns,pos,urut)";

                    $asg = $this->db->query($sql . $csql);
                    if (!($asg))
                    {
                        $msg = array('pesan' => '0');
                        echo json_encode($msg);
                        exit();
                    } else
                    {
                        $msg = array('pesan' => '1');
                        echo json_encode($msg);
                    }
                }
            }
    }


	
	
 function hapus_ju(){
        $nomor = $this->input->post('no');
        $msg = array();
        $sql = "delete from trdju_pkd where no_voucher='$nomor'";
        $asg = $this->db->query($sql);
        if ($asg)
        {
            $sql = "delete from trhju_pkd where no_voucher='$nomor'";
            $asg = $this->db->query($sql);
            if (!($asg))
            {
                $msg = array('pesan' => '0');
                echo json_encode($msg);
                exit();
            }
        } else
        {
            $msg = array('pesan' => '0');
            echo json_encode($msg);
            exit();
        }
        $msg = array('pesan' => '1');
        echo json_encode($msg);
    }

  function hapus_ju_ppkd(){
        $nomor = $this->input->post('no');
        $msg = array();
        $sql = "delete from trdju_pkd where no_voucher='$nomor'";
        $asg = $this->db->query($sql);
        if ($asg)
        {
            $sql = "delete from trhju_pkd where no_voucher='$nomor'";
            $asg = $this->db->query($sql);
            if (!($asg))
            {
                $msg = array('pesan' => '0');
                echo json_encode($msg);
                exit();
            }
        } else
        {
            $msg = array('pesan' => '0');
            echo json_encode($msg);
            exit();
        }
        $msg = array('pesan' => '1');
        echo json_encode($msg);
    }

    function penjabaran(){
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/penjabaran', $data);
    }

  /*  function cetak_perkada_real($ctk = '', $skpd = '', $awal = '', $akhir = ''){
        $cetak = $ctk;
        $id = $skpd;
        $date_awal = $awal;
        $date_akhir = $akhir;
        if ($cetak == 2)
        {
            $tgl_awal = $this->tukd_model->tanggal_format_indonesia($date_awal);
            $tgl_akhir = $this->tukd_model->tanggal_format_indonesia($date_akhir);
        }
        $sqldns = "SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
        $sqlskpd = $this->db->query($sqldns);
        foreach ($sqlskpd->result() as $rowdns)
        {

            $kd_urusan = $rowdns->kd_u;
            $nm_urusan = $rowdns->nm_u;
            $kd_skpd = $rowdns->kd_sk;
            $nm_skpd = $rowdns->nm_sk;
        }

        $sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
        $sqlsclient = $this->db->query($sqlsc);
        foreach ($sqlsclient->result() as $rowsc)
        {

            $tgl = $rowsc->tgl_rka;
            $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
            $kab = $rowsc->kab_kota;
            $daerah = $rowsc->daerah;
            $thn = $rowsc->thn_ang;
        }


        $cRet = '';
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>RINCIAN LAPORAN REALISASI ANGGARAN MENURUT URUSAN PEMERINTAHAN DAERAH,ORGANISASI<br/>PENDAPATAN,BELANJA DAN PEMBIAYAAN </strong></td>
                    </tr>
                    
                    <tr>
                         <td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>

                  </table>";
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                    <tr>
                        <td width=\"20%\">Urusan Organisasi </td>
                        <td width=\"80%\">:$kd_urusan - $nm_urusan</td>
                    </tr>
                    <tr>
                        <td>Organisasi</td>
                        <td>:$kd_skpd - $nm_skpd</td>
                    </tr>";
        if ($cetak == 2)
        {
            $cRet .= "<TR>                        
						<TD  align=\"left\" width=\"20%\" >PERIODE</TD>
						<TD align=\"left\" width=\"80%\" >:$tgl_awal s/d $tgl_akhir </TD>                      
					 </TR>";
        }
        $cRet .= "</table>";

        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Kode Rekening</b></td>                            
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"26%\" align=\"center\"><b>Uraian</b></td>                            
                            <td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"28%\" align=\"center\"><b>Jumlah (Rp.)</b></td>
                            <td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"16%\" align=\"center\"><b>Bertambah/ (berkurang)</b></td>
                            <td  rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"13%\" align=\"center\"><b>Dasar Hukum</b></td>                            
                            </tr>
                        <tr>
 		                     <td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Anggaran </td>
                             <td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Realisasi</td>
                             <td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Jumlah</td>
                             <td width=\"3%\" bgcolor=\"#CCCCCC\" align=\"center\">%</td>
                             
                        </tr>    
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>  
                            <td style=\"border-top: none;\"></td>
                                                                                   
                         </tr>
                     </tfoot>
                    
                     
                        <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"26%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"14%\">&nbsp;</td>
                            </tr>
                        ";
        if ($cetak == 1)
        {
            $sqltp = "SELECT SUM(a.nilai) AS totp,SUM(a.nilai_ubah) AS totp_u, 
                        (SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,1)='4' AND a.kd_skpd='$id') AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,1)='4' AND d.kd_skpd='$id') AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,1)='4' AND f.kd_skpd='$id') AS kredit FROM trdrka a
                         WHERE LEFT(kd_rek5,1)='4' AND kd_skpd='$id'";
        }
        if ($cetak == 2)
        {
            $sqltp = "SELECT SUM(a.nilai) AS totp,SUM(a.nilai_ubah) AS totp_u, 
                        (SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,1)='4' AND a.kd_skpd='$id' AND b.tgl_sts>='$date_awal' AND b.tgl_sts<='$date_akhir') AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,1)='4' AND d.kd_skpd='$id' AND  d.tgl_voucher>='$date_awal' AND d.tgl_voucher<='$date_akhir') AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,1)='4' AND f.kd_skpd='$id' AND  f.tgl_voucher>='$date_awal' AND f.tgl_voucher<='$date_akhir') AS kredit FROM trdrka a
                         WHERE LEFT(kd_rek5,1)='4' AND kd_skpd='$id'";
        }

        $sqlp = $this->db->query($sqltp);
        foreach ($sqlp->result() as $rowp)
        {
            $angp = number_format($rowp->totp_u, "2", ".", ",");
            $angaranp = $rowp->totp_u;
            $penp = $rowp->cp;
            $debetp = $rowp->debet;
            $kreditp = $rowp->kredit;
            $realp = ($penp + $kreditp) - $debetp;
            $nrealp = number_format($realp, "2", ".", ",");
            $real_sp = $realp - $angaranp;
            if ($real_sp < 0)
            {
                $x1 = "(";
                $real_sp = $real_sp * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisihp = number_format($real_sp, "2", ".", ",");
            $per1p = ($real_sp != 0) ? ($real_sp / $rowp->totp_u) * 100 : 0;
            $persen1p = number_format($per1p);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Pendapatan Daerah</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$angp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nrealp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisihp$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1p</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
        }
        if ($cetak == 1)
        {
            $sql_p = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE  h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'3' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
                        ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,24)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,25)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
                        ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,27)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan)AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'6' AS nu FROM trdrka a                     
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,29),a.nm_rek5 ) a ORDER BY kd_rek,nu ";
        }
        if ($cetak == 2)
        {
            $sql_p = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE  h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'3' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,24)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,25)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir')AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
                        ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,27)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir')AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir')AS kredit,'6' AS nu FROM trdrka a                     
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,29),a.nm_rek5 ) a ORDER BY kd_rek,nu ";
        }
        $pend = $this->db->query($sql_p);
        //$query = $this->skpd_model->getAllc();

        foreach ($pend->result() as $row)
        {
            $kode = $row->kd_rek;
            $nama = $row->nm_rek;
            $ang = number_format($row->nilai_u, "2", ".", ",");
            $angaran = $row->nilai_u;
            $pen = $row->cp;
            $debet = $row->debet;
            $kredit = $row->kredit;
            $real = ($pen + $kredit) - $debet;
            $nreal = number_format($real, "2", ".", ",");
            $real_s = $real - $angaran;
            if ($real_s < 0)
            {
                $x1 = "(";
                $real_s = $real_s * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $pend_selisih = number_format($real_s, "2", ".", ",");
            $per1 = ($real_s != 0) ? ($real_s / $row->nilai_u) * 100 : 0;
            $persen1 = number_format($per1);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
                                     </tr>
                                     ";


        }

        $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";


        if ($cetak == 1)
        {
            $sqltb = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u, 
            (SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,1)='5' AND a.kd_skpd='$id' ) AS cp,
            (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,1)='5' AND d.kd_skpd='$id' ) AS debet,
            (SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,1)='5' AND f.kd_skpd='$id' ) AS kredit FROM trdrka a
            WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='$id'";
        }
        if ($cetak == 2)
        {
            $sqltb = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u, 
            (SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,1)='5' AND a.kd_skpd='$id' AND b.tgl_sts>='$date_awal' AND b.tgl_sts<='$date_akhir') AS cp,
            (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,1)='5' AND d.kd_skpd='$id' AND  d.tgl_voucher>='$date_awal' AND d.tgl_voucher<='$date_akhir') AS debet,
            (SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,1)='5' AND f.kd_skpd='$id' AND  f.tgl_voucher>='$date_awal' AND f.tgl_voucher<='$date_akhir') AS kredit FROM trdrka a
            WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='$id'";
        }
        $sqlb = $this->db->query($sqltb);
        foreach ($sqlb->result() as $rowb_5)
        {
            $ang_5 = number_format($rowb_5->totb_u, "2", ".", ",");
            $angaran_5 = $rowb_5->totb_u;
            $in_5 = $rowb_5->cp;
            $debet_5 = $rowb_5->debet;
            $kredit_5 = $rowb_5->kredit;
            $real_5 = $debet_5 - ($in_5 + $kredit_5);
            $nreal_5 = number_format($real_5, "2", ".", ",");
            $real_s_5 = $real_5 - $angaran_5;
            if ($real_s_5 < 0)
            {
                $x1 = "(";
                $real_s_5 = $real_s_5 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih_5 = number_format($real_s_5, "2", ".", ",");
            $per_5 = ($real_s_5 != 0) ? ($real_s_5 / $rowb_5->totb_u) * 100 : 0;
            $persen_5 = number_format($per_5);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Belanja Daerah</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_5</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_5</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_5$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_5</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";


        }
        if ($cetak == 1)
        {
            $sqltbtl = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u, 
                            (SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='51' AND a.kd_skpd='$id' ) AS cp,
                            (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='51' AND d.kd_skpd='$id' ) AS debet,
                            (SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='51' AND f.kd_skpd='$id' ) AS kredit FROM trdrka a
                            WHERE LEFT(kd_rek5,2)='51' AND kd_skpd='$id'";
        }
        if ($cetak == 2)
        {
            $sqltbtl = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u, 
                            (SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='51' AND a.kd_skpd='$id' AND b.tgl_sts>='$date_awal' AND b.tgl_sts<='$date_akhir') AS cp,
                            (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='51' AND d.kd_skpd='$id' AND  d.tgl_voucher>='$date_awal' AND d.tgl_voucher<='$date_akhir') AS debet,
                            (SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='51' AND f.kd_skpd='$id' AND  f.tgl_voucher>='$date_awal' AND f.tgl_voucher<='$date_akhir') AS kredit FROM trdrka a
                            WHERE LEFT(kd_rek5,2)='51' AND kd_skpd='$id'";
        }
        $sqlbtl = $this->db->query($sqltbtl);
        foreach ($sqlbtl->result() as $rowbtl)
        {
            $ang_51 = number_format($rowbtl->totb_u, "2", ".", ",");
            $angaran_51 = $rowbtl->totb_u;
            $in_51 = $rowbtl->cp;
            $debet_51 = $rowbtl->debet;
            $kredit_51 = $rowbtl->kredit;
            $real_51 = $debet_51 - ($in_51 + $kredit_51);
            $nreal_51 = number_format($real_51, "2", ".", ",");
            $real_s_51 = $real_51 - $angaran_51;
            if ($real_s_51 < 0)
            {
                $x1 = "(";
                $real_s_51 = $real_s_51 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih_51 = number_format($real_s_51, "2", ".", ",");
            $per_51 = ($real_s_51 != 0) ? ($real_s_51 / $rowbtl->totb_u) * 100 : 0;
            $persen_51 = number_format($per_51);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Belanja Tidak Langsung</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_51</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_51</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_51$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_51</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
        }


        if ($cetak == 1)
        {
            $sql_btl = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,25)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
                        ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,27)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'6' AS nu FROM trdrka a                     
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,29),a.nm_rek5 ) a ORDER BY kd_rek,nu";
        }
        if ($cetak == 2)
        {
            $sql_btl = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,25)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir')AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
                        ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,27)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir')AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir')AS kredit,'6' AS nu FROM trdrka a                     
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,29),a.nm_rek5 ) a ORDER BY kd_rek,nu";
        }
        $btl = $this->db->query($sql_btl);

        foreach ($btl->result() as $row_btl)
        {
            $kode = $row_btl->kd_rek;
            $nama = $row_btl->nm_rek;
            $ang_511 = number_format($row_btl->nilai_u, "2", ".", ",");
            $angaran_511 = $row_btl->nilai_u;
            $in_511 = $row_btl->cp;
            $debet_511 = $row_btl->debet;
            $kredit_511 = $row_btl->kredit;
            $real_511 = $debet_511 - ($in_511 + $kredit_511);
            $nreal_511 = number_format($real_511, "2", ".", ",");
            $real_s_511 = $real_511 - $angaran_511;
            if ($real_s_511 < 0)
            {
                $x1 = "(";
                $real_s_511 = $real_s_511 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih_511 = number_format($real_s_511, "2", ".", ",");
            $per_511 = ($real_s_5 != 0) ? ($real_s_511 / $row_btl->nilai_u) * 100 : 0;
            $persen_511 = number_format($per_511);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_511</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_511</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_511$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_511</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
                                     </tr>
                                     ";


        }
        $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";

        if ($cetak == 1)
        {
            $sqltbl = "SELECT SUM(a.nilai) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
                        (SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='52' AND a.kd_skpd='$id') AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='52' AND d.kd_skpd='$id') AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='52' AND f.kd_skpd='$id') AS kredit FROM trdrka a
                        WHERE LEFT(kd_rek5,2)='52' AND kd_skpd='$id'";
        }
        if ($cetak == 2)
        {
            $sqltbl = "SELECT SUM(a.nilai) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
                        (SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='52' AND a.kd_skpd='$id' AND b.tgl_sts>='$date_awal' AND b.tgl_sts<='$date_akhir') AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='52' AND d.kd_skpd='$id' AND  d.tgl_voucher>='$date_awal' AND d.tgl_voucher<='$date_akhir') AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='52' AND f.kd_skpd='$id' AND  f.tgl_voucher>='$date_awal' AND f.tgl_voucher<='$date_akhir') AS kredit FROM trdrka a
                        WHERE LEFT(kd_rek5,2)='52' AND kd_skpd='$id'";
        }
        $sqlbl = $this->db->query($sqltbl);
        foreach ($sqlbl->result() as $rowbl)
        {
            $ang_52 = number_format($rowbl->totbl_u, "2", ".", ",");
            $angaran_52 = $rowbl->totbl_u;
            $in_52 = $rowbl->cp;
            $debet_52 = $rowbl->debet;
            $kredit_52 = $rowbl->kredit;
            $real_52 = $debet_52 - ($in_52 + $kredit_52);
            $nreal_52 = number_format($real_52, "2", ".", ",");
            $real_s_52 = $real_52 - $angaran_52;
            if ($real_s_52 < 0)
            {
                $x1 = "(";
                $real_s_52 = $real_s_52 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih_52 = number_format($real_s_51, "2", ".", ",");
            $per_52 = ($real_s_5 != 0) ? ($real_s_51 / $rowbl->totbl_u) * 100 : 0;
            $persen_52 = number_format($per_52);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Belanja Langsung</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_52</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_52</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_52$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_52</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
        }
        $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";


        if ($cetak == 1)
        {
            $sql_bl = "SELECT * FROM (SELECT a.kd_program AS kd_rek, c.nm_program AS nm_rek,(SELECT SUM(nilai) FROM trdrka WHERE LEFT(kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program) AS nilai,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program) AS nilai_u,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd g INNER JOIN trhkasin_pkd h ON g.no_sts = h.no_sts WHERE h.kd_skpd='$id' AND LEFT(h.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program ) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd i  INNER JOIN trhju_pkd j ON i.no_voucher = j.no_voucher  WHERE j.kd_skpd='$id' AND LEFT(i.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program ) AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd k  INNER JOIN trhju_pkd l ON k.no_voucher = l.no_voucher WHERE l.kd_skpd='$id' AND LEFT(k.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program ) AS kredit,'1' AS nu FROM trskpd a INNER JOIN m_prog c ON a.kd_program1=c.kd_program
                        LEFT JOIN trdrka b ON a.kd_program=LEFT(b.kd_kegiatan,(LENGTH(a.kd_program))) WHERE a.kd_skpd='$id' AND RIGHT(a.kd_program,2) <>'00' GROUP BY a.kd_program,c.nm_program 
                        UNION ALL
                        SELECT a.kd_kegiatan AS kd_rek,c.nm_kegiatan AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd g INNER JOIN trhkasin_pkd h ON g.no_sts = h.no_sts WHERE h.kd_skpd='$id' AND h.kd_kegiatan = a.kd_kegiatan ) AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd i  INNER JOIN trhju_pkd j ON i.no_voucher = j.no_voucher  WHERE j.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan ) AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd k  INNER JOIN trhju_pkd l ON k.no_voucher = l.no_voucher WHERE l.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan ) AS kredit,'2' AS nu FROM trskpd a INNER JOIN m_giat c ON a.kd_kegiatan1=c.kd_kegiatan
                        LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan WHERE a.kd_skpd='$id' AND RIGHT(a.kd_program,2) <>'00' GROUP BY a.kd_kegiatan,c.nm_kegiatan
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'3' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3   
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,24)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3                   
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,25)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
                        ON LEFT(a.kd_rek5,5)=b.kd_rek4                      
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,27)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'6' AS nu FROM trdrka a                     
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,29),a.nm_rek5 ) a ORDER BY kd_rek,nu";
        }
        if ($cetak == 2)
        {
            $sql_bl = "SELECT * FROM (SELECT a.kd_program AS kd_rek, c.nm_program AS nm_rek,(SELECT SUM(nilai) FROM trdrka WHERE LEFT(kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program) AS nilai,
                        (SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program) AS nilai_u,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd g INNER JOIN trhkasin_pkd h ON g.no_sts = h.no_sts WHERE h.kd_skpd='$id' AND LEFT(h.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program AND h.tgl_sts>='$date_awal' AND h.tgl_sts<='$date_akhir') AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd i  INNER JOIN trhju_pkd j ON i.no_voucher = j.no_voucher  WHERE j.kd_skpd='$id' AND LEFT(i.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program AND j.tgl_voucher>='$date_awal' AND j.tgl_voucher<='$date_akhir') AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd k  INNER JOIN trhju_pkd l ON k.no_voucher = l.no_voucher WHERE l.kd_skpd='$id' AND LEFT(k.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program AND l.tgl_voucher>='$date_awal' AND l.tgl_voucher<='2$date_akhir') AS kredit,'1' AS nu FROM trskpd a INNER JOIN m_prog c ON a.kd_program1=c.kd_program
                        LEFT JOIN trdrka b ON a.kd_program=LEFT(b.kd_kegiatan,(LENGTH(a.kd_program))) WHERE a.kd_skpd='$id' AND RIGHT(a.kd_program,2) <>'00' GROUP BY a.kd_program,c.nm_program 
                        UNION ALL
                        SELECT a.kd_kegiatan AS kd_rek,c.nm_kegiatan AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
                        (SELECT SUM(rupiah) FROM trdkasin_pkd g INNER JOIN trhkasin_pkd h ON g.no_sts = h.no_sts WHERE h.kd_skpd='$id' AND h.kd_kegiatan = a.kd_kegiatan AND h.tgl_sts>='2012-11-01' AND h.tgl_sts <='$date_akhir') AS cp,
                        (SELECT SUM(debet) FROM trdju_pkd i  INNER JOIN trhju_pkd j ON i.no_voucher = j.no_voucher  WHERE j.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan AND j.tgl_voucher>='$date_awal' AND j.tgl_voucher<='$date_akhir') AS debet,
                        (SELECT SUM(kredit) FROM trdju_pkd k  INNER JOIN trhju_pkd l ON k.no_voucher = l.no_voucher WHERE l.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan AND l.tgl_voucher>='$date_awal' AND l.tgl_voucher<='$date_akhir') AS kredit,'2' AS nu FROM trskpd a INNER JOIN m_giat c ON a.kd_kegiatan1=c.kd_kegiatan
                        LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan WHERE a.kd_skpd='$id' AND RIGHT(a.kd_program,2) <>'00' GROUP BY a.kd_kegiatan,c.nm_kegiatan
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'3' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3   
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,24)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='2012-11-01' AND d.tgl_sts<='$date_akhir' )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3                   
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,25)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir')AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
                        ON LEFT(a.kd_rek5,5)=b.kd_rek4                      
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,27)
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir')AS cp,
                        (SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                        (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir')AS kredit,'6' AS nu FROM trdrka a                     
                        WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,29),a.nm_rek5 ) a ORDER BY kd_rek,nu";
        }
        $bl = $this->db->query($sql_bl);
        foreach ($bl->result() as $row_bl)
        {
            $kode = $row_bl->kd_rek;
            $nama = $row_bl->nm_rek;
            $ang_522 = number_format($row_bl->nilai_u, "2", ".", ",");
            $angaran_522 = $row_bl->nilai_u;
            $in_522 = $row_bl->cp;
            $debet_522 = $row_bl->debet;
            $kredit_522 = $row_bl->kredit;
            $real_522 = $debet_522 - ($in_522 + $kredit_522);
            $nreal_522 = number_format($real_522, "2", ".", ",");
            $real_s_522 = $real_522 - $angaran_522;
            if ($real_s_522 < 0)
            {
                $x1 = "(";
                $real_s_522 = $real_s_522 * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih_522 = number_format($real_s_522, "2", ".", ",");
            $per_522 = ($real_s_522 != 0) ? ($real_s_522 / $row_bl->nilai_u) * 100 : 0;
            $persen_522 = number_format($per_522);

            $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_522</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_522</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_522$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_522</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
                                     </tr>
                                     ";


        }
        $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";


        $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Belanja Daerah</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_5</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_5</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_5$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_5</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
        $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
        if($id=='1.20.05.01')
        {
                if ($cetak == 1)
                {
                    $sqltpm = "SELECT SUM(IFNULL(a.nilai,0)) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
                                (SELECT SUM(IFNULL(rupiah,0)) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='61' AND a.kd_skpd='$id' ) AS cp,
                                (SELECT SUM(IFNULL(debet,0)) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='61' AND d.kd_skpd='$id' ) AS debet,
                                (SELECT SUM(IFNULL(kredit,0)) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='61' AND f.kd_skpd='$id' ) AS kredit FROM trdrka a
                                WHERE LEFT(kd_rek5,2)='61' AND kd_skpd='$id'";
                }
                if ($cetak == 2)
                {
                    $sqltpm = "SELECT SUM(IFNULL(a.nilai,0)) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
                                (SELECT SUM(IFNULL(rupiah,0)) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='61' AND a.kd_skpd='$id' AND b.tgl_sts>='$date_awal' AND b.tgl_sts<='$date_akhir') AS cp,
                                (SELECT SUM(IFNULL(debet,0)) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='61' AND d.kd_skpd='$id' AND  d.tgl_voucher>='$date_awal' AND d.tgl_voucher<='$date_akhir') AS debet,
                                (SELECT SUM(IFNULL(kredit,0)) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='61' AND f.kd_skpd='$id' AND  f.tgl_voucher>='$date_awal' AND f.tgl_voucher<='$date_akhir') AS kredit FROM trdrka a
                                WHERE LEFT(kd_rek5,2)='61' AND kd_skpd='$id'";
                }
                $sqlpm = $this->db->query($sqltpm);
                foreach ($sqlpm->result() as $rowpm)
                {
                    $ang_61 = number_format($rowpm->totbl_u, "2", ".", ",");
                    $angaran_61 = $rowpm->totbl_u;
                    $in_61 = $rowpm->cp;
                    $debet_61 = $rowpm->debet;
                    $kredit_61 = $rowpm->kredit;
                    $real_61 = $debet_61 - ($in_61 + $kredit_61);
                    $nreal_61 = number_format($real_61, "2", ".", ",");
                    $real_s_61 = $real_61 - $angaran_61;
                    if ($real_s_61 < 0)
                    {
                        $x1 = "(";
                        $real_s_61 = $real_s_61 * -1;
                        $y1 = ")";
                    } else
                    {
                        $x1 = "";
                        $y1 = "";
                    }
                    $selisih_61 = number_format($real_s_61, "2", ".", ",");
                    $per_61 = ($real_s_61 != 0) ? ($real_s_61 / $rowpm->totbl_u) * 100 : 0;
                    $persen_61 = number_format($per_61);
                    //
                    //                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
                    //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Pembiayaan Masuk</td>
                    //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_61</td>
                    //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_61</td>
                    //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_61$y1</td>
                    //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_61</td>
                    //                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                    //                                     </tr>";
                }
        
        
                if ($cetak == 1)
                {
                    $sqlpm = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
                                ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,24)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                                ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,25)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
                                ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,27)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'6' AS nu FROM trdrka a                     
                                WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,29),a.nm_rek5 ) a ORDER BY kd_rek,nu";
                }
                if ($cetak == 2)
                {
                    $sqlpm = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='<strong>$date_awal</strong>' AND g.tgl_voucher<='$date_akhir' )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
                                ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,24)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='2012-10-01' AND d.tgl_sts<='$date_akhir' )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                                ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,25)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir')AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
                                ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,27)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir')AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir')AS kredit,'6' AS nu FROM trdrka a                     
                                WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,29),a.nm_rek5 ) a ORDER BY kd_rek,nu";
                }
                $sql611 = $this->db->query($sqlpm);
                foreach ($sql611->result() as $row_61)
                {
                    $kd = $row_61->kd_rek;
                    $nm = $row_61->nm_rek;
                    $ang_611 = number_format($row_61->nilai_u, "2", ".", ",");
                    $angaran_611 = $row_61->nilai_u;
                    $in_611 = $row_61->cp;
                    $debet_611 = $row_61->debet;
                    $kredit_611 = $row_61->kredit;
                    $real_611 = $debet_611 - ($in_611 + $kredit_611);
                    $nreal_611 = number_format($real_611, "2", ".", ",");
                    $real_s_611 = $real_611 - $angaran_611;
                    if ($real_s_611 < 0)
                    {
                        $x1 = "(";
                        $real_s_611 = $real_s_611 * -1;
                        $y1 = ")";
                    } else
                    {
                        $x1 = "";
                        $y1 = "";
                    }
                    $selisih_611 = number_format($real_s_611, "2", ".", ",");
                    $per_611 = ($real_s_611 != 0) ? ($real_s_611 / $row_61->nilai_u) * 100 : 0;
                    $persen_611 = number_format($per_611);
        
                    $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"15%\" align=\"left\">$kd</td>                                     
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"26%\">$nm</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$ang_611</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$nreal_611</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$x1$selisih_611$y1</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"3%\" align=\"right\">$persen_611</td>
                                             <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             </tr>";
                }
                $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                             <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             </tr>";
                if ($cetak == 1)
                {
                    $sqltpk = "SELECT SUM(IFNULL(a.nilai,0)) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
                                (SELECT SUM(IFNULL(rupiah,0)) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='62' AND a.kd_skpd='$id' ) AS cp,
                                (SELECT SUM(IFNULL(debet,0)) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='62' AND d.kd_skpd='$id' ) AS debet,
                                (SELECT SUM(IFNULL(kredit,0)) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='62' AND f.kd_skpd='$id' ) AS kredit FROM trdrka a
                                WHERE LEFT(kd_rek5,2)='62' AND kd_skpd='$id' ";
                }
                if ($cetak == 2)
                {
                    $sqltpk = "SELECT SUM(IFNULL(a.nilai,0)) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
                                (SELECT SUM(IFNULL(rupiah,0)) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='62' AND a.kd_skpd='$id' AND b.tgl_sts>='$date_awal' AND b.tgl_sts<='$date_akhir') AS cp,
                                (SELECT SUM(IFNULL(debet,0)) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='62' AND d.kd_skpd='$id' AND  d.tgl_voucher>='$date_awal' AND d.tgl_voucher<='$date_akhir') AS debet,
                                (SELECT SUM(IFNULL(kredit,0)) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='62' AND f.kd_skpd='$id' AND  f.tgl_voucher>='$date_awal' AND f.tgl_voucher<='$date_akhir') AS kredit FROM trdrka a
                                WHERE LEFT(kd_rek5,2)='62' AND kd_skpd='$id' ";
                }
                $sqlpk = $this->db->query($sqltpk);
                foreach ($sqlpk->result() as $rowpk)
                {
                    $ang_62 = number_format($rowpk->totbl_u, "2", ".", ",");
                    $angaran_62 = $rowpk->totbl_u;
                    //echo($angaran_62);
                    $in_62 = $rowpk->cp;
                    $debet_62 = $rowpk->debet;
                    $kredit_62 = $rowpk->kredit;
                    $real_62 = $debet_62 - ($in_62 + $kredit_62);
                    $nreal_62 = number_format($real_62, "2", ".", ",");
                    $real_s_62 = $real_62 - $angaran_62;
                    if ($real_s_62 < 0)
                    {
                        $x1 = "(";
                        $real_s_62 = $real_s_62 * -1;
                        $y1 = ")";
                    } else
                    {
                        $x1 = "";
                        $y1 = "";
                    }
                    $selisih_62 = number_format($real_s_62, "2", ".", ",");
                    $per_62 = ($real_s_62 != 0) ? ($real_s_62 / $rowpk->totbl_u) * 100 : 0;
                    $persen_62 = number_format($per_62);
        
                    //                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
                    //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Pembiayaan Keluar</td>
                    //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_62</td>
                    //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_62</td>
                    //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_62$y1</td>
                    //                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_62</td>
                    //                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                    //                                     </tr>";
                }
                if ($cetak == 1)
                {
                    $sqlpk = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
                                ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,24)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                                ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,25)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
                                ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,27)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'6' AS nu FROM trdrka a                     
                                WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,29),a.nm_rek5 ) a ORDER BY kd_rek,nu";
                }
                if ($cetak == 2)
                {
                    $sqlpk = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='<strong>$date_awal</strong>' AND g.tgl_voucher<='$date_akhir' )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
                                ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,24)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='2012-10-01' AND d.tgl_sts<='$date_akhir' )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
                                ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,25)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir')AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
                                ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,27)
                                UNION ALL
                                SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                                (SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir')AS cp,
                                (SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
                                (SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir')AS kredit,'6' AS nu FROM trdrka a                     
                                WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,29),a.nm_rek5 ) a ORDER BY kd_rek,nu";
                }
                $sql62 = $this->db->query($sqlpk);
                foreach ($sql62->result() as $row_62)
                {
                    $kd = $row_62->kd_rek;
                    $nm = $row_62->nm_rek;
                    $ang_622 = number_format($row_62->nilai_u, "2", ".", ",");
                    $angaran_622 = $row_62->nilai_u;
                    $in_622 = $row_62->cp;
                    $debet_622 = $row_62->debet;
                    $kredit_622 = $row_62->kredit;
                    $real_622 = $debet_622 - ($in_622 + $kredit_622);
                    $nreal_622 = number_format($real_622, "2", ".", ",");
                    $real_s_622 = $real_622 - $angaran_622;
                    if ($real_s_622 < 0)
                    {
                        $x1 = "(";
                        $real_s_622 = $real_s_622 * -1;
                        $y1 = ")";
                    } else
                    {
                        $x1 = "";
                        $y1 = "";
                    }
                    $selisih_622 = number_format($real_s_622, "2", ".", ",");
                    $per_622 = ($real_s_611 != 0) ? ($real_s_622 / $row_62->nilai_u) * 100 : 0;
                    $persen_622 = number_format($per_622);
        
                    $cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"15%\" align=\"left\">$kd</td>                                     
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"26%\">$nm</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$ang_622</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$nreal_622</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$x1$selisih_622$y1</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"3%\" align=\"right\">$persen_622</td>
                                             <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             </tr>";
                }
                $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                             <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             </tr>";
        
                $netto = $angaran_61 - $angaran_62;
                $net = number_format($netto, "2", ",", ".");
                $netto_r = $real_61 - $real_62;
                $net_r = number_format($netto_r, "2", ",", ".");
                $netto_s = $netto_r - $netto;
                if ($netto_s < 0)
                {
                    $x1 = "(";
                    $netto_s = $netto_s * -1;
                    $y1 = ")";
                } else
                {
                    $x1 = "";
                    $y1 = "";
                }
                $netto_selisih = number_format($netto_s, "2", ",", ".");
                $perpnet = ($netto_s != 0) ? ($netto_s / $netto) * 100 : 0;
                $persennet = number_format($perpnet);
        
        
                $cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
                                            <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Pembiayaan Netto</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$net</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$net_r</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$netto_selisih$y1</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persennet</td>
                                             <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                             </tr>";
        
                $silpa = ($angaranp + $angaran_61) - ($angaran_5 + $angaran_62);
                if ($silpa < 0)
                {
                    $a = "(";
                    $silpa = $silpa * -1;
                    $b = ")";
                } else
                {
                    $a = "";
                    $b = "";
                }
                $silp = number_format($silpa, "2", ",", ".");
                $silpa_real = ($realp + $real_61) - ($real_5 + $real_62);
                if ($silpa_real < 0)
                {
                    $c = "(";
                    $silpa_real = $silpa_real * -1;
                    $d = ")";
                } else
                {
                    $c = "";
                    $d = "";
                }
                $silp_real = number_format($silpa_real, "2", ",", ".");
                $silpa_s = $silpa_real - $silpa;
                if ($silpa_s < 0)
                {
                    $x = "(";
                    $silpa_s = $silpa_s * -1;
                    $y = ")";
                } else
                {
                    $x = "";
                    $y = "";
                }
                $silpa_selisih = number_format($silpa_s, "2", ",", ".");
                $persil = ($silpa_s != 0) ? ($silpa_s / $silpa) * 100 : 0;
                $persensilpa = number_format($persil);
            
                $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
                                                    <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">SILPA</td>
                                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$a$silp$b</td>
                                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$c$silp_real$d</td>
                                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x$silpa_selisih$y</td>
                                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persensilpa</td>
                                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                  
                                                   </tr>";
        }else{
            $silpa = $angaranp  - $angaran_5 ;
        if ($silpa < 0)
        {
            $a = "(";
            $silpa = $silpa * -1;
            $b = ")";
        } else
        {
            $a = "";
            $b = "";
        }
        $silp = number_format($silpa, "2", ",", ".");
        $silpa_real = $realp  - $real_5;
        if ($silpa_real < 0)
        {
            $c = "(";
            $silpa_real = $silpa_real * -1;
            $d = ")";
        } else
        {
            $c = "";
            $d = "";
        }
        $silp_real = number_format($silpa_real, "2", ",", ".");
        $silpa_s = $silpa_real - $silpa;
        if ($silpa_s < 0)
        {
            $x = "(";
            $silpa_s = $silpa_s * -1;
            $y = ")";
        } else
        {
            $x = "";
            $y = "";
        }
        $silpa_selisih = number_format($silpa_s, "2", ",", ".");
        $persil = ($silpa_s != 0) ? ($silpa_s / $silpa) * 100 : 0;
        $persensilpa = number_format($persil);
    
        $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
                                            <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">SILPA</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$a$silp$b</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$c$silp_real$d</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x$silpa_selisih$y</td>
                                             <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persensilpa</td>
                                             <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
          
                                           </tr>";
            
        }                                   
        $cRet .= " </table>";
        $data['prev'] = $cRet;
        echo ("$cRet");
        // $this->template->set('title', 'CETAK RINCIAN REALISASI');
        //        $this->tukd_model->_mpdf('',$cRet,10,10,10,1);


    }*/
    
    function cetak_perkada_real($ctk='',$skpd='',$awal='',$akhir=''){
         $cetak='1';        
         $id =$skpd;
         $date_awal = $awal;
         $date_akhir = $akhir;
         
        $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                   
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                }
       
        $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                }

        $cRet='';
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>RINCIAN LAPORAN REALISASI ANGGARAN MENURUT URUSAN PEMERINTAHAN DAERAH,ORGANISASI<br/>PENDAPATAN,BELANJA DAN PEMBIAYAAN </strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>
                  </table>";
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                    <tr>
                        <td width=\"20%\">Urusan Organisasi </td>
                        <td width=\"80%\">:$kd_urusan - $nm_urusan</td>
                    </tr>
                    <tr>
                        <td>Organisasi</td>
                        <td>:$kd_skpd - $nm_skpd</td>
                    </tr>";
        if ($cetak==2){ 
            $tgl_awal=$this->tukd_model->tanggal_format_indonesia($date_awal);
         $tgl_akhir=$this->tukd_model->tanggal_format_indonesia($date_akhir);
        $cRet .="<TR>                        
						<TD  align=\"left\" width=\"20%\" >PERIODE</TD>
						<TD align=\"left\" width=\"80%\" >:$tgl_awal s/d $tgl_akhir </TD>                      
					 </TR>";
        }            
        $cRet .="</table>";  
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Kode Rekening</b></td>                            
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"26%\" align=\"center\"><b>Uraian</b></td>                            
                            <td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"28%\" align=\"center\"><b>Jumlah (Rp.)</b></td>
                            <td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"16%\" align=\"center\"><b>Bertambah/ (berkurang)</b></td>
                            <td  rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"13%\" align=\"center\"><b>Dasar Hukum</b></td>                            
                            </tr>
                        <tr>
 		                     <td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Anggaran </td>
                             <td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Realisasi</td>
                             <td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Jumlah</td>
                             <td width=\"3%\" bgcolor=\"#CCCCCC\" align=\"center\">%</td>
                             
                        </tr>    
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>  
                            <td style=\"border-top: none;\"></td>                                                      
                         </tr>
                     </tfoot>
                        <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"26%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"14%\">&nbsp;</td>
                            </tr>
                        ";
                 if ($cetak==1){       
                 $sqltp="SELECT SUM(anggaran) AS totp_u,SUM(real_spj) AS realisasi FROM realisasi_bulan  WHERE kd_skpd='$id' AND LEFT(kd_rek5,1)='4' ";
                 }
                 
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                    $angp=number_format($rowp->totp_u,"2",".",",");
                    $angaranp=$rowp->totp_u;
                    $realp=$rowp->realisasi;
                    $nrealp=number_format($realp,"2",".",",");                    
                    $real_sp = $realp - $angaranp;
                    if ($real_sp < 0){
                    	$x1="("; $real_sp=$real_sp*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $pend_selisihp = number_format($real_sp,"2",".",",");
                    $per1p   = ($real_sp!=0)?($real_sp / $rowp->totp_u ) * 100:0; 
                    $persen1p= number_format($per1p);
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Pendapatan Daerah</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$angp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nrealp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisihp$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1p</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
                                     
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
                 }
                 if ($cetak==1){      
                 $sql_p="SELECT * FROM (SELECT a.kd_kegiatan AS kd_giat,LEFT(a.kd_rek5,2) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
				FROM realisasi_bulan a INNER JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' 
				GROUP BY a.kd_kegiatan ,LEFT(a.kd_rek5,2)
				UNION ALL
				SELECT a.kd_kegiatan AS kd_giat,LEFT(a.kd_rek5,3) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
				FROM realisasi_bulan a INNER JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' 
				GROUP BY a.kd_kegiatan ,LEFT(a.kd_rek5,3)
				UNION ALL
				SELECT a.kd_kegiatan AS kd_giat,LEFT(a.kd_rek5,5) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
				FROM realisasi_bulan a INNER JOIN ms_rek4 b ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' 
				GROUP BY a.kd_kegiatan ,LEFT(a.kd_rek5,5)
				UNION ALL
				SELECT a.kd_kegiatan AS kd_giat,a.kd_rek5 AS kd_rek,b.nm_rek5 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
				FROM realisasi_bulan a INNER JOIN ms_rek5 b ON a.kd_rek5=b.kd_rek5 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' 
				GROUP BY a.kd_kegiatan ,a.kd_rek5 ) a ORDER BY kd_rek";
                 }
                  
                 $pend = $this->db->query($sql_p);                           
                foreach ($pend->result() as $row)
                {
                    $giat=$row->kd_giat;
					$kode=$row->kd_rek;
                    $nama=$row->nm_rek;   
                    $ang=number_format($row->nilai_u,"2",".",",");
                    $angaran=$row->nilai_u;
                    $real=$row->realisasi;
                    $nreal=number_format($real,"2",".",",");                    
                    $real_s = $real - $angaran;
                    if ($real_s < 0){
                    	$x1="("; $real_s=$real_s*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $pend_selisih = number_format($real_s,"2",".",",");
                    $per1   = ($real_s!=0)?($real_s / $row->nilai_u ) * 100:0; 
                    $persen1= number_format($per1);

                    if (strlen($kode)<=3){
                   
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\"><b>$giat.$kode</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$ang</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nreal</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$pend_selisih$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
                                     </tr>";
                     }else{
                     	$cRet    .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$giat.$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
                                     </tr>";
                     }
                  }
                  
                   $cRet    .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";

            if ($cetak==1){       
                 $sqltp="SELECT SUM(anggaran) AS totp_u,SUM(real_spj) AS realisasi FROM realisasi_bulan  WHERE kd_skpd='$id' AND LEFT(kd_rek5,1)='5' ";
                 }
                 
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                    $angp=number_format($rowp->totp_u,"2",".",",");
                    $angaranp=$rowp->totp_u;
                    $realp=$rowp->realisasi;
                    $nrealp=number_format($realp,"2",".",",");                    
                    $real_sp = $realp - $angaranp;
                    if ($real_sp < 0){
                    	$x1="("; $real_sp=$real_sp*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $pend_selisihp = number_format($real_sp,"2",".",",");
                    $per1p   = ($real_sp!=0)?($real_sp / $rowp->totp_u ) * 100:0; 
                    $persen1p= number_format($per1p);
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Belanja Daerah</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$angp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nrealp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisihp$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1p</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
                                     
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
                 }
                

				if ($cetak==1){      
                 $sql_p="SELECT * FROM (
						SELECT LEFT(a.kd_kegiatan,18) AS kd_giat,'' AS kd_rek,b.nm_program AS nm_rek, SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a left JOIN trskpd b ON LEFT(a.kd_kegiatan,18)=b.kd_program WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='5' 
						GROUP BY LEFT(a.kd_kegiatan,18)
						UNION ALL
						SELECT kd_kegiatan AS kd_giat,'' AS kd_rek,a.nm_kegiatan AS nm_rek, SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a  WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='5' 
						GROUP BY a.kd_kegiatan
						UNION ALL
						SELECT a.kd_kegiatan AS kd_giat,LEFT(a.kd_rek5,2) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a left JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='5' 
						GROUP BY a.kd_kegiatan,b.kd_rek2
						UNION ALL
						SELECT a.kd_kegiatan AS kd_giat,LEFT(a.kd_rek5,3) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a left JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='5' 
						GROUP BY a.kd_kegiatan,b.kd_rek3
						UNION ALL
						SELECT a.kd_kegiatan AS kd_giat,LEFT(a.kd_rek5,5) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a left JOIN ms_rek4 b ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='5' 
						GROUP BY a.kd_kegiatan,b.kd_rek4
						UNION ALL
						SELECT a.kd_kegiatan AS kd_giat,a.kd_rek5 AS kd_rek,b.nm_rek5 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a left JOIN ms_rek5 b ON a.kd_rek5=b.kd_rek5 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='5' 
						GROUP BY a.kd_rek5 ) a ORDER BY kd_giat,kd_rek";
                 }
                  
                 $pend = $this->db->query($sql_p);                           
                foreach ($pend->result() as $row)
                {
                    $giat=$row->kd_giat;
					$kode=$row->kd_rek;
                    $nama=$row->nm_rek;   
                    $ang=number_format($row->nilai_u,"2",".",",");
                    $angaran=$row->nilai_u;
                    $real=$row->realisasi;
                    $nreal=number_format($real,"2",".",",");                    
                    $real_s = $real - $angaran;
                    if ($real_s < 0){
                    	$x1="("; $real_s=$real_s*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $pend_selisih = number_format($real_s,"2",".",",");
                    $per1   = ($real_s!=0)?($real_s / $row->nilai_u ) * 100:0; 
                    $persen1= number_format($per1);
                    if (strlen($kode)<=3){
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\"><b>$giat.$kode</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$ang</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nreal</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$pend_selisih$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
                                     </tr>";
                      }else{
                      	 $cRet    .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$giat.$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
                                     </tr>";
                      }
                  }
                  
                   $cRet    .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";

                

				 if ($cetak==1){       
                 $sqltp="SELECT SUM(anggaran) AS totp_u,SUM(real_spj) AS realisasi FROM realisasi_bulan  WHERE kd_skpd='$id' AND LEFT(kd_rek5,1)='5' ";
                 }
                 
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                    $angp=number_format($rowp->totp_u,"2",".",",");
                    $angaranp=$rowp->totp_u;
                    $realp=$rowp->realisasi;
                    $nrealp=number_format($realp,"2",".",",");                    
                    $real_sp = $realp - $angaranp;
                    if ($real_sp < 0){
                    	$x1="("; $real_sp=$real_sp*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $pend_selisihp = number_format($real_sp,"2",".",",");
                    $per1p   = ($real_sp!=0)?($real_sp / $rowp->totp_u ) * 100:0; 
                    $persen1p= number_format($per1p);
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Jumlah Belanja Daerah</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$angp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nrealp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisihp$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1p</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
                                     
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
                 }
////----------------------------------------Pembiayaan
				if ($cetak==1){       
                 $sqltp="SELECT SUM(anggaran) AS totp_u,SUM(real_spj) AS realisasi FROM realisasi_bulan  WHERE kd_skpd='$id' AND LEFT(kd_rek5,1)='6' ";
                 }
                 
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                    $angp=number_format($rowp->totp_u,"2",".",",");
                    $angaranp=$rowp->totp_u;
                    $realp=$rowp->realisasi;
                    $nrealp=number_format($realp,"2",".",",");                    
                    $real_sp = $realp - $angaranp;
                    if ($real_sp < 0){
                    	$x1="("; $real_sp=$real_sp*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $pend_selisihp = number_format($real_sp,"2",".",",");
                    $per1p   = ($real_sp!=0)?($real_sp / $rowp->totp_u ) * 100:0; 
                    $persen1p= number_format($per1p);
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Pembiayaan Daerah</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$angp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nrealp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisihp$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1p</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
                                     
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
                 }
                

				if ($cetak==1){      
                 $sql_p="SELECT * FROM (
						SELECT LEFT(a.kd_kegiatan,18) AS kd_giat,'' AS kd_rek,b.nm_program AS nm_rek, SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a left JOIN trskpd b ON LEFT(a.kd_kegiatan,18)=b.kd_program WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='6' 
						GROUP BY LEFT(a.kd_kegiatan,18)
						UNION ALL
						SELECT kd_kegiatan AS kd_giat,'' AS kd_rek,a.nm_kegiatan AS nm_rek, SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a  WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='6' 
						GROUP BY a.kd_kegiatan
						UNION ALL
						SELECT a.kd_kegiatan AS kd_giat,LEFT(a.kd_rek5,2) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a left JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='6' 
						GROUP BY a.kd_kegiatan,b.kd_rek2
						UNION ALL
						SELECT a.kd_kegiatan AS kd_giat,LEFT(a.kd_rek5,3) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a left JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='6' 
						GROUP BY a.kd_kegiatan,b.kd_rek3
						UNION ALL
						SELECT a.kd_kegiatan AS kd_giat,LEFT(a.kd_rek5,5) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a left JOIN ms_rek4 b ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='6' 
						GROUP BY a.kd_kegiatan,b.kd_rek4
						UNION ALL
						SELECT a.kd_kegiatan AS kd_giat,a.kd_rek5 AS kd_rek,b.nm_rek5 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a left JOIN ms_rek5 b ON a.kd_rek5=b.kd_rek5 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='6' 
						GROUP BY a.kd_rek5 ) a ORDER BY kd_giat,kd_rek";
                 }
                  
                 $pend = $this->db->query($sql_p);                           
                foreach ($pend->result() as $row)
                {
                    $giat=$row->kd_giat;
					$kode=$row->kd_rek;
                    $nama=$row->nm_rek;   
                    $ang=number_format($row->nilai_u,"2",".",",");
                    $angaran=$row->nilai_u;
                    $real=$row->realisasi;
                    $nreal=number_format($real,"2",".",",");                    
                    $real_s = $real - $angaran;
                    if ($real_s < 0){
                    	$x1="("; $real_s=$real_s*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $pend_selisih = number_format($real_s,"2",".",",");
                    $per1   = ($real_s!=0)?($real_s / $row->nilai_u ) * 100:0; 
                    $persen1= number_format($per1);
                   
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$giat.$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
                                     </tr>";
                  }
                  
                   $cRet    .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";

                

				 if ($cetak==1){       
                 $sqltp="SELECT (SUM(totp_u61)-SUM(totp_u62)) AS totp_u ,(SUM(realisasi61)-SUM(realisasi62)) AS realisasi FROM(
						SELECT SUM(anggaran) AS totp_u61,SUM(real_spj) AS realisasi61,'' AS totp_u62,'' AS realisasi62 FROM realisasi_bulan  WHERE   kd_skpd='$id' and LEFT(kd_rek5,2)='61'
						UNION
						SELECT '' AS totp_u61,'' AS realisasi61,SUM(anggaran)  AS totp_u62,SUM(real_spj) AS realisasi62 FROM realisasi_bulan  WHERE  kd_skpd='$id' and LEFT(kd_rek5,2)='62'
						)w ";
                 }
                 
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                    $angp=number_format($rowp->totp_u,"2",".",",");
                    $angaranp=$rowp->totp_u;
                    $realp=$rowp->realisasi;
                    $nrealp=number_format($realp,"2",".",",");                    
                    $real_sp = $realp - $angaranp;
                    if ($real_sp < 0){
                    	$x1="("; $real_sp=$real_sp*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $pend_selisihp = number_format($real_sp,"2",".",",");
                    $per1p   = ($real_sp!=0)?($real_sp / $rowp->totp_u ) * 100:0; 
                    $persen1p= number_format($per1p);
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Jumlah Pembiayaan Netto</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$angp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nrealp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisihp$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1p</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
                                     
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
                 }
				
            
                    $cRet .=       " </table>";
        $data['prev']= $cRet;
        $this->template->set('title', 'CETAK RINCIAN REALISASI');        
        $this->tukd_model->_mpdf('',$cRet,10,10,10,0);
    }
    
    //----- tambah
	function lampiran_perkada_I(){
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/perkada_real_1', $data);
    }

	function cetak_perkada1_real( $ctk = '',$lap = '', $skpd = ''){
        $id = $skpd;
        $cetak = $ctk;
        $laporan = $lap;

		$ww=$this->cetak_perkada1_semester('1',$laporan,$id);
        
    }

	function cetak_perkada1_semester($ctk = '',$lap = '', $skpd = ''){
        $id = $skpd;
        $cetak = 1;
        $laporan = $lap;

        if ($laporan <> '2')
        {
            $sts = '';
            $jurnal = '';
		    $zz=$this->cetak_perkada_1('1','','','1');
        }
	 }

	 function cetak_perkada_1($cetak='', $bulan='',$hari='',$perkada=''){
		$thnx=$this->session->userdata('pcThang');
		if($bulan==''){
			$b=date('m');
			$bulanx=$thnx.'-'.$b.'-01';
		}else{
			$bulanx=$thnx.'-'.$bulan.'-01';
		}
		$date=date('Y-m-t',strtotime($bulanx));
		$last= strtoupper($this->tukd_model->tanggal_format_indonesia($date));
       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang, no_qanun, tgl_qanun, no_perbup, tgl_perbup, bupati FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl     = $rowsc->tgl_rka;
                    $tanggal = $this->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                    
                    $bupati     = $rowsc->bupati;
                    $no_qanun   = $rowsc->no_qanun;
                    $tgl_qanun  = $this->tukd_model->tanggal_format_indonesia($rowsc->tgl_qanun);
                    $no_perbup  = $rowsc->no_perbup;
                    $tgl_perbup = $rowsc->tgl_perbup;
                } 
        $cRet='';
       if($perkada=="2"){ 
        $cRet .="<table width=\"100%\" align=\"center\" border=\"0\">
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">LAMPIRAN I : PERATURAN BUPATI BIAK NUMFOR</td>
                    </tr>
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">NOMOR : $no_perbup</td>
                    </tr>
                    
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">TANGGAL : ".$this->tukd_model->tanggal_format_indonesia($tgl_perbup)."</td>
                    </tr>

                  </table>
				  <br>";
            
        $cRet .="<table style=\"border-collapse:collapse;  style=\"font-size:12\"\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>LAPORAN REALISASI PENJABARAN ANGGARAN </strong></td>
                    </tr>
                    
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>

                  </table>"; 
				 $tanggal= $this->tukd_model->tanggal_format_indonesia($tgl_perbup);
	   }else{
		$cRet .="<table width=\"100%\" align=\"center\" border=\"0\">
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">LAMPIRAN I : PERATURAN BUPATI BIAK NUMFOR</td>
                    </tr>
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">NOMOR : $no_qanun</td>
                    </tr>
                    
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">TANGGAL : $tgl_qanun</td>
                    </tr>

                  </table>
				  <br>";
            
        $cRet .="<table style=\"border-collapse:collapse;  style=\"font-size:12\"\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>LAPORAN REALISASI ANGGARAN </strong></td>
                    </tr>
                    
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>PER $last</strong></td>
                    </tr>

                  </table>"; 
				  $tanggal= $tgl_qanun;
	   	   }
        $cRet .= "<table style=\"border-collapse:collapse; font-size:14;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NOMOR URUT</b></td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"45%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>ANGGARAN</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>REALISASI</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>LEBIH<br>(KURANG)</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>%</b></td>
						</tr>
                     </thead>
					  <tfoot>
                        <tr><td style=\"border-bottom: none; border-left:none;border-right:none;\" colspan=\"6\"></td>
                     </tfoot>";
                 $sql1="SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
						IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek1 a INNER JOIN realisasi_bulan b
						ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='4'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
						UNION ALL
						SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
						IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek2 a 
						LEFT JOIN realisasi_bulan b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='4' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
						IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek3 a 
						LEFT JOIN realisasi_bulan b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='4'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3 
						ORDER BY kd_rek";
                 $query = $this->db->query($sql1);
                                                  
                foreach ($query->result() as $row)
                {
                    $coba1=$row->rek;
                    $coba2=ucwords(strtolower($row->nm_rek));
                    $coba3= number_format($row->anggaran,"2",",",".");
					$coba3x= number_format($row->realy,"2",",",".");
					$coba3xx=$row->anggaran - $row->realy;
					$coba3xx= number_format($coba3xx,"2",",",".");
					
					if ($row->anggaran==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$row->anggaran;
						$per1 = ($row->realy!=0)?( $row->realy /  $row->anggaran ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);
                    if(strlen($coba1)<=3){
                        $coba1_= strtoupper($coba1);
                        $coba2_= strtoupper($coba2);
                        
                        $cRet .= "<tr>
									<td width=\"10%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
                                    <td width=\"45%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
                                    <td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"5%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
								</tr>";
                        
                        $cRet    .= " <tr>
										<td  width=\"10%\" align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba1_</b></td>
										<td width=\"45%\" style=\"border-top:none;border-bottom:none;\"><b>$coba2_</b></td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba3</b></td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba3x</b></td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba3xx</b></td>
										<td width=\"5%\" align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$persen1</b></td>
									</tr>";
                    }else{
                        $cRet    .= " <tr>
										<td width=\"10%\" align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba1</td>
										<td width=\"45%\" style=\"border-top:none;border-bottom:none;\">$coba2</td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba3</td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba3x</td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba3xx</td>
										<td width=\"5%\" align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$persen1</td>
									</tr>";
                    }
                    
                }
                $sqltp="SELECT SUM(anggaran) AS totp,sum(real_spj)as realp FROM realisasi_bulan WHERE LEFT(kd_rek5,1)='4'";
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                   $coba4=number_format($rowp->totp,"2",",",".");
                    $cob1=$rowp->totp;
					$cob1x=$rowp->realp;
					$coba4x=number_format($rowp->realp,"2",",",".");
					$cob1xx=$cob1-$cob1x;
					$cob1xxx=number_format($cob1xx,"2",",",".");
					if ($cob1==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$cob1;
						$per1 = ($cob1x!=0)?( $cob1x /  $cob1 ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                    $cRet    .= " <tr><td idth=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"45%\" align=\"right\"><b>JUMLAH PENDAPATAN&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba4</b></td>
									 <td width=\"15%\" align=\"right\"><b>$coba4x</b></td>
									 <td width=\"15%\" align=\"right\"><b>$cob1xxx</b></td>
									 <td width=\"5%\" align=\"center\"><b>$persen1</b></td>
								  </tr>";
                 } 
				
                $sql2="SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
					IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek1 a INNER JOIN realisasi_bulan b
					ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='5'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
					UNION ALL 
					SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
					IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy  FROM ms_rek2 a LEFT JOIN realisasi_bulan b
					ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='5' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
					UNION ALL 
					SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
					IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek3 a LEFT JOIN realisasi_bulan b
					ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='5'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3 ORDER BY kd_rek";
                 
                 $query1 = $this->db->query($sql2);
                 foreach ($query1->result() as $row1)
                {
                    $coba5=$row1->rek;
                    $coba6=ucwords(strtolower($row1->nm_rek));
                    $coba7= number_format($row1->anggaran,"2",",",".");
					$coba7x= number_format($row1->realy,"2",",",".");
					$coba7xx=$row1->anggaran - $row1->realy;
					$coba7xxx= number_format($coba7xx,"2",",",".");

					if ($row1->anggaran==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$row1->anggaran;
						$per1 = ($row1->realy!=0)?($row1->realy /  $row1->anggaran ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                    if(strlen($coba5)<=3){
                        $coba5_= strtoupper($coba5);
                        $coba6_= strtoupper($coba6);
                        
                        $cRet .= "<tr><td width=\"10%\" align=\"center\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
										<td width=\"45%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
										<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
										<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
										<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
										<td width=\"5%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
								</tr>";
                        
                         $cRet    .= " <tr>
										<td width=\"10%\" align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba5_</b></td>
										<td width=\"45%\" align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba6_</b></td>
                                        <td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba7</b></td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba7x</b></td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba7xxx</b></td>
										<td width=\"5%\" align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$persen1</b></td>
									</tr>";
                    }else{
                         $cRet    .= " <tr><td width=\"10%\" align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba5</td>                                     
										<td width=\"45%\" align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba6</td>
										<td width=\"20%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba7</td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba7x</td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba7xxx</td>
										<td width=\"5%\" align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$persen1</td>
									</tr>";
                    }
                    
                }
                
                    $sqltb="SELECT SUM(anggaran) AS totb,sum(real_spj)as realb FROM realisasi_bulan WHERE LEFT(kd_rek5,1)='5'";
                    $sqlb=$this->db->query($sqltb);
                 foreach ($sqlb->result() as $rowb)
                {
                   $coba8=number_format($rowb->totb,"2",",",".");
                    $cob=$rowb->totb;
					$coba8x=number_format($rowb->realb,"2",",",".");
                    $cobx=$rowb->realb;
					$cobxx= $cob - $cobx;
					$cobxxx = number_format($cobxx,"2",",",".");

					if ($cob==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$cob;
						$per1 = ($cobx!=0)?($cobx /  $cob ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"45%\" align=\"right\"><b>JUMLAH BELANJA&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba8</b></td>
									<td width=\"15%\" align=\"right\"><b>$coba8x</b></td>
									<td width=\"15%\" align=\"right\"><b>$cobxxx</b></td>
									<td width=\"5%\" align=\"center\"><b>$persen1</b></td>
								</tr>";
                 } 
                  
                  $suplus=$cob1-$cob; 
                  if ($suplus < 0){
                	$x1="(";
                	$suplus=$suplus*-1;
                	$y1=")";}
                  else {
                	$x1="";
	                $y1="";}
                 $surp=number_format($suplus,2,',','.');

				  $suplusx=$cob1x-$cobx; 
                  if ($suplusx < 0){
                	$xx1="(";
                	$suplusx=$suplusx*-1;
                	$yy1=")";}
                  else {
                	$xx1="";
	                $yy1="";}
                 $surpx=number_format($suplusx,2,',','.');

				 $suplusxx=$cob1xx-$cobxx; 
                  if ($suplusxx < 0){
                	$xxx1="(";
                	$suplusxx=$suplusxx*-1;
                	$yyy1=")";}
                  else {
                	$xxx1="";
	                $yyx1="";}
                 $surpxx=number_format($suplusxx,2,',','.');
					
				 if ($suplus==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$suplus;
						$per1 = ($suplusx!=0)?($suplusx /  $suplus ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"45%\" align=\"right\"><b>SURPLUS/DEFISIT</b> &nbsp;&nbsp;&nbsp;&nbsp;</td>
                                     <td width=\"15%\" align=\"right\"><b>$x1$surp$y1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$xx1$surpx$yy1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$xxx1$surpxx$yyy1</b></td>
									 <td width=\"5%\" align=\"center\"><b></b></td>
									</tr>";
                   
                    $sql3="SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
							IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek1 a INNER JOIN realisasi_bulan b
							ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='6'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
							UNION ALL 
							SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
							IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek2 a LEFT JOIN realisasi_bulan b
							ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='61' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
							UNION ALL 
							SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
							IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek3 a LEFT JOIN realisasi_bulan b
							ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='61'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3 ORDER BY kd_rek";
                 
                 $query3 = $this->db->query($sql3);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query3->result() as $row3)
                {
                    $coba9=$row3->rek;
                    $coba10=ucwords(strtolower($row3->nm_rek));
                    $coba11= number_format($row3->anggaran,"2",",",".");
					$coba11x=number_format($row3->realy,"2",",",".");
					$coba11xx=$row3->anggaran - $row3->realy;
					$coba11xxx=number_format($coba11xx,"2",",",".");

					if ($row3->anggaran==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$row3->anggaran;
						$per1 = ($row3->realy!=0)?($row3->realy /  $row3->anggaran ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                   if(strlen($coba9)<=3){
                        $coba9_= strtoupper($coba9);
                        $coba10_= strtoupper($coba10);
                        
                        $cRet .= "<tr><td width=\"10%\" valign=\"top\" align=\"center\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
									   <td width=\"45%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									   <td width=\"15%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									   <td width=\"15%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									   <td width=\"15%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									   <td width=\"5%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									</tr>";
                        if(strlen($coba9)==1){
                            $cRet    .= " <tr><td  width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"><b>$coba9_</b></td>                                     
                                     <td width=\"45%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba10_</b></td>
                                     <td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>&nbsp;</b></td>
										<td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>&nbsp;</b></td>
									   <td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>&nbsp;</b></td>
									   <td width=\"5%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>&nbsp;</b></td>
									 </tr>";
                        }else{
                            $cRet    .= " <tr>
										<td  width=\"10%\" valign=\"top\" align=\"left\" style=\"border-top:none;border-bottom:none;\"><b>$coba9_</b></td>
										<td width=\"45%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba10_</b></td>
										<td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba11</b></td>
										<td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba11x</b></td>
										<td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba11xxx</b></td>
										<td width=\"5%\" valign=\"top\" align=\"center\" style=\"border-top:none;border-bottom:none;\"><b>$persen1</b></td>
										</tr>";
                        }
                   }else{
                       $cRet    .= " <tr>
									<td  width=\"10%\" valign=\"top\" align=\"left\" style=\"border-top:none;border-bottom:none;\">$coba9</td>
									<td width=\"45%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba10</td>
                                     <td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba11</td>
									 <td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba11x</td>
									 <td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba11xxx</td>
									 <td width=\"5%\" valign=\"top\" align=\"center\" style=\"border-top:none;border-bottom:none;\">$persen1</td>
									</tr>";
                   }
                     
                }
                $sqltpm="SELECT SUM(anggaran) AS totpm, SUM(real_spj) AS realpm FROM realisasi_bulan WHERE LEFT(kd_rek5,2)='61'";
                 $sqlpm=$this->db->query($sqltpm);
                 foreach ($sqlpm->result() as $rowpm)
                {
                   $coba12=number_format($rowpm->totpm,"2",",",".");
                    $cob3=$rowpm->totpm;
					$cob3x=$rowpm->realpm;
				    $coba12x=number_format($cob3x,"2",",",".");
					$cob3xx=$cob3 - $cob3x;
					$cob3xxx=number_format($cob3xx,"2",",",".");
                   if ($cob3==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$cob3;
						$per1 = ($cob3x!=0)?($cob3x /  $cob3 ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);
                    $cRet    .= " <tr><td width=\"10%\" valign=\"top\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                      <td width=\"45%\" valign=\"top\" align=\"right\"><b>JUMLAH PEMBIAYAAN MASUK&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                      <td width=\"15%\" valign=\"top\" align=\"right\"><b>$coba12</b></td>
									  <td width=\"15%\" valign=\"top\" align=\"right\"><b>$coba12x</b></td>
									  <td width=\"15%\" valign=\"top\" align=\"right\"><b>$cob3xxx</b></td>
									  <td width=\"5%\" valign=\"top\" align=\"center\"><b>$persen1</b></td>
									</tr>";
                 }
                  
                $sql4="SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
						IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek2 a LEFT JOIN realisasi_bulan b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='62' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
						IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek3 a LEFT JOIN realisasi_bulan b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='62'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3 ORDER BY kd_rek";
                 
                 $query4 = $this->db->query($sql4);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query4->result() as $row4)
                {
                    $coba13=$row4->rek;
                    $coba14=ucwords(strtolower($row4->nm_rek));
                    $coba15= number_format($row4->anggaran,"2",",",".");
					$coba15x= number_format($row4->realy,"2",",",".");
					$coba15xx=$row4->anggaran - $row4->realy;
					$coba15xxx=number_format($coba15xx,"2",",",".");

					 if ($row4->anggaran==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$row4->anggaran;
						$per1 = ($row4->realy!=0)?($row4->realy /  $row4->anggaran ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                   if(strlen($coba13)<=3){
                        $coba13_= strtoupper($coba13);
                        $coba14_= strtoupper($coba14);

                        $cRet .= "<tr><td width=\"10%\" align=\"center\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
									<td width=\"45%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"5%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
								</tr>";
                        
                       $cRet    .= " <tr>
									<td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"><b>$coba13_</b></td>
                                     <td width=\"45%\" style=\"border-top:none;border-bottom:none;\"><b>$coba14_</b></td>
                                     <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba15</b></td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba15x</b></td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba15xxx</b></td>
									 <td width=\"5%\"  align=\"center\" style=\"border-top:none;border-bottom:none;\"><b>$persen1</b></td>
									</tr>";
                   }else{
                       $cRet    .= " <tr>
									<td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\">$coba13</td>                          
                                     <td width=\"45%\" style=\"border-top:none;border-bottom:none;\">$coba14</td>
                                     <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba15</td>
									<td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba15x</td>                          
                                     <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba15xxx</td>
                                     <td width=\"5%\" align=\"center\" style=\"border-top:none;border-bottom:none;\">$persen1</td>
									 </tr>";
                   }
                     
                }
                $sqltpk="SELECT SUM(anggaran) AS totpk,SUM(real_spj) AS realpk FROM realisasi_bulan WHERE LEFT(kd_rek5,2)='62'";
                 $sqlpk=$this->db->query($sqltpk);
                 foreach ($sqlpk->result() as $rowpk)
                {
                   $coba16=number_format($rowpk->totpk,"2",",",".");
				   $coba16x=number_format($rowpk->realpk,"2",",",".");
                    $cob4=$rowpk->totpk;
					$cob4x=$rowpk->realpk;
					$cob4xx=$cob4 - $cob4x;
					$cob4xxx=number_format($cob4xx,"2",",",".");

					if ($cob4==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$cob4;
						$per1 = ($cob4!=0)?($cob4x /  $cob4 ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);
                   
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"45%\" align=\"right\"><b>JUMLAH PEMBIAYAAN KELUAR&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba16</b></td>
									 <td width=\"15%\" align=\"right\"><b>$coba16x</b></td>
									 <td width=\"15%\" align=\"right\"><b>$cob4xxx</b></td>
									 <td width=\"5%\" align=\"center\"><b>$persen1</b></td>
									 </tr>";
                 }  
                  
                  $netto=$cob3-$cob4; 
                  if ($netto < 0){
                	$a1="(";
                	$netto=$netto*-1;
                	$b1=")";}
                  else {
                	$a1="";
	                $b1="";}
                 $nett=number_format($netto,2,',','.');
				 
				 $nettox=$cob3x-$cob4x; 
                  if ($nettox < 0){
                	$aa1="(";
                	$nettox=$nettox*-1;
                	$bb1=")";}
                  else {
                	$aa1="";
	                $bb1="";}
                 $nettx=number_format($nettox,2,',','.');

				 $nettoxx=$cob3xx-$cob4xx; 
                  if ($nettox < 0){
                	$aaa1="(";
                	$nettoxx=$nettoxx*-1;
                	$bbb1=")";}
                  else {
                	$aaa1="";
	                $bbb1="";}
                 $nettxx=number_format($nettoxx,2,',','.');
					
					if ($netto==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$netto;
						$per1 = ($nettox!=0)?($nettox /  $netto ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                    $cRet .= "<tr><td width=\"10%\" align=\"center\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
									<td width=\"45%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"5%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
							  </tr>";
                 
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"45%\" align=\"right\"><b>PEMBIAYAAN NETTO&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$a1$nett$b1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$aa1$nettx$bb1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$aaa1$nettxx$bbb1</b></td>
									 <td width=\"5%\" align=\"center\"><b>$persen1</b></td>
								</tr>";
                    $silpa=($cob1+$cob3)-($cob+$cob4);
                     if ($silpa < 0){
						$c1="(";
						$silpa=$silpa*-1;
						$d1=")";}
                    else {
						$c1="";
						$d1="";}
					$silp=number_format($silpa,2,',','.'); 
					
					$silpax=($cob1x+$cob3x)-($cobx+$cob4x);
                     if ($silpax < 0){
						$cc1="(";
						$silpax=$silpax*-1;
						$dd1=")";}
                    else {
						$cc1="";
						$dd1="";}
					$silpx=number_format($silpax,2,',','.'); 

					$silpaxx=($cob1xx+$cob3xx)-($cobxx+$cob4xx);
                     if ($silpaxx < 0){
						$ccc1="(";
						$silpaxx=$silpaxx*-1;
						$ddd1=")";}
                    else {
						$ccc1="";
						$ddd1="";}
					$silpxx=number_format($silpaxx,2,',','.'); 
					
					if ($silpa==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$silpa;
						$per1 = ($silpax!=0)?($silpax /  $silpa ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                    $cRet .= "<tr><td width=\"10%\" align=\"center\">&nbsp;</td>                            
								<td width=\"45%\">&nbsp;</td>
								<td width=\"15%\">&nbsp;</td>
								<td width=\"15%\">&nbsp;</td>
								<td width=\"15%\">&nbsp;</td>
								<td width=\"5%\">&nbsp;</td>
							</tr>";
                    
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\"><b>3.3</b></td>                                     
                                     <td width=\"45%\" ><b>SISA LEBIH PEMBIAYAAN ANGGARAN TAHUN BERKENAAN (SILPA)&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$c1$silp$d1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$cc1$silpx$dd1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$ccc1$silpxx$ddd1</b></td>
									 <td width=\"5%\" align=\"center\"><b></b></td>
									</tr>";
                    $cRet .="<tr>
                                <td width=\"100%\" align=\"left\" colspan=\"6\">
                                                    <table border=\"0\" cellpading = \"8\" width=\"100%\">
                                                        <tr>
                                                            <td width=\"90%\" align=\"left\">&nbsp;<br>&nbsp;
								<br>&nbsp;
								&nbsp;<br>
                                                                &nbsp;<br>
                                                                &nbsp;<br>
								&nbsp;	
                                                            </td> 
                                             <td width=\"30%\" align=\"center\">".ucwords(strtolower($daerah)).",   ".$last."
                                                                <p>BUPATI BIAK NUMFOR</p>
                                                                <p>&nbsp;</p>
                                                                <br><br>
                                                                <br><b>$bupati</b>
                                                                <br>
                                                            </td>
                                                        </tr>
                                                    </table></td>
                             </tr>";
                    
        $cRet    .= "</table>";
        $data['prev']= $cRet;
        $this->template->set('title', 'CETAK PERDA');
       // $this->_mpdf1('',$cRet,25,10,10,'P','',$hal);
        switch($cetak) {
			case 0;
				 echo ("<title>L R A</title>"); 
				 echo $cRet;
			break;		
			case 1;
				 $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
			break;
			case 2;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");
				
				$this->load->view('anggaran/rka/perkadaII', $data);
			break;
			case 3;     
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
			break;
        
        }
    }
//-----  

    function lampiran_I(){
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/perda_real_1', $data);
    }
    
	function lampiran_I_smstr(){
        $data['page_title'] = 'REALISASI SEMESTER I';
        $this->template->set('title', 'SEMESTER I');
        $this->template->load('template', 'akuntansi/perda_real_smstr', $data);
    }

    function cetak_perda1_real( $ctk = '',$lap = '', $skpd = ''){
        $id = $skpd;
        $cetak = $ctk;
        $laporan = $lap;

		$ww=$this->cetak_perda1_semester('1',$laporan,$id);
        
    }

    function cetak_perda1_semester($ctk = '',$lap = '', $skpd = ''){
        $id = $skpd;
        $cetak = 1;
        $laporan = $lap;

        if ($laporan <> '2')
        {
            $sts = '';
            $jurnal = '';
		    $zz=$this->cetak_lra_bulan('1','','','1');
        } else
        {
            $sts = "AND MONTH(d.tgl_sts)<='6'";
            $jurnal = "AND MONTH(d.tgl_voucher)<='6'";

        }
       
       
	   $sts = '';
	   $jurnal = '';           
       
        $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                }
                
         $sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$id' and kode='PA'";
                 $sqlttd=$this->db->query($sqlttd1);
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip=$rowttd->nip;                    
                    $namapa= $rowttd->nm;
                    $jabatan  = $rowttd->jab;
                }
       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang, no_qanun, tgl_qanun, no_perbup, tgl_perbup, bupati FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl     = $rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                    
                    $bupati     = $rowsc->bupati;
                    $no_qanun   = $rowsc->no_qanun;
                    $tgl_qanun  = $this->tukd_model->tanggal_format_indonesia($rowsc->tgl_qanun);
                    $no_perbup  = $rowsc->no_perbup;
                    $tgl_perbup = $rowsc->tgl_perbup;
                    
                }
        $jk=$this->rka_model->combo_skpd();
       
        $cRet='';
        
        if ($cetak == '1') {
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td rowspan=\"3\" align=\"left\" width=\"55%\"><strong></strong></td>
                         <td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"15%\"><strong><h5>LAMPIRAN I  :</h6></strong></td>
                         <td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>PERATURAN DAERAH</strong></h5></td>
                    </tr>
                    <tr> 
                         <td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>: $no_qanun</h5></td>
                    </tr>
                    <tr>
                        <td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>: $tgl_qanun</h5></td>
                    </tr>                                     
                   
                  </table>"; 
            }                 
             
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>RINGKASAN REALISASI APBD SEMESTER I</strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        if ($cetak == '1') {
            $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
                            <td width=\"20%\">Urusan Organisasi </td>
                            <td width=\"80%\">: $kd_urusan - $nm_urusan</td>
                        </tr>
                        <tr>
                            <td>Organisasi</td>
                            <td>: $kd_skpd - $nm_skpd </td>
                        </tr>
                    
                    </table>";      
        }
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NOMOR URUT</b></td>                            
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>JUMLAH(Rp.)</b></td>
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>PROGNOSIS</b></td>
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>%</b></td>
						</tr>
						<tr>
							<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Anggaran</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Realisasi</b></td>
						</tr>
                     </thead>
					  <tfoot>
                        <tr><td style=\"border-bottom: none; border-left:none;border-right:none;\" colspan=\"6\"></td>
                     </tfoot>
                        <tr>
							<td  width=\"10%\" align=\"center\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
                               <td width=\"40%\">&nbsp;</td>
                               <td width=\"15%\">&nbsp;</td>
							    <td width=\"15%\">&nbsp;</td>
                               <td width=\"15%\">&nbsp;</td>
							    <td width=\"5%\">&nbsp;</td>
							 </tr>
                        ";
                 $sql1="SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,SUM(c.real_spj)AS realy FROM ms_rek1 a 
						INNER JOIN trdrka b ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) 
						INNER JOIN realisasi_bulan c ON a.kd_rek1=LEFT(c.kd_rek5,(LENGTH(a.kd_rek1)))AND c.kd_skpd=b.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan
						WHERE LEFT(a.kd_rek1,1)='4' AND b.kd_skpd='$id' GROUP BY a.kd_rek1,a.lra, a.nm_rek1
						UNION ALL 
						SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,SUM(c.real_spj)AS realy FROM ms_rek2 a 
						INNER JOIN trdrka b ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2)))
						INNER JOIN realisasi_bulan c ON a.kd_rek2=LEFT(c.kd_rek5,(LENGTH(a.kd_rek2)))AND c.kd_skpd=b.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan 
						WHERE LEFT(a.kd_rek2,1)='4' AND b.kd_skpd='$id' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,SUM(c.real_spj)AS realy FROM ms_rek3 a 
						INNER JOIN trdrka b ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) 
						INNER JOIN realisasi_bulan c ON a.kd_rek3=LEFT(c.kd_rek5,(LENGTH(a.kd_rek3)))AND c.kd_skpd=b.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan
						WHERE LEFT(a.kd_rek3,1)='4' AND b.kd_skpd='$id'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3 ORDER BY kd_rek";
                 
                 $query = $this->db->query($sql1);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query->result() as $row)
                {
                    $coba1=$row->rek;
                    $coba2=$row->nm_rek;
                    $coba3= number_format($row->nilai,"2",",",".");
					$coba4=number_format($row->realy,"2",",",".");
					$sisx=$row->nilai - $row->realy;
					$sis=number_format($sisx,"2",",",".");
					
					if ($row->realy < 0){
                    	$x1="("; $row->realy=$row->realy*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";
					}
                   
                    $perz   = ($row->realy!=0)?($row->realy / $row->nilai ) * 100:0; 
                    $persenz= number_format($perz,"2",".",",");  

                   if(strlen($coba1)<=3){
                        $cRet    .= " <tr>
										<td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"><b>$coba1</b></td>
										<td width=\"40%\" style=\"border-top:none;border-bottom:none;\"><b>$coba2</b></td>
										 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba3</b></td>
										 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba4</b></td>
										 <td width=\"10%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$sis</b></td>
										 <td width=\"5%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$persenz</b></td>
									 </tr>";
                    }else{
                        $cRet    .= " <tr>
										<td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\">$coba1</td>
										<td width=\"40%\"  style=\"border-top:none;border-bottom:none;\">$coba2</td>
										<td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba3</td>
										 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba4</td>
										  <td width=\"10%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$sis</td>
										 <td width=\"5%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$persenz</td>
									 </tr>";
                    }
                     
                }
                $sqltp="SELECT SUM(a.nilai_ubah) AS totp,sum(real_spj)as totpreal FROM trdrka a INNER JOIN realisasi_bulan b ON a.kd_rek5=b.kd_rek5 AND a.kd_skpd=b.kd_skpd and a.kd_kegiatan=b.kd_kegiatan WHERE LEFT(a.kd_rek5,1)='4' and a.kd_skpd='$id'";
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                   $coba4=number_format($rowp->totp,"2",",",".");
                    $cob1=$rowp->totp;
					 $cob2=$rowp->totpreal;
					 $sisx1= $cob1-$cob2;
					 $sisx2=number_format($sisx1,"2",",",".");
					  $coba3=number_format($rowp->totpreal,"2",",",".");

					if ($cob2 < 0){
                    	$x1="("; $cob2=$cob2*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";
					}
                   
                    $perx   = ($cob2!=0)?($rowp->totpreal / $rowp->totp ) * 100:0; 
                    $persenx= number_format($perx,"2",".",",");  
                   
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"40%\"><b>Jumlah Pendapatan</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba4</b></td>
									 <td width=\"15%\" align=\"right\"><b>$coba3</b></td>
									 <td width=\"15%\" align=\"right\"><b>$sisx2</b></td>
									 <td width=\"5%\" align=\"right\"><b>$persenx</b></td>
								</tr>
									 ";

                 }     
                $sql2="SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,SUM(c.real_spj) AS realy FROM ms_rek1 a 
						INNER JOIN trdrka b ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1)))
						LEFT JOIN realisasi_bulan c ON a.kd_rek1=LEFT(c.kd_rek5,(LENGTH(a.kd_rek1))) AND b.kd_skpd=c.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan
						WHERE LEFT(a.kd_rek1,1)='5' AND b.kd_skpd='$id' GROUP BY a.kd_rek1,a.lra, a.nm_rek1
						UNION ALL 
						SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,SUM(c.real_spj) AS realy FROM ms_rek2 a 
						INNER JOIN trdrka b ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2)))
						LEFT JOIN realisasi_bulan c ON a.kd_rek2=LEFT(c.kd_rek5,(LENGTH(a.kd_rek2)))AND c.kd_skpd=b.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan  
						WHERE LEFT(a.kd_rek2,1)='5' AND b.kd_skpd='$id' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,SUM(c.real_spj) AS realy FROM ms_rek3 a 
						INNER JOIN trdrka b ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3)))
						LEFT JOIN realisasi_bulan c ON a.kd_rek3=LEFT(c.kd_rek5,(LENGTH(a.kd_rek3)))AND c.kd_skpd=b.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan
						WHERE LEFT(a.kd_rek3,1)='5' AND b.kd_skpd='$id'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3 ORDER BY kd_rek";
                 
                 $query1 = $this->db->query($sql2);
                 foreach ($query1->result() as $row1)
                {
                    $coba5=$row1->rek;
                    $coba6=$row1->nm_rek;
                    $coba7= number_format($row1->nilai,"2",",",".");
					$coba8=number_format($row1->realy,"2",",",".");
					$sisax=$row1->nilai-$row1->realy;
					
                    if ($coba8 < 0){
                    	$x1="("; $coba8=$coba8*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                   
                    $per1   = ($coba8!=0)?($row1->realy / $row1->nilai ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");  
                   if(strlen($coba5)<=3){
                       $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"><b>$coba5</b></td>                                     
                                     <td width=\"40%\" style=\"border-top:none;border-bottom:none;\"><b>$coba6</b></td>
                                     <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba7</b></td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba8</b></td>
									<td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>".number_format($sisax,"2",",",".")."$</b></td>
									<td width=\"5%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$persen1</b></td></tr>";
                   }else{
                       $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\">$coba5</td>                                     
                                     <td width=\"40%\" style=\"border-top:none;border-bottom:none;\">$coba6</td>
                                     <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba7</td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba8</td>
									<td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">".number_format($sisax,"2",",",".")."$</td>
									<td width=\"5%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$persen1</td></tr>";
                   }
                }
                
                    $sqltb="SELECT SUM(a.nilai_ubah) AS totb,sum(real_spj)as totbreal FROM trdrka a INNER JOIN realisasi_bulan b ON a.kd_rek5=b.kd_rek5 AND a.kd_skpd=b.kd_skpd and a.kd_kegiatan=b.kd_kegiatan WHERE LEFT(a.kd_rek5,1)='5' and a.kd_skpd='$id'";
                    $sqlb=$this->db->query($sqltb);
                 foreach ($sqlb->result() as $rowb)
                {
                   $coba8=number_format($rowb->totb,"2",",",".");
                    $cob=$rowb->totb;
					$cobx=$rowb->totbreal;
					$coba9=number_format($rowb->totbreal,"2",",",".");
					$sisatb=$cob-$cobx;
					 if ($sisatb < 0){
                    	$x1="("; $sisatb=$sisatb*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                   
                    $per2   = ($sisatb!=0)?($rowb->totbreal / $rowb->totb ) * 100:0; 
                    $persen2= number_format($per2,"2",".",",");
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"40%\"><b>Jumlah Belanja</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba8</b></td>
									 <td width=\"15%\" align=\"right\"><b>$coba9</b></td>
									 <td width=\"15%\" align=\"right\"><b>".number_format($sisatb,"2",",",".")."</b></td>
									 <td width=\"5%\" align=\"right\"><b>$persen2</b></td>
									 </tr>";
                 } 
                  
                  $suplus=$cob1-$cob; 
                  if ($suplus < 0){
                	$x1="(";
                	$suplus=$suplus*-1;
                	$y1=")";}
                  else {
                	$x1="";
	                $y1="";}
                  $surp=number_format($suplus,2,',','.'); 
				  
				  $suplusx=$cob2-$cobx; 
                  if ($suplusx < 0){
                	$xx1="(";
                	$suplusx=$suplusx*-1;
                	$yy1=")";}
                  else {
                	$xx1="";
	                $yy1="";}
                 $surpx=number_format($suplusx,2,',','.');
				

				  $suplusxx=$suplus-$suplusx; 
                                    
                    $per3   = ($suplusxx!=0)?($suplusx / $suplus ) * 100:0; 
                    $persen3= number_format($per3,"2",".",",");
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"40%\"><b>Surplus/Defisit</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$x1$surp$y1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$xx1$surpx$yy1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$x1".number_format($suplusxx,2,',','.')."$y1</b></td>
									 <td width=\"5%\" align=\"right\"><b>$persen3</b></td>
									 </tr>";
                    
                    $sql3="SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,SUM(c.real_spj) AS realy FROM ms_rek1 a 
					INNER JOIN trdrka b ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1)))
					LEFT JOIN realisasi_bulan c ON a.kd_rek1=LEFT(c.kd_rek5,(LENGTH(a.kd_rek1))) AND b.kd_skpd=c.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan 
					WHERE LEFT(a.kd_rek1,1)='6' AND b.kd_skpd='$id' GROUP BY a.kd_rek1,a.lra, a.nm_rek1
					UNION ALL 
					SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,SUM(c.real_spj) AS realy FROM ms_rek2 a 
					INNER JOIN trdrka b ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2)))
					LEFT JOIN realisasi_bulan c ON a.kd_rek2=LEFT(c.kd_rek5,(LENGTH(a.kd_rek2))) AND b.kd_skpd=c.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan  
					WHERE LEFT(a.kd_rek2,2)='61' AND b.kd_skpd='$id' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
					UNION ALL 
					SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,SUM(c.real_spj) AS realy FROM ms_rek3 a 
					INNER JOIN trdrka b ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) 
					LEFT JOIN realisasi_bulan c ON a.kd_rek3=LEFT(c.kd_rek5,(LENGTH(a.kd_rek3))) AND b.kd_skpd=c.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan 
					WHERE LEFT(a.kd_rek3,2)='61' AND b.kd_skpd='$id' GROUP BY a.kd_rek3,a.lra, a.nm_rek3 ORDER BY kd_rek";
                 
                 $query3 = $this->db->query($sql3);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query3->result() as $row3)
                {
                    $coba9=$row3->rek;
                    $coba10=$row3->nm_rek;
                    $coba11= number_format($row3->nilai,"2",",",".");
					$coba12= number_format($row3->realy,"2",",",".");
					$cobaw =$row3->nilai-$row3->realy;
					if ($cobaw < 0){
                    	$x1="("; $cobaw=$cobaw*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                   
                    $per3   = ($cobaw!=0)?($row3->realy / $row3->nilai ) * 100:0; 
                    $persen3= number_format($per3,"2",".",",");
                   
                     $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\">$coba9</td>                                     
                                     <td width=\"40%\" style=\"border-top:none;border-bottom:none;\">$coba10</td>
                                     <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba11</td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba12</td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">".number_format($cobaw,"2",",",".")."</td>
									 <td width=\"5%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$persen3</td>
									</tr>";
                }
                $sqltpm="SELECT SUM(nilai) AS totpm, sum(real_spj)as totpmreal FROM trdrka a INNER JOIN realisasi_bulan b ON a.kd_rek5=b.kd_rek5 AND a.kd_skpd=b.kd_skpd and a.kd_kegiatan=b.kd_kegiatan WHERE LEFT(a.kd_rek5,2)='61' and a.kd_skpd='$id'";
                 $sqlpm=$this->db->query($sqltpm);
                 foreach ($sqlpm->result() as $rowpm)
                {
                   $coba12=number_format($rowpm->totpm,"2",",",".");
                    $cob3=$rowpm->totpm;
					$cob3x=$rowpm->totpmreal;
				  $coba13=number_format($rowpm->totpmreal,"2",",",".");
				  $total= $rowpm->totpm - $rowpm->totpmreal;
				   if ($total < 0){
                    	$x1="("; $total=$total*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                   
                    $per3   = ($total!=0)?($rowpm->totbreal / $rowpm->totb ) * 100:0; 
                    $persen3= number_format($per3,"2",".",",");
                   
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"40%\"><b>Jumlah Pembiayaan Masuk </b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba12</b></td>
									 <td width=\"15%\" align=\"right\"><b>$coba13</b></td>
									 <td width=\"15%\" align=\"right\"><b>".number_format($total,"2",",",".")."</b></td>
									 <td width=\"5%\" align=\"right\"><b>$persen3</b></td>
									</tr>";
                 }     
                $sql4="SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,SUM(c.real_spj) AS realy FROM ms_rek2 a 
					INNER JOIN trdrka b ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2)))
					LEFT JOIN realisasi_bulan c ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) AND b.kd_skpd=c.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan 
					WHERE LEFT(a.kd_rek2,2)='62'  AND b.kd_skpd='$id' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
					UNION ALL 
					SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,SUM(c.real_spj) AS realy FROM ms_rek3 a 
					INNER JOIN trdrka b ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3)))
					LEFT JOIN realisasi_bulan c ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) AND b.kd_skpd=c.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan 
					WHERE LEFT(a.kd_rek3,2)='62'  AND b.kd_skpd='$id' GROUP BY a.kd_rek3,a.lra, a.nm_rek3 ORDER BY kd_rek";
                 
                 $query4 = $this->db->query($sql4);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query4->result() as $row4)
                {
                    $coba13=$row4->rek;
                    $coba14=$row4->nm_rek;
                    $coba15= number_format($row4->nilai,"2",",",".");
					$coba16= number_format($row4->realy,"2",",",".");
					$coba17= $row4->nilai-$row4->realy;
					
				   if ($coba17 < 0){
                    	$x1="("; $coba17=$coba17*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                   
                    $per3   = ($coba17!=0)?($row4->realy / $row4->nilai ) * 100:0; 
                    $persen3= number_format($per3,"2",".",",");
                   if(strlen($coba13)<=3){
                       $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"><b>$coba13</b></td>                                     
                                     <td width=\"40%\" style=\"border-top:none;border-bottom:none;\"><b>$coba14</b></td>
                                     <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba15</b></td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba16</b></td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>".number_format($coba17,"2",",",".")."</b></td>
									 <td width=\"5%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$persen3</td></tr>";
                   }else{
                       $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\">$coba13</td>                                     
                                     <td width=\"40%\" style=\"border-top:none;border-bottom:none;\">$coba14</td>
                                     <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba15</td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba16</td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">".number_format($coba17,"2",",",".")."</td>
									 <td width=\"5%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$persen3</td></tr>";
                   }
                }
                $sqltpk="SELECT SUM(nilai) AS totpk, sum(real_spj)as totpkreal FROM trdrka a INNER JOIN realisasi_bulan b ON a.kd_rek5=b.kd_rek5 AND a.kd_skpd=b.kd_skpd and a.kd_kegiatan=b.kd_kegiatan WHERE LEFT(a.kd_rek5,2)='62' and a.kd_skpd='$id'";
                 $sqlpk=$this->db->query($sqltpk);
                 foreach ($sqlpk->result() as $rowpk)
                {
                   $coba16=number_format($rowpk->totpk,"2",",",".");
                    $cob4=$rowpk->totpk;
					$cob4x=$rowpk->totpkreal;
					 $coba17=number_format($rowpk->totpkreal,"2",",",".");
                    $total2= $rowpk->totpk - $rowpk->totpkreal;
				   if ($total2 < 0){
                    	$x1="("; $total2=$total2*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                   
                    $per4   = ($total2!=0)?($rowpk->totpkreal / $rowpk->totpk ) * 100:0; 
                    $persen4= number_format($per4,"2",".",",");
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"40%\"><b>Jumlah Pembiayaan Keluar</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba16</b></td>
									 <td width=\"15%\" align=\"right\"><b>$coba17</b></td>
									 <td width=\"15%\" align=\"right\"><b>".number_format($total2,"2",",",".")."</b></td>
									 <td width=\"5%\" align=\"right\"><b>$persen4</b></td>
									</tr>";
                 }  
                  
                  $netto=$cob3-$cob4; 
                  if ($netto < 0){
                	$a1="(";
                	$suplus=$netto*-1;
                	$b1=")";}
                  else {
                	$a1="";
	                $b1="";}
                 $nett=number_format($netto,2,',','.'); 
				 
				 $nettox=$cob3x-$cob4x; 
                  if ($nettox < 0){
                	$aa1="(";
                	$suplusx=$nettox*-1;
                	$bb1=")";}
                  else {
                	$aa1="";
	                $bb1="";}
                 $nettx=number_format($nettox,2,',','.');  

				 $nettoxx=$netto-$nettox; 
                  if ($nettoxx < 0){
                	$aaa1="(";
                	$suplusxx=$nettoxx*-1;
                	$bbb1=")";}
                  else {
                	$aaa1="";
	                $bbb1="";}
                 $nettxx=number_format($nettoxx,2,',','.');
				 
				  $per3   = ($nettoxx!=0)?($netto / $nettox ) * 100:0; 
                  $persen3= number_format($per3,"2",".",",");
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"40%\"><b>Pembiayaan Netto</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$a1$nett$b1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$aa1$nettx$bb1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$aaa1$nettxx$bbb1</b></td>
									 <td width=\"5%\" align=\"right\"><b> $persen3</b></td>
								</tr>";
                    $silpa=($cob1+$cob3)-($cob+$cob4);
                     if ($silpa < 0){
                		$c1="(";
                		$silpa=$silpa*-1;
                		$d1=")";
					}else {
                		$c1="";
						$d1="";
					}
                 $silp=number_format($silpa,2,',','.');  
				 
				 $silpax=($cob2+$cob3x)-($cobx+$cob4x);
                     if ($silpax < 0){
                		$cc1="(";
                		$silpax=$silpax*-1;
                		$dd1=")";
					}else {
                		$cc1="";
						$dd1="";
					}
                 $silpx=number_format($silpax,2,',','.');  

				  $silpaxx=$silpa-$silpax;
                 $silpxx=number_format($silpaxx,2,',','.');
				   $per3   = ($silpaxx!=0)?($silpax / $silpa ) * 100:0; 
                  $persen3= number_format($per3,"2",".",",");
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"40%\"><b>Sisa Lebih Pembiayaan(SILPA)</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$c1$silp$d1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$cc1$silpx$dd1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$c1$silpxx$d1</b></td>
									 <td width=\"5%\" align=\"right\"><b>$persen3</b></td>
								</tr>";
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                                     
                                     <td width=\"40%\">&nbsp;</td>
                                     <td width=\"15%\" align=\"right\">&nbsp;</td>
									 <td width=\"15%\" align=\"right\"><b></b></td>
									 <td width=\"15%\" align=\"right\"><b></b></td>
									 <td width=\"5%\" align=\"right\"><b></b></td>
								</tr>";
        $cRet    .= "</table>";
		   $date=date('Y-m-t');
        $cRet .= "<br><table width=\"100%\" border=\"0\" cellpading = \"8\">
                                <tr>
                                    <td width=\"60%\" align=\"left\">&nbsp;<br>&nbsp;
                                        <br>&nbsp;
                                        &nbsp;<br>
                                        &nbsp;<br>
                                        &nbsp;<br>
                                        &nbsp;	
                                    </td>
                                    <td width=\"40%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($date)."
                                        <p><b>$jabatan</b></p>
                                        <p>&nbsp;</p>
                                        <br><br>
                                        <br><b><u>$namapa</u></b>
                                        <br>$nip</b>
                                    </td>
                                </tr>";
         $cRet .=       " </table>";
        $data['prev']= $cRet;
        $this->template->set('title', 'CETAK PERDA'); 
		$skpdx  = $kd_skpd.' '. $nm_skpd;
        switch($cetak){   
        case 1;
			  $this->tukd_model->_mpdf('',$cRet,15,10,10,'0');
			break;
        case 0;
			$this->template->load('template','anggaran/rka/perda1_skpd',$data);
			break;
        case 2;        
			header("Cache-Control: no-cache, no-store, must-revalidate");
			header("Content-Type: application/vnd.ms-excel");
			header("Content-Disposition: attachment; filename=PERDA.xls");
			$this->load->view('anggaran/rka/perda1_skpd', $data);
        break;
        }           

	 }
/* 
    function cetak_lra($cetak = 1, $lap = 1){
		$skpd=$this->session->userdata('kdskpd');
        if ($lap == 1)
        {
            $tabel = 'realisasi_bulan';
        } else
        {
            $tabel = 'realisasi_bulan';
        }
        //function cetak_lra(){
        $sql41 = "SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM $tabel WHERE left(kd_rek5,1)='4' and kd_skpd='$skpd' ";
        $query41 = $this->db->query($sql41);
        $jmlp = $query41->row();
        $jmlpendapatan = $jmlp->nilai;
        $jmlangpendapatan = $jmlp->anggaran;
        $jmlangpendapatan1 = number_format($jmlp->anggaran, "2", ".", ",");
        $jmlpendapatan1 = number_format($jmlp->nilai, "2", ".", ",");

        $sql51 = "SELECT SUM(anggaran) as angaran,SUM(real_spj)as nilai FROM $tabel WHERE left(kd_rek5,1)='5' and kd_skpd='$skpd'";
        $query51 = $this->db->query($sql51);
        $jmlb = $query51->row();
        $jmlangbelanja = $jmlb->angaran;
        $jmlbelanja = $jmlb->nilai;
        $jmlbelanja1 = number_format($jmlb->nilai, "2", ".", ",");
        $jmlangbelanja1 = number_format($jmlb->angaran, "2", ".", ",");
        $sql523 = "SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM $tabel WHERE left(kd_rek5,3)='523' and kd_skpd='$skpd'";
        $query523 = $this->db->query($sql523);
        $jmlbm = $query523->row();
        $jmlbmbelanja = $jmlbm->nilai;
        $jmlangbmbelanja = $jmlbm->anggaran;
        $jmlbmbelanja1 = number_format($jmlbmbelanja, "2", ".", ",");
        $jmlangbmbelanja1 = number_format($jmlangbmbelanja, "2", ".", ",");
        $sql61 = "SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM $tabel WHERE left(kd_rek5,2)='61' and kd_skpd='$skpd'";
        $query61 = $this->db->query($sql61);
        $jmlpm = $query61->row();
        $jmlpmasuk = $jmlpm->nilai;
        $jmlangpmasuk = $jmlpm->anggaran;
        $sql62 = "SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM $tabel WHERE left(kd_rek5,2)='62' and kd_skpd='$skpd'";
        $query62 = $this->db->query($sql62);
        $jmlpk = $query62->row();
        $jmlpkeluar = $jmlpk->nilai;
        $jmlangpkeluar = $jmlpk->anggaran;
        $surplus = $jmlpendapatan - $jmlbelanja;
        $angsurplus = $jmlangpendapatan - $jmlangbelanja;
        if ($surplus < 0)
        {
            $x = "(";
            $surplus = $surplus * -1;
            $y = ")";
        } else
        {
            $x = "";
            $y = "";
        }
        if ($angsurplus < 0)
        {
            $e = "(";
            $angsurplus = $angsurplus * -1;
            $f = ")";
        } else
        {
            $e = "";
            $f = "";
        }
        $surplus1 = number_format($surplus, "2", ".", ",");
        $angsurplus1 = number_format($angsurplus, "2", ".", ",");
        $biaya_net = $jmlpmasuk - $jmlpkeluar;
        $angbiaya_net = $jmlangpmasuk - $jmlangpkeluar;
        if ($biaya_net < 0)
        {
            $a = "(";
            $biaya_net = $biaya_net * -1;
            $b = ")";
        } else
        {
            $a = "";
            $b = "";
        }
        if ($angbiaya_net < 0)
        {
            $g = "(";
            $angbiaya_net = $angbiaya_net * -1;
            $h = ")";
        } else
        {
            $g = "";
            $h = "";
        }
        $biaya_net1 = number_format($biaya_net, "2", ".", ",");
        $angbiaya_net1 = number_format($angbiaya_net, "2", ".", ",");
        $silpa = ($jmlpendapatan + $jmlpmasuk) - ($jmlbelanja + $jmlpkeluar);
        $angsilpa = ($jmlangpendapatan + $jmlangpmasuk) - ($jmlangbelanja + $jmlangpkeluar);
        if ($silpa < 0)
        {
            $c = "(";
            $silpa = $silpa * -1;
            $d = ")";
        } else
        {
            $c = "";
            $d = "";
        }
        if ($angsilpa < 0)
        {
            $i = "(";
            $angsilpa = $angsilpa * -1;
            $j = ")";
        } else
        {
            $i = "";
            $j = "";
        }
        $silpa1 = number_format($silpa, "2", ".", ",");
        $angsilpa1 = number_format($angsilpa, "2", ".", ",");
        $sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
        $sqlsclient = $this->db->query($sqlsc);
        foreach ($sqlsclient->result() as $rowsc)
        {

            $tgl = $rowsc->tgl_rka;
            $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
            $kab = $rowsc->kab_kota;
            $daerah = $rowsc->daerah;
            $thn = $rowsc->thn_ang;
        }

        $jk = $this->rka_model->combo_skpd();

        $cRet = '';


        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>LAPORAN REALISASI ANGGARAN </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>TAHUN ANGGARAN $thn</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";


        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>ANGGARAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>REALISASI</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>LEBIH</br>(KURANG)</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>   
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
                        </tr>";


        $sql4 = "SELECT IFNULL(a.kode,\" \") as kode,a.seq,a.nor,a.uraian,ifnull(a.kode_1,\"''\") as kode_1,thn_m1 AS lalu FROM map_lra_ppkd_kab a GROUP BY a.nor,a.uraian,a.kode_1 ORDER BY CAST(a.seq AS SIGNED)";


        $query4 = $this->db->query($sql4);
        //$query = $this->skpd_model->getAllc();
        $no = 0;
        foreach ($query4->result() as $row4)
        {
            //$kode=$row4->rek;
            $nama = $row4->uraian;
			
            $real_lalu = number_format($row4->lalu, "2", ".", ",");
            $kod = $row4->kode;
            $n = $row4->kode_1;
            //echo $n;
			$test1='';
			if($n <>''){
				$test=explode(',',$n);
				$test1=strlen($test[0]);
			}
			
			//tambahan desember 15
		if ($n==''){
	$n=0;
	$test1=1;
}
//akhir
            $sql5 = "SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM realisasi_bulan WHERE substr(kd_rek64,1,$test1) IN ($n) and kd_skpd='$skpd'";
            //echo $sql5;
            $query5 = $this->db->query($sql5);
            $trh = $query5->row();
            $nil = $trh->nilai;
            $angnil = $trh->anggaran;

            //$nilai=0;
            //$real_s = $trh->nilai - $row4->lalu ;
            $real_s = $trh->nilai - $trh->anggaran;
            if ($real_s < 0)
            {
                $x1 = "(";
                $real_s = $real_s * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih = number_format($real_s, "2", ".", ",");
            if ($trh->nilai == 0)
            {
                $tmp = 1;
            } else
            {
                $tmp = $trh->nilai;
            }
            $nilai = number_format($trh->nilai, "2", ".", ",");
            $angnilai = number_format($trh->anggaran, "2", ".", ",");
            $per1 = ($real_s != 0) ? ($real_s / $tmp) * 100 : 0;
            $persen1 = number_format($per1);

			if( $angnilai=='' or $angnilai==0){
			$persen1 = '';
			}else{
			$persen1 = ($nil/$angnil)*100;
			$persen1 = number_format($persen1,"1",".",",");

			}
            $no = $no + 1;
            switch ($row4->nor)
            {
                case 1:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kod</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlangpendapatan1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlpendapatan1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                    break;
	             default:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kod</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";

            }


        }

        $cRet .= " </table>";
        $data['prev'] = $cRet;
        $data['sikap'] = 'preview';
        $judul = 'LAPORAN REALISASI ANGGARAN';
        $this->template->set('title', 'CETAK LAPORAN REALISASI ANGGARAN');
        switch ($cetak)
        {
            case 1;
                $this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
                break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }


        //$this->template->load('template','anggaran/rka/perkadaII',$data);
    }
  */
  
  
  
  
  
    function cetak_lra($cetak = 1, $lap = 1){
		$skpd=$this->session->userdata('kdskpd');
        if ($lap == 1)
        {
            $tabel = 'realisasi_bulan';
        } else
        {
            $tabel = 'realisasi_bulan';
        }
        //function cetak_lra(){
        $sql41 = "SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM $tabel WHERE left(kd_rek5,1)='4' and kd_skpd='$skpd' ";
        $query41 = $this->db->query($sql41);
        $jmlp = $query41->row();
        $jmlpendapatan = $jmlp->nilai;
        $jmlangpendapatan = $jmlp->anggaran;
        $jmlangpendapatan1 = number_format($jmlp->anggaran, "2", ".", ",");
        $jmlpendapatan1 = number_format($jmlp->nilai, "2", ".", ",");

        $sql51 = "SELECT SUM(anggaran) as angaran,SUM(real_spj)as nilai FROM $tabel WHERE left(kd_rek5,1)='5' and kd_skpd='$skpd'";
        $query51 = $this->db->query($sql51);
        $jmlb = $query51->row();
        $jmlangbelanja = $jmlb->angaran;
        $jmlbelanja = $jmlb->nilai;
        $jmlbelanja1 = number_format($jmlb->nilai, "2", ".", ",");
        $jmlangbelanja1 = number_format($jmlb->angaran, "2", ".", ",");
        $sql523 = "SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM $tabel WHERE left(kd_rek5,3)='523' and kd_skpd='$skpd'";
        $query523 = $this->db->query($sql523);
        $jmlbm = $query523->row();
        $jmlbmbelanja = $jmlbm->nilai;
        $jmlangbmbelanja = $jmlbm->anggaran;
        $jmlbmbelanja1 = number_format($jmlbmbelanja, "2", ".", ",");
        $jmlangbmbelanja1 = number_format($jmlangbmbelanja, "2", ".", ",");
        $sql61 = "SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM $tabel WHERE left(kd_rek5,2)='61' and kd_skpd='$skpd'";
        $query61 = $this->db->query($sql61);
        $jmlpm = $query61->row();
        $jmlpmasuk = $jmlpm->nilai;
        $jmlangpmasuk = $jmlpm->anggaran;
        $sql62 = "SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM $tabel WHERE left(kd_rek5,2)='62' and kd_skpd='$skpd'";
        $query62 = $this->db->query($sql62);
        $jmlpk = $query62->row();
        $jmlpkeluar = $jmlpk->nilai;
        $jmlangpkeluar = $jmlpk->anggaran;
        $surplus = $jmlpendapatan - $jmlbelanja;
        $angsurplus = $jmlangpendapatan - $jmlangbelanja;
        if ($surplus < 0)
        {
            $x = "(";
            $surplus = $surplus * -1;
            $y = ")";
        } else
        {
            $x = "";
            $y = "";
        }
        if ($angsurplus < 0)
        {
            $e = "(";
            $angsurplus = $angsurplus * -1;
            $f = ")";
        } else
        {
            $e = "";
            $f = "";
        }
        $surplus1 = number_format($surplus, "2", ".", ",");
        $angsurplus1 = number_format($angsurplus, "2", ".", ",");
        $biaya_net = $jmlpmasuk - $jmlpkeluar;
        $angbiaya_net = $jmlangpmasuk - $jmlangpkeluar;
        if ($biaya_net < 0)
        {
            $a = "(";
            $biaya_net = $biaya_net * -1;
            $b = ")";
        } else
        {
            $a = "";
            $b = "";
        }
        if ($angbiaya_net < 0)
        {
            $g = "(";
            $angbiaya_net = $angbiaya_net * -1;
            $h = ")";
        } else
        {
            $g = "";
            $h = "";
        }
        $biaya_net1 = number_format($biaya_net, "2", ".", ",");
        $angbiaya_net1 = number_format($angbiaya_net, "2", ".", ",");
        $silpa = ($jmlpendapatan + $jmlpmasuk) - ($jmlbelanja + $jmlpkeluar);
        $angsilpa = ($jmlangpendapatan + $jmlangpmasuk) - ($jmlangbelanja + $jmlangpkeluar);
        if ($silpa < 0)
        {
            $c = "(";
            $silpa = $silpa * -1;
            $d = ")";
        } else
        {
            $c = "";
            $d = "";
        }
        if ($angsilpa < 0)
        {
            $i = "(";
            $angsilpa = $angsilpa * -1;
            $j = ")";
        } else
        {
            $i = "";
            $j = "";
        }
        $silpa1 = number_format($silpa, "2", ".", ",");
        $angsilpa1 = number_format($angsilpa, "2", ".", ",");
        $sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
        $sqlsclient = $this->db->query($sqlsc);
        foreach ($sqlsclient->result() as $rowsc)
        {

            $tgl = $rowsc->tgl_rka;
            $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
            $kab = $rowsc->kab_kota;
            $daerah = $rowsc->daerah;
            $thn = $rowsc->thn_ang;
        }

        $jk = $this->rka_model->combo_skpd();

        $cRet = '';


        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH $kab</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>PPKD</strong></td>                         
                    </tr>
                    <tr>
                        <td align=\"center\"><strong>LAPORAN REALISASI ANGGARAN PENDAPATAN DAN BELANJA</strong></td>
                    </tr>
                      <tr>
                        <td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN</strong></td>
                    </tr>                       
                    <tr>
                         <td align=\"center\"><strong>31 DESEMBER 2015 dan 2014 </strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";


        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"2%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>ANGGARAN 2015</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>REALISASI 2015</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>   
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>REALISASI 2014</b></td>
                        </tr>
                        
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td> 
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"2%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
                              <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                        </tr>";


        $sql4 = "SELECT IFNULL(a.kode,\" \") as kode,a.seq,a.nor,a.uraian,ifnull(a.kode_1,\"''\") as kode_1,thn_m1 AS lalu FROM map_lra_ppkd_kab a GROUP BY a.nor,a.uraian,a.kode_1 ORDER BY CAST(seq AS SIGNED)";


        $query4 = $this->db->query($sql4);
        //$query = $this->skpd_model->getAllc();
        $no = 0;
        foreach ($query4->result() as $row4)
        {
            //$kode=$row4->rek;
            $nama = $row4->uraian;
			
            $real_lalu = number_format($row4->lalu, "2", ".", ",");
            $kod = $row4->kode;
            $n = $row4->kode_1;
            //echo $n;







			$test1='';
			if($n <>''){
				$test=explode(',',$n);
				$test1=strlen($test[0]);
			}

			if ($n==''){
	$n='0';
	$test1=1;
}

            $sql5 = "SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM realisasi_bulan WHERE substr(kd_rek64,1,$test1) IN ($n) and kd_skpd='$skpd'";
            //echo $sql5;
            $query5 = $this->db->query($sql5);
            $trh = $query5->row();
            $nil = $trh->nilai;
            $angnil = $trh->anggaran;

            //$nilai=0;
            //$real_s = $trh->nilai - $row4->lalu ;
            $real_s = $trh->nilai - $trh->anggaran;
            if ($real_s < 0)
            {
                $x1 = "(";
                $real_s = $real_s * -1;
                $y1 = ")";
            } else
            {
                $x1 = "";
                $y1 = "";
            }
            $selisih = number_format($real_s, "2", ".", ",");
            if ($trh->nilai == 0)
            {
                $tmp = 1;
            } else
            {
                $tmp = $trh->nilai;
            }
            $nilai = number_format($trh->nilai, "2", ".", ",");
            $angnilai = number_format($trh->anggaran, "2", ".", ",");
            $per1 = ($real_s != 0) ? ($real_s / $tmp) * 100 : 0;
            $persen1 = number_format($per1);

			if( $angnilai=='' or $angnilai==0){
			$persen1 = '';
			}else{
			$persen1 = ($nil/$angnil)*100;
			$persen1 = number_format($persen1,"1",".",",");

			}
            $no = $no + 1;
            switch ($row4->nor)
            {
                case 1:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong>$jmlangpendapatan1</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong>$jmlpendapatan1</strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">0.00</td>
                                 </tr>";
                    break;

			   case 2:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                 </tr>";
                    break;
               case 8:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                 </tr>";
                    break;

   case 9:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                 </tr>";
                    break;


   case 16:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                 </tr>";
                    break;

   case 22:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                 </tr>";
                    break;

   case 28:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                 </tr>";
                    break;


   case 35:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                 </tr>";
                    break;

   case 40:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong>$angnilai</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong>$nilai</strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong>$persen1</strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong>0.00</strong></td>
                                 </tr>";
                    break;

   case 42:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                 </tr>";
                    break;


   case 43:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                 </tr>";
                    break;

   case 50:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                 </tr>";
                    break;

   case 53:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong>$angnilai</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong>$nilai</strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong>$persen1</strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong>0.00</strong></td>
                                 </tr>";
                    break;


   case 55:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                 </tr>";
                    break;

   case 56:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                 </tr>";
                    break;

   case 62:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                 </tr>";
                    break;
 case 67:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong>$angnilai</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong>$nilai</strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong>$persen1</strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong>0.00</strong></td>
                                 </tr>";
                    break;


//jumlah belanja dan transfer
   case 68:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong>$angnilai</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong>$nilai</strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong>$persen1</strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong>0.00</strong></td>
                                 </tr>";
                    break;
	
   case 70:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong>$e$angsurplus1$f</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong>$x$surplus1$y</strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                 </tr>";
                    break;


   case 72:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                 </tr>";
                    break;

   case 74:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                 </tr>";
                    break;

   case 89:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                 </tr>";
                    break;

   case 103:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong></strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                 </tr>";
                    break;

   case 105:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" ><strong>$nama</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong>$i$angsilpa1$j</strong></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\"><strong>$c$silpa1$d</strong></td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><strong></strong></td>
                                 </tr>";
                    break;
















	             default:
                    $cRet .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" >$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\">$angnilai</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"right\">$nilai</td>
                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$persen1</td>
                                       <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">0.00</td>
                                 </tr>";

            }


        }

        $cRet .= " </table>";
        $data['prev'] = $cRet;
        $data['sikap'] = 'preview';
        $judul = 'LAPORAN REALISASI ANGGARAN';
        $this->template->set('title', 'CETAK LAPORAN REALISASI ANGGARAN');
        switch ($cetak)
        {
            case 1;
                $this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
                break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }


        //$this->template->load('template','anggaran/rka/perkadaII',$data);
    }




  function ctk_lra_lo_ppkd($pilih=1){
     	$cetak='1'; 
        //$id        = $this->session->userdata('kdskpd');
        $id='1.20.05.01';
        $thn_ang   = $this->session->userdata('pcThang');
        $bul       = $_REQUEST['tgl1'];
        $bulan     = $this->tukd_model->getBulan($bul); 
        $tgl_ttd   = $_REQUEST['tgl_ttd'];       
        $thn_ang_1 = $thn_ang-1;
        $reallalu  = number_format(0,"2",".",",");  
	$cetak = $this->uri->segment(3);
		
		
		
       $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk 
                    FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 


$sql84="SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(a.kd_rek5,1)='84' AND b.kd_skpd='$id' and YEAR(tgl_voucher)='$thn_ang'";
                    $query84   = $this->db->query($sql84);
                    $jmlp84    = $query84->row();
                    $jmlpend84 = $jmlp84->nilai;               

$sql93="SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(kd_rek5,3) IN ('931','932','933')  AND b.kd_skpd='$id' and YEAR(tgl_voucher)='$thn_ang'";                                            
                    $query93   = $this->db->query($sql93);
                    $jmlb93    = $query93->row();
                    $jmlbel93  = $jmlb93->nilai;
        $surplus8493 =  ($jmlpend84-$jmlbel93);
//thn lalu



$sql84lalu="SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd_lalu a INNER JOIN trhju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE LEFT(a.kd_rek5,1)='84' AND b.kd_skpd='$id' and tgl_voucher='2015-12-31'";
                    $query84lalu   = $this->db->query($sql84lalu);
                    $jmlp84lalu    = $query84lalu->row();
                    $jmlpend84lalu = $jmlp84lalu->nilai;               

$sql93lalu="SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd_lalu a INNER JOIN trhju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE LEFT(kd_rek5,3) IN ('931','932','933')  AND b.kd_skpd='$id' and tgl_voucher='2015-12-31'";                                            
                    $query93lalu   = $this->db->query($sql93lalu);
                    $jmlb93lalu    = $query93lalu->row();
                    $jmlbel93  = $jmlb93lalu->nilai;
        $surplus8493lalu =  ($jmlpend84lalu-$jmlbel93);

 
 
//akhir===============================================================================================================================================




            
        $sql851="SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(a.kd_rek5,3)='851' AND b.kd_skpd='$id' and YEAR(tgl_voucher)='$thn_ang'";
                    $query851   = $this->db->query($sql851);
                    $jmlp851    = $query851->row();
                    $jmlpend851 = $jmlp851->nilai;               

       $sql941="SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(kd_rek5,3) IN ('941')  AND b.kd_skpd='$id' and YEAR(tgl_voucher)='$thn_ang'";                                            
                    $query941   = $this->db->query($sql941);
                    $jmlb941    = $query941->row();
                    $jmlbel941  = $jmlb941->nilai;
                
        $surplus89 =  $jmlpend851-$jmlbel941;

 //awal===============================================================================================================================================

    $sql851lalu="SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd_lalu a INNER JOIN trhju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE LEFT(a.kd_rek5,3)='851' AND b.kd_skpd='$id' and tgl_voucher='2015-12-31'";
                    $query851lalu   = $this->db->query($sql851lalu);
                    $jmlp851lalu    = $query851lalu->row();
                    $jmlpend851lalu = $jmlp851lalu->nilai;               

       $sql941lalu="SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd_lalu a INNER JOIN trhju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE LEFT(kd_rek5,3) IN ('941')  AND b.kd_skpd='$id' and tgl_voucher='2015-12-31'";                                            
                    $query941lalu   = $this->db->query($sql941lalu);
                    $jmlb941lalu    = $query941lalu->row();
                    $jmlbel941lalu  = $jmlb941lalu->nilai;
                
        $surplus89lalu =  $jmlpend851lalu-$jmlbel941lalu;
    

//akhir===============================================================================================================================================


        
        $sql81="SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(kd_rek5,2) IN ('81','82','83') AND b.kd_skpd='$id' and YEAR(tgl_voucher)='$thn_ang'";
                    $query81   = $this->db->query($sql81);
                    $jmlp81    = $query81->row();
                    $jmlpend81 = $jmlp81->nilai;               

       $sql91="SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' and LEFT(kd_rek5,2) IN ('91','92')  AND b.kd_skpd='$id' and YEAR(tgl_voucher)='$thn_ang'";                                            
                    $query91   = $this->db->query($sql91);
                    $jmlb91    = $query91->row();
                    $jmlbel91  = $jmlb91->nilai;
                
        $surplus89a =  ($jmlpend81-$jmlbel91);
  



//awal===============================================================================================================================================
        $sql81lalu="SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd_lalu a INNER JOIN trhju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE  LEFT(kd_rek5,2) IN ('81','82','83') AND b.kd_skpd='$id' and tgl_voucher='2015-12-31'";
                    $query81lalu   = $this->db->query($sql81lalu);
                    $jmlp81lalu    = $query81lalu->row();
                    $jmlpend81lalu = $jmlp81lalu->nilai;               

       $sql91lalu="SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd_lalu a INNER JOIN trhju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE  LEFT(kd_rek5,2) IN ('91','92') AND left(kd_rek5,3) not in ('912','913') AND b.kd_skpd='$id' and tgl_voucher='2015-12-31'";                                            
                    $query91lalu   = $this->db->query($sql91lalu);
                    $jmlb91lalu    = $query91lalu->row();
                    $jmlbel91lalu  = $jmlb91lalu->nilai;
                
        $surplus89alalu =  ($jmlpend81lalu-$jmlbel91lalu);
     

//akhir===============================================================================================================================================
        
        $surplus89aa =  $surplus8493+$surplus89a;
       

//awal===============================================================================================================================================
        
        $surplus89aalalu =  $surplus8493lalu+$surplus89alalu;
      


//akhir===============================================================================================================================================


                       
        $surplus =  $surplus89aa+$surplus89;
     
        
//awal===============================================================================================================================================
                     
        $surpluslalu =  $surplus89aalalu+$surplus89lalu;
     
   //akhir===============================================================================================================================================
           
                      
       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
        
        $cRet='';
        $lastmoth=$thn.'-'.$bul.'-'.'01';
		$lastyear=date('Y-m-t',strtotime($lastmoth)); 
		$str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));
        
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH $kab</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>PPKD</strong></td>                         
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>LAPORAN OPERASIONAL </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK PERIODE YANG BERAKHIR SAMPAI DENGAN<br> $str</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"45%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>$thn_ang_1</b></td>
                         <td bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>Kenaikan (Penurunan)</b></td>


                            <td  bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\" ><b>%</b></td>   
                        </tr>  
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                             <td style=\"border-top: none;\"></td>
                             <td style=\"border-top: none;\"></td>
                             <td style=\"border-top: none;\"></td>
                 
                           
                                            
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" >&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" >&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" >&nbsp;</td>
                              <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" >&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" >&nbsp;</td>
                          
                        </tr>";

                 $sql4="SELECT IFNULL(a.kode,'')AS kode,a.seq AS seq,a.nor,a.uraian AS uraian ,IFNULL(a.kode_1,\"''\") as kode_1,kre_deb as kre
                                FROM map_lo_ppkd_kab a GROUP BY a.nor,a.uraian,a.kode_1 ORDER BY a.nor";
                 $query4 = $this->db->query($sql4);
                $no=0;                                  
                foreach ($query4->result() as $row4)
                {
                    $kode   = $row4->kode;
                    $nama   = $row4->uraian;   
                    $n      = $row4->kode_1;
                    $nor    = $row4->nor;
                     $kre    = $row4->kre;
					  $seqi    = $row4->seq;
                    	$seq=$row4->seq;
                    $test1 = '';
					if($n <> ''){
						$test  = explode(',',$n);
						$test1 = strlen($test[0]);
					}
                    
                   if($row4->kre=='K'){

	                  $sql5="SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                   WHERE MONTH(b.tgl_voucher)<='$bul' AND  substr(kd_rek5,1,$test1) IN (".$n.") AND a.kd_skpd='$id'  AND YEAR(tgl_voucher)='2016'";
                   	                  $sql5lalu="SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd_lalu a INNER JOIN trhju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                   WHERE   substr(kd_rek5,1,$test1) IN (".$n.") AND a.kd_skpd='$id'   and tgl_voucher='2015-12-31'";
                    }else{
                                                                                   
	                $sql5="SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                   WHERE MONTH(b.tgl_voucher)<='$bul' AND substr(kd_rek5,1,$test1) IN (".$n.") AND a.kd_skpd='$id' AND YEAR(tgl_voucher)='2016'";
                      $sql5lalu="SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd_lalu a INNER JOIN trhju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                   WHERE  substr(kd_rek5,1,$test1) IN (".$n.") AND a.kd_skpd='$id'  and tgl_voucher='2015-12-31'";  
                    }    
                    
                    $query5 = $this->db->query($sql5);
                    $trh    = $query5->row();
                    $nil    = $trh->nilai;
                    $nilai  = number_format($trh->nilai,"2",".",",");

				

  $query5lalu = $this->db->query($sql5lalu);
                    $trhlalu    = $query5lalu->row();
                    $nillalu    = $trhlalu->nilai;
                    $nilailalu  = number_format($trhlalu->nilai,"2",".",",");



                    $real_s = $nil-$nillalu ;
                  $selisih =  $this->angka($real_s);

if($nil==0 && $nillalu<>0){

	$per1=100.00;
}else if ($nillalu==0 && $nil<>0){

	$per1=100.00;
}else{
   $per1   = ($real_s!=0)?($real_s / $nillalu ) * 100:0;
}

if($per1<0){
	$per1=$per1*-1;
}


                    if($per1<0){
 $per1= $per1* -1;
                    }
                    $persen1= number_format($per1,2);
                    $no=$no+1;
                    
                        
                    $surp = $surplus-$surpluslalu ;
                        $surp1 = number_format($surp,"2",".",",");
                    


if($surplus==0 && $surpluslalu<>0){

	$per4=100.00;
}else if ($surpluslalu==0 && $surplus<>0){

	$per4=100.00;
}else{
   $per4   = ($surp!=0)?($surp / $surpluslalu ) * 100:0;
}

if($per4<0){
	$per4=$per4*-1;
}


                        $persen4= number_format($per4,2);
                    
                    $tpad=$trh->nilai-$nillalu;
                    $totpad=number_format($tpad,"2",".",",");
                    

                    



if($trh->nilai==0 && $nillalu<>0){

	$perp=100.00;
}else if ($nillalu==0 && $trh->nilai<>0){

	$perp=100.00;
}else{
   $perp   = ($tpad!=0)?($tpad / $nillalu ) * 100:0;
}

if($perp<0){
	$perp=$perp*-1;
}


                        $persenp= number_format($perp,2);
                        
                    $tsur=$surplus89a-$surplus89alalu;
                    $totsur=number_format($tsur,"2",".",",");
if($surplus89a==0 && $surplus89alalu<>0){

	$persu=100.00;
}else if ($surplus89alalu==0 && $surplus89a<>0){

	$persu=100.00;
}else{
   $persu   = ($tsur!=0)?($tsur / $surplus89alalu ) * 100:0;
}

if($persu<0){
	$persu=$persu*-1;
}

$persensu= number_format($persu,2);
                        
                    $tsur8493=$surplus8493-$surplus8493lalu;
                    $totsur8493=number_format($tsur8493,"2",".",",");
            

if($surplus8493==0 && $surplus8493lalu<>0){

	$persu8493=100.00;
}else if ($surplus8493lalu==0 && $surplus8493<>0){

	$persu8493=100.00;
}else{
   $persu8493   = ($tsur8493!=0)?($tsur8493 / $surplus8493lalu ) * 100:0;
}

if($persu8493<0){
	$persu8493=$persu8493*-1;
}


                     $persensu8493= number_format($persu8493,2);
                        
                    $tsur89=$surplus89aa-$surplus89aalalu;
                    $totsur89=number_format($tsur89,"2",".",",");
                  


if($surplus89aa==0 && $surplus89aalalu<>0){

	$persu89=100.00;
}else if ($surplus89aalalu==0 && $surplus89aa<>0){

	$persu89=100.00;
}else{
   $persu89   = ($tsur89!=0)?($tsur89 / $surplus89aalalu ) * 100:0;
}

if($persu89<0){
	$persu89=$persu89*-1;
}

          $persensu89= number_format($persu89,2);
                        
                     $tsurp89=$surplus89-$surplus89lalu;
                    $totsurp89=number_format($tsurp89,"2",".",",");
              

if($surplus89==0 && $surplus89lalu<>0){

	$persurp89=100.00;
}else if ($surplus89lalu==0 && $surplus89<>0){

	$persurp89=100.00;
}else{
   $persurp89   = ($tsurp89!=0)?($tsurp89 / $surplus89lalu ) * 100:0;
}

if($persurp89<0){
	$persurp89=$persurp89*-1;
}


			

                      
                        $persensup89= number_format($persurp89,2);
                        
                    $tsurp=$surplus-$surpluslalu;
                    $totsurp=number_format($tsurp,"2",".",",");
        


if($surplus==0 && $surpluslalu<>0){

	$persurp=100.00;
}else if ($surpluslalu==0 && $surplus<>0){

	$persurp=100.00;
}else{
   $persurp   = ($tsurp!=0)?($tsurp / $surpluslalu ) * 100:0;
}

if($persurp<0){
	$persurp=$persurp*-1;
}


		

                        $persensup= number_format($persurp,2);
                    
                        
                    switch ($seq) {
              case ($seq==5||$seq==10||$seq==45||$seq==50||$seq==85||$seq==110||$seq==127||$seq==140||$seq==170||$seq==175||$seq==230||$seq==285
              	||$seq==290||$seq==320||$seq==365||$seq==370||$seq==390):         
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                        <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
					
                  case ($seq==35||$seq==75||$seq==100||$seq==125||$seq==128||$seq==130||$seq==155||$seq==160||$seq==220||$seq==260||$seq==265||$seq==310
              	||$seq==340||$seq==380||$seq==400):  
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilai</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilailalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$selisih</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persenp</b></td>
                                    </tr>";
                        break;
              
				                       
					
				
			
                    
					 case 275:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus89a)."</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus89alalu)."</b></td>
                           <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus89a-$surplus89alalu)."</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persensu</b></td>
                                    </tr>";
                        break; 
				
				
				
					 case 345:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> ".$this->angka($surplus8493)."</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus8493lalu)."</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus8493-$surplus8493lalu)."</b></td>
                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persensu8493</b></td>
                                    </tr>";
                        break; 
					 case 355:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus89aa)."</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus89aalalu)."</b></td>
 									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus89aa-$surplus89aalalu)."</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persensu89</b></td>
                                    </tr>";
                        break; 
			
					
					 case 405:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus89)."</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus89lalu)."</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus89-$surplus89lalu)."</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persensup89</b></td>
                                    </tr>";
                        break;  
					 case 415:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus)."</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surpluslalu)."</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus-$surpluslalu)."</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persensup</b></td>
                                    </tr>";
                        break;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                					 
                    default:
					if($nama<>''){
                    $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nilailalu</td>
                                 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$selisih</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$persen1</td>
                                 </tr>";
					}else{
					 $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";	
					
					}

                }         
                    
                }
               $cRet .=       " </table>";
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id' and kode='PPK'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">$jabatan</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>$nip</b></td>
                        </tr>

                    </table>"; 

           
			 
			  $data['prev']= $cRet;    
        //$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
        switch($cetak) {        
        case 1;
             $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename=lo.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        }
        }


   function _mpdftn2($judul='',$isi='',$lMargin='',$rMargin='',$top='',$orientasi='',$init='',$hal='') {
        
        ini_set("memory_limit","-1");
        $this->load->library('mpdf');

        $this->mpdf->defaultheaderfontsize = 6; /* in pts */
        $this->mpdf->defaultheaderfontstyle = BI;   /* blank, B, I, or BI */
        $this->mpdf->defaultheaderline = 1;     /* 1 to include line below header/above footer */
        
        $this->mpdf->defaultfooterfontsize = 7; /* in pts */
        $this->mpdf->defaultfooterfontstyle = I;    /* blank, B, I, or BI */
        $this->mpdf->defaultfooterline = 1; 
        //$hal='';
        $bMargin='';
        //$kertas='A4';
        $this->mpdf->SetBottomMargin('12');
        $this->mpdf->SetFooter(''.$init.' || Halaman  : {PAGENO}| ');

        $this->mpdf->AddPage($orientasi,'',$hal,'1','off',$lMargin,$rMargin,$top,$bMargin);
        if (!empty($judul)) $this->mpdf->writeHTML($judul);
        $this->mpdf->writeHTML($isi);         
        $this->mpdf->Output(); 

                
    }



		function ctk_lra_lo_pemda($pilih=1){
        $cetak='2'; 
        $id        = $this->session->userdata('kdskpd');
        $thn_ang   = $this->session->userdata('pcThang');
        $bul       = $_REQUEST['tgl1'];
        $bulan     = $this->tukd_model->getBulan($bul); 
        $tgl_ttd   = $_REQUEST['tgl_ttd'];       
        $thn_ang_1 = $thn_ang-1;
        $reallalu  = number_format(0,"2",".",",");  

       $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk 
                    FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
 
         $sql84="SELECT SUM(kredit)-SUM(debet) AS nilai FROM trdju_pkd WHERE LEFT(kd_rek5,2) IN ('84') 
	               AND no_voucher+kd_skpd IN(SELECT no_voucher+kd_skpd FROM trhju_pkd WHERE MONTH(tgl_voucher)<='$bul')";
                    $query84   = $this->db->query($sql84);
                    $jmlp84    = $query84->row();
                    $jmlpend84 = $jmlp84->nilai;               

        $sql93="SELECT SUM(debet)-SUM(kredit) AS nilai FROM trdju_pkd WHERE LEFT(kd_rek5,3) IN ('941') 
	               AND no_voucher+kd_skpd IN(SELECT no_voucher+kd_skpd FROM trhju_pkd WHERE MONTH(tgl_voucher)<='$bul')";                                            
                    $query93   = $this->db->query($sql93);
                    $jmlb93    = $query93->row();
                    $jmlbel93  = $jmlb93->nilai;
                
        $surplus8493 =  $jmlpend84-$jmlbel93;
        if ($surplus8493 < 0){
                    	$x="("; 
                        $surplus8493=$surplus8493*-1; 
                        $y=")";
                        }else {
                    	$x="";
                        $surplus8493=$surplus8493*1; 
                        $y="";
                        }
        $surplus8493a = number_format($surplus8493,"2",".",",");
            
        $sql851="SELECT SUM(kredit)-SUM(debet) AS nilai FROM trdju_pkd WHERE LEFT(kd_rek5,3) IN ('851') 
	               AND no_voucher+kd_skpd IN(SELECT no_voucher+kd_skpd FROM trhju_pkd WHERE MONTH(tgl_voucher)<='$bul')";
                    $query851   = $this->db->query($sql851);
                    $jmlp851    = $query851->row();
                    $jmlpend851 = $jmlp851->nilai;               

       $sql941="SELECT SUM(debet)-SUM(kredit) AS nilai FROM trdju_pkd WHERE LEFT(kd_rek5,3) IN ('941') 
	               AND no_voucher+kd_skpd IN(SELECT no_voucher+kd_skpd FROM trhju_pkd WHERE MONTH(tgl_voucher)<='$bul')";                                            
                    $query941   = $this->db->query($sql941);
                    $jmlb941    = $query941->row();
                    $jmlbel941  = $jmlb941->nilai;
                
        $surplus89 =  $jmlpend851-$jmlbel941;
        if ($surplus89 < 0){
                    	$x="("; 
                        $surplus89=$surplus89*-1; 
                        $y=")";
                        }else {
                    	$x="";
                        $surplus89=$surplus89*1; 
                        $y="";
                        }
        $surplus891 = number_format($surplus89,"2",".",",");
        
        $sql81="SELECT SUM(kredit)-SUM(debet) AS nilai FROM trdju_pkd WHERE LEFT(kd_rek5,2) IN ('81','82','83') 
	               AND no_voucher+kd_skpd IN(SELECT no_voucher+kd_skpd FROM trhju_pkd WHERE MONTH(tgl_voucher)<='$bul')";
                    $query81   = $this->db->query($sql81);
                    $jmlp81    = $query81->row();
                    $jmlpend81 = $jmlp81->nilai;               

       $sql91="SELECT SUM(debet)-SUM(kredit) AS nilai FROM trdju_pkd WHERE LEFT(kd_rek5,2) IN ('91','92') 
	               AND no_voucher+kd_skpd IN(SELECT no_voucher+kd_skpd FROM trhju_pkd WHERE MONTH(tgl_voucher)<='$bul')";                                            
                    $query91   = $this->db->query($sql91);
                    $jmlb91    = $query91->row();
                    $jmlbel91  = $jmlb91->nilai;
                
        $surplus89a =  $jmlpend81-$jmlbel91;
        if ($surplus89a < 0){
                    	$x="("; 
                        $surplus89a=$surplus89a*-1; 
                        $y=")";
                        }else {
                    	$x="";
                        $surplus89a=$surplus89a*1; 
                        $y="";
                        }
        $surplus891a = number_format($surplus89a,"2",".",",");   
        
        $surplus89aa =  $surplus8493+$surplus89a;
        if ($surplus89aa < 0){
                    	$x="("; 
                        $surplus89aa=$surplus89aa*-1; 
                        $y=")";
                        }else {
                    	$x="";
                        $surplus89aa=$surplus89aa*1; 
                        $y="";
                        }
        $surplus89aa1 = number_format($surplus89aa,"2",".",",");              
                        
        $surplus =  $surplus89aa+$surplus89;
        if ($surplus < 0){
                    	$x="("; 
                        $surplus=$surplus*-1; 
                        $y=")";
                        }else {
                    	$x="";
                        $surplus=$surplus*1; 
                        $y="";
                        }
        $surplus1= number_format($surplus,"2",".",",");
        
        
                      
       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
        
        $cRet='';
        $lastmoth=$thn.'-'.$bul.'-'.'01';
		$lastyear=date('Y-m-t',strtotime($lastmoth)); 
		$str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));
        
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH $kab</strong></td>                         
                    </tr>                  
                    <tr>
                         <td align=\"center\"><strong>LAPORAN OPERASIONAL </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK PERIODE YANG BERAKHIR SAMPAI DENGAN <br>$str dan $thn_ang_1</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"45%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>$thn_ang_1</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>Kenaikan</br>(Penurunan)</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>   
                        </tr>  
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
                        </tr>";

                 $sql4="SELECT IFNULL(a.kode,'')AS kode,a.seq as seq,a.nor,a.uraian as uraian ,ifnull(a.kode_1,\"''\") as kode_1
                                FROM map_lo_kab a GROUP BY a.nor,a.uraian,a.kode_1 ORDER BY a.seq";
                 $query4 = $this->db->query($sql4);
                $no=0;                                  
                foreach ($query4->result() as $row4)
                {
                    $kode   = $row4->kode;
                    $nama   = $row4->uraian;   
                    $n      = $row4->kode_1;
                    $nor    = $row4->nor;
                    
                    $test1 = '';
					if($n <> ''){
						$test  = explode(',',$n);
						$test1 = strlen($test[0]);
					}
                    
                   if($row4->seq<'165'){
                       $sql5="SELECT SUM(kredit)-SUM(debet) AS nilai FROM trdju_pkd WHERE substr(kd_rek5,1,$test1) IN (".$n.") 
	                           AND no_voucher+kd_skpd IN(SELECT no_voucher+kd_skpd FROM trhju_pkd WHERE MONTH(tgl_voucher)<='$bul')";
                    }else{
                       $sql5="SELECT SUM(debet)-SUM(kredit) AS nilai FROM trdju_pkd WHERE substr(kd_rek5,1,$test1) IN (".$n.") 
	                           AND no_voucher+kd_skpd IN(SELECT no_voucher+kd_skpd FROM trhju_pkd WHERE MONTH(tgl_voucher)<='$bul')";                                                                  
                    }    
                    
                    $query5 = $this->db->query($sql5);
                    $trh    = $query5->row();
                    $nil    = $trh->nilai;
                    $nilai  = number_format($trh->nilai,"2",".",",");

                    $real_s = $nil-$reallalu ;
                    
                    if ($real_s < 0){
                    	$x1="("; 
                        $real_s=$real_s*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $real_s=$real_s; 
                        $y1="";}
                        
                    $selisih = number_format($real_s,"2",".",",");
                    if ($trh->nilai==0){
                        $tmp=1;
                    }else{
                        $tmp=$trh->nilai;
                    }
                    
                    $per1   = ($real_s!=0)?($real_s / $tmp ) * 100:0; 
                    $persen1= number_format($per1);
                    $no=$no+1;
                    
                    $surpluslalu = 0;        
                    $surp = $surplus-$surpluslalu ;
                        $surp1 = number_format($surp,"2",".",",");
                        if ($surp==0){
                            $tmp=1;
                        }else{
                            $tmp=$surp;
                        }
                        $per4   = ($surp!=0)?($surp / $tmp ) * 100:0; 
                        $persen4= number_format($per4);
                    
                    $tpad=$trh->nilai-$reallalu;
                    $totpad=number_format($tpad,"2",".",",");
                    if ($tpad==0){
                            $tmp=1;
                        }else{
                            $tmp=$tpad;
                        }
                        $perp   = ($tpad!=0)?($tpad / $trh->nilai ) * 100:0; 
                        $persenp= number_format($perp);
                        
                    $tsur=$surplus89a-$reallalu;
                    $totsur=number_format($tsur,"2",".",",");
                    if ($tsur==0){
                            $tmp=1;
                        }else{
                            $tmp=$tsur;
                        }
                        $persu   = ($tsur!=0)?($tsur / $surplus89a ) * 100:0; 
                        $persensu= number_format($persu);
                        
                    $tsur8493=$surplus8493-$reallalu;
                    $totsur8493=number_format($tsur8493,"2",".",",");
                    if ($tsur8493==0){
                            $tmp=1;
                        }else{
                            $tmp=$tsur8493;
                        }
                        $persu8493   = ($tsur8493!=0)?($tsur8493 / $surplus8493 ) * 100:0; 
                        $persensu8493= number_format($persu8493);
                        
                    $tsur89=$surplus89aa-$reallalu;
                    $totsur89=number_format($tsur89,"2",".",",");
                    if ($tsur89==0){
                            $tmp=1;
                        }else{
                            $tmp=$tsur89;
                        }
                        $persu89   = ($tsur89!=0)?($tsur89 / $surplus89aa ) * 100:0; 
                        $persensu89= number_format($persu89);
                        
                     $tsurp89=$surplus89-$reallalu;
                    $totsurp89=number_format($tsurp89,"2",".",",");
                    if ($tsurp89==0){
                            $tmp=1;
                        }else{
                            $tmp=$tsurp89;
                        }
                        $persurp89   = ($tsurp89!=0)?($tsurp89 / $surplus89 ) * 100:0; 
                        $persensup89= number_format($persurp89);
                        
                    $tsurp=$surplus-$reallalu;
                    $totsurp=number_format($tsurp,"2",".",",");
                    if ($tsurp==0){
                            $tmp=1;
                        }else{
                            $tmp=$tsurp;
                        }
                        $persurp   = ($tsurp!=0)?($tsurp / $surplus ) * 100:0; 
                        $persensup= number_format($persurp);
                    
                        
                    switch ($row4->seq) {
                    case 5:
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
					 case 10:
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break;
                    case 35:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilai</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totpad</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persenp</b></td>
                                    </tr>";
                        break;
                    case 45:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break;
					 case 50:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break;
					 case 75:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilai</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totpad</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persenp</b></td>
                                    </tr>";
                        break;                        
					 case 85:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break;
					 case 100:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilai</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totpad</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persenp</b></td>
                                    </tr>";
                        break;
					 case 110:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break;
					 case 125:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilai</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totpad</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persenp</b></td>
                                    </tr>";
                        break;  
					 case 130:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilai</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totpad</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persenp</b></td>
                                    </tr>";
                        break; 
					 case 140:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break;
					 case 155:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilai</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totpad</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persenp</b></td>
                                    </tr>";
                        break;
					 case 160:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilai</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totpad</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persenp</b></td>
                                    </tr>";
                        break;  
					 case 170:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break;
					 case 175:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break;  
					 case 220:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilai</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totpad</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persenp</b></td>
                                    </tr>";
                        break;
					 case 230:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break; 
					 case 260:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilai</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totpad</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persenp</b></td>
                                    </tr>";
                        break; 
					 case 265:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilai</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totpad</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persenp</b></td>
                                    </tr>";
                        break; 
					 case 275:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$surplus891a$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totsur</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persensu</b></td>
                                    </tr>";
                        break; 
					 case 285:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break; 
					 case 290:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break; 
					 case 310:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilai</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totpad</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persenp</b></td>
                                    </tr>";
                        break;
					 case 320:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break;
					 case 340:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilai</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totpad</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persenp</b></td>
                                    </tr>";
                        break; 
					 case 345:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$surplus8493a$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totsur8493</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persensu8493</b></td>
                                    </tr>";
                        break; 
					 case 355:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$surplus89aa1$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totsur89</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persensu89</b></td>
                                    </tr>";
                        break; 
					 case 365:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break;  
					 case 370:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break;
					 case 380:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilai</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totpad</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persenp</b></td>
                                    </tr>";
                        break; 
					 case 390:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break;
					 case 400:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilai</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totpad</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persenp</b></td>
                                    </tr>";
                        break;  
					 case 405:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$surplus891$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totsurp89</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persensup89</b></td>
                                    </tr>";
                        break;  
					 case 415:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$surplus1$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totsurp</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persensup</b></td>
                                    </tr>";
                        break;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                					 
                    default:
					if($nama<>''){
                    $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$reallalu</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$x1$selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$persen1</td>
                                 </tr>";
					}else{
					 $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";	
					
					}

                }         
                    
                }
               
        
        $cRet .=       " </table>";
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id' and kode='PPK'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">$jabatan</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>$nip</b></td>
                        </tr>

                    </table>"; 

             $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
                 
    }
    
    function lampiran_II(){
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/perda_real_ii', $data);
    }


 function cetak_perdaII_real(){

	$cetak=$this->uri->segment(3);
	$hal = $this->uri->segment(4);
	$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang, no_qanun, tgl_qanun, no_perbup, tgl_perbup, bupati,tgl_ctk_raperda FROM sclient";
	$sqlsclient=$this->db->query($sqlsc);
	foreach ($sqlsclient->result() as $rowsc)
	{

		$tgl     = $rowsc->tgl_rka;
		$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
		$kab     = $rowsc->kab_kota;
		$daerah  = $rowsc->daerah;
		$thn     = $rowsc->thn_ang;

		$bupati     = $rowsc->bupati;
		$no_qanun   = $rowsc->no_qanun;
		$tgl_qanun  = $this->tukd_model->tanggal_format_indonesia($rowsc->tgl_qanun);
		$no_perbup  = $rowsc->no_perbup;
		$tgl_perbup = $rowsc->tgl_perbup;
		$tgl_ctk_raperda=$rowsc->tgl_ctk_raperda;

	} 
		$tgl_qanun='_________________';
	$cRet='';
	/*$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
	<tr>
		<td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
		<td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"10%\"><strong><h5>LAMPIRAN II  :</h6></strong></td>
		<td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>PERATURAN DAERAH</strong></h5></td>
	</tr>
	<tr> 
		<td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>: $no_qanun</h5></td>
	</tr>
	<tr>
		<td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>: $tgl_qanun</h5></td>
	</tr>


</table>
<br>";*/
$cRet .="<table width=\"100%\" align=\"center\" border=\"0\">
                    <tr>
                         <td colspan=\"6\" width=\"80\" align=\"right\" style=\"font-size:10\">LAMPIRAN I.1</td>
                         <td align=\"left\" width=\"5\" style=\"font-size:10\">:</td>
                         <td align=\"left\" style=\"font-size:10\">RANCANGAN PERATURAN DAERAH $kab</td>
                    </tr>
                    <tr>
                         <td colspan=\"6\" width=\"80\" align=\"right\" style=\"font-size:10\">NOMOR</td>
                         <td align=\"left\" width=\"5\" style=\"font-size:10\">:</td>
                         <td align=\"left\" style=\"font-size:10\">$no_qanun</td>
                    </tr>
                    
                    <tr>
                         <td colspan=\"6\" width=\"80\" align=\"right\" style=\"font-size:10\">TANGGAL</td>
                         <td align=\"left\" width=\"5\" style=\"font-size:10\">:</td>
                         <td align=\"left\" style=\"font-size:10\">$tgl_qanun</td>
                    </tr>

                  </table>
				  <br>";
$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
<tr>
	<td colspan=\"6\" align=\"center\"><strong>$kab</strong></td>

</tr>
<tr>
	<td colspan=\"6\" align=\"center\"><strong>RINGKASAN LAPORAN REALISASI ANGGARAN MENURUT URUSAN PEMERINTAHAN DAERAH DAN ORGANISASI </strong></td>
</tr>

<tr>
	<td colspan=\"6\" align=\"center\"><strong>TAHUN ANGGARAN $thn</strong></td>
</tr>

</table><br>";  

$cRet .= "<table style=\"border-collapse:collapse;font-size:14;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
<thead>                       
	<tr><td rowspan=\"3\" bgcolor=\"#CCCCCC\" align=\"center\"><b>KODE</b></td>                            
		<td rowspan=\"3\" bgcolor=\"#CCCCCC\" align=\"center\"><b>URUSAN PEMERINTAH DAERAH</b></td>
		<td colspan=\"4\" bgcolor=\"#CCCCCC\" align=\"center\"><b>PENDAPATAN</b></td>
		<td colspan=\"24\" bgcolor=\"#CCCCCC\" align=\"center\"><b>BELANJA</b></td>
	</tr>
	<tr>
		<td  bgcolor=\"#CCCCCC\" align=\"center\"><b>Anggaran Setelah Perubahan</td>
		<td  bgcolor=\"#CCCCCC\" align=\"center\"><b>Realisasi</td>
		<td  colspan=\"2\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Bertambah/<br>(Berkurang)</td>

		<td colspan=\"11\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Anggaran Setelah Perubahan (Rp)</td>
		<td colspan=\"11\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Realisasi</td>
		<td  colspan=\"2\"  bgcolor=\"#CCCCCC\" align=\"center\"><b>Bertambah/<br>(Berkurang)</td>
	</tr>
	<tr>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\"><b>Rp</td> 
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\"><b>Rp</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\"><b>Rp</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\"><b>%</td>

	
		<td  bgcolor=\"#CCCCCC\" text-rotate=\"-90\" align=\"left\" style=\"border-top:none;vertical-align:top;\"><b>Belanja Pegawai</td>
		<td  bgcolor=\"#CCCCCC\" text-rotate=\"-90\" align=\"left\" style=\"border-top:none;vertical-align:top;\"><b>Belanja Barang Jasa</td>
		<td  bgcolor=\"#CCCCCC\" text-rotate=\"-90\" align=\"left\" style=\"border-top:none;vertical-align:top;\"><b>Belanja Modal</td>
		<td  bgcolor=\"#CCCCCC\" text-rotate=\"-90\" align=\"left\" style=\"border-top:none;vertical-align:top;\"><b>Belanja Bunga</td>
		<td  bgcolor=\"#CCCCCC\" text-rotate=\"-90\" align=\"left\" style=\"border-top:none;vertical-align:top;\"><b>Belanja Subsidi</td>
		<td  bgcolor=\"#CCCCCC\" text-rotate=\"-90\" align=\"left\" style=\"border-top:none;vertical-align:top;\"><b>Belanja Hibah</td>
		<td  bgcolor=\"#CCCCCC\" text-rotate=\"-90\" align=\"left\" style=\"border-top:none;vertical-align:top;\"><b>Belanja Bantuan</td> 
		<td  bgcolor=\"#CCCCCC\" text-rotate=\"-90\" align=\"left\" style=\"border-top:none;vertical-align:top;\"><b>Belanja Bagi Hasil</td>
		<td  bgcolor=\"#CCCCCC\" text-rotate=\"-90\" align=\"left\" style=\"border-top:none;vertical-align:top;\"><b>Bel. Bantuan</td>
		<td  bgcolor=\"#CCCCCC\" text-rotate=\"-90\" align=\"left\" style=\"border-top:none;vertical-align:top;\"><b>Belanja Tidak Terduga</td>
		<td  bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\"><b>Jumlah Belanja</td>
		
		<td  bgcolor=\"#CCCCCC\" text-rotate=\"-90\" align=\"left\" style=\"border-top:none;vertical-align:top;\"><b>Belanja Pegawai</td>
		<td  bgcolor=\"#CCCCCC\" text-rotate=\"-90\" align=\"left\" style=\"border-top:none;vertical-align:top;\"><b>Belanja Barang Jasa</td>
		<td  bgcolor=\"#CCCCCC\" text-rotate=\"-90\" align=\"left\" style=\"border-top:none;vertical-align:top;\"><b>Belanja Modal</td>
		<td  bgcolor=\"#CCCCCC\" text-rotate=\"-90\" align=\"left\" style=\"border-top:none;vertical-align:top;\"><b>Belanja Bunga</td>
		<td  bgcolor=\"#CCCCCC\" text-rotate=\"-90\" align=\"left\" style=\"border-top:none;vertical-align:top;\"><b>Belanja Subsidi</td>
		<td  bgcolor=\"#CCCCCC\" text-rotate=\"-90\" align=\"left\" style=\"border-top:none;vertical-align:top;\"><b>Belanja Hibah</td>
		<td  bgcolor=\"#CCCCCC\" text-rotate=\"-90\" align=\"left\" style=\"border-top:none;vertical-align:top;\"><b>Belanja Bantuan</td> 
		<td  bgcolor=\"#CCCCCC\" text-rotate=\"-90\" align=\"left\" style=\"border-top:none;vertical-align:top;\"><b>Belanja Bagi Hasil</td>
		<td  bgcolor=\"#CCCCCC\" text-rotate=\"-90\" align=\"left\" style=\"border-top:none;vertical-align:top;\"><b>Bel. Bantuan</td>
		<td  bgcolor=\"#CCCCCC\" text-rotate=\"-90\" align=\"left\" style=\"border-top:none;vertical-align:top;\"><b>Belanja Tidak Terduga</td>
		<td  bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\"><b>Jumlah Belanja</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\"><b>Rp</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\"><b>%</td>
	</tr>
	
	<tr>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">1</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">2</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">3</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">4</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">5 (4 - 3)</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">6</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">7</td> 
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">8</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">9</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">10</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">11</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">12</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">13</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">14</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">15</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">16</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">17 (7 + s.d + 16)</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">18</td> 
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">19</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">20</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">21</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">22</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">23</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">24</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">25</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">26</td> 
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">27</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">28 (18 + s.d + 27)</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">29 = 28 - 17</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">30</td>
	</tr>
	
	</thead>
			<tfoot>
              <tr>
              	<td colspan=\"30\" style=\"border:solid 1px white;border-top:solid 1px black;\"></td>
              </tr>
            </tfoot>";
				$sql1="SELECT
						a.kd_urusan1 AS kode,
						a.nm_urusan1 AS nama,'H' as tipe FROM ms_urusan1 a
						GROUP BY  a.kd_urusan1 ,a.nm_urusan1
						UNION 
						SELECT
						a.kd_urusan AS kode,
						a.nm_urusan AS nama,'S' as tipe FROM ms_urusan a 
						GROUP BY  a.kd_urusan ,a.nm_urusan
						UNION
						SELECT
						a.kd_skpd AS kode,
						a.nm_skpd AS nama,'S' as tipe
						FROM ms_skpd a 
						GROUP BY a.kd_skpd,a.nm_skpd
						ORDER BY kode";

				$query = $this->db->query($sql1);


$angpend=0;
$angbpeg=0;
$angbbj=0;
$angbmod=0;
$angbbunga=0;
$angbsubsi=0;
$angbhibah=0;
$angbbantu=0;
$angbbh=0;
$angbbelban=0;
$angbbeltt=0;

$rpend=0;
$rpeg=0;
$rbj=0;
$rbmod=0;
$rbbunga=0;
$rbsubsi=0;
$rbhibah=0;
$rbbantu=0;
$rbbh=0;
$rbelban=0;
$rbeltt=0;

foreach ($query->result() as $row)
{
	$kode=$row->kode;
	$pjgkode = strlen($kode);
	$nama=$row->nama;


	$csqlangpdpt = "select sum(nilai_ubah) as jm from trdrka 
	where left(kd_rek5,1)='4' and left(kd_skpd,$pjgkode) = '$kode'";
	$hslangpdpt = $this->db->query($csqlangpdpt)->row();  

	$csqlangpeg = "select sum(nilai_ubah) as jm from trdrka 
	where left(kd_rek5,3) IN ('511','521') and left(kd_skpd,$pjgkode) = '$kode'";
	$hslangppeg = $this->db->query($csqlangpeg)->row();                  

	$csqlangbj = "select sum(nilai_ubah) as jm from trdrka 
	where left(kd_rek5,3)='522' and left(kd_skpd,$pjgkode) = '$kode'";
	$hslangpbj = $this->db->query($csqlangbj)->row();

	$csqlangbmod = "select sum(nilai_ubah) as jm from trdrka 
	where left(kd_rek5,3)='523' and left(kd_skpd,$pjgkode) = '$kode'";
	$hslangpbmod = $this->db->query($csqlangbmod)->row();

	$csqlangbunga = "select sum(nilai_ubah) as jm from trdrka 
	where left(kd_rek5,3)='512' and left(kd_skpd,$pjgkode) = '$kode'";
	$hslangpbunga = $this->db->query($csqlangbunga)->row();

	$csqlangsubsi = "select sum(nilai_ubah) as jm from trdrka 
	where left(kd_rek5,3)='513' and left(kd_skpd,$pjgkode) = '$kode'";
	$hslangpsubsi = $this->db->query($csqlangsubsi)->row();

	$csqlanghibah = "select sum(nilai_ubah) as jm from trdrka 
	where left(kd_rek5,3)='514' and left(kd_skpd,$pjgkode) = '$kode'";
	$hslangphibah = $this->db->query($csqlanghibah)->row();

	$csqlangbantu = "select sum(nilai_ubah) as jm from trdrka 
	where left(kd_rek5,3)='515' and left(kd_skpd,$pjgkode) = '$kode'";
	$hslangpbantu = $this->db->query($csqlangbantu)->row();

	$csqlangbh = "select sum(nilai_ubah) as jm from trdrka 
	where left(kd_rek5,3)='516' and left(kd_skpd,$pjgkode) = '$kode'";
	$hslangpbh = $this->db->query($csqlangbh)->row();

	$csqlangbelban = "select sum(nilai_ubah) as jm from trdrka 
	where left(kd_rek5,3)='517' and left(kd_skpd,$pjgkode) = '$kode'";
	$hslangpbelban = $this->db->query($csqlangbelban)->row();

	$csqlangbeltt = "select sum(nilai_ubah) as jm from trdrka 
	where left(kd_rek5,3)='518' and left(kd_skpd,$pjgkode) = '$kode'";
	$hslangpbeltt = $this->db->query($csqlangbeltt)->row();



	$csqlpdpt = "SELECT SUM(real1) AS jmreal1 FROM (
		SELECT SUM(nilai) AS real1 FROM tr_terima_ppkd WHERE LEFT(kd_rek5,1)='4' and left(kd_skpd,$pjgkode) = '$kode'
		UNION 
		SELECT SUM(rupiah) AS real1 FROM trdkasin_pkd WHERE LEFT(kd_rek5,1)='4'  and left(kd_skpd,$pjgkode) = '$kode'
		UNION 
		SELECT SUM(nilai) AS real1 FROM tr_terima_blud WHERE LEFT(kd_rek5,1)='4'  and left(kd_skpd,$pjgkode) = '$kode'
		UNION
		SELECT IFNULL(SUM(berkurang)*-1,0) AS real1 FROM raperda  
		WHERE LEFT(kd_rek5,1)='4'  and left(kd_skpd,$pjgkode) = '$kode'
		UNION
		SELECT IFNULL(SUM(bertambah),0) AS real1 FROM raperda  
		WHERE  LEFT(kd_rek5,1)='4'  and left(kd_skpd,$pjgkode) = '$kode')z";
$hslpend = $this->db->query($csqlpdpt)->row();


$csqlrealpeg = "SELECT SUM(real1) AS jmreal1 FROM (
	SELECT SUM(a.nilai) AS real1 FROM trdtransout a LEFT JOIN trhtransout b
	ON a.no_bukti = b.no_bukti WHERE (b.jns_spp = '1' OR b.jns_spp = '2' OR b.jns_spp = '3' OR b.jns_spp = '7'  )
	AND LEFT(a.kd_rek5,3) IN ('511','521') and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION 
	SELECT SUM(a.nilai) AS real1  FROM trdspp a LEFT JOIN 
	trhsp2d b ON a.no_spp = b.no_spp WHERE (b.jns_spp='4' OR b.jns_spp='5' OR b.jns_spp='6' )
	AND  LEFT(a.kd_rek5,3) IN ('511','521') and left(b.kd_skpd,$pjgkode) = '$kode' and no_kas_bud<>''
	UNION 
	SELECT SUM(rupiah)*-1 AS real1 FROM trdkasin_pkd WHERE LEFT(kd_rek5,3) IN ('511','521') 
	and left(kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT SUM(a.nilai) AS real1 FROM trdtransout_blud a LEFT JOIN trhtransout_blud b
	ON a.no_bukti = b.no_bukti WHERE LEFT(a.kd_rek5,3) IN ('511','521') and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(a.nilaid)*-1,0) real1 FROM dkoreksi a 
	INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,3) IN ('511','521') and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(a.nilaik),0) real1 FROM dkoreksi a 
	INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,3) IN ('511','521') and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION                      
	SELECT IFNULL(SUM(berkurang)*-1,0) AS real1 FROM raperda  
	WHERE LEFT(kd_rek5,3) IN ('511','521')  and left(kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(bertambah),0) AS real1 FROM raperda  
	WHERE  LEFT(kd_rek5,3) IN ('511','521')  and left(kd_skpd,$pjgkode) = '$kode') z";

$hslrealpeg = $this->db->query($csqlrealpeg)->row();


$csqlrealbj = "SELECT SUM(real1) AS jmreal1 FROM (
	SELECT SUM(a.nilai) AS real1 FROM trdtransout a LEFT JOIN trhtransout b
	ON a.no_bukti = b.no_bukti WHERE (b.jns_spp = '1' OR b.jns_spp = '2' OR b.jns_spp = '3' OR b.jns_spp = '7')
	AND LEFT(a.kd_rek5,3)='522' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION 
	SELECT SUM(a.nilai) AS real1  FROM trdspp a LEFT JOIN 
	trhsp2d b ON a.no_spp = b.no_spp WHERE (b.jns_spp='4' OR b.jns_spp='5' OR b.jns_spp='6' )
	AND  LEFT(a.kd_rek5,3)='522' and left(b.kd_skpd,$pjgkode) = '$kode' and no_kas_bud<>''
	UNION 
	SELECT SUM(rupiah)*-1 AS real1 FROM trdkasin_pkd WHERE LEFT(kd_rek5,3)='522' 
	and left(kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT SUM(a.nilai) AS real1 FROM trdtransout_blud a LEFT JOIN trhtransout_blud b
	ON a.no_bukti = b.no_bukti WHERE LEFT(a.kd_rek5,3)='522' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(a.nilaid)*-1,0) real1 FROM dkoreksi a 
	INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,3)='522' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(a.nilaik),0) real1 FROM dkoreksi a 
	INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,3)='522' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION                      
	SELECT IFNULL(SUM(berkurang)*-1,0) AS real1 FROM raperda  
	WHERE LEFT(kd_rek5,3)='522'  and left(kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(bertambah),0) AS real1 FROM raperda  
	WHERE  LEFT(kd_rek5,3)='522'  and left(kd_skpd,$pjgkode) = '$kode') z";

$hslrealbj = $this->db->query($csqlrealbj)->row();

$csqlrealmod = "SELECT SUM(real1) AS jmreal1 FROM (
	SELECT SUM(a.nilai) AS real1 FROM trdtransout a LEFT JOIN trhtransout b
	ON a.no_bukti = b.no_bukti WHERE (b.jns_spp = '1' OR b.jns_spp = '2' OR b.jns_spp = '3' OR b.jns_spp = '7')
	AND LEFT(a.kd_rek5,3)='523' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION 
	SELECT SUM(a.nilai) AS real1  FROM trdspp a LEFT JOIN 
	trhsp2d b ON a.no_spp = b.no_spp WHERE (b.jns_spp='4' OR b.jns_spp='5' OR b.jns_spp='6' )
	AND  LEFT(a.kd_rek5,3)='523' and left(b.kd_skpd,$pjgkode) = '$kode' and no_kas_bud<>''
	UNION 
	SELECT SUM(rupiah)*-1 AS real1 FROM trdkasin_pkd WHERE LEFT(kd_rek5,3)='523' 
	and left(kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT SUM(a.nilai) AS real1 FROM trdtransout_blud a LEFT JOIN trhtransout_blud b
	ON a.no_bukti = b.no_bukti WHERE LEFT(a.kd_rek5,3)='523' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(a.nilaid)*-1,0) real1 FROM dkoreksi a 
	INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,3)='523' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(a.nilaik),0) real1 FROM dkoreksi a 
	INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,3)='523' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION                      
	SELECT IFNULL(SUM(berkurang)*-1,0) AS real1 FROM raperda  
	WHERE LEFT(kd_rek5,3)='523'  and left(kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(bertambah),0) AS real1 FROM raperda  
	WHERE  LEFT(kd_rek5,3)='523'  and left(kd_skpd,$pjgkode) = '$kode') z";

$hslrealbmod = $this->db->query($csqlrealmod)->row();  

$csqlrealbunga = "SELECT SUM(real1) AS jmreal1 FROM (
	SELECT SUM(a.nilai) AS real1 FROM trdtransout a LEFT JOIN trhtransout b
	ON a.no_bukti = b.no_bukti WHERE (b.jns_spp = '1' OR b.jns_spp = '2' OR b.jns_spp = '3' OR b.jns_spp = '7')
	AND LEFT(a.kd_rek5,3)='512' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION 
	SELECT SUM(a.nilai) AS real1  FROM trdspp a LEFT JOIN 
	trhsp2d b ON a.no_spp = b.no_spp WHERE (b.jns_spp='4' OR b.jns_spp='5' OR b.jns_spp='6' )
	AND  LEFT(a.kd_rek5,3)='512' and left(b.kd_skpd,$pjgkode) = '$kode' and no_kas_bud<>''
	UNION 
	SELECT SUM(rupiah)*-1 AS real1 FROM trdkasin_pkd WHERE LEFT(kd_rek5,3)='512' 
	and left(kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT SUM(a.nilai) AS real1 FROM trdtransout_blud a LEFT JOIN trhtransout_blud b
	ON a.no_bukti = b.no_bukti WHERE LEFT(a.kd_rek5,3)='512' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(a.nilaid)*-1,0) real1 FROM dkoreksi a 
	INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,3)='512' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(a.nilaik),0) real1 FROM dkoreksi a 
	INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,3)='512' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION                      
	SELECT IFNULL(SUM(berkurang)*-1,0) AS real1 FROM raperda  
	WHERE LEFT(kd_rek5,3)='512'  and left(kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(bertambah),0) AS real1 FROM raperda  
	WHERE  LEFT(kd_rek5,3)='512'  and left(kd_skpd,$pjgkode) = '$kode') z";

$hslrealbbunga = $this->db->query($csqlrealbunga)->row(); 

$csqlrealsubsi = "SELECT SUM(real1) AS jmreal1 FROM (
	SELECT SUM(a.nilai) AS real1 FROM trdtransout a LEFT JOIN trhtransout b
	ON a.no_bukti = b.no_bukti WHERE (b.jns_spp = '1' OR b.jns_spp = '2' OR b.jns_spp = '3' OR b.jns_spp = '7')
	AND LEFT(a.kd_rek5,3)='513' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION 
	SELECT SUM(a.nilai) AS real1  FROM trdspp a LEFT JOIN 
	trhsp2d b ON a.no_spp = b.no_spp WHERE (b.jns_spp='4' OR b.jns_spp='5' OR b.jns_spp='6' )
	AND  LEFT(a.kd_rek5,3)='513' and left(b.kd_skpd,$pjgkode) = '$kode' and no_kas_bud<>''
	UNION 
	SELECT SUM(rupiah)*-1 AS real1 FROM trdkasin_pkd WHERE LEFT(kd_rek5,3)='513' 
	and left(kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT SUM(a.nilai) AS real1 FROM trdtransout_blud a LEFT JOIN trhtransout_blud b
	ON a.no_bukti = b.no_bukti WHERE LEFT(a.kd_rek5,3)='513' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(a.nilaid)*-1,0) real1 FROM dkoreksi a 
	INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,3)='513' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(a.nilaik),0) real1 FROM dkoreksi a 
	INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,3)='513' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION                      
	SELECT IFNULL(SUM(berkurang)*-1,0) AS real1 FROM raperda  
	WHERE LEFT(kd_rek5,3)='513'  and left(kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(bertambah),0) AS real1 FROM raperda  
	WHERE  LEFT(kd_rek5,3)='513'  and left(kd_skpd,$pjgkode) = '$kode') z";

$hslrealbsubsi = $this->db->query($csqlrealsubsi)->row();

$csqlrealhibah = "SELECT SUM(real1) AS jmreal1 FROM (
	SELECT SUM(a.nilai) AS real1 FROM trdtransout a LEFT JOIN trhtransout b
	ON a.no_bukti = b.no_bukti WHERE (b.jns_spp = '1' OR b.jns_spp = '2' OR b.jns_spp = '3' OR b.jns_spp = '7')
	AND LEFT(a.kd_rek5,3)='514' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION 
	SELECT SUM(a.nilai) AS real1  FROM trdspp a LEFT JOIN 
	trhsp2d b ON a.no_spp = b.no_spp WHERE (b.jns_spp='4' OR b.jns_spp='5' OR b.jns_spp='6' )
	AND  LEFT(a.kd_rek5,3)='514' and left(b.kd_skpd,$pjgkode) = '$kode' and no_kas_bud<>''
	UNION 
	SELECT SUM(rupiah)*-1 AS real1 FROM trdkasin_pkd WHERE LEFT(kd_rek5,3)='514' 
	and left(kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT SUM(a.nilai) AS real1 FROM trdtransout_blud a LEFT JOIN trhtransout_blud b
	ON a.no_bukti = b.no_bukti WHERE LEFT(a.kd_rek5,3)='514' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(a.nilaid)*-1,0) real1 FROM dkoreksi a 
	INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,3)='514' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(a.nilaik),0) real1 FROM dkoreksi a 
	INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,3)='514' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION                      
	SELECT IFNULL(SUM(berkurang)*-1,0) AS real1 FROM raperda  
	WHERE LEFT(kd_rek5,3)='514'  and left(kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(bertambah),0) AS real1 FROM raperda  
	WHERE  LEFT(kd_rek5,3)='514'  and left(kd_skpd,$pjgkode) = '$kode') z";

$hslrealbhibah = $this->db->query($csqlrealhibah)->row();

$csqlrealbantu = "SELECT SUM(real1) AS jmreal1 FROM (
	SELECT SUM(a.nilai) AS real1 FROM trdtransout a LEFT JOIN trhtransout b
	ON a.no_bukti = b.no_bukti WHERE (b.jns_spp = '1' OR b.jns_spp = '2' OR b.jns_spp = '3' OR b.jns_spp = '7')
	AND LEFT(a.kd_rek5,3)='515' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION 
	SELECT SUM(a.nilai) AS real1  FROM trdspp a LEFT JOIN 
	trhsp2d b ON a.no_spp = b.no_spp WHERE (b.jns_spp='4' OR b.jns_spp='5' OR b.jns_spp='6' )
	AND  LEFT(a.kd_rek5,3)='515' and left(b.kd_skpd,$pjgkode) = '$kode' and no_kas_bud<>''
	UNION 
	SELECT SUM(rupiah)*-1 AS real1 FROM trdkasin_pkd WHERE LEFT(kd_rek5,3)='515' 
	and left(kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT SUM(a.nilai) AS real1 FROM trdtransout_blud a LEFT JOIN trhtransout_blud b
	ON a.no_bukti = b.no_bukti WHERE LEFT(a.kd_rek5,3)='515' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(a.nilaid)*-1,0) real1 FROM dkoreksi a 
	INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,3)='515' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(a.nilaik),0) real1 FROM dkoreksi a 
	INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,3)='515' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION                      
	SELECT IFNULL(SUM(berkurang)*-1,0) AS real1 FROM raperda  
	WHERE LEFT(kd_rek5,3)='515'  and left(kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(bertambah),0) AS real1 FROM raperda  
	WHERE  LEFT(kd_rek5,3)='515'  and left(kd_skpd,$pjgkode) = '$kode') z";

$hslrealbbantu = $this->db->query($csqlrealbantu)->row();

$csqlrealbh = "SELECT SUM(real1) AS jmreal1 FROM (
	SELECT SUM(a.nilai) AS real1 FROM trdtransout a LEFT JOIN trhtransout b
	ON a.no_bukti = b.no_bukti WHERE (b.jns_spp = '1' OR b.jns_spp = '2' OR b.jns_spp = '3' OR b.jns_spp = '7')
	AND LEFT(a.kd_rek5,3)='516' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION 
	SELECT SUM(a.nilai) AS real1  FROM trdspp a LEFT JOIN 
	trhsp2d b ON a.no_spp = b.no_spp WHERE (b.jns_spp='4' OR b.jns_spp='5' OR b.jns_spp='6' )
	AND  LEFT(a.kd_rek5,3)='516' and left(b.kd_skpd,$pjgkode) = '$kode' and no_kas_bud<>''
	UNION 
	SELECT SUM(rupiah)*-1 AS real1 FROM trdkasin_pkd WHERE LEFT(kd_rek5,3)='516' 
	and left(kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT SUM(a.nilai) AS real1 FROM trdtransout_blud a LEFT JOIN trhtransout_blud b
	ON a.no_bukti = b.no_bukti WHERE LEFT(a.kd_rek5,3)='516' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(a.nilaid)*-1,0) real1 FROM dkoreksi a 
	INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,3)='516' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(a.nilaik),0) real1 FROM dkoreksi a 
	INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,3)='516' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION                      
	SELECT IFNULL(SUM(berkurang)*-1,0) AS real1 FROM raperda  
	WHERE LEFT(kd_rek5,3)='516'  and left(kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(bertambah),0) AS real1 FROM raperda  
	WHERE  LEFT(kd_rek5,3)='516'  and left(kd_skpd,$pjgkode) = '$kode') z";

$hslrealbbh = $this->db->query($csqlrealbh)->row(); 

$csqlrealbelban = "SELECT SUM(real1) AS jmreal1 FROM (
	SELECT SUM(a.nilai) AS real1 FROM trdtransout a LEFT JOIN trhtransout b
	ON a.no_bukti = b.no_bukti WHERE (b.jns_spp = '1' OR b.jns_spp = '2' OR b.jns_spp = '3' OR b.jns_spp = '7')
	AND LEFT(a.kd_rek5,3)='517' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION 
	SELECT SUM(a.nilai) AS real1  FROM trdspp a LEFT JOIN 
	trhsp2d b ON a.no_spp = b.no_spp WHERE (b.jns_spp='4' OR b.jns_spp='5' OR b.jns_spp='6' )
	AND  LEFT(a.kd_rek5,3)='517' and left(b.kd_skpd,$pjgkode) = '$kode' and no_kas_bud<>''
	UNION 
	SELECT SUM(rupiah)*-1 AS real1 FROM trdkasin_pkd WHERE LEFT(kd_rek5,3)='517' 
	and left(kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT SUM(a.nilai) AS real1 FROM trdtransout_blud a LEFT JOIN trhtransout_blud b
	ON a.no_bukti = b.no_bukti WHERE LEFT(a.kd_rek5,3)='517' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(a.nilaid)*-1,0) real1 FROM dkoreksi a 
	INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,3)='517' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(a.nilaik),0) real1 FROM dkoreksi a 
	INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,3)='517' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION                      
	SELECT IFNULL(SUM(berkurang)*-1,0) AS real1 FROM raperda  
	WHERE LEFT(kd_rek5,3)='517'  and left(kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(bertambah),0) AS real1 FROM raperda  
	WHERE  LEFT(kd_rek5,3)='517'  and left(kd_skpd,$pjgkode) = '$kode') z";

$hslrealbelban = $this->db->query($csqlrealbelban)->row(); 

$csqlrealbeltt = "SELECT SUM(real1) AS jmreal1 FROM (
	SELECT SUM(a.nilai) AS real1 FROM trdtransout a LEFT JOIN trhtransout b
	ON a.no_bukti = b.no_bukti WHERE (b.jns_spp = '1' OR b.jns_spp = '2' OR b.jns_spp = '3' OR b.jns_spp = '7')
	AND LEFT(a.kd_rek5,3)='518' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION 
	SELECT SUM(a.nilai) AS real1  FROM trdspp a LEFT JOIN 
	trhsp2d b ON a.no_spp = b.no_spp WHERE (b.jns_spp='4' OR b.jns_spp='5' OR b.jns_spp='6' )
	AND  LEFT(a.kd_rek5,3)='518' and left(b.kd_skpd,$pjgkode) = '$kode' and no_kas_bud<>''
	UNION 
	SELECT SUM(rupiah)*-1 AS real1 FROM trdkasin_pkd WHERE LEFT(kd_rek5,3)='518' 
	and left(kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT SUM(a.nilai) AS real1 FROM trdtransout_blud a LEFT JOIN trhtransout_blud b
	ON a.no_bukti = b.no_bukti WHERE LEFT(a.kd_rek5,3)='518' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(a.nilaid)*-1,0) real1 FROM dkoreksi a 
	INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,3)='518' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(a.nilaik),0) real1 FROM dkoreksi a 
	INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,3)='518' and left(b.kd_skpd,$pjgkode) = '$kode'
	UNION                      
	SELECT IFNULL(SUM(berkurang)*-1,0) AS real1 FROM raperda  
	WHERE LEFT(kd_rek5,3)='518'  and left(kd_skpd,$pjgkode) = '$kode'
	UNION
	SELECT IFNULL(SUM(bertambah),0) AS real1 FROM raperda  
	WHERE  LEFT(kd_rek5,3)='518'  and left(kd_skpd,$pjgkode) = '$kode') z";
$hslrealbeltt = $this->db->query($csqlrealbeltt)->row(); 

$angpdpt = $hslangpdpt->jm;
$angpeg = $hslangppeg->jm;
$angbj = $hslangpbj->jm;
$angmod = $hslangpbmod->jm;
$angbunga = $hslangpbunga->jm;
$angsubsisi = $hslangpsubsi->jm;
$anghibah = $hslangphibah->jm;
$angbantu = $hslangpbantu->jm;
$angbh = $hslangpbh->jm;
$angbelban = $hslangpbelban->jm;
$angbeltt = $hslangpbeltt->jm;



$realpend = $hslpend->jmreal1;
$realpeg = $hslrealpeg->jmreal1;
$realbj = $hslrealbj->jmreal1;
$realmod = $hslrealbmod->jmreal1;
$realbunga = $hslrealbbunga->jmreal1;
$realsubsidi = $hslrealbsubsi->jmreal1;
$realhibah = $hslrealbhibah->jmreal1;
$realbantu = $hslrealbbantu->jmreal1;
$realbh = $hslrealbbh->jmreal1;
$realbelban = $hslrealbelban->jmreal1;
$realbeltt = $hslrealbeltt->jmreal1;

$sisaanggpend=$angpdpt-$realpend;
if($angpdpt <> 0){
								$persendpt   = ($realpend!=0)?($realpend /$angpdpt) * 100:0; 
							}else if($angpdpt <> 0 and $realpend ==0){
								$persendpt=100;
							}else{
								$persendpt=0;
							}

$jmlangg=$angpeg+$angbj+$angmod+$angbunga+$angsubsisi+$anghibah+$angbantu+$angbh+$angbelban+$angbeltt;
$jumreal=$realpeg+$realbj+$realmod+$realbunga+$realsubsidi+$realhibah+$realbantu+$realbh+$realbelban+$realbeltt;
$sisaangg=$jmlangg-$jumreal;
if($jmlangg <> 0){
								$persenangg   = ($jumreal!=0)?($jumreal /$jmlangg) * 100:0; 
							}else if($jmlangg <> 0 and $jumreal ==0){
								$persenangg=100;
							}else{
								$persenangg=0;
							}
if($row->tipe=='H'){
	$angpend=$angpend+$angpdpt;
	$angbpeg=$angbpeg+$angpeg;
	$angbbj=$angbbj+$angbj;
	$angbmod=$angbmod+$angmod;
	$angbbunga=$angbbunga+$angbunga;
	$angbsubsi=$angbsubsi+$angsubsisi;
	$angbhibah=$angbhibah+$anghibah;
	$angbbantu=$angbbantu+$angbantu;
	$angbbh=$angbbh+$angbh;
	$angbbelban=$angbbelban+$angbelban;
	$angbbeltt=$angbbeltt+$angbeltt;

	$rpend=$rpend+$realpend;
	$rpeg=$rpeg+$realpeg;
	$rbj=$rbj+$realbj;
	$rbmod=$rbmod+$realmod;
	$rbbunga=$rbbunga+$realbunga;
	$rbsubsi=$rbsubsi+$realsubsidi;
	$rbhibah=$rbhibah+$realhibah;
	$rbbantu=$rbbantu+$realbantu;
	$rbbh=$rbbh+$realbh;
	$rbelban=$rbelban+$realbelban;
	$rbeltt=$rbeltt+$realbeltt; 

	$sisapenda= $angpend -  $rpend;
	if($angpend <> 0){
								$persenpenda   = ($rpend!=0)?($rpend /$angpend) * 100:0; 
							}else if($angpend <> 0 and $rpend ==0){
								$persenpenda=100;
							}else{
								$persenpenda=0;
							}
	$jumsemuaangg=$angbpeg+$angbbj+$angbmod+$angbbunga+$angbsubsi+$angbhibah+$angbbantu+$angbbh+$angbbelban+$angbbeltt;
	$jumsemuareal=$rpeg+$rbj+$rbmod+$rbbunga+$rbsubsi+$rbhibah+$rbbantu+$rbbh+$rbelban+$rbeltt;
	$sisasemuaang=$jumsemuaangg-$jumsemuareal;

	if($jumsemuaangg <> 0){
								$persenreali   = ($jumsemuareal!=0)?($jumsemuareal /$jumsemuaangg) * 100:0; 
							}else if($jumsemuaangg <> 0 and $jumsemuareal ==0){
								$persenreali=100;
							}else{
								$persenreali=0;
							}
}
if(strlen($kode) <=5){
	$cRet    .= " <tr>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"left\" ><b>$kode</b></td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"left\" ><b>$nama</b></td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($angpdpt)."</b></td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($realpend)."</b></td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($sisaanggpend)."</b></td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($persendpt)."</b></td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;vertical-align:bottom;\" align=\"center\" ><b>".$this->angka($angpeg)."</b></td> 
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;vertical-align:bottom;\" align=\"center\" ><b>".$this->angka($angbj)."</b></td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;vertical-align:bottom;\" align=\"center\" ><b>".$this->angka($angmod)."</b></td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;vertical-align:bottom;\" align=\"center\" ><b>".$this->angka($angbunga)."</b></td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;vertical-align:bottom;\" align=\"center\" ><b>".$this->angka($angsubsisi)."</b></td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;vertical-align:bottom;\" align=\"center\" ><b>".$this->angka($anghibah)."</b></td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;vertical-align:bottom;\" align=\"center\" ><b>".$this->angka($angbantu)."</b></td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;vertical-align:bottom;\" align=\"center\" ><b>".$this->angka($angbh)."</b></td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;vertical-align:bottom;\" align=\"center\" ><b>".$this->angka($angbelban)."</b></td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;vertical-align:bottom;\" align=\"center\" ><b>".$this->angka($angbeltt)."</b></td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($jmlangg)."</b></td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;vertical-align:bottom;\" align=\"center\" ><b>".$this->angka($realpeg)."</b></td> 
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;vertical-align:bottom;\" align=\"center\" ><b>".$this->angka($realbj)."</b></td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;vertical-align:bottom;\" align=\"center\" ><b>".$this->angka($realmod)."</b></td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;vertical-align:bottom;\" align=\"center\" ><b>".$this->angka($realbunga)."</b></td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;vertical-align:bottom;\" align=\"center\" ><b>".$this->angka($realsubsidi)."</b></td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;vertical-align:bottom;\" align=\"center\" ><b>".$this->angka($realhibah)."</b></td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;vertical-align:bottom;\" align=\"center\" ><b>".$this->angka($realbantu)."</b></td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;vertical-align:bottom;\" align=\"center\" ><b>".$this->angka($realbh)."</b></td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;vertical-align:bottom;\" align=\"center\" ><b>".$this->angka($realbelban)."</b></td> 
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;vertical-align:bottom;\" align=\"center\" ><b>".$this->angka($realbeltt)."</b></td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($jumreal)."</b></td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($sisaangg)."</b></td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($persenangg)."</b></td>
		</tr>";
	

	

	
	}else{


	

$cRet    .= " <tr>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"left\" >$kode</td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"left\" >$nama</td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($angpdpt)."</td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($realpend)."</td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($sisaanggpend)."</td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($persendpt)."</td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($angpeg)."</td> 
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($angbj)."</td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($angmod)."</td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($angbunga)."</td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($angsubsisi)."</td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($anghibah)."</td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($angbantu)."</td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($angbh)."</td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($angbelban)."</td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($angbeltt)."</td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($jmlangg)."</td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($realpeg)."</td> 
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($realbj)."</td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($realmod)."</td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($realbunga)."</td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($realsubsidi)."</td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($realhibah)."</td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($realbantu)."</td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($realbh)."</td>
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($realbelban)."</td> 
				<td text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($realbeltt)."</td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($jumreal)."</td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($sisaangg)."</td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" >".$this->angka($persenangg)."</td>
		</tr>";


	
	}


}  

$cRet    .= " <tr>
				<td colspan=\"2\" style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>JUMLAH</b></td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b> ".$this->angka($angpend)."</b></td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($rpend)."</b></td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($sisapenda)."</b></td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($persenpenda)."</b></td>
				<td  text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($angbpeg)."</b></td> 
				<td  text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($angbbj)."</b></td>
				<td  text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($angbmod)."</b></td>
				<td  text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($angbbunga)."</b></td>
				<td  text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($angbsubsi)."</b></td>
				<td  text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($angbhibah)."</b></td>
				<td  text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($angbbantu)."</b></td>
				<td  text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($angbbh)."</b></td>
				<td  text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($angbbelban)."</b></td>
				<td  text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($angbbeltt)."</b></td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($jumsemuaangg)."</b></td>
				<td  text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($rpeg)."</b></td> 
				<td  text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($rbj)."</b></td>
				<td  text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($rbmod)."</b></td>
				<td  text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($rbbunga)."</b></td>
				<td  text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($rbsubsi)."</b></td>
				<td  text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($rbhibah)."</b></td>
				<td  text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($rbbantu)."</b></td>
				<td  text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($rbbh)."</b></td>
				<td  text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($rbelban)."</b></td> 
				<td  text-rotate=\"-90\" style=\"vertical-align:bottom;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($rbeltt)."</b></td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($jumsemuareal)."</b></td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($sisasemuaang)."</b></td>
				<td style=\"vertical-align:middle;border-top: none;border-bottom: solid 1px black;\" align=\"center\" ><b>".$this->angka($persenreali)."</b></td>
		</tr>";




$cRet .=       " </table>";
$date=date('Y-m-t');



$spasi=100;
	$zz=0;
			for($zz=0;$zz <=$spasi;$zz++){
				$cRet .="<br>";
			}









$cRet .= "<table style=\"border-collapse:collapse;font-size:14;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
<thead>                       

	<tr>
		<td rowspan=\"3\"  bgcolor=\"#CCCCCC\" align=\"center\" >Kode</td>
		<td  rowspan=\"3\" bgcolor=\"#CCCCCC\" align=\"center\" >Urusan Pemerintahan Daerah</td>
		<td colspan=\"8\" bgcolor=\"#CCCCCC\" align=\"center\" >Pembiayaan</td>
		
	</tr>
	
	<tr>
	<td colspan=\"2\" bgcolor=\"#CCCCCC\" align=\"center\" >Anggaran Setelah Perubahan(Rp)</td>
	
	<td colspan=\"2\" bgcolor=\"#CCCCCC\" align=\"center\" >Realisasi (Rp)</td>

	<td colspan=\"4\" bgcolor=\"#CCCCCC\" align=\"center\" >Bertambah/(berkurang) (Rp)</td>
	
	</tr>

	<tr>
	<td bgcolor=\"#CCCCCC\" align=\"center\" >Penerimaan</td>
	<td bgcolor=\"#CCCCCC\" align=\"center\" >Pengeluaran</td>
	<td bgcolor=\"#CCCCCC\" align=\"center\" >Penerimaan</td>
	<td bgcolor=\"#CCCCCC\" align=\"center\" >Pengeluaran</td>
	<td bgcolor=\"#CCCCCC\" align=\"center\" >Penerimaan</td>
	<td bgcolor=\"#CCCCCC\" align=\"center\" >%</td>
	<td bgcolor=\"#CCCCCC\" align=\"center\" >Pengeluaran</td>
	<td bgcolor=\"#CCCCCC\" align=\"center\" >%</td>
	</tr>
	
	<tr>
		<td bgcolor=\"#CCCCCC\" align=\"center\" >1</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" >2</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" >3</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" >4</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" >5</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" >6</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" >7</td> 
		<td bgcolor=\"#CCCCCC\" align=\"center\" >8</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" >9</td>
		<td bgcolor=\"#CCCCCC\" align=\"center\" >10</td>
	</tr>
	
	</thead>
			<tfoot>
              <tr>
              	<td colspan=\"10\" style=\"border:solid 1px white;border-top:solid 1px black;\"></td>
              </tr>
            </tfoot>";

$sisa=0;
              $sqlww=$this->db->query("SELECT '1' ID,'URUSAN WAJIB' AS NM,
SUM(CASE WHEN LEFT(KD_SKPD,4)='1.20' AND LEFT(KD_REK5,2)='61' THEN nilai_ubah ELSE 0 END)AS a61,
SUM(CASE WHEN LEFT(KD_SKPD,4)='1.20' AND LEFT(KD_REK5,2)='62' THEN nilai_ubah ELSE 0 END) AS a62
FROM TRDRKA 
UNION ALL
SELECT '1.20' AS ID,'Otonomi Daerah, Pemerintahan Umum, Administrasi Keuangan' AS NM,
SUM(CASE WHEN LEFT(KD_SKPD,4)='1.20' AND LEFT(KD_REK5,2)='61' THEN nilai_ubah ELSE 0 END)AS a61,
SUM(CASE WHEN LEFT(KD_SKPD,4)='1.20' AND LEFT(KD_REK5,2)='62' THEN nilai_ubah ELSE 0 END) AS a62
FROM TRDRKA 
UNION ALL
SELECT KD_SKPD as ID,NM_SKPD AS NM,
SUM(CASE WHEN KD_SKPD='1.20.05.01' AND LEFT(KD_REK5,2)='61' THEN nilai_ubah ELSE 0 END)AS a61,
SUM(CASE WHEN KD_SKPD='1.20.05.01' AND LEFT(KD_REK5,2)='62' THEN nilai_ubah ELSE 0 END) AS a62
FROM TRDRKA where KD_SKPD='1.20.05.01'
");
				foreach($sqlww->result() as $roww){
					$ID=$roww->ID;
					$NM=$roww->NM;
					$a61=$roww->a61;
					$a62=$roww->a62;




  $IDK = strlen($ID);
                    
                   
        $sqldns="SELECT SUM(real1) AS jmreal1 FROM (
SELECT SUM(nilai) AS real1 FROM tr_terima_ppkd WHERE LEFT(kd_rek5,2)='61' AND LEFT(kd_skpd,$IDK) = '$ID'
UNION 
SELECT SUM(a.rupiah) AS real1 FROM trdkasin_pkd a LEFT JOIN trhkasin_pkd b ON a.no_sts = b.no_sts
WHERE LEFT(a.kd_rek5,2)='61' 
AND LEFT(b.kd_skpd,$IDK) = '$ID' 
UNION
SELECT SUM(nilai) AS real1 FROM tr_terima_blud WHERE LEFT(kd_rek5,2)='61' AND LEFT(kd_skpd,$IDK) = '$ID'
UNION
SELECT IFNULL(SUM(berkurang)*-1,0) AS real1 FROM raperda  
WHERE LEFT(kd_rek5,2)='61' AND LEFT(kd_skpd,$IDK)='$ID' 
UNION
SELECT IFNULL(SUM(bertambah),0) AS real1 FROM raperda  
WHERE LEFT(kd_rek5,2)='61'  AND LEFT(kd_skpd,$IDK)='$ID'

)z";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $jmreal1=$rowdns->jmreal1;                    
                }



 $sql62="SELECT SUM(real1) AS jmreal1 FROM (
SELECT SUM(a.nilai) AS real1 FROM trdtransout a LEFT JOIN trhtransout b
ON a.no_bukti = b.no_bukti WHERE (b.jns_spp = '1' OR b.jns_spp = '2' OR b.jns_spp = '3' OR b.jns_spp = '7')
AND LEFT(a.kd_rek5,2)='62' AND LEFT(b.kd_skpd,$IDK)='$ID'                     
UNION 
SELECT SUM(a.nilai) AS real1  FROM trdspp a LEFT JOIN 
trhsp2d b ON a.no_spp = b.no_spp WHERE (b.jns_spp='4' OR b.jns_spp='5' OR b.jns_spp='6'  )
AND LEFT(a.kd_rek5,2)='62' AND LEFT(a.kd_skpd,$IDK)='$ID'  
AND no_kas_bud<>''
UNION 
SELECT SUM(a.rupiah) AS real1 FROM trdkasin_pkd a
LEFT JOIN trhkasin_pkd b ON a.no_sts = b.no_sts 
WHERE LEFT(a.kd_rek5,2)='62' AND LEFT(b.kd_skpd,$IDK)='$ID'  
UNION
SELECT SUM(a.nilai) AS real1 FROM trdtransout_blud a LEFT JOIN trhtransout_blud b
ON a.no_bukti = b.no_bukti WHERE LEFT(a.kd_rek5,2)='62' AND LEFT(b.kd_skpd,$IDK)='$ID' 
UNION
SELECT IFNULL(SUM(a.nilaID)*-1,0)   AS real1 FROM dkoreksi a 
INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,2)='62' AND LEFT(b.kd_skpd,$IDK)='$ID' 
UNION
SELECT IFNULL(SUM(a.nilaik),0)  AS real1  FROM dkoreksi a 
INNER JOIN hkoreksi b ON a.no_bukti=b.no_bukti WHERE LEFT(a.kd_rek5,2)='62' AND LEFT(b.kd_skpd,$IDK)='$ID' 
UNION
SELECT IFNULL(SUM(berkurang)*-1,0) AS real1 FROM raperda  
WHERE LEFT(kd_rek5,2)='62' AND LEFT(kd_skpd,$IDK)='$ID' 
UNION
SELECT IFNULL(SUM(bertambah),0) AS real1 FROM raperda  
WHERE LEFT(kd_rek5,2)='62'  AND LEFT(kd_skpd,$IDK)='$ID' 
)z";
  $sql62=$this->db->query($sql62);
                 foreach ($sql62->result() as $row62)
                {
                    $r62=$row62->jmreal1;                    
                }


$sisa=$a61-$jmreal1;
$sisa62=$a62-$jmreal1;
$persen=$jmreal1/$a61*100;
$persen2=$r62/$a62*100;


if(strlen($ID)<=4){
$cRet .="<tr>
		<td  align=\"LEFT\" ><B>$ID</B></td>
		<td  align=\"LEFT\" ><B>$NM</B></td>
		<td  align=\"RIGHT\" ><B>".$this->angka($a61)."</B></td>
		<td  align=\"RIGHT\" ><B>".$this->angka($a62)."</B></td>
		<td  align=\"RIGHT\" ><B>".$this->angka($jmreal1)."</B></td>
		<td  align=\"RIGHT\" ><B>".$this->angka($r62)."</B></td>
		<td  align=\"RIGHT\" ><B>".$this->angka($sisa)."</B></td>
		<td  align=\"RIGHT\" ><B>".$this->angka($persen)."</B></td>
		<td  align=\"RIGHT\" ><B>".$this->angka($sisa62)."</B></td>
		<td  align=\"RIGHT\" ><B>".$this->angka($persen2)."</B></td>
	</tr>";
}else{
$cRet .="<tr>
		<td  align=\"LEFT\" >$ID</td>
		<td  align=\"LEFT\" >$NM</td>
		<td  align=\"RIGHT\" >".$this->angka($a61)."</td>
		<td  align=\"RIGHT\" >".$this->angka($a62)."</td>
		<td  align=\"RIGHT\" >".$this->angka($jmreal1)."</td>
		<td  align=\"RIGHT\" >".$this->angka($r62)."</td>
		<td  align=\"RIGHT\" >".$this->angka($sisa)."</td>
		<td  align=\"RIGHT\" >".$this->angka($persen)."</td>
		<td  align=\"RIGHT\" >".$this->angka($sisa62)."</td>
		<td  align=\"RIGHT\" >".$this->angka($persen2)."</td>
	</tr>";

}




				}
				$cRet .="<tr>
		<td colspan=\"2\" align=\"LEFT\" ><B>JUMLAH</B></td>
		<td  align=\"RIGHT\" ><B>".$this->angka($a61)."</B></td>
		<td  align=\"RIGHT\" ><B>".$this->angka($a62)."</B></td>
		<td  align=\"RIGHT\" ><B>".$this->angka($jmreal1)."</B></td>
		<td  align=\"RIGHT\" ><B>".$this->angka($r62)."</B></td>
		<td  align=\"RIGHT\" ><B>".$this->angka($sisa)."</B></td>
		<td  align=\"RIGHT\" ><B>".$this->angka($persen)."</B></td>
		<td  align=\"RIGHT\" ><B>".$this->angka($sisa62)."</B></td>
		<td  align=\"RIGHT\" ><B>".$this->angka($persen2)."</B></td>
	</tr>";


$cRet .=       " </table>";

 $cRet .= "<br>   <table border=\"0\" cellpading = \"8\" width=\"100%\">
                                                        <tr>
                                                            <td width=\"90%\" align=\"left\">&nbsp;<br>&nbsp;
								<br>&nbsp;
								&nbsp;<br>
                                                                &nbsp;<br>
                                                                &nbsp;<br>
								&nbsp;	
                                                            </td>
                                                            <td width=\"30%\" align=\"center\">".ucwords(strtoupper($daerah)).", ".ucwords(strtolower('__ SEPTEMBER 2016'))."&nbsp;&nbsp;&nbsp;
															".ucwords(strtolower($tgl_ctk_raperda))."
															<br>
															<br>
															
                                                                <p><B>BUPATI BIAK NUMFOR</B></p>
                                                                <p>&nbsp;</p>
                                                                <br><br>
                                                                <br><b>$bupati</b>
                                                                <br>
                                                            </td>
                                                        </tr>
                                                    </table>";








$init="RINGKASAN REALISASI ANGGARAN MENURUT URUSAN PEMERINTAH DAERAH DAN ORGANISASI";
$data['prev']= $cRet;
$this->template->set('title', 'CETAK PERDA LAMPIRAN II');        

switch($cetak) {
	case 1;
	//$this->tukd_model->_mpdf('',$cRet,10,10,10,'1');
	$this->_mpdftn2('', $cRet, 10, 10, 10,'L',$init, $hal);
	break;
	case 2;        
	header("Cache-Control: no-cache, no-store, must-revalidate");
	header("Content-Type: application/vnd.ms-excel");
	header("Content-Disposition: attachment; filename= PERDAII.xls");
	$this->load->view('anggaran/rka/perkadaII', $data);
	break;
	case 3;        
	header("Cache-Control: no-cache, no-store, must-revalidate");
	header("Content-Type: application/vnd.ms-word");
	header("Content-Disposition: attachment; filename= PERDAII.doc");
	$this->load->view('anggaran/rka/perkadaII', $data);
	break;

}


}
    function lampiran_III(){
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/perda_real_iii', $data);
    }

    function cetak_perdaIII_real($cetak=''){
		 $cetak=$cetak;      
         $id   = $this->uri->segment(4);

        $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                }

	    $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang, no_qanun, tgl_qanun, no_perbup, tgl_perbup, bupati,no_perkada_d as n,tgl_perkada_d as t FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl     = $rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                    
                    $bupati     = $rowsc->bupati;
                    $no_qanun   = $rowsc->no_qanun;
                    $tgl_qanun  = $this->tukd_model->tanggal_format_indonesia($rowsc->tgl_qanun);
                    $no_perbup  = $rowsc->no_perbup;
                    $tgl_perbup = $rowsc->tgl_perbup;
                     $n  = $rowsc->n;
                    $t = $rowsc->t;
                    $t1= $this->tukd_model->tanggal_format_indonesia($t);
                    
                }
        $sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$id' and kode='PA'";
                 $sqlttd=$this->db->query($sqlttd1);
				 $z=0;
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip=$rowttd->nip;                    
                    $namapa= $rowttd->nm;
                    $jabatan  = $rowttd->jab;
					$z++;
                }
		if($z == '0'){
			 $nip='Belum ada Nip';                    
			 $namapa= 'Belum ada nama';
			 $jabatan  = 'Belum ada jabatan';
		}
       
        $cRet='';
        
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td rowspan=\"3\" align=\"left\" width=\"55%\"><strong></strong></td>
                         <td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"15%\"><strong><h5>LAMPIRAN III:</h6></strong></td>
                         <td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>PERATURAN DAERAH</strong></h5></td>
                    </tr>
                    <tr> 
                         <td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>: $n</h5></td>
                    </tr>
                    <tr>
                        <td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>: $t</h5></td>
                    </tr>
                                         
                   
                  </table>"; 
                           
             
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>RINGKASAN REALISASI APBD </strong></td>
                    </tr>
                    
                    <tr>
                         <td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>

                  </table><br>";
       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                    <tr>
                        <td width=\"20%\">Urusan Organisasi </td>
                        <td width=\"80%\">: $kd_urusan - $nm_urusan</td>
                    </tr>
                    <tr>
                        <td>Organisasi</td>
                        <td>: $kd_skpd - $nm_skpd</td>
                    </tr>
                    
                </table>";        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td rowspan =\"2\" bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>NOMOR URUT</b></td>                            
                            <td rowspan =\"2\" bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>URAIAN</b></td>
                            <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;border-bottom;\" colspan =\"2\" bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>JUMLAH(Rp.)</b></td>
                            <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;border-bottom;\" colspan =\"2\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>LEBIH</br>(BERKURANG)</b></td>
                            <td rowspan =\"2\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>DASAR HUKUM</b></td>
                        </tr>
                        <tr><td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>Anggaran</b></td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>Realisasi</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>(Rp.)</b></td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>%</b></td>
                        </tr>
                     </thead>
                     
                       <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
                         </tr>
                    </tfoot>
                                                
                        ";
                 $sql1="SELECT * FROM (SELECT  CONCAT(a.kd_kegiatan, '.4') AS kd_rek,c.nm_kegiatan AS nm_rek,SUM(d.anggaran)AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trskpd a INNER JOIN m_giat c ON a.kd_kegiatan1=c.kd_kegiatan
                        LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						LEFT JOIN realisasi_bulan d ON a.kd_skpd=d.kd_skpd AND a.kd_kegiatan=d.kd_kegiatan AND b.kd_rek5=d.kd_rek5
						WHERE a.kd_skpd='$id' AND LEFT(b.kd_rek5,1)='4' GROUP BY a.kd_kegiatan,c.nm_kegiatan 
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(d.anggaran)AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trdrka a LEFT JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2 
						LEFT JOIN realisasi_bulan d ON a.kd_skpd=d.kd_skpd AND a.kd_kegiatan=d.kd_kegiatan AND a.kd_rek5=d.kd_rek5 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,24),b.nm_rek2
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(d.anggaran)AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trdrka a LEFT JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
						LEFT JOIN realisasi_bulan d ON a.kd_skpd=d.kd_skpd AND a.kd_kegiatan=d.kd_kegiatan AND a.kd_rek5=d.kd_rek5 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,25),b.nm_rek3
                        ) a ORDER BY kd_rek";
                 
                 $query = $this->db->query($sql1);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query->result() as $row)
                {
                    $coba1  = $row->kd_rek;
                    $coba2  = $row->nm_rek;
                    $coba3  = number_format($row->nilai,"2",".",",");
                    $coba3u = number_format($row->nilai_ubah,"2",".",",");
                    $rumus1 = $row->nilai_ubah - $row->nilai;
                    if ($rumus1 < 0){
                    	$x1="("; $rumus1=$rumus1*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $total1 = number_format($rumus1,"2",".",",");  
                    $per1   = ($rumus1!=0)?($row->nilai_ubah / $row->nilai ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");    
                    
                    if(strlen($coba1)<=24){
		                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"><b>$coba1</b></td>                                     
		                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"><b>$coba2</b></td>
		                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$coba3</b></td>
		                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$coba3u</b></td>
		                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$total1$y1</b></td>
		                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1</b></td>
		                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
		                                </tr>";
                        }else{
                        	$cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\">$coba1</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\">$coba2</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$coba3</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$coba3u</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$total1$y1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>";
                        }
                }
                $sqltp="SELECT SUM(anggaran) AS totp, SUM(real_spj) as totp_ubah FROM realisasi_bulan WHERE LEFT(kd_rek5,1)='4' and kd_skpd='$id'";
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                   $coba4=number_format($rowp->totp,"2",".",",");
                   $coba4u=number_format($rowp->totp_ubah,"2",".",",");
                   $rumus2 = $rowp->totp_ubah - $rowp->totp;
                   if ($rumus2 < 0){
                        $x1="("; $rumus2=$rumus2*-1; $y1=")";}
                   else {
                        $x1=""; $y1="";}
                   $total2 = number_format($rumus2,"2",".",",");  
                   $per2   = ($rumus2!=0)?($rowp->totp_ubah / $rowp->totp ) * 100:0; 
                   $persen2= number_format($per2,"2",".",",");
                   $cob1=$rowp->totp;
                   $cob1u=$rowp->totp_ubah;
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"><b>JUMLAH PENDAPATAN</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$coba4</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$coba4u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$total2$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen2</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>";
                                     
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\">&nbsp;</td>
                                </tr>";
                 } 
                 
                 $sqltb="SELECT concat(a.kd_kegiatan, '.', 5) as kd_rek,SUM(b.anggaran) AS totb,SUM(b.real_spj) AS totb_ubah FROM trdrka a 
						LEFT JOIN realisasi_bulan b ON a.kd_skpd=b.kd_skpd AND a.kd_kegiatan=b.kd_kegiatan AND a.kd_rek5=b.kd_rek5 
						WHERE LEFT(a.kd_rek5,1)='5' AND a.kd_skpd='$id'";
                    $sqlb=$this->db->query($sqltb);
                 foreach ($sqlb->result() as $rowb)
                {
                   $jmlb=number_format($rowb->totb,"2",".",",");
                   $jmlbu=number_format($rowb->totb_ubah,"2",".",",");
				   $cob11  = $rowb->kd_rek;
                   $cob=$rowb->totb;
                   $cobu=$rowb->totb_ubah;
                   $rumus3 = $rowb->totb_ubah - $rowb->totb;
                   if ($rumus3 < 0){
                        $x1="("; $rumus3=$rumus3*-1; $y1=")";}
                   else {
                        $x1=""; $y1="";}
                   $total3 = number_format($rumus3,"2",".",",");  
                   $per3   = ($rumus3!=0)?($rowb->totb_ubah / $rowb->totb ) * 100:0; 
                   $persen3= number_format($per3,"2",".",",");
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: nonek;border-bottom: none;\" width=\"20%\" align=\"left\">$cob11</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"><b>BELANJA DAERAH</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$jmlb</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$jmlbu</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$total3$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen3</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>";
                 }    
                $sql2="SELECT * FROM (SELECT CONCAT(a.kd_kegiatan, '.', 51) AS kd_rek,c.nm_kegiatan AS nm_rek,SUM(d.anggaran)AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trskpd a 
				INNER JOIN m_giat c ON a.kd_kegiatan1=c.kd_kegiatan
				LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
				LEFT JOIN realisasi_bulan d ON b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan AND b.kd_rek5=d.kd_rek5 
				WHERE a.kd_skpd='$id' AND LEFT(b.kd_rek5,2)='51' GROUP BY a.kd_kegiatan,c.nm_kegiatan 
				UNION ALL
				SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(d.anggaran)AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trdrka a 
				INNER JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
				LEFT JOIN realisasi_bulan d ON a.kd_skpd=d.kd_skpd AND a.kd_kegiatan=d.kd_kegiatan AND a.kd_rek5=d.kd_rek5 
				WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,25),b.nm_rek3
				) a ORDER BY kd_rek";
                 
                 $query1 = $this->db->query($sql2);
                 foreach ($query1->result() as $row1)
                {
                    $coba5  = $row1->kd_rek;
                    $coba6  = ucwords(strtolower($row1->nm_rek));
                    $coba7  = number_format($row1->nilai,"2",".",",");
                    $coba7u = number_format($row1->nilai_ubah,"2",".",",");
                    $rumus4 = $row1->nilai_ubah - $row1->nilai;
                    if ($rumus4 < 0){
                        $x1="("; $rumus4=$rumus4*-1; $y1=")";}
                   else {
                        $x1=""; $y1="";}
                   $total4 = number_format($rumus4,"2",".",",");  
                   $per4   = ($rumus4!=0)?($row1->nilai_ubah / $row1->nilai) * 100:0; 
                   $persen4= number_format($per4,"2",".",",");
                   if(strlen($coba5)<=24){
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"><b>$coba5</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"><b>$coba6</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$coba7</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$coba7u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$total4$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen4</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>
                                ";
                    
                   }else{
                   
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\">$coba5</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\">$coba6</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$coba7</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$coba7u</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$total4$y1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\">$persen4</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>
                                ";
                     }
                }
                
                    $sqltbl="SELECT CONCAT(a.kd_kegiatan, '.', 52) AS kd_rek,SUM(b.anggaran) AS totbl, SUM(b.real_spj) as totbl_ubah FROM trdrka a LEFT join realisasi_bulan b on a.kd_skpd=b.kd_skpd and a.kd_kegiatan=b.kd_kegiatan and a.kd_rek5=b.kd_rek5 WHERE LEFT(a.kd_rek5,2)='52' and a.kd_skpd='$id'";
                    $sqlbl=$this->db->query($sqltbl);
                 foreach ($sqlbl->result() as $rowbl)
                {
                   $jumbl   = number_format($rowbl->totbl,"2",".",",");
                   $jumblu  = number_format($rowbl->totbl_ubah,"2",".",",");
                   $rumus5  = $rowbl->totbl_ubah - $rowbl->totbl;
				    $cob2   = $rowbl->kd_rek;
                   if ($rumus5 < 0){
                        $x1="("; $rumus5=$rumus5*-1; $y1=")";}
                   else {
                        $x1=""; $y1="";}
                   $total5 = number_format($rumus5,"2",".",",");  
                   $per5   = ($rumus5!=0)?($rowbl->totbl_ubah / $rowbl->totbl) * 100:0; 
                   $persen5= number_format($per5,"2",".",",");
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"></td>                                     
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\">&nbsp;</td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\">&nbsp;</td>
                              </tr>
                              <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\">$cob2</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"><b>Belanja Langsung</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$jumbl</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$jumblu</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$total5$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen5</b></td>                                
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>";
                 }
                 $sql2bl="SELECT * FROM (SELECT a.kd_program AS kd_rek,c.nm_program AS nm_rek,
						(SELECT SUM(c.anggaran) FROM realisasi_bulan c WHERE a.kd_skpd=c.kd_skpd and a.kd_program=LEFT(c.kd_kegiatan,(LENGTH(a.kd_program))) ) AS nilai,
						(SELECT SUM(c.real_spj) FROM realisasi_bulan c WHERE a.kd_skpd=c.kd_skpd and a.kd_program=LEFT(c.kd_kegiatan,(LENGTH(a.kd_program))) ) AS nilai_ubah
						FROM trskpd a INNER JOIN m_prog c ON a.kd_program1=c.kd_program
						LEFT JOIN trdrka b ON a.kd_program=LEFT(b.kd_kegiatan,(LENGTH(a.kd_program))) WHERE a.kd_skpd='$id' AND RIGHT(a.kd_program,2)<>'00' GROUP BY a.kd_program,c.nm_program
						UNION ALL
						SELECT a.kd_kegiatan AS kd_rek,c.nm_kegiatan AS nm_rek,SUM(d.anggaran) AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trskpd a 
						INNER JOIN m_giat c ON a.kd_kegiatan1=c.kd_kegiatan
						LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						left JOIN realisasi_bulan d ON a.kd_skpd=d.kd_skpd AND a.kd_kegiatan=d.kd_kegiatan AND b.kd_rek5=d.kd_rek5 
						WHERE a.kd_skpd='$id' AND RIGHT(a.kd_program,2)<>'00' GROUP BY a.kd_kegiatan,c.nm_kegiatan 
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(d.anggaran) AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trdrka a 
						LEFT JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
						LEFT JOIN realisasi_bulan d ON a.kd_skpd=d.kd_skpd AND a.kd_kegiatan=d.kd_kegiatan AND a.kd_rek5=d.kd_rek5 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,25),b.nm_rek3
						) a ORDER BY kd_rek";
                 
                 $query1bl = $this->db->query($sql2bl);
                 foreach ($query1bl->result() as $row1bl)
                {
                    $bl1    =$row1bl->kd_rek;
                    $bl2    =ucwords(strtolower($row1bl->nm_rek));
                    $bl3    = number_format($row1bl->nilai,"2",".",",");
                    $bl3u   = number_format($row1bl->nilai_ubah,"2",".",",");
                    $rumus6 = $row1bl->nilai_ubah - $row1bl->nilai;
                    if ($rumus6 < 0){
                        $x1="("; $rumus6=$rumus6*-1; $y1=")";}
                    else {
                        $x1=""; $y1="";}
                    $total6 = number_format($rumus6,"2",".",",");  
                    $per6   = ($rumus6!=0)?($row1bl->nilai_ubah / $row1bl->nilai) * 100:0; 
                    $persen6= number_format($per6,"2",".",",");
                    if(strlen($bl1)<=24){
                        $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"><b>$bl1</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"><b>$bl2</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$bl3</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$bl3u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$total6$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen6</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>";
                    }else{
                   
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\">$bl1</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\">$bl2</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$bl3</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$bl3u</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$total6$y1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\">$persen6</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>";
                     }
                }
                
                    $sqltbl="SELECT SUM(b.anggaran) AS totbl,Sum(b.real_spj) as totbl_ubah FROM trdrka a LEFT JOIN realisasi_bulan b on a.kd_skpd=b.kd_skpd and a.kd_kegiatan=b.kd_kegiatan and a.kd_rek5=b.kd_rek5 WHERE LEFT(a.kd_rek5,1)='5' and a.kd_skpd='$id'";
                    $sqlbl=$this->db->query($sqltbl);
                 foreach ($sqlbl->result() as $rowbl)
                {
                   $jumbl   = number_format($rowbl->totbl,"2",".",",");
                   $jumblu  = number_format($rowbl->totbl_ubah,"2",".",",");
                   $rumus7  = $rowbl->totbl_ubah - $rowbl->totbl;
                   if ($rumus7 < 0){
                        $x1="("; $rumus7=$rumus7*-1; $y1=")";}
                    else {
                        $x1=""; $y1="";}
                    $total7 = number_format($rumus7,"2",".",",");  
                    $per7   = ($rumus7!=0)?($rowbl->totbl_ubah / $rowbl->totbl) * 100:0; 
                    $persen7= number_format($per7,"2",".",",");
                   $cob=$rowbl->totbl;
                   $cobu=$rowbl->totbl_ubah;
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"30%\"><b>JUMLAH BELANJA</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"10%\" align=\"right\"><b>$jumbl</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"10%\" align=\"right\"><b>$jumblu</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"10%\" align=\"right\"><b>$x1$total7$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"right\"></strong><b>$persen7</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>";
                 }
                 
                 $suplus=$cob1-$cob;
                 $suplusu=$cob1u-$cobu; 
                  if ($suplus < 0){
                	$x1="(";
                	$suplus=$suplus*-1;
                	$y1=")";}
                 else {
                	$x1="";
	                $y1="";}
                 if ($suplusu < 0){
                	$x1="(";
                	$suplusu=$suplusu*-1;
                	$y1=")";}
                 else {
                	$x1="";
	                $y1="";}
                    
                 $surp  = number_format($suplus,2,',','.');
                 $surpu = number_format($suplusu,2,',','.');               
                  
               /* $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"></td>                                     
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"><b>Suprlus/(Defisit)</b></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$surp$y1</b></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$surpu$y1</b></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\">&nbsp;</td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\">&nbsp;</td>
                              </tr>*/
                 $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"></td>                                     
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\">&nbsp;</td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\">&nbsp;</td>
                              </tr>";
                
                 
                    
                    $sql3="SELECT * FROM (SELECT a.kd_kegiatan AS kd_rek,c.nm_kegiatan AS nm_rek,SUM(d.anggaran)AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trskpd a 
					INNER JOIN m_giat c ON a.kd_kegiatan1=c.kd_kegiatan
					LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan
					LEFT JOIN realisasi_bulan d ON b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan AND b.kd_rek5=d.kd_rek5 
					WHERE a.kd_skpd='$id' AND RIGHT(a.kd_kegiatan,5)='00.03' GROUP BY a.kd_kegiatan,c.nm_kegiatan 
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(d.anggaran)AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trdrka a 
					LEFT JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					LEFT JOIN realisasi_bulan d ON a.kd_skpd=d.kd_skpd AND a.kd_kegiatan=d.kd_kegiatan AND a.kd_rek5=d.kd_rek5 
					WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,25),b.nm_rek3
					) a ORDER BY kd_rek";
                 
                 $query3 = $this->db->query($sql3);
                 //$query = $this->skpd_model->getAllc();
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"><b>PEMBIAYAAN DAERAH</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>";                                                  
                foreach ($query3->result() as $row3)
                {
                    $coba9  =$row3->kd_rek;
                    $coba10 =$row3->nm_rek;
                    $coba11 = number_format($row3->nilai,"2",".",",");
                    $coba11u= number_format($row3->nilai_ubah,"2",".",",");
                    $rumus8 = $row3->nilai_ubah - $row3->nilai;
                    if ($rumus8 < 0){
                        $x1="("; $rumus8=$rumus8*-1; $y1=")";}
                    else {
                        $x1=""; $y1="";}
                    $total8 = number_format($rumus8,"2",".",",");  
                    $per8   = ($rumus8!=0)?($row3->nilai_ubah / $row3->nilai) * 100:0; 
                    $persen8= number_format($per8,"2",".",",");
                    
                     $cRet    .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"><b>$coba9</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"30%\"><b>$coba10</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"10%\" align=\"right\"><b>$coba11</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"10%\" align=\"right\"><b>$coba11u</<b>b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"10%\" align=\"right\"><b>$x1$total8$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"right\"><b>$persen8</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>";
                }
                $sqltpm="SELECT SUM(b.anggaran) AS totpm,SUM(b.real_spj) AS totpm_ubah FROM trdrka a left join realisasi_bulan b on a.kd_skpd=b.kd_skpd and a.kd_kegiatan=b.kd_kegiatan and a.kd_rek5=b.kd_rek5 WHERE LEFT(a.kd_rek5,2)='61' and a.kd_skpd='$id'";
                 $sqlpm=$this->db->query($sqltpm);
                 foreach ($sqlpm->result() as $rowpm)
                {
                   $coba12  = number_format($rowpm->totpm,"2",".",",");
                   $coba12u = number_format($rowpm->totpm_ubah,"2",".",",");
                   $rumus9  = $rowpm->totpm_ubah - $rowpm->totpm;
                   if ($rumus9 < 0){
                        $x1="("; $rumus9=$rumus9*-1; $y1=")";}
                    else {
                        $x1=""; $y1="";}
                    $total9 = number_format($rumus9,"2",".",",");  
                    $per9   = ($rumus9!=0)?($rowpm->totpm_ubah / $rowpm->totpm) * 100:0; 
                    $persen9= number_format($per9,"2",".",",");
                    $cob3    = $rowpm->totpm;
                    $cob3u   = $rowpm->totpm_ubah;
                     $cRet    .= " 
                                <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"><b>JUMLAH PENERIMAAN PEMBIAYAAN</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$coba12</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$coba12u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$total9$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen9</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>
                                <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"></td>                                     
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\">&nbsp;</td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\">&nbsp;</td>
                              </tr>";
                 }     
                $sql4="SELECT * FROM (SELECT a.kd_kegiatan AS kd_rek,c.nm_kegiatan AS nm_rek,SUM(d.anggaran)AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trskpd a INNER JOIN m_giat c ON a.kd_kegiatan1=c.kd_kegiatan
                       LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
					   LEFT JOIN realisasi_bulan d ON b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan AND b.kd_rek5=d.kd_rek5 
					   WHERE a.kd_skpd='$id' and right(a.kd_kegiatan,5)='00.04' GROUP BY a.kd_kegiatan,c.nm_kegiatan 
                       UNION ALL
                       SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(d.anggaran)AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trdrka a LEFT JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					   LEFT JOIN realisasi_bulan d ON a.kd_skpd=d.kd_skpd AND a.kd_kegiatan=d.kd_kegiatan AND a.kd_rek5=d.kd_rek5 WHERE a.kd_skpd='$id' and left(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,25),b.nm_rek3
                       ) a ORDER BY kd_rek";
                 
                 $query4 = $this->db->query($sql4);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query4->result() as $row4)
                {
                    $coba13     = $row4->kd_rek;
                    $coba14     = strtoupper($row4->nm_rek);
                    $coba15     = number_format($row4->nilai,"2",".",",");
                    $coba15u    = number_format($row4->nilai_ubah,"2",".",",");
                    $rumus10    = $row4->nilai_ubah - $row4->nilai;
                    if ($rumus10 < 0){
                        $x1="("; $rumus10=$rumus10*-1; $y1=")";}
                    else {
                        $x1=""; $y1="";}
                    $total10 = number_format($rumus10,"2",".",",");  
                    $per10   = ($rumus10!=0)?($row4->nilai_ubah / $row4->nilai) * 100:0; 
                    $persen10= number_format($per10,"2",".",",");
                    
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"left\">$coba13</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"30%\">$coba14</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$coba15</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$coba15u</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$total10$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen10</td>&nbsp;
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>&nbsp;
                                </tr>";
                }
                $sqltpk="SELECT SUM(b.anggaran) AS totpk,SUM(b.real_spj) AS totpk_ubah FROM trdrka a left join realisasi_bulan b on a.kd_skpd=b.kd_skpd and a.kd_kegiatan=b.kd_kegiatan and a.kd_rek5=b.kd_rek5 WHERE LEFT(a.kd_rek5,2)='62' and a.kd_skpd='$id'";
                 $sqlpk=$this->db->query($sqltpk);
                 foreach ($sqlpk->result() as $rowpk)
                {
                   $coba16  = number_format($rowpk->totpk,"2",".",",");
                   $coba16u = number_format($rowpk->totpk_ubah,"2",".",",");
                   $rumus11 = $rowpk->totpk_ubah - $rowpk->totpk;
                   if ($rumus11 < 0){
                        $x1="("; $rumus11=$rumus11*-1; $y1=")";}
                    else {
                        $x1=""; $y1="";}
                    $total11 = number_format($rumus11,"2",".",",");  
                    $per11   = ($rumus11!=0)?($rowpk->totpk_ubah / $rowpk->totpk) * 100:0; 
                    $persen11= number_format($per11,"2",".",",");
                    
                   $cob4    =$rowpk->totpk;
                   $cob4u   =$rowpk->totpk_ubah;
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"><b>JUMLAH PENGELUARAN PEMBIAYAAN</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$coba16</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$coba16u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$total11$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen11</b></td>&nbsp;
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>&nbsp;
                                </tr>";
                 }  
                  
				$netto=$cob3 - $cob4;
				$net=number_format($netto,"2",",",".");
				$netto_r= $cob3u -  $cob4u;
				$net_r=number_format($netto_r,"2",",",".");
				$netto_s=$netto_r - $netto;
				if ($netto_s < 0){
					$x1="("; $netto_s=$netto_s*-1; $y1=")";}
				else {
					$x1=""; $y1="";}
				$netto_selisih = number_format($netto_s,"2",",",".");
				$perpnet   = ($netto_s!=0)?($netto_s / $netto ) * 100:0; 
				$persennet= number_format($perpnet);                    
				
				
				$cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\"><b>PEMBIAYAAN NETTO</b></td>
								 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$net</b></td>
								 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$net_r</b></td>
								 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$netto_selisih$y1</b></td>
								 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persennet</b></td>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
								 </tr>";
              
        $cRet    .= "</table>";
		 $date=date('Y-m-t');
        $cRet .= "<br><table width=\"100%\" border=\"0\" cellpading = \"8\">
                                <tr>
                                    <td width=\"60%\" align=\"left\">&nbsp;<br>&nbsp;
                                        <br>&nbsp;
                                        &nbsp;<br>
                                        &nbsp;<br>
                                        &nbsp;<br>
                                        &nbsp;	
                                    </td>
                                    <td width=\"40%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($date)."
                                        <p><b>$jabatan</b></p>
                                        <p>&nbsp;</p>
                                        <br><br>
                                        <br><b><u>$namapa</u></b>
                                        <br>$nip</b>
                                    </td>
                                </tr>";
         $cRet .=       " </table>";
        $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul     = 'Laporan real APBD Lamp III - '.$kd_skpd;
        $this->template->set('title', 'CETAK PERDA');    
        //$this->_mpdf('',$cRet,10,10,10,0);
        switch($cetak) {
        case 0;
              $this->template->load('template','anggaran/rka/perdaIII_ubah',$data);
        break;
        case 1;
             $this->tukd_model->_mpdf('',$cRet,10,10,10,'P');
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
           $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        }       
       
        
                
    }

    function lampiran_IV(){
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/perda_real_iv', $data);
    }
    
	function cetak_lra2(){
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/cetak_lra', $data);
    }

    function cetak_lra_ppkd(){
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/cetak_lra_ppkd', $data);
    }

    function cetak_lra_lo_v(){
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/cetak_lra_lo', $data);
    }

    function cetak_lra_lo_ppkd(){
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/cetak_lra_lo_ppkd', $data);
    }
    
    function ctk_lo_pemda(){
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/cetak_lo_pemda', $data);
    }
    
    function cetak_lpe(){
        $data['page_title'] = 'LPE';
        $this->template->set('title', 'LPE');
        $this->template->load('template', 'akuntansi/cetak_lpe', $data);
    }

    function cetak_lpe_ppkd(){
        $data['page_title'] = 'LPE';
        $this->template->set('title', 'LPE');
        $this->template->load('template', 'akuntansi/cetak_lpe_ppkd', $data);
    }
    
    function cetak_lpsal(){
        $data['page_title'] = 'LPSAL';
        $this->template->set('title', 'LPSAL');
        $this->template->load('template', 'akuntansi/cetak_lpsal', $data);
    }

    function cetak_perdaIV_real(){
       
	   $cetak = $this->uri->segment(3);
		 $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang,upper(no_qanun)as no_qanun, tgl_qanun, no_perbup, tgl_perbup, bupati FROM sclient";
		 $sqlsclient=$this->db->query($sqlsc);
		 foreach ($sqlsclient->result() as $rowsc)
		{
		   
			$tgl     = $rowsc->tgl_rka;
			$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
			$kab     = $rowsc->kab_kota;
			$daerah  = $rowsc->daerah;
			$thn     = $rowsc->thn_ang;
			
			$bupati     = $rowsc->bupati;
			$no_qanun   = $rowsc->no_qanun;
			$tgl_qanun  = $this->tukd_model->tanggal_format_indonesia($rowsc->tgl_qanun);
			$no_perbup  = $rowsc->no_perbup;
			$tgl_perbup = $rowsc->tgl_perbup;
			
		}
		$sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='1.20.05.00' and kode='KD'");
		foreach($sqlttd->result() as $rowtd){
			$nip=$rowtd->nip;
			$namapa=$rowtd->nama;
			$jabatan=$rowtd->jabatan;
		}
        $cRet='';
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
                         <td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"10%\"><strong><h5>LAMPIRAN IV  :</h6></strong></td>
                         <td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>PERATURAN DAERAH</strong></h5></td>
                    </tr>
                    <tr> 
                         <td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>: $no_qanun</h5></td>
                    </tr>
                    <tr>
                        <td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>: $tgl_qanun</h5></td>
                    </tr>
                                         
                   
                  </table>
				<br>";
        $cRet .="<table style=\"border-collapse:collapse;font-size:14;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td colspan = \"10\" align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                     <tr>
                         <td colspan = \"10\" align=\"center\"><strong>REKAPITULASI REALISASI BELANJA MENURUT URUSAN, ORGANISASI </strong></td>
                    </tr>
                    <tr>
                         <td colspan = \"10\" align=\"center\"><strong>PROGRAM, KEGIATAN DAN JENIS BELANJA TAHUN ANGARAN $thn</strong></td>
                    </tr>

                  </table><br>";  
        
        $cRet .= "<table style=\"border-collapse:collapse;font-size:14;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>Kode Rekening</b></td>                            
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"39%\" align=\"center\"><b>Uraian Urusan, Organisasi,Program dan Kegiatan</b></td>                         
                            <td colspan=\"4\" bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>Jenis Belanja</b></td>
							<td colspan=\"4\" bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>Realisasi</b></td>
                            </tr>
                        <tr>
 							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Pegawai</b></td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Barang dan Jasa</b></td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Modal</b></td>
							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Jumlah</b></td>
							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Pegawai</b></td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Barang dan Jasa</b></td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Modal</b></td>
							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Jumlah</b></td>
                        </tr>    

						<tr>
							<td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">1</td>        
                            <td bgcolor=\"#CCCCCC\" width=\"39%\" align=\"center\">2</td> 
 							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">3</td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">4</td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">5</td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">6 = 3+4+5</td>
							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">7</td>
							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">8</td>
							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">9</td>
							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">10 = 7+8+9</td>

                        </tr>   
                     </thead>
                    <tfoot>
                        <tr>
                            <td colspan=\"10\" style=\"border:solid 1px white;border-top: solid 1px black;\"></td>
                         </tr>
                    </tfoot>";
					 $cRet    .= "  <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"39%\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									 </tr>";
                                     
                 $sql1 = "SELECT 
							a.kd_urusan1 AS kode, 
							a.nm_urusan1 AS nama,
							SUM(IF(LEFT(c.kd_rek5,3)='521',c.anggaran,0)) AS bpeg,
							SUM(IF(LEFT(c.kd_rek5,3)='522',c.anggaran,0)) AS bbj,
							SUM(IF(LEFT(c.kd_rek5,3)='523',c.anggaran,0)) AS bm,
							SUM(IF(LEFT(c.kd_rek5,2)='52',c.anggaran,0))  AS jumlah,
							SUM(IF(LEFT(c.kd_rek5,3)='521',c.real_spj,0)) AS rbpeg,
							SUM(IF(LEFT(c.kd_rek5,3)='522',c.real_spj,0)) AS rbbj,
							SUM(IF(LEFT(c.kd_rek5,3)='523',c.real_spj,0)) AS rbm,
							SUM(IF(LEFT(c.kd_rek5,2)='52',c.real_spj,0))  AS rjumlah
							FROM trdrka b 
							INNER JOIN ms_urusan1 a ON LEFT(b.kd_skpd,1)=a.kd_urusan1 
							LEFT JOIN realisasi_bulan c ON b.kd_skpd=c.kd_skpd AND b.kd_kegiatan=c.kd_kegiatan AND b.kd_rek5=c.kd_rek5
							GROUP BY  a.kd_urusan1 ,a.nm_urusan1
							UNION
							SELECT 
							a.kd_urusan AS kode, 
							a.nm_urusan AS nama,
							SUM(IF(LEFT(c.kd_rek5,3)='521' AND LEFT(c.kd_skpd,4)=a.kd_urusan,c.anggaran,0)) AS bpeg,
							SUM(IF(LEFT(c.kd_rek5,3)='522' AND LEFT(c.kd_skpd,4)=a.kd_urusan,c.anggaran,0)) AS bbj,
							SUM(IF(LEFT(c.kd_rek5,3)='523' AND LEFT(c.kd_skpd,4)=a.kd_urusan,c.anggaran,0)) AS bm,
							SUM(IF(LEFT(c.kd_rek5,2)='52' AND LEFT(c.kd_skpd,4)=a.kd_urusan,c.anggaran,0)) AS jumlah,
							SUM(IF(LEFT(c.kd_rek5,3)='521' AND LEFT(c.kd_skpd,4)=a.kd_urusan,c.real_spj,0)) AS rbpeg,
							SUM(IF(LEFT(c.kd_rek5,3)='522' AND LEFT(c.kd_skpd,4)=a.kd_urusan,c.real_spj,0)) AS rbbj,
							SUM(IF(LEFT(c.kd_rek5,3)='523' AND LEFT(c.kd_skpd,4)=a.kd_urusan,c.real_spj,0)) AS rbm,
							SUM(IF(LEFT(c.kd_rek5,2)='52' AND LEFT(c.kd_skpd,4)=a.kd_urusan,c.real_spj,0)) AS rjumlah
							FROM trdrka b 
							INNER JOIN ms_urusan a ON LEFT(b.kd_skpd,4)=a.kd_urusan 
							LEFT JOIN realisasi_bulan c ON b.kd_skpd=c.kd_skpd AND b.kd_kegiatan=c.kd_kegiatan AND b.kd_rek5=c.kd_rek5 
							GROUP BY  a.kd_urusan ,a.nm_urusan
							UNION
							SELECT 
							a.kd_skpd AS kode, 
							b.nm_skpd AS nama,
							SUM(IF(LEFT(c.kd_rek5,3)='521' AND c.kd_skpd=a.kd_skpd,c.anggaran,0)) AS bpeg,
							SUM(IF(LEFT(c.kd_rek5,3)='522' AND c.kd_skpd=a.kd_skpd,c.anggaran,0)) AS bbj,
							SUM(IF(LEFT(c.kd_rek5,3)='523' AND c.kd_skpd=a.kd_skpd,c.anggaran,0)) AS bm,
							SUM(IF(LEFT(c.kd_rek5,2)='52' AND  c.kd_skpd=a.kd_skpd,c.anggaran,0)) AS jumlah,
							SUM(IF(LEFT(c.kd_rek5,3)='521' AND c.kd_skpd=a.kd_skpd,c.real_spj,0)) AS rbpeg,
							SUM(IF(LEFT(c.kd_rek5,3)='522' AND c.kd_skpd=a.kd_skpd,c.real_spj,0)) AS rbbj,
							SUM(IF(LEFT(c.kd_rek5,3)='523' AND c.kd_skpd=a.kd_skpd,c.real_spj,0)) AS rbm,
							SUM(IF(LEFT(c.kd_rek5,2)='52' AND c.kd_skpd=a.kd_skpd,c.real_spj,0)) AS rjumlah
							FROM trdrka a 
							INNER JOIN ms_skpd b ON a.kd_skpd=b.kd_skpd 
							LEFT JOIN realisasi_bulan c ON a.kd_skpd=c.kd_skpd AND a.kd_kegiatan=c.kd_kegiatan AND a.kd_rek5=c.kd_rek5 
							GROUP BY a.kd_skpd,b.nm_skpd       
							ORDER BY kode";
                 $query = $this->db->query($sql1);
                 //$query = $this->skpd_model->getAllc();
                foreach ($query->result() as $row)
                {
                    $kode=$row->kode;
                    $nama=$row->nama;
                    $pend=number_format($row->bpeg,"2",",",".");
                    $btl= number_format($row->bbj,"2",",",".");
                    $bl= number_format($row->bm,"2",",",".");
                    $jum= number_format($row->jumlah,"2",",",".");
					$rpend=number_format($row->rbpeg,"2",",",".");
                    $rbtl= number_format($row->rbbj,"2",",",".");
                    $rbl= number_format($row->rbm,"2",",",".");
                    $rjum= number_format($row->rjumlah,"2",",",".");
                   
                    if ($kode <> '2'){
                        $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"39%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$pend</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$btl</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$bl</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$jum</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rpend</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rbtl</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rbl</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rjum</b></td>
									</tr>
                                     ";
                    }else{
					
						 $cRet    .= "  <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"39%\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									</tr>
                                     
									<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"39%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$pend</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$btl</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$bl</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$jum</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rpend</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rbtl</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rbl</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rjum</b></td>
									</tr>
                                     ";
					
					}
                 
							

					$sql2=" SELECT a.kd_skpd AS skpdx,
					b.kd_program AS kode,
					c.nm_program AS nama,SUBSTR(b.kd_program,17,2)AS kodex,
					SUM(IF(LEFT(d.kd_rek5,3)='521' AND d.kd_skpd=a.kd_skpd AND LEFT(d.kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program,d.anggaran,0))  AS bpeg,
					SUM(IF(LEFT(d.kd_rek5,3)='522' AND d.kd_skpd=a.kd_skpd AND LEFT(d.kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program,d.anggaran,0)) AS bbj,
					SUM(IF(LEFT(d.kd_rek5,3)='523' AND d.kd_skpd=a.kd_skpd AND LEFT(d.kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program,d.anggaran,0)) AS bm,
					SUM(IF(LEFT(d.kd_rek5,2)='52' AND d.kd_skpd=a.kd_skpd AND LEFT(d.kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program,d.anggaran,0)) AS jumlah,
					SUM(IF(LEFT(d.kd_rek5,3)='521' AND d.kd_skpd=a.kd_skpd AND LEFT(d.kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program,d.real_spj,0))  AS rbpeg,
					SUM(IF(LEFT(d.kd_rek5,3)='522' AND d.kd_skpd=a.kd_skpd AND LEFT(d.kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program,d.real_spj,0)) AS rbbj,
					SUM(IF(LEFT(d.kd_rek5,3)='523' AND d.kd_skpd=a.kd_skpd AND LEFT(d.kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program,d.real_spj,0)) AS rbm,
					SUM(IF(LEFT(d.kd_rek5,2)='52' AND d.kd_skpd=a.kd_skpd AND LEFT(d.kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program,d.real_spj,0)) AS rjumlah
					FROM trdrka a 
					JOIN trskpd b ON a.kd_kegiatan=b.kd_kegiatan
					LEFT JOIN m_prog c ON b.kd_program1 = c.kd_program 
					LEFT JOIN realisasi_bulan d ON a.kd_skpd=d.kd_skpd AND a.kd_kegiatan=d.kd_kegiatan AND a.kd_rek5=d.kd_rek5 
					WHERE a.kd_skpd='$kode' and RIGHT(b.kd_program,2) <>'00' GROUP BY b.kd_program,c.nm_program ORDER BY kode";

					$query1 = $this->db->query($sql2);
                                                  
					foreach ($query1->result() as $row1)
					{
						$kode1=$row1->kode;
						$nama1=$row1->nama;
						$kodex=$row1->kodex;
						$skpdx=$row1->skpdx;
						$pend1=number_format($row1->bpeg,"2",",",".");
						$btl1= number_format($row1->bbj,"2",",",".");
						$bl1= number_format($row1->bm,"2",",",".");
						$jum1= number_format($row1->jumlah,"2",",",".");
						$rpend1=number_format($row1->rbpeg,"2",",",".");
						$rbtl1= number_format($row1->rbbj,"2",",",".");
						$rbl1= number_format($row1->rbm,"2",",",".");
						$rjum1= number_format($row1->rjumlah,"2",",",".");

						$cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode1</b></td>                                     
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"39%\"><b>$nama1</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$pend1</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$btl1</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$bl1</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$jum1</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rpend1</b></td>
									  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rbtl1</b></td>
									   <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rbl1</b></td>
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rjum1</b></td>
									</tr>

										 ";
								

							$sql3="SELECT 
							b.kd_kegiatan AS kode,
							c.nm_kegiatan AS nama,
							SUM(IF(LEFT(d.kd_rek5,3)='521' AND b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan,d.anggaran,0)) AS bpeg,
							SUM(IF(LEFT(d.kd_rek5,3)='522' AND b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan,d.anggaran,0)) AS bbj,
							SUM(IF(LEFT(d.kd_rek5,3)='523' AND b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan,d.anggaran,0)) AS bm,
							SUM(IF(LEFT(d.kd_rek5,2)='52' AND b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan,d.anggaran,0)) AS jumlah,
							SUM(IF(LEFT(d.kd_rek5,3)='521' AND b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan,d.real_spj,0)) AS rbpeg,
							SUM(IF(LEFT(d.kd_rek5,3)='522' AND b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan,d.real_spj,0)) AS rbbj,
							SUM(IF(LEFT(d.kd_rek5,3)='523' AND b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan,d.real_spj,0)) AS rbm,
							SUM(IF(LEFT(d.kd_rek5,2)='52' AND b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan,d.real_spj,0)) AS rjumlah
							FROM trdrka a JOIN trskpd b ON a.kd_kegiatan=b.kd_kegiatan
							LEFT JOIN m_giat c ON b.kd_kegiatan1 = c.kd_kegiatan 
							LEFT JOIN realisasi_bulan d ON a.kd_skpd=d.kd_skpd AND a.kd_kegiatan=d.kd_kegiatan AND a.kd_rek5=d.kd_rek5
							WHERE a.kd_skpd='$skpdx' AND LEFT(b.kd_kegiatan,18)='$kode1' AND
							SUBSTR(b.kd_program,17,2) ='$kodex' GROUP BY  b.kd_kegiatan,c.nm_kegiatan ORDER BY kode";
								$query2 = $this->db->query($sql3);
                                                  
							foreach ($query2->result() as $row2)
							{
								$kode2=$row2->kode;
								$nama2=$row2->nama;
								$pend2=number_format($row2->bpeg,"2",",",".");
								$btl2= number_format($row2->bbj,"2",",",".");
								$bl2= number_format($row2->bm,"2",",",".");
								$jum2= number_format($row2->jumlah,"2",",",".");
								$rpend2=number_format($row2->rbpeg,"2",",",".");
								$rbtl2= number_format($row2->rbbj,"2",",",".");
								$rbl2= number_format($row2->rbm,"2",",",".");
								$rjum2= number_format($row2->rjumlah,"2",",",".");

								$cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\">$kode2</td>                                     
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"39%\">$nama2</td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$pend2</td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$btl2</td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$bl2</td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$jum2</td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rpend2</td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rbtl2</td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rbl2</td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rjum2</td>
											</tr>
											 ";
							}
								
						$cRet    .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\">&nbsp;</td>                                     
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"39%\">&nbsp;</td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									</tr>";

								

						}
					
						
                  }  
				  $sqly="SELECT 
						a.kd_urusan1 AS kode, 
						a.nm_urusan1 AS nama,
						SUM(IF(LEFT(c.kd_rek5,3)='521',c.anggaran,0)) AS bpeg,
						SUM(IF(LEFT(c.kd_rek5,3)='522',c.anggaran,0)) AS bbj,
						SUM(IF(LEFT(c.kd_rek5,3)='523',c.anggaran,0)) AS bm,
						SUM(IF(LEFT(c.kd_rek5,2)='52',c.anggaran,0))  AS jumlah,
						SUM(IF(LEFT(c.kd_rek5,3)='521',c.real_spj,0)) AS rbpeg,
						SUM(IF(LEFT(c.kd_rek5,3)='522',c.real_spj,0)) AS rbbj,
						SUM(IF(LEFT(c.kd_rek5,3)='523',c.real_spj,0)) AS rbm,
						SUM(IF(LEFT(c.kd_rek5,2)='52',c.real_spj,0))  AS rjumlah
						FROM trdrka b 
						INNER JOIN ms_urusan1 a ON LEFT(b.kd_skpd,1)=a.kd_urusan1 
						LEFT JOIN realisasi_bulan c ON b.kd_skpd=c.kd_skpd AND b.kd_kegiatan=c.kd_kegiatan AND b.kd_rek5=c.kd_rek5
						GROUP BY  a.kd_urusan1 ,a.nm_urusan1";
					$queryxy=$this->db->query($sqly);
					$tot1=0; $tot2=0; $tot3=0; $tot4=0;$tot5=0; $tot6=0; $tot7=0; $tot8=0;
					foreach($queryxy->result() as $rowxy){
								$pendxy=$rowxy->bpeg;
								$btlxy= $rowxy->bbj;
								$blxy= $rowxy->bm;
								$jumxy= $rowxy->jumlah;
								$rpendxy=$rowxy->rbpeg;
								$rbtlxy= $rowxy->rbbj;
								$rblxy= $rowxy->rbm;
								$rjumxy= $rowxy->rjumlah;
							$tot1=$tot1 + $pendxy;
							$tot2=$tot2 + $btlxy;
							$tot3=$tot3 + $blxy;
							$tot4=$tot4 + $jumxy;
							$tot5=$tot5 + $rpendxy;
							$tot6=$tot6 + $rbtlxy;
							$tot7=$tot7 + $rblxy;
							$tot8=$tot8 + $rjumxy;
						
						
					}
				  
				  
				  
				  $cRet    .= "<tr>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\"></td>    
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"34%\" align=\"center\"><b>Jumlah</b></td>                                     
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($tot1,2,',','.')."</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($tot2,2,',','.')."</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($tot3,2,',','.')."</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($tot4,2,',','.')."</b></td>
									  <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($tot5,2,',','.')."</b></td>
									  <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($tot6,2,',','.')."</b></td>
									  <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($tot7,2,',','.')."</b></td>
									  <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($tot8,2,',','.')."</b></td>
							</tr>";

        $cRet .=       " </table>";
		$date=date('Y-m-t');
        $cRet .= "<br><table width=\"100%\" border=\"0\" cellpading = \"8\">
                                <tr>
                                    <td width=\"60%\" align=\"left\">&nbsp;<br>&nbsp;
                                        <br>&nbsp;
                                        &nbsp;<br>
                                        &nbsp;<br>
                                        &nbsp;<br>
                                        &nbsp;	
                                    </td>
                                    <td width=\"40%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($date)."
                                        <p><b>$jabatan</b></p>
                                        <p>&nbsp;</p>
                                        <br><br>
                                        <br><b><u>$namapa</u></b>
                                        <br>$nip</b>
                                    </td>
                                </tr>";
         $cRet .=       "                 </table>";
        $data['prev']= $cRet;
        $this->template->set('title', 'CETAK PERDA LAMPIRAN IV');        
        //$this->_mpdf('',$cRet,10,10,10,1,'',$hal);
        //$this->template->load('template','anggaran/rka/perdaIV',$data);
        switch($cetak) {
        case 0;
           // $this->template->load('template','anggaran/rka/perkadaII',$data);
        break;
        case 1;
		     $hal=1;
            $this->tukd_model->_mpdf('',$cRet,10,10,10,'L');
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= PerdaIV.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        
        }
        
    }

    function lampiran_V(){
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/perda_real_v', $data);
    }

    function cetak_perdaV_real($cetak=''){
	   $skpd=$this->session->userdata('kdskpd');
       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang, no_qanun, tgl_qanun, no_perbup, tgl_perbup, bupati FROM sclient";
		 $sqlsclient=$this->db->query($sqlsc);
		 foreach ($sqlsclient->result() as $rowsc)
		{
		   
			$tgl     = $rowsc->tgl_rka;
			$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
			$kab     = $rowsc->kab_kota;
			$daerah  = $rowsc->daerah;
			$thn     = $rowsc->thn_ang;
			
			$bupati     = $rowsc->bupati;
			$no_qanun   = $rowsc->no_qanun;
			$tgl_qanun  = $this->tukd_model->tanggal_format_indonesia($rowsc->tgl_qanun);
			$no_perbup  = $rowsc->no_perbup;
			$tgl_perbup = $rowsc->tgl_perbup;
			
		} 
		$sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='1.20.05.00' and kode='KD'");
		foreach($sqlttd->result() as $rowtd){
			$nip=$rowtd->nip;
			$namapa=$rowtd->nama;
			$jabatan=$rowtd->jabatan;
		}
        $cRet='';
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
                         <td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"10%\"><strong><h5>LAMPIRAN V  :</h6></strong></td>
                         <td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>PERATURAN DAERAH</strong></h5></td>
                    </tr>
                    <tr> 
                         <td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>: $no_qanun</h5></td>
                    </tr>
                    <tr>
                        <td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>: $tgl_qanun</h5></td>
                    </tr>
                                         
                   
                  </table>
				<br>";
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>REKAPITULASI REALISASI BELANJA DAERAH UNTUK KESELARASAN DAN KETERPADUAN URUSAN PEMERINTAHAN DAERAH DAN FUNGSI DALAM KERANGKA PENGELOLAAN KEUANGAN NEGARA </strong></td>
                    </tr>
                    
                    <tr>
                         <td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>

                  </table><br>";  
        
        $cRet .= "<table style=\"border-collapse:collapse; font-size:14;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"8%\" align=\"center\"><b>Kode</b></td>                            
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"28%\" align=\"center\"><b>Uraian</b></td>                            
                            <td colspan=\"4\" bgcolor=\"#CCCCCC\" width=\"39%\" align=\"center\"><b>Jenis Belanja</b></td>
							<td colspan=\"4\" bgcolor=\"#CCCCCC\" width=\"39%\" align=\"center\"><b>Realisasi Belanja</b></td>
                            </tr>
                        <tr>
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Pegawai</b></td>
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Barang dan Jasa</b></td>
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Modal</b></td>
							 <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Jumlah</b></td>
							  <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Pegawai</b></td>
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Barang dan Jasa</b></td>
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Modal</b></td>
							 <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Jumlah</b></td>
                        </tr>  
						<tr>
							<td bgcolor=\"#CCCCCC\" width=\"8%\" align=\"center\">1</td>   
                            <td bgcolor=\"#CCCCCC\" width=\"28%\" align=\"center\">2</td> 
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">3</td>
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">4</td>
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">5</td>
							 <td  bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">6 = 3+4+5</td>
							 <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">7</td>
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">8</td>
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">9</td>
							 <td  bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">10 = 7+8+9</td>
                        </tr> 
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>     
                         </tr>
                    </tfoot>";
                 $sql1="   SELECT 
							a.kd_fungsi AS kode, 
							a.nm_fungsi AS nama,
							SUM(IF(LEFT(b.kd_rek5,3)='521',b.anggaran,0)) AS bpeg,
							SUM(IF(LEFT(b.kd_rek5,3)='522',b.anggaran,0)) AS bbj,
							SUM(IF(LEFT(b.kd_rek5,3)='523',b.anggaran,0)) AS bm,
							SUM(IF(LEFT(b.kd_rek5,2)='52',b.anggaran,0))  AS jumlah,
							SUM(IF(LEFT(b.kd_rek5,3)='521',b.real_spj,0)) AS rbpeg,
							SUM(IF(LEFT(b.kd_rek5,3)='522',b.real_spj,0)) AS rbbj,
							SUM(IF(LEFT(b.kd_rek5,3)='523',b.real_spj,0)) AS rbm,
							SUM(IF(LEFT(b.kd_rek5,2)='52',b.real_spj,0))  AS rjumlah
							FROM realisasi_bulan b 
							INNER JOIN ms_skpd c ON c.kd_skpd=b.kd_skpd
							LEFT JOIN ms_fungsi a ON a.kd_fungsi=c.kd_fungsi 
							GROUP BY  a.kd_fungsi , a.nm_fungsi ORDER BY kode";
                 
                 $query = $this->db->query($sql1);
                 //$query = $this->skpd_model->getAllc();
                 $coba=0;$tot1=0;$tot2=0;$tot3=0;$tot4=0;$tot5=0;$tot6=0;$tot7=0;$tot8=0;                                 
                foreach ($query->result() as $row)
                {
                    $kode=$row->kode;
                    $nama=$row->nama;
                 
					 $bpegx= $row->bpeg;
					 $bbjx= $row->bbj;
					 $bmx= $row->bm;
					 $jumx= $row->jumlah;
					 $rbpegx= $row->rbpeg;
					 $rbbjx= $row->rbbj;
					 $rbmx= $row->rbm;
					 $rjumx= $row->rjumlah;
						
				$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"8%\" align=\"left\"><b>&nbsp;</b></td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"28%\"><b>&nbsp;</b></td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>&nbsp;</b></td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>&nbsp;</b></td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>&nbsp;</b></td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>&nbsp;</b></td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>&nbsp;</b></td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>&nbsp;</b></td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>&nbsp;</b></td>
							 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>&nbsp;</b></td>
						</tr>
							 ";
                        
				   $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"8%\" align=\"left\"><b>$kode</b></td>      
							 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"28%\"><b>$nama</b></td>
							 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($bpegx,2,',','.')."</b></td>
							 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($bbjx,2,',','.')."</b></td>
							 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($bmx,2,',','.')."</b></td>
							 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($jumx,2,',','.')."</b></td>
							 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($rbpegx,2,',','.')."</b></td>
							 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($rbbjx,2,',','.')."</b></td>
							 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($rbmx,2,',','.')."</b></td>
							 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($rjumx,2,',','.')."</b></td>
						</tr>
							 ";
									 
						 $sql2="SELECT b.kd_urusan AS kode,b.nm_urusan AS nama,
								SUM(IF(LEFT(d.kd_rek5,3)='521',d.anggaran,0))AS bpeg,
								SUM(IF(LEFT(d.kd_rek5,3)='522',d.anggaran,0))AS bbj,
								SUM(IF(LEFT(d.kd_rek5,3)='523',d.anggaran,0))AS bm,
								SUM(IF(LEFT(d.kd_rek5,2)='52',d.anggaran,0)) AS jumlah,
								SUM(IF(LEFT(d.kd_rek5,3)='521',d.real_spj,0))AS rbpeg,
								SUM(IF(LEFT(d.kd_rek5,3)='522',d.real_spj,0))AS rbbj,
								SUM(IF(LEFT(d.kd_rek5,3)='523',d.real_spj,0))AS rbm,
								SUM(IF(LEFT(d.kd_rek5,2)='52',d.real_spj,0)) AS rjumlah
								FROM ms_fungsi a  
								INNER JOIN ms_urusan b ON a.kd_fungsi=b.kd_fungsi 
								INNER JOIN ms_skpd c ON c.kd_urusan=b.kd_urusan 
								LEFT JOIN realisasi_bulan d ON c.kd_skpd=d.kd_skpd 
								WHERE a.kd_fungsi='$kode' GROUP BY b.kd_urusan ORDER BY a.kd_fungsi,b.kd_urusan
								";
                 
							 $query2 = $this->db->query($sql2);
							
															  
							foreach ($query2->result() as $row2)
							{
								$kode1=$row2->kode;
								$nama1=$row2->nama;
								$bpeg1= number_format($row2->bpeg,"2",",",".");
								$bbj1= number_format($row2->bbj,"2",",",".");
								$bm1= number_format($row2->bm,"2",",",".");
								$jum1= number_format($row2->jumlah,"2",",",".");
								$rbpeg1= number_format($row2->rbpeg,"2",",",".");
								$rbbj1= number_format($row2->rbbj,"2",",",".");
								$rbm1= number_format($row2->rbm,"2",",",".");
								$rjum1= number_format($row2->rjumlah,"2",",",".");
								
								
							 $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"8%\" align=\"left\">$kode.$kode1</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"28%\">$nama1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$bpeg1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$bbj1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$bm1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$jum1</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rbpeg1</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rbbj1</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rbm1</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rjum1</td>
									</tr>
                                     ";	
								
							}
									 
							
                                  
        
                  }  
                  
        $cRet .=       " </table>";
           $date=date('Y-m-t');
        $cRet .= "<br><table width=\"100%\" border=\"0\" cellpading = \"8\">
                                <tr>
                                    <td width=\"60%\" align=\"left\">&nbsp;<br>&nbsp;
                                        <br>&nbsp;
                                        &nbsp;<br>
                                        &nbsp;<br>
                                        &nbsp;<br>
                                        &nbsp;	
                                    </td>
                                    <td width=\"40%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($date)."
                                        <p><b>$jabatan</b></p>
                                        <p>&nbsp;</p>
                                        <br><br>
                                        <br><b><u>$namapa</u></b>
                                        <br>$nip</b>
                                    </td>
                                </tr>";
         $cRet .=       " </table>";
        $data['prev']= $cRet;
        $this->template->set('title', 'CETAK PERDA LAMPIRAN V');        
       switch($cetak) {
        case 1;
             $this->tukd_model->_mpdf('',$cRet,10,10,10,'1');
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
           $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        }        
    }

    function jur_umum(){
        $data['page_title'] = 'JURNAL UMUM';
        $this->template->set('title', 'JURNAL UMUM');
        $this->template->load('template', 'akuntansi/jur_umum', $data);
    }
    
	function jur_umum_ppkd(){
        $data['page_title'] = 'JURNAL UMUM';
        $this->template->set('title', 'JURNAL UMUM');
        $this->template->load('template', 'akuntansi/jur_umum_ppkd', $data);
    }

	function ctk_jurum(){
			$skpd 	 = $_REQUEST['skpd'];
			$dcetak  = $_REQUEST['dcetak'];
			$dcetak2 = $_REQUEST['dcetak2'];
   	        $csql11  = "select nm_skpd from ms_skpd where kd_skpd = '$skpd'"; 
            $rs1 	 = $this->db->query($csql11);
            $trh1 	 = $rs1->row();
            $lcskpd  = strtoupper ($trh1->nm_skpd);
            $tgl	 = $this->tukd_model->tanggal_format_indonesia($dcetak);
            $tgl2	 = $this->tukd_model->tanggal_format_indonesia($dcetak2);
			
            $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc){
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                }			

			$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
						<tr>
							<td colspan=\"11\" align=\"center\" style=\"border: solid 1px white;\">PEMERINTAH $kab
							</td>
						</tr>
						 <tr>
							<td colspan=\"11\" align=\"center\" style=\"border: solid 1px white;\">JURNAL UMUM
							</td>
						</tr>
						<tr>
							<td colspan=\"11\" align=\"center\" style=\"border: solid 1px white;\">$lcskpd
							</td>
						</tr>						
						<tr>
							<td colspan=\"11\" align=\"center\" style=\"border: solid 1px white;border-bottom:solid 1px black;\">PERIODE $tgl s/d $tgl2
							</td>
						</tr>";
			$cRet .="</table>";
			$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
						<thead>
						<tr>
							<td align=\"center\" width=\"10%\" bgcolor=\"#CCCCCC\" rowspan=\"2\">Tanggal</td>
							<td align=\"center\" width=\"10%\" bgcolor=\"#CCCCCC\" rowspan=\"2\">Nomor<br>Bukti</td>
							<td colspan=\"5\" width=\"15%\" bgcolor=\"#CCCCCC\" align=\"center\" rowspan=\"2\">Kode<br>Rekening</td>
							<td align=\"center\" width=\"45%\" bgcolor=\"#CCCCCC\" rowspan=\"2\">Uraian</td>
							<td align=\"center\" width=\"20%\" bgcolor=\"#CCCCCC\" colspan=\"2\">Jumlah Rp</td>
						</tr>
						<tr>
							<td align=\"center\" bgcolor=\"#CCCCCC\">Debit</td>
							<td align=\"center\" bgcolor=\"#CCCCCC\">Kredit</td>
						</tr>
						<tr>
							<td align=\"center\" bgcolor=\"#E8E3E3\">1</td>
							<td align=\"center\" bgcolor=\"#E8E3E3\">2</td>
							<td colspan=\"5\" align=\"center\" bgcolor=\"#E8E3E3\">3</td>
							<td align=\"center\" bgcolor=\"#E8E3E3\">4</td>
							<td align=\"center\" bgcolor=\"#E8E3E3\">5</td>
							<td align=\"center\" bgcolor=\"#E8E3E3\">6</td>
						</tr>
						</thead>
						<tfoot>
							<tr>
								<td colspan=\"10\" style=\"border: solid 1px white;border-top:solid 1px black;\"></td>
							</tr>
						</tfoot>";
						
		$csql1 = "select count(*) as tot FROM 
					trdju_pkd a LEFT JOIN trhju_pkd b ON a.no_voucher= b.no_voucher
					where b.tgl_voucher between '$dcetak' and '$dcetak2' and b.kd_skpd = '$skpd' and a.kd_skpd='$skpd'"; 
		$rs = $this->db->query($csql1);
		$trh = $rs->row();

		$csql = "SELECT b.tgl_voucher,a.no_voucher,a.kd_rek5,a.nm_rek5 AS nm_rek5,a.debet,a.kredit,a.rk FROM 
					trdju_pkd a LEFT JOIN trhju_pkd b ON a.no_voucher= b.no_voucher
					where b.tgl_voucher between '$dcetak' and '$dcetak2' and b.kd_skpd = '$skpd' and a.kd_skpd='$skpd'
					ORDER BY b.tgl_voucher,a.no_voucher,a.urut,a.kd_rek5";   				
			  
         $query = $this->db->query($csql);  
         $cnovoc = '';
         $lcno = 0;
         foreach($query->result_array() as $res){
			$lcno = $lcno + 1;
			if ($lcno==$trh->tot){
				$cRet .="<tr>
							<td style=\"border-bottom:none;border-top:none;\"></td>
							<td style=\"border-bottom:none;border-top:none;\"></td>
							<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],0,1)."</td>
							<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],1,1)."</td>
							<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],2,1)."</td>
							<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],3,2)."</td>
							<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],5,2)."</td>
							<td style=\"border-bottom:none;\">".$res['nm_rek5']."</td>";
							if($res['rk']=='K'){
								$cRet .=" <td style=\"border-bottom:none;\"></td>
										<td style=\"border-bottom:none;\" align=\"right\">".number_format($res['kredit'],'2',',','.')."</td>";
							}else{$cRet .="<td style=\"border-bottom:none;\" align=\"right\">".number_format($res['debet'],'2',',','.')."</td>
										   <td style=\"border-bottom:none;\"></td>";                                    
							}
				   
				   $cRet .="</tr>"; 
			}else{
					if($cnovoc==$res['no_voucher']){
						$cRet .="<tr>
							<td style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
							<td style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
							<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],0,1)."</td>
							<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],1,1)."</td>
							<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],2,1)."</td>
							<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],3,2)."</td>
							<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],5,2)."</td>
							<td style=\"border-bottom:none;\">".$res['nm_rek5']."</td>";
							if($res['rk']=='K'){
								$cRet .=" <td style=\"border-bottom:none;\"></td>
										<td style=\"border-bottom:none;\" align=\"right\">".number_format($res['kredit'],'2',',','.')."</td>";
							}else{$cRet .="<td style=\"border-bottom:none;\" align=\"right\">".number_format($res['debet'],'2',',','.')."</td>
										   <td style=\"border-bottom:none;\"></td>";                                    
							}
				   
				   $cRet .="</tr>";                    
					}else{
					$cRet .="<tr>
							<td style=\"border-bottom:none\">".$this->tukd_model->tanggal_ind($res['tgl_voucher'])."</td>
							<td style=\"border-bottom:none\">".$res['no_voucher']."</td>
							<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],0,1)."</td>
							<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],1,1)."</td>
							<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],2,1)."</td>
							<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],3,2)."</td>
							<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],5,2)."</td>
							<td style=\"border-bottom:none;\">".$res['nm_rek5']."</td>";
							if($res['rk']=='K'){
								$cRet .=" <td style=\"border-bottom:none;\"></td>
										<td style=\"border-bottom:none;\" align=\"right\">".number_format($res['kredit'],'2',',','.')."</td>";
							}else{$cRet .="<td style=\"border-bottom:none;\" align=\"right\">".number_format($res['debet'],'2',',','.')."</td>
										   <td style=\"border-bottom:none;\"></td>";                                    
							}
				   
						$cRet .="</tr>";
					}
				$cnovoc=$res['no_voucher'];
			}						
        }
			
         $cRet .=" <tr>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                    </tr>  
         </table>
         ";
		 
	$sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$skpd' and kode='PA'");
		foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
		}

	$sqlttd2=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$skpd' and kode='BK'");
		foreach($sqlttd2->result() as $ttd2){
			$nip1=empty($ttd2->nip) || $ttd2->nip== null ?'&nbsp;' :$ttd2->nip;
			$nama1=empty($ttd2->nama) || $ttd2->nama== null ?'&nbsp;' :$ttd2->nama;
			$jabatan1=empty($ttd2->jabatan) || $ttd2->jabatan== null ?'&nbsp;' :$ttd2->jabatan;
		}
	   $sqld=$this->db->query("select daerah from sclient");
	   $hasil=$sqld->row();
	   $daerah=$hasil->daerah;
		$last=date('Y-m-t',strtotime($dcetak2));
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"30%\" align=\"center\"></td>
                            <td width=\"40%\">&nbsp;</td>
                            <td width=\"30%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"30%\" align=\"center\">Mengetahui,</td>
                            <td width=\"40%\">&nbsp;</td>
                            <td width=\"30%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($last)."</td>
                        </tr>
						<tr>
							<td width=\"30%\" align=\"center\">$jabatan</td>
                            <td width=\"40%\">&nbsp;</td>
                            <td width=\"30%\" align=\"center\">$jabatan1</td>
                        </tr>
						<tr>
							<td width=\"30%\" align=\"center\"></td>
                            <td width=\"40%\">&nbsp;</td>
                            <td width=\"30%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"30%\" align=\"center\"></td>
                            <td width=\"40%\">&nbsp;</td>
                            <td width=\"30%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"30%\" align=\"center\"></td>
                            <td width=\"40%\">&nbsp;</td>
                            <td width=\"30%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"30%\" align=\"center\"><b><u>$nama</u></b></td>
                            <td width=\"40%\">&nbsp;</td>
                            <td width=\"30%\" align=\"center\"><b><u>$nama1</u></b></td>
                        </tr>
						<tr>
							<td width=\"30%\" align=\"center\"><b>$nip</b></td>
                            <td width=\"40%\">&nbsp;</td>
                            <td width=\"30%\" align=\"center\"><b>$nip1</b></td>
                        </tr>
                    </table>"; 
		$data['prev']= 'JURNAL UMUM';
        $this->tukd_model->_mpdf('',$cRet,5,5,10,'0');
	} 	

    function ctk_jurum_ppkd($dcetak = '', $dcetak2 = '', $skpd = ''){
        $csql11 = " select nm_skpd from ms_skpd where kd_skpd = '$skpd'";
        $rs1 = $this->db->query($csql11);
        $trh1 = $rs1->row();
        $lcskpd = strtoupper($trh1->nm_skpd);
        $tgl_cetak = $this->tukd_model->rev_date($dcetak);
        $tgl_cetak2 = $this->tukd_model->rev_date($dcetak2);

		$cRet ='';

        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
            <tr>
                <td colspan=\"11\" align=\"center\" style=\"border: solid 1px white;\"><b>PPKD</b>
                </td>
            </tr>
             <tr>
                <td colspan=\"11\" align=\"center\" style=\"border: solid 1px white;\"><b>JURNAL UMUM</b>
                </td>
            </tr>
            <tr>
                <td colspan=\"11\" align=\"center\" style=\"border: solid 1px white;\">PERIODE $tgl_cetak S.D $tgl_cetak2
                </td>
            </tr>
			</table><br>";
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
			<thead>
            <tr>
                <td align=\"center\" bgcolor=\"#CCCCCC\" rowspan=\"2\">Tanggal</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" rowspan=\"2\">Nomor<br>Bukti</td>
                <td colspan=\"5\" bgcolor=\"#CCCCCC\" align=\"center\" rowspan=\"2\">Kode<br>Rekening</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" rowspan=\"2\">Uraian</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" rowspan=\"2\">ref</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\" colspan=\"2\">Jumlah Rp</td>
            </tr>
            <tr>
                <td align=\"center\" bgcolor=\"#CCCCCC\">Debit</td>
                <td align=\"center\" bgcolor=\"#CCCCCC\">Kredit</td>
            </tr>

            <tr>
                <td align=\"center\" bgcolor=\"#EBEBEB\" width=\"10%\">1</td>
                <td align=\"center\" bgcolor=\"#EBEBEB\" width=\"10%\">2</td>
                <td colspan=\"5\" bgcolor=\"#EBEBEB\" align=\"center\" width=\"15%\">3</td>
                <td align=\"center\" bgcolor=\"#EBEBEB\" width=\"42%\">4</td>
                <td align=\"center\" bgcolor=\"#EBEBEB\" width=\"3%\"></td>
                <td align=\"center\" bgcolor=\"#EBEBEB\" width=\"10%\">5</td>
                <td align=\"center\" bgcolor=\"#EBEBEB\" width=\"10%\">6</td>
            </tr>
			</thead>
			<tfoot>
				<tr>
					<td colspan=\"11\" style=\"border:solid 1px white;border-top:solid 1px black;\"></td>
				</tr>
			</tfoot>
           ";
		if($skpd=='1.20.05.01'){
			$csql1 = "select count(*) as tot FROM 
					 trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher= b.no_voucher and a.kd_skpd=b.kd_skpd
					 where b.tgl_voucher between '$dcetak' and '$dcetak2' and b.kd_skpd = '$skpd'";
			$rs = $this->db->query($csql1);
			$trh = $rs->row();


			$csql = "SELECT b.tgl_voucher,a.no_voucher,a.kd_rek5,CONCAT(a.nm_rek5,IF(pos='0',' *','')) AS nm_rek5,a.debet,a.kredit FROM 
					  trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher= b.no_voucher and a.kd_skpd=b.kd_skpd
					  where b.tgl_voucher between '$dcetak' and '$dcetak2' and b.kd_skpd = '$skpd' 
					  ORDER BY b.tgl_voucher,a.no_voucher,a.urut,a.rk,a.kd_rek5";
			$query = $this->db->query($csql);
		}else{
			$csql1 = "select count(*) as tot FROM 
					 trdju_ppkd a INNER JOIN trhju_ppkd b ON a.no_voucher= b.no_voucher and a.kd_skpd=b.kd_skpd
					 where b.tgl_voucher between '$dcetak' and '$dcetak2' and b.kd_skpd = '$skpd'";
			$rs = $this->db->query($csql1);
			$trh = $rs->row();


			$csql = "SELECT b.tgl_voucher,a.no_voucher,a.kd_rek5,CONCAT(a.nm_rek5,IF(pos='0',' *','')) AS nm_rek5,a.debet,a.kredit FROM 
					  trdju_ppkd a INNER JOIN trhju_ppkd b ON a.no_voucher= b.no_voucher and a.kd_skpd=b.kd_skpd
					  where b.tgl_voucher between '$dcetak' and '$dcetak2' and b.kd_skpd = '$skpd' 
					  ORDER BY b.tgl_voucher,a.no_voucher,a.urut,a.rk,a.kd_rek5";
			$query = $this->db->query($csql);		
		}
        $cnovoc = '';
        $lcno = 0;
        foreach ($query->result_array() as $res)
        {
            $lcno = $lcno + 1;
            if ($lcno == $trh->tot)
            {
                $cRet .= "<tr>
                                <td style=\"border-bottom:none;border-top:none;\"></td>
                                <td style=\"border-bottom:none;border-top:none;\"></td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                    0, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                    1, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                    2, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                    3, 2) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                    5, 2) . "</td>
                                <td style=\"border-bottom:none;\">" .$res['nm_rek5'].
                    "</td>
                                <td style=\"border-bottom:none;\"></td>";
                if ($res['debet'] == 0)
                {
                    $cRet .= " <td style=\"border-bottom:none;\"></td>
                                            <td style=\"border-bottom:none;\" align=\"right\">" .
                        number_format($res['kredit'],2,',','.') . "</td>";
                } else
                {
                    $cRet .= "<td style=\"border-bottom:none;\" align=\"right\">" . number_format($res['debet'],2,',','.') .
                        "</td>
                                               <td style=\"border-bottom:none;\"></td>";
                }

                $cRet .= "</tr>";
            } else
            {
                if ($cnovoc == $res['no_voucher'])
                {
                    $cRet .= "<tr>
                                <td style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                                <td style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        0, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        1, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        2, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        3, 2) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        5, 2) . "</td>
                                <td style=\"border-bottom:none;\">" .$res['nm_rek5'].
                        "</td>
                                <td style=\"border-bottom:none;\"></td>";
                    if ($res['debet'] == 0)
                    {
                        $cRet .= " <td style=\"border-bottom:none;\"></td>
                                            <td style=\"border-bottom:none;\" align=\"right\">" .
                            number_format($res['kredit'],2,',','.') . "</td>";
                    } else
                    {
                        $cRet .= "<td style=\"border-bottom:none;\" align=\"right\">" . number_format($res['debet'],2,',','.') .
                            "</td>
                                               <td style=\"border-bottom:none;\"></td>";
                    }

                    $cRet .= "</tr>";
                } else
                {
                    $cRet .= "<tr>
                                <td style=\"border-bottom:none\">" . $this->
                        tukd_model->rev_date($res['tgl_voucher']) . "</td>
                                <td style=\"border-bottom:none\">" . $res['no_voucher'] .
                        "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        0, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        1, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        2, 1) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        3, 2) . "</td>
                                <td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],
                        5, 2) . "</td>
                                <td style=\"border-bottom:none;\">" .$res['nm_rek5'].
                        "</td>
                                <td style=\"border-bottom:none;\"></td>";
                    if ($res['debet'] == 0)
                    {
                        $cRet .= " <td style=\"border-bottom:none;\"></td>
                                            <td style=\"border-bottom:none;\" align=\"right\">" .
                            number_format($res['kredit'],2,',','.') . "</td>";
                    } else
                    {
                        $cRet .= "<td style=\"border-bottom:none;\" align=\"right\">" . number_format($res['debet'],2,',','.') .
                            "</td>
                                               <td style=\"border-bottom:none;\"></td>";
                    }

                    $cRet .= "</tr>";
                }
                $cnovoc = $res['no_voucher'];
            }

        }

        $cRet .= " <tr>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                        <td style=\"border-top:none\"></td>
                    </tr>  
         </table>
         ";

        $data['prev'] = 'JURNAL UMUM PPKD';
        $this->tukd_model->_mpdf('', $cRet, 5, 5, 10, '0');

    }

    function cetak_lak(){
        $data['page_title'] = 'LAPORAN ARUS KAS';
        $this->template->set('title', 'LAPORAN ARUS KAS');
        $this->template->load('template', 'akuntansi/cetak_lak', $data);
    }

	
	
	function rpt_lak($cetak = 1){
        //$thi = $this->session->userdata('pcThang');
		$thi = '2016';
        $thl = $thi - 1;
       $cetak=$this->uri->segment(3);


        $cRet = '<TABLE width="100%">
					<TR>
						<TD align="center" ><b>PEMERINTAH KABUPATEN BIAK NUMFOR</b></TD>
					</TR>
					<TR>
						<TD align="center" ><b>LAPORAN ARUS KAS</b></TD>
					</TR>
					<TR>
						<TD align="center" ><b>TAHUN ANGGARAN ' . $thi .'</b></TD>
					</TR>
					</TABLE><br>';

 
$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
<thead>                       
<tr><td bgcolor=\"#CCCCCC\" width=\"1%\" align=\"center\"><b>NO</b></td>                            
<td bgcolor=\"#CCCCCC\" width=\"69%\" align=\"center\"><b>URAIAN</b></td>
<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>" . $thi . "</b></td>
<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>" . $thl . "</b></td>




</thead>
<tfoot>
<tr>
<td style=\"border-top: none;\"></td>
<td style=\"border-top: none;\"></td>
<td style=\"border-top: none;\"></td>
<td style=\"border-top: none;\"></td>
</tr>
</tfoot>";






     

        //level 1
        $idx = 0;
        $query = $this->db->query(" SELECT * FROM rg_lak  ORDER BY seq ");
        foreach ($query->result_array() as $res)
        {
            $idx++;
            $no = $res['nor'];
            $uraian = $res['uraian'];
            $seq = $res['seq'];
            $parent = $res['parent'];
            $bold = $res['bold'];
            $nl = $res['nilai'];
            $sblm = $res['nilai_lalu'];
            if (trim($parent) == '')
                $parent = 'xxx';

            if ($bold == '1')
            {
				if($nl<0){
					$nil = $nl * -1;
					$nilai = "(".number_format($nil,2).")";
				}else{
					$nilai = number_format($nl,2);
				}
				
				if($sblm<0){
					$bl = $sblm * -1;
					$nilai_sblm = "(".number_format($bl,2).")";
				}else{
					$nilai_sblm = number_format($sblm,2);
				}
				
				$cRet .= "<TR>
			<TD  style=\"font-size:12px;border-bottom:none;border-top:none\" align=\"right\" >" . $idx . "</TD>
			<TD style=\"font-size:12px;border-bottom:none;border-top:none\" align=\"left\" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;" . $uraian . "</TD>
							<TD style=\"font-size:12px;border-bottom:none;border-top:none\" align=\"right\" >" . $nilai . "</TD>
							<TD style=\"font-size:12px;border-bottom:none;border-top:none\" align=\"right\" >" . $nilai_sblm . "</TD>
							
						 </TR>";
            }
			elseif ($bold == '6')
            {
                $cRet .= '<TR>

                <TD  style="font-size:12px" align="right" >' . $idx . '</TD>
							<TD style="font-size:12px" style="font-size:12px"   align="left" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>' . $uraian .'</b></TD>                
							<TD style="font-size:12px" style="font-size:12px"   align="right" ></TD>
							<TD style="font-size:12px" style="font-size:12px"   align="right" ></TD>
							
						 </TR>';
            }elseif ($bold == '2')
            {
                if($nl<0){
					$nil = $nl * -1;
					$nilai = "(".number_format($nil,2).")";
				}else{
					$nilai = number_format($nl,2);
				}
				
				if($sblm<0){
					$bl = $sblm * -1;
					$nilai_sblm = "(".number_format($bl,2).")";
				}else{
					$nilai_sblm = number_format($sblm,2);
				}
				
				$cRet .= '<TR>
				<TD   style="font-size:12px"  align="right" >' . $idx . '</TD>
							<TD  style="font-size:12px"  align="left" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>' . $uraian .'</b></TD>                
							<TD  style="font-size:12px"  align="right" ><b>' . $nilai . '</b></TD>
								<TD style="font-size:12px"   align="right" ><b>' . $nilai_sblm . '</b></TD>
						 </TR>';
            }elseif ($bold == '4')
            {
				if($nl<0){
					$nil = $nl * -1;
					$nilai = "(".number_format($nil,2).")";
				}else{
					$nilai = number_format($nl,2);
				}
				
				if($sblm<0){
					$bl = $sblm * -1;
					$nilai_sblm = "(".number_format($bl,2).")";
				}else{
					$nilai_sblm = number_format($sblm,2);
				}
				
                $cRet .= '<TR>
                	<TD  style="font-size:12px" align="right" >' . $idx . '</TD>
							<TD style="font-size:12px"  align="left" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>' . $uraian .'</b></TD>
							<TD  style="font-size:12px" align="right" ><b>' . $nilai . '</b></TD>
							<TD  style="font-size:12px" align="right" ><b>' . $nilai_sblm . '</b></TD>
						 </TR>';

            } elseif ($bold == '5')
            {

                $cRet .= '<TR>
                <TD  style="font-size:12px"  align="right" >' . $idx . '</TD>
							<TD style="font-size:12px"   align="left" ><b>' . $uraian . '</b></TD>
							<TD  style="font-size:12px"  align="right" ></TD>
							<TD  style="font-size:12px"  align="right" ></TD>
						 </TR>';

            } elseif ($bold == '3')
            {
                if($nl<0){
					$nil = $nl * -1;
					$nilai = "(".number_format($nil,2).")";
				}else{
					$nilai = number_format($nl,2);
				}
				
				if($sblm<0){
					$bl = $sblm * -1;
					$nilai_sblm = "(".number_format($bl,2).")";
				}else{
					$nilai_sblm = number_format($sblm,2);
				}
				
				$cRet .= '<TR>
				<TD  style="font-size:12px"   align="right" >' . $idx . '</TD>
							<TD   style="font-size:12px"  align="left" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>' . $uraian . '</b></TD>
							<TD  style="font-size:12px"  align="right" ><b>' . $nilai . '</b></TD>
					<TD   style="font-size:12px" align="right" ><b>' . $nilai_sblm . '</b></TD>
						 </TR>';
			
            } elseif ($bold == '')
            {
                $cRet .= '<TR>
							<TD style="font-size:12px" align="left" >&nbsp;</TD>
							<TD style="font-size:12px" align="right" >&nbsp;</TD>
							<TD style="font-size:12px" align="center" >&nbsp;</TD>
							<TD style="font-size:12px" align="center" >&nbsp;</TD>
						 </TR>';
            }
        }

        $cRet .= '</TABLE>';
        
		$data['prev']= $cRet;   
  switch($cetak) {        
        case 1;
        $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename=register_spM.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        
        }
    }
    
	
	
	
	function cetak_neraca(){
        $data['page_title'] = 'LAPORAN NERACA';
        $this->template->set('title', 'LAPORAN NERACA');
        $this->template->load('template', 'akuntansi/cetak_neraca', $data);
    }
    
    function cetak_neraca_ppkd(){
        $data['page_title'] = 'LAPORAN NERACA';
        $this->template->set('title', 'LAPORAN NERACA');
        $this->template->load('template', 'akuntansi/cetak_neraca_ppkd', $data);
    }

    
  	function rpt_neraca_ppkd($cetak=1){
	        $skpd     = $this->session->userdata('kdskpd');
			$thi      = $this->session->userdata('pcThang');
            $th1      = $thi-1;
            $bul      = $_REQUEST['tgl1'];
            $bulan    = $this->tukd_model->getBulan($bul); 
            $tgl_ttd  = $_REQUEST['tgl_ttd'];  
            	$thn_ang      = $this->session->userdata('pcThang');
            
            $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
                            
            $lastmoth = $thn.'-'.$bul.'-'.'01';
            $lastyear = date('Y-m-t',strtotime($lastmoth)); 
            $str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));               
             
            $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk 
                        FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$skpd'";
                     $sqlskpd=$this->db->query($sqldns);
                     foreach ($sqlskpd->result() as $rowdns)
                    {
                        $kd_urusan=$rowdns->kd_u;                    
                        $nm_urusan= $rowdns->nm_u;
                        $kd_skpd  = $rowdns->kd_sk;
                        $nm_skpd  = $rowdns->nm_sk;
                    }             
            
			$cRet ='<TABLE width="100%">
                    <tr>        
						<td align="center" ><b>PEMERINTAH '.$kab.'</b></td>
					</tr>
					<tr>
						<td align="center" ><b>PPKD</b></td>
					</tr>                    
					<TR>
						<TD align="center" ><b>LAPORAN NERACA</b></TD>
					</TR>
					<TR>
						<TD align="center" ><b>PER '.$str.' dan '.$th1.'</b></TD>
					</TR>
					</TABLE><br><br><br>';


			$cRet .='<TABLE border="1" cellspacing="0" cellpadding="0" width="100%" >
					 <thead>
                     <TR>
                        <TD width="5%" align="center" ><b>NO</b></TD>
						<TD width="45%" align="center" ><b>URAIAN</b></TD>
						<TD width="25%" align="center" ><b>'.$thi.'</b></TD>
						<TD width="25%" align="center" ><b>'.$th1.'</b></TD>
					 </TR>
                     </thead>
                     <tfoot>
                     <TR>
                        <TD width="5%" align="center" ><b></b></TD>
						<TD width="45%" align="center" ><b></b></TD>
						<TD width="25%" align="center" ><b></b></TD>
						<TD width="25%" align="center" ><b></b></TD>
					 </TR>
					
				</tfoot>';
				
				$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                    </tr>";
			//aset
			$total_aset_lncr = 0;
			$total_aset_lncr_llu = 0;	
			$total_inves_per = 0;
			$total_inves_per_llu = 0;								
			$total_inves_nonper = 0;
			$total_inves_nonper_llu = 0;
			$total_dana = 0;
			$total_dana_llu =0;
			$total_aset_lain =0;
			$total_aset_lain_ll = 0;
			$total_inves_jkpjg = 0;		
			$total_inves_jkpjg_lalu	= 0;		
			
			//kewajiban			
			$total_kew_jpen = 0;
			$total_kew_jpen_llu = 0;
			$total_kew_jpan = 0;
			$total_kew_jpan_llu = 0;
			$total_kew = 0;
			$total_kew_llu =0;
			$total_ekui = 0;
			$total_ekui_llu = 0;
			$total_kew_ek = 0;
			$total_kew_ek_llu = 0;
			
			$query = $this->db->query("SELECT * FROM map_neraca_ppkd  ORDER BY kode");  
			foreach($query->result_array() as $res){
				
				$kode   = $res['kode'];
				$uraian = $res['uraian'];
				$seq    = $res['seq'];
				$parent = $res['parent'];
				$normal = $res['normal'];
				$nilai_lalu = $res['nilai_lalu'];				
				$kode_1 = $res['kode_1'];
				$bold = $res['bold'];						
								
			switch ($bold){
                case 4:
				
					$cek_kd5 = strlen($kode_1);
					if ($cek_kd5=='5'){
							$q = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
							ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd AND a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$skpd' and (month(b.tgl_voucher)<='$bul' OR tgl_voucher='2015-12-31') AND
							LEFT(kd_rek5,3) IN (".$kode_1.")");

							$qlalu = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
							ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd AND a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$skpd' and tgl_voucher='2015-12-31' and
							LEFT(kd_rek5,3) IN (".$kode_1.")");

					}else if ($cek_kd5=='4'){
							


							$q = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
							ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd AND a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$skpd' and (month(b.tgl_voucher)<='$bul' OR tgl_voucher='2015-12-31') AND
							(LEFT(kd_rek5,2) IN (".$kode_1.") OR left(a.kd_rek5,1)='8' OR (left(a.kd_rek5,1)='9'))");

														$qlalu = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
							ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd AND a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$skpd' and tgl_voucher='2015-12-31' and
							(LEFT(kd_rek5,2) IN (".$kode_1.") OR left(a.kd_rek5,1)='8' OR (left(a.kd_rek5,1)='9'))");


					}
					else if ($cek_kd5=='7'){

						$q = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
							ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd AND a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$skpd' and (month(b.tgl_voucher)<='$bul' OR tgl_voucher='2015-12-31') AND
							LEFT(kd_rek5,5) IN (".$kode_1.")");

							$qlalu = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
							ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd AND a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$skpd' and tgl_voucher='2015-12-31' and
							LEFT(kd_rek5,5) IN (".$kode_1.")");





					}else if ($cek_kd5=='9'){
							$q = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
							ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd AND a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$skpd' and (month(b.tgl_voucher)<='$bul' OR tgl_voucher='2015-12-31') AND
							LEFT(kd_rek5,7) IN (".$kode_1.")");


														$qlalu = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
							ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd AND a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$skpd' and tgl_voucher='2015-12-31' and
							LEFT(kd_rek5,7) IN (".$kode_1.")");

					}											
				
				 foreach($q->result_array() as $r){
					$debet  = $r['debet'];
					$kredit = $r['kredit'];
				 }

				 	 foreach($qlalu->result_array() as $rlalu){
					$debetlalu  = $rlalu['debet'];
					$kreditlalu = $rlalu['kredit'];
				 }
				
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;


				if ($debetlalu=='') $debetlalu=0;
				if ($kreditlalu=='') $kreditlalu=0;

				if ($normal=='D'){
					$nilai=$debet-$kredit;

					$nilailaluaaa=$debetlalu-$kreditlalu;
				}else{
					$nilai=$kredit-$debet;

					$nilailaluaaa=$kreditlalu-$debetlalu;				
				}
                
                $nil= number_format($nilai,2);
				$nil_lalu = number_format($nilailaluaaa,2);	
									
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\">$uraian</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\">$nil</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\">$nil_lalu</td>
                                    </tr>";
									
							if($parent=='41'){
								$total_aset_lncr = $total_aset_lncr + $nilai;
								$total_aset_lncr_llu = 	$total_aset_lncr_llu + $nilailaluaaa;
							}else if($parent=='42'){
								if($seq=='28' || $seq=='29' || $seq=='30'){
									$total_inves_per = $total_inves_per + $nilai;
									$total_inves_per_llu = $total_inves_per_llu + $nilailaluaaa;
								}else{
									$total_inves_nonper = $total_inves_nonper + $nilai;
									$total_inves_nonper_llu = $total_inves_nonper_llu + $nilailaluaaa;
								}
							}else if($parent=='44'){
								$total_dana = $total_dana + $nilai;
								$total_dana_llu = $total_dana_llu + $nilailaluaaa;
							}else if($parent=='45'){
								$total_aset_lain = $total_aset_lain + $nilai;
								$total_aset_lain_ll = $total_aset_lain_ll + $nilailaluaaa;
							}else if($parent=='46'){
								$total_kew_jpen = $total_kew_jpen + $nilai;
								$total_kew_jpen_llu = $total_kew_jpen_llu + $nilailaluaaa;
							}else if($parent=='47'){
								$total_kew_jpan = $total_kew_jpan + $nilai;
								$total_kew_jpan_llu = $total_kew_jpan_llu + $nilailaluaaa;
							}else if($parent=='48'){
								$total_ekui = $total_ekui + $nilai;
								$total_ekui_llu = $total_ekui_llu + $nilailaluaaa;
							}			
																				
							
                        break; 																					                                   
						case 3:
								
								if ($kode=='14'){
									$n_aset_lnr = number_format($total_aset_lncr,2);
									$n_aset_lnr_llu = number_format($total_aset_lncr_llu,2);
							
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_aset_lnr</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_aset_lnr_llu</b></td>
                                    </tr>";
								}else if ($kode=='22'){
									$n_invs_non = number_format($total_inves_nonper,2);
									$n_invs_non_llu = number_format($total_inves_nonper_llu,2);
							
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_invs_non</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_invs_non_llu</b></td>
                                    </tr>";
								
								}else if ($kode=='26'){
									$n_invs_per = number_format($total_inves_per,2);
									$n_invs_per_llu = number_format($total_inves_per_llu,2);
							
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_invs_per</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_invs_per_llu</b></td>
                                    </tr>";
								
								}else if ($kode=='27'){
									$total_inves_jkpjg = $total_inves_nonper + $total_inves_per;
									$total_inves_jkpjg_lalu = $total_inves_nonper_llu + $total_inves_per_llu;
									
									$ttl_inves = number_format($total_inves_jkpjg,2);
									$ttl_inves_llu = number_format($total_inves_jkpjg_lalu,2);
							
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$ttl_inves</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$ttl_inves_llu</b></td>
                                    </tr>";
								
								}else if ($kode=='31'){									
									$n_dana = number_format($total_dana,2);
									$n_dana_lalu = number_format($total_dana_llu,2);
							
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_dana</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_dana_lalu</b></td>
                                    </tr>";
								
								}else if ($kode=='39'){				
							
									$n_aset_l = number_format($total_aset_lain,2);
									$n_aset_llalu = number_format($total_aset_lain_ll,2);
							
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_aset_l</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_aset_llalu</b></td>
                                    </tr>";
								
								}else if ($kode=='41'){																				
									
									$total_asetn = $total_aset_lncr + $total_inves_jkpjg + $total_dana + $total_aset_lain;
									$total_asetn_lain = $total_aset_lncr_llu + $total_inves_jkpjg_lalu + $total_dana_llu + $total_aset_lain_ll;
									
									$n_aset_a = number_format($total_asetn,2);
									$n_aset_a_lalu = number_format($total_asetn_lain,2);
									
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_aset_a</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_aset_a_lalu</b></td>
                                    </tr>";
								
								}else if ($kode=='51'){																															
									
									$n_kew_jpen = number_format($total_kew_jpen,2);
									$n_kew_jpen_lalu = number_format($total_kew_jpen_llu,2);
									
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_kew_jpen </b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_kew_jpen_lalu</b></td>
                                    </tr>";								
								}else if ($kode=='58'){																															
												
									$n_kew_jpan = number_format($total_kew_jpan,2);
									$n_kew_jpan_lalu = number_format($total_kew_jpan_llu,2);
									
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_kew_jpan </b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_kew_jpan_lalu</b></td>
                                    </tr>";								
								}else if ($kode=='60'){																															
									
									$total_kew = $total_kew_jpen + $total_kew_jpan;
									$total_kew_llu = $total_kew_jpen_llu + $total_kew_jpan_llu;
									
									$n_kew = number_format($total_kew,2);
									$n_kew_lalu = number_format($total_kew_llu,2);
									
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_kew </b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_kew_lalu</b></td>
                                    </tr>";								
								}else if ($kode=='66'){																															
																		
									$n_ekui = number_format($total_ekui,2);
									$n_ekui_lalu = number_format($total_ekui_llu,2);
									
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_ekui</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_ekui_lalu</b></td>
                                    </tr>";								
								}else if ($kode=='68'){																															
									
									$total_kew_ek = $total_kew + $total_ekui;
									$total_kew_ek_llu = $total_kew_llu + $total_ekui_llu;			
										
									$n_kew_ek = number_format($total_kew_ek,2);
									$n_kew_ek_lalu = number_format($total_kew_ek_llu,2);
									
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_kew_ek</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_kew_ek_lalu</b></td>
                                    </tr>";								
								}
								else{
								
								$cRet    .= "
                                   <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$nil</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$nil_lalu</b></td>
                                    </tr>";							
								}
								
						break;
						case 2:
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"><b></b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                    </tr>";
						break;						
						case 1:
							  $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"><b></b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                    </tr>";
						break;
                    default:
                if($uraian <> ''){
                    $cRet    .= "
                                <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>  
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\">$uraian</td>                                   
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\">$nil</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\">$nil_lalu</td>
                                 </tr>";
                }else{
					 $cRet    .= "
                                <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\">$uraian</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                 </tr>";	
				}

                }
                
			}
            
			$cRet .='</TABLE>';	
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$skpd' and kode='PA'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td  width=\"30%\" align=\"center\"></td>
                            
                            <td colspan=\"2\" width=\"30%\">&nbsp;</td>
                        </tr>
						<tr>
							<td  width=\"30%\" align=\"center\"></td>
                            
                            <td colspan=\"2\" width=\"30%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td  width=\"30%\" align=\"center\"></td>
                            
                            <td colspan=\"2\" width=\"30%\" align=\"center\"><b>$jabatan</b></td>
                        </tr>
						<tr>
							<td width=\"30%\" align=\"center\"></td>
                            <td width=\"40%\">&nbsp;</td>
                            <td width=\"30%\">&nbsp;</td>
                        </tr>
						<tr>
							<td  width=\"30%\" align=\"center\"></td>
                            
                            <td colspan=\"2\" width=\"30%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"30%\" align=\"center\"></td>
                            <td width=\"40%\">&nbsp;</td>
                            <td width=\"30%\">&nbsp;</td>
                        </tr>
						<tr>
							<td  width=\"30%\" align=\"center\"><b></b></td>
                            
                            <td colspan=\"2\" width=\"30%\" align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td  width=\"30%\" align=\"center\"><b></b></td>
                            
                            <td colspan=\"2\" width=\"30%\" align=\"center\"><b>NIP. $nip</b></td>
                        </tr>

                    </table>";             
            	 
		 	$cetak = $this->uri->segment(3);
      
        $data['prev']= $cRet;
		$this->template->set('title', 'CETAK LO PPKD');        
        
        switch($cetak) {
        case 1;
	//		$this->tukd_model->_mpdf('',$cRet,10,10,10,'1');
            $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= neraca_ppkd.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        
        }

	}    
    
    function rpt_neraca($cetak=1){
	        
			$thi=$this->session->userdata('pcThang');
			$thl=$thi-1;
			$cRet ='<TABLE width="100%">
					<TR>
						<TD align="center" >LAPORAN NERACA</TD>
					</TR>
					<TR>
						<TD align="center" >TAHUN ANGGARAN '.$thi.'</TD>
					</TR>
					</TABLE><br>';


			$cRet .='<TABLE border="1" cellspacing="0" cellpadding="0" width="100%" >
					 <TR>
						<TD width="70%" align="center" >URAIAN</TD>
						<TD width="15%" align="center" >'.$thi.'</TD>
						<TD width="15%" align="center" >'.$thl.'</TD>
					 </TR>';
			
			//level 1
			$idx=0;
			
			
			
			
			$parent='0';
			$no='0';
			$query = $this->db->query(" SELECT * FROM map_neraca  ORDER BY kode ");  
			foreach($query->result_array() as $res){

				$idx++;				
				$no=$res['kode'];
				$uraian=$res['uraian'];
				//$seq=$res['seq'];
				$parent=$res['parent'];
				$normal=$res['normal'];

				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);

				if ($kode_1=='') $kode_1='xxx';												
				if ($kode_2=='') $kode_2='xxx';												
				if ($kode_3=='') $kode_3='xxx';												
				if ($kode_4=='') $kode_4='xxx';												
				if ($kode_5=='') $kode_5='xxx';												
				if ($kode_6=='') $kode_6='xxx';												
				if ($kode_7=='') $kode_7='xxx';												
				if ($kode_8=='') $kode_8='xxx';												
				if ($kode_9=='') $kode_9='xxx';												
				if ($kode_10=='') $kode_10='xxx';												
				if ($kode_11=='') $kode_11='xxx';												
				if ($kode_12=='') $kode_12='xxx';												
				if ($kode_13=='') $kode_13='xxx';												
				if ($kode_14=='') $kode_14='xxx';												
				if ($kode_15=='') $kode_15='xxx';												


				$q = $this->db->query(" SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher WHERE 
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%'  or 
										kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%'  or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%'  or 
										kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%'  or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or 
										kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or 
										kd_rek5 like '$kode_15%') 	");  

				 foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal=='D'){
					$nilai=$debet-$kredit;
				}else{
					$nilai=$kredit-$debet;				
				}
				if ($nilai=='') $nilai=0;

				$q = $this->db->query(" update map_neraca set  nilai=$nilai where kode='$no' ");  
				
			}




			$idx=0;			
			$query = $this->db->query(" SELECT * FROM map_neraca  ORDER BY kode ");  
			foreach($query->result_array() as $res){
				$idx++;
				$no=$res['kode'];
				$uraian=$res['uraian'];
				$seq=$res['seq'];
				$parent=$res['parent'];
				$bold=$res['bold'];
				$nl=$res['nilai'];
				$sblm=$res['nilai_lalu'];
                
                if ($nl < 0){
                    	$a="("; $nl=$nl*-1; $b=")";
                        }else {
                    	$a=""; $b="";
                        }
                //$nl =   number_format($biaya_net);

				if (trim($parent)=='') $parent='xxx';

				if ($bold=='1'){
				$cRet .='<TR>
							<TD width="70%" align="left" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'.$uraian.'</TD>
							<TD width="15%" align="right" >'.$a.''.number_format($nl).''.$b.'</TD>
							<TD width="15%" align="right" >'.number_format($sblm).'</TD>
						 </TR>';
				}elseif($bold=='2'){ 
				$cRet .='<TR>
							<TD width="70%" align="left" >&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;'.$uraian.'</TD>
							<TD width="15%" align="right" >'.$a.''.number_format($nl).''.$b.'</TD>
							<TD width="15%" align="right" >'.number_format($sblm).'</TD>
						 </TR>';
				}elseif($bold=='3'){ 
				$cRet .='<TR>
							<TD width="70%" align="left" >'.$uraian.'</TD>
							<TD width="15%" align="right" >'.$a.''.number_format($nl).''.$b.'</TD>
							<TD width="15%" align="right" >'.number_format($sblm).'</TD>
						 </TR>';

				}elseif($bold=='4'){ 
				$cRet .='<TR>
							<TD width="70%" align="left" >'.$uraian.'</TD>
							<TD width="15%" align="right" >'.$a.''.number_format($nl).''.$b.'</TD>
							<TD width="15%" align="right" >'.number_format($sblm).'</TD>
						 </TR>';

				}elseif($bold=='5'){ 
				$cRet .='<TR>
							<TD width="70%" align="left" >'.$uraian.'</TD>
							<TD width="15%" align="right" >'.$a.''.number_format($nl).''.$b.'</TD>
							<TD width="15%" align="right" >'.number_format($sblm).'</TD>
						 </TR>';

				}elseif($bold=='6'){ 
				$cRet .='<TR>
							<TD width="70%" align="left" >'.$uraian.'</TD>
							<TD width="15%" align="right" >'.$a.''.number_format($nl).''.$b.'</TD>
							<TD width="15%" align="right" >'.number_format($sblm).'</TD>
						 </TR>';

				}elseif($bold==''){ 
				$cRet .='<TR>
							<TD width="70%" align="left" >&nbsp;</TD>
							<TD width="15%" align="right" >&nbsp;</TD>
							<TD width="15%" align="center" >&nbsp;</TD>
						 </TR>';

				}
			}


			
			$cRet .='</TABLE>';		 
		    $this->tukd_model->_mpdf('',$cRet,10,5,10,'0');	
	}
    
    function ctk_neraca_saldo(){
        $thn_ang = $this->session->userdata('pcThang');
            
           
         $tgl= $_REQUEST['tgl1'];
         
         $tgl_ttd= $_REQUEST['tgl_ttd'];
                  
       
         
         $csql="SELECT a.nama, a.nip FROM ms_ttd a WHERE kode = 'BP' AND a.kd_skpd = '1.20.05.00'";
         $hasil = $this->db->query($csql);
         $trh2 = $hasil->row();          
         $lcNmBP = empty($trh2->nama) || $trh2->nama =='' ?'Belum ada Nama' :$trh2->nama ;
         $lcNipBP = empty($trh2->nip) || $trh2->nip =='' ?'Belum ada Nip' :$trh2->nip;    
		 $sqlc=$this->db->query("select * from sclient");
			foreach($sqlc->result() as $rowc){
					$kab=$rowc->kab_kota;
					$daerah= $rowc->daerah;
			}
       
            
         $cRet = '';
         $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
         
            <tr>
                <td align=\"center\" colspan=\"4\" style=\"font-size:14px;border: solid 1px white;\"><b>PEMERINTAH $kab<br>LAPORAN NERACA SALDO</b></td>
            </tr>
              <tr>
                <td align=\"left\" colspan=\"4\" style=\"font-size:12px;border: solid 1px white;\">&nbsp;</td>
            </tr>
            <tr>
                <td align=\"center\" colspan=\"4\" style=\"font-size:12px;border: solid 1px white;\"> TANGGAL : ".$this->tanggal_format_indonesia($tgl)."</td>
            </tr>
            
            <tr>
                <td align=\"left\"  style=\"font-size:12px;border: solid 1px white;border-bottom:solid 2px black;\">&nbsp;</td>
                <td align=\"left\" colspan=\"3\" style=\"font-size:12px;border: solid 1px white;border-bottom:solid 2px black;\">&nbsp;</td>
            </tr></table>";
       $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
            <thead> 
            <tr>
                <td align=\"center\" rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"10%\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black;\" >Kode Rekening</td>
                <td align=\"center\" rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"50%\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black;\">Nama Rekening</td>
                <td align=\"center\" colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"40%\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black;\">Jumlah</td>             
            </tr> 
            <tr>
                
                <td align=\"center\" width=\"20%\" bgcolor=\"#CCCCCC\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black;\">Debet</td>
                <td align=\"center\" width=\"20%\" bgcolor=\"#CCCCCC\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black;\">Kredit</td>             
            </tr> 
                   
            <tr>
                <td align=\"center\" bgcolor=\"#EBEBEB\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">1</td>
                <td align=\"center\" bgcolor=\"#EBEBEB\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">2</td>
                <td align=\"center\" bgcolor=\"#EBEBEB\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">3</td>
                <td align=\"center\" bgcolor=\"#EBEBEB\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">4</td>              
            </tr>
			 </thead> 
			 <tfoot>
				<tr>
					<td colspan=\"border:solid 1px white;border-top:solid 1px black;\"></td>
				</tr>
			 </tfoot>";
           
           


                                                       
                
                     $sql = "SELECT kd_rek64 as kd_rek5,nm_rek64 as nm_rek5,sal_n FROM ms_rek5 where left(kd_rek64,3) <> '312' group by kd_rek64 ORDER BY kd_rek5";                 
                    $hasil = $this->db->query($sql); 
                    foreach ($hasil->result() as $row)
                    {
                      
                       $kd_rek   =$row->kd_rek5 ;
                       $nama     =$row->nm_rek5;
                       $sn       =$row->sal_n;
                       
                             $sql1 = "SELECT a.kd_rek5,SUM(a.debet)AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_skpd WHERE a.kd_rek5='$kd_rek' and b.tgl_voucher <='$tgl' GROUP BY a.kd_rek5 ";
                             $hasil1 = $this->db->query($sql1); 
                            foreach ($hasil1->result() as $row1)
                            {
                             $lcdebet      =$row1->debet ;
                             $lckredit     =$row1->kredit;
                                if($sn=='0'  ) {
                                    $nilai=$lcdebet-$lckredit;
                                } else{
                                    $nilai=$lckredit-$lcdebet;
                                }
                                 if($sn=='0'  ) {
                                     $cRet .="<tr>
                                          <td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">$kd_rek</td>
                                          <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">$nama</td>
                                          <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"> ".number_format($nilai,2,',','.')."</td>
                                          <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">&nbsp;</td>
                                          </tr>";
                                } else{
                                    $cRet .="<tr>
                                          <td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">$kd_rek</td>
                                          <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">$nama</td>
                                          <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"> &nbsp;</td>
                                          <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"> ".number_format($nilai,2,',','.')."</td>
                                          </tr>";
                                }  
                               
                            }                     
                     
                    }
                 
                
        $cRet .='</table>';
                 
         $data['prev']= $cRet;    
         //$this->tukd_model->_mpdf('',$cRet,'10','10',5,'0');
         //$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, 'L');
         $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
        // echo $cRet;
    }

/* //=================mulai_neraca==================================
    function rpt_neraca_pemda(){
			$skpd	  = $this->session->userdata('kdskpd');
			$thi      = $this->session->userdata('pcThang');
            $th1      = $thi-1;
            $bul      = $_REQUEST['bulan'];
            $bulan    = $this->tukd_model->getBulan($bul); 
            $tgl_ttd  = $_REQUEST['tgl_ctk'];  
            
            $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $tgl     = $rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
                    
        $sql41 = "SELECT ifnull(SUM(b.kredit),0)-ifnull(SUM(b.debet),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,1)='8' AND MONTH(a.tgl_voucher)<='$bul'";
                    $query41    = $this->db->query($sql41);
                    $jmlp       = $query41->row();
                    $jmlpendlo  = $jmlp->nilai; 
        
        $sql51 = "SELECT ifnull(SUM(b.debet),0)-ifnull(SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,1)='9' AND MONTH(a.tgl_voucher)<='$bul'";
                    $query51    = $this->db->query($sql51);
                    $jmlb       = $query51->row();
                    $jmlbello   = $jmlb->nilai;                   
                   
        $ekuitas =  $jmlpendlo-$jmlbello;
        if ($ekuitas < 0){
                    	$x="("; 
                        $ekuitas=$ekuitas*-1; 
                        $y=")";
                        }else {
                    	$x="";
                        $ekuitas=$ekuitas*1; 
                        $y="";
                        }
        $ekuitas1= number_format($ekuitas,"2",".",",");
		
        $sql2 = "SELECT ifnull(SUM(b.kredit),0)-ifnull(SUM(b.debet),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,1)='2' AND MONTH(a.tgl_voucher)<='$bul'";
                    $query2     = $this->db->query($sql2);
                    $jmlut      = $query2->row();
                    $jmlutang   = $jmlut->nilai;
					
        $ekuitasakhir =  $ekuitas+$jmlutang;
        if ($ekuitasakhir < 0){
                    	$x="("; 
                        $ekuitasakhir=$ekuitasakhir*-1; 
                        $y=")";
                        }else {
                    	$x="";
                        $ekuitasakhir=$ekuitasakhir*1; 
                        $y="";
                        }
        $ekuitasakhir1= number_format($ekuitasakhir,"2",".",",");					
					
                                    
            $lastmoth = $thn.'-'.$bul.'-'.'01';
            $lastyear = date('Y-m-t',strtotime($lastmoth)); 
            $str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));                            
            
			$cRet ='<TABLE width="100%">
                    <tr>        
						<td align="center" ><b>PEMERINTAH '.$kab.'</b></td>
					</tr>                   
					<TR>
						<TD align="center" ><b>NERACA</b></TD>
					</TR>
					<TR>
						<TD align="center" ><b>PER '.$str.' dan '.$th1.'</b></TD>
					</TR>
					</TABLE><br>';


			$cRet .='<TABLE border="1" cellspacing="0" cellpadding="0" width="100%" >
					 <thead>
                     <TR>
                        <TD width="5%" align="center" ><b>NO</b></TD>
						<TD width="45%" align="center" ><b>URAIAN</b></TD>
						<TD width="25%" align="center" ><b>'.$thi.'</b></TD>
						<TD width="25%" align="center" ><b>'.$th1.'</b></TD>
					 </TR>
                     </thead>
                     <tfoot>
                     <TR>
                        <TD width="5%" align="center" ><b></b></TD>
						<TD width="45%" align="center" ><b></b></TD>
						<TD width="25%" align="center" ><b></b></TD>
						<TD width="25%" align="center" ><b></b></TD>
					 </TR>
					
				</tfoot>';

			$query = $this->db->query("SELECT kode,uraian,seq,normal,ifnull(kode_1,\"''\") as kode_1,nilai_lalu FROM map_neraca ORDER BY kode ");  
			foreach($query->result_array() as $res){
				
				$kode   = $res['kode'];
				$uraian = $res['uraian'];
				$seq    = $res['seq'];
				$normal = $res['normal'];
                $reallalu1 = $res['nilai_lalu'];
				$reallalu = number_format($reallalu1,"2",".",",");  
				$kode_1 = $res['kode_1'];
                
                $test1 = '';
					if($kode_1 <> ''){
						$test  = explode(',',$kode_1);
						$test1 = strlen($test[0]);
					}										

				$q = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a 
											INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
											WHERE left(a.kd_rek5,3)<>'118' and SUBSTR(a.kd_rek5,1,$test1) IN ($kode_1)
											AND MONTH(b.tgl_voucher)<='$bul'");  

				 foreach($q->result_array() as $r){
					$debet  = $r['debet'];
					$kredit = $r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal=='D'){
					$nilai=$debet-$kredit;
				}else{
					$nilai=$kredit-$debet;				
				}
                
                $nil= number_format($nilai,"2",".",",");                

    switch ($seq) {
                    case 5:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break; 
                    case 15:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break;                               
                    case 100:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                    </tr>";
                        break;
                    case 110:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break;   
                    case 115:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break;                                              
					 case 140:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                    </tr>";
                        break;
					 case 145:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break;                        
                    case 160:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"></td>
                                    </tr>";
                        break; 
                    case 165:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                    </tr>";
                        break;  
                    case 175:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break;                                                                     
                    case 215:
                        $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                    </tr>";
                        break;
                    case 225:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>  
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                   
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break; 
                    case 235:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                    </tr>";
                        break;                                               
                    case 245:
                        $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                   </tr>";
                        break;
					 case 275:
                        $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                     </tr>";
                        break;
                    case 285:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                    </tr>";
                        break;  
                    case 295:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break;  
                    case 305:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>   
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                  
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break;                                                                    
					 case 340:
                        $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                    </tr>";
                        break;
                    case 350:
                        $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                    </tr>";
                        break;
					 case 375:
                        $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                    </tr>";
                        break; 
					 case 380:
                        $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                    </tr>";
                        break; 
                    case 390:
                        $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                    </tr>";
                        break; 
                    case 395:
                        $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$x$ekuitas1$y</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$reallalu</td>
                                    </tr>";
                        break;                         
					 case 400:
                        $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"><b>$x$ekuitasakhir1$y</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"><b>$reallalu</b></td>
                                    </tr>";
                        break;                                                                                                               
                    default:
                if($uraian <> ''){
                    $cRet    .= "
                                <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>  
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$uraian</td>                                   
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nil</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$reallalu</td>
                                 </tr>";
                }else{
					 $cRet    .= "
                                <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$uraian</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";	
				}

                }
                
			}
            
        $cRet .='</table>';	
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$skpd' and kode='PPK'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">$jabatan</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>$nip</b></td>
                        </tr>

                    </table>";             
            	 
		    $this->tukd_model->_mpdf('',$cRet,10,5,10,'0');	
	}
//===============================================================
 */  
	function rpt_neraca_pemda(){
			$skpd	  = $this->session->userdata('kdskpd');
			$thi      = $this->session->userdata('pcThang');
            $th1      = $thi-1;
$thn_ang      = $this->session->userdata('pcThang');

            $bul      = $_REQUEST['bulan'];
            $bulan    = $this->tukd_model->getBulan($bul); 
            $tgl_ttd  = $_REQUEST['tgl_ctk'];  
			$cetak = $this->uri->segment(3);
            
            $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $tgl     = $rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
				
				
				
				
				
                    
        $sql41 = "SELECT ifnull(SUM(b.kredit),0)-ifnull(SUM(b.debet),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,1)='8' AND MONTH(a.tgl_voucher)<='$bul' and YEAR(tgl_voucher)='$thn_ang'";
                    $query41    = $this->db->query($sql41);
                    $jmlp       = $query41->row();
                    $jmlpendlo  = $jmlp->nilai; 
        
        $sql51 = "SELECT ifnull(SUM(b.debet),0)-ifnull(SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,1)='9' AND MONTH(a.tgl_voucher)<='$bul' and YEAR(tgl_voucher)='$thn_ang'";
                    $query51    = $this->db->query($sql51);
                    $jmlb       = $query51->row();
                    $jmlbello   = $jmlb->nilai;   




$sql3110101="SELECT IFNULL(sum(kredit)-sum(debet),0) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE MONTH(b.tgl_voucher)<='$bul' AND a.kd_rek5='3110101' and YEAR(tgl_voucher)='$thn_ang'";
$query311  = $this->db->query($sql3110101);
$j3110101     = $query311->row();
$j3110101a  = $j3110101->nilai;


//thn lalu
$sql3110101lalu="SELECT IFNULL(sum(kredit)-sum(debet),0) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE tgl_voucher='2015-12-31'  AND a.kd_rek5='3110101'";
$query311lalu  = $this->db->query($sql3110101lalu);
$j3110101lalu     = $query311lalu->row();
$j3110101lalua  = $j3110101lalu->nilai;
//akhir


		$ekuitaslalu =  $j3110101lalua;      
        $ekuitas =  ($jmlpendlo-$jmlbello)+$j3110101a+$ekuitaslalu;



      
		
        $sql2 = "SELECT ifnull(SUM(b.kredit),0)-ifnull(SUM(b.debet),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,1)='2' AND MONTH(a.tgl_voucher)<='$bul' and YEAR(tgl_voucher)='$thn_ang' ";
                    $query2     = $this->db->query($sql2);
                    $jmlut      = $query2->row();
                    $jmlutang   = $jmlut->nilai;

//thn lalu
  $sql2lalu = "SELECT ifnull(SUM(b.kredit),0)-ifnull(SUM(b.debet),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,1)='2' and tgl_voucher='2015-12-31'  ";
                    $query2lalu     = $this->db->query($sql2lalu);
                    $jmlutlalu      = $query2lalu->row();
                    $jmlutanglalu   = $jmlutlalu->nilai;
//akhir
					
        $ekuitasakhir =  $ekuitas+$jmlutang+$jmlutanglalu;;

                $ekuitasakhirlalu =  $ekuitaslalu+$jmlutanglalu;




     
        $ekuitasakhir1=$this->angka($ekuitasakhir);
					
                                    
            $lastmoth = $thn.'-'.$bul.'-'.'01';
            $lastyear = date('Y-m-t',strtotime($lastmoth)); 
            $str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));                            
              

            
        $ekuitas1=$this->angka($ekuitas);
			$cRet ='<TABLE width="100%">
                    <tr>        
						<td align="center" ><b>PEMERINTAH '.$kab.'</b></td>
					</tr>                   
					<TR>
						<TD align="center" ><b>NERACA</b></TD>
					</TR>
					<TR>
						<TD align="center" ><b>PER '.$str.' dan '.$th1.'</b></TD>
					</TR>
					</TABLE><br>';


			$cRet .='<TABLE border="1" cellspacing="0" cellpadding="0" width="100%" >
					 <thead>
                     <TR>
                        <TD width="5%" align="center" ><b>NO</b></TD>
						<TD width="45%" align="center" ><b>URAIAN</b></TD>
						<TD width="25%" align="center" ><b>'.$thi.'</b></TD>
						<TD width="25%" align="center" ><b>'.$th1.'</b></TD>
					 </TR>
                     </thead>
                     <tfoot>
                     <TR>
                        <TD width="5%" align="center" ><b></b></TD>
						<TD width="45%" align="center" ><b></b></TD>
						<TD width="25%" align="center" ><b></b></TD>
						<TD width="25%" align="center" ><b></b></TD>
					 </TR>
					
				</tfoot>';

			$query = $this->db->query("SELECT kode,uraian,seq,normal,IFNULL(kode_1,\"''\") as kode_1,
IFNULL(kode_2,\"''\") as kode_2,
IFNULL(kode_3,\"''\") as kode_3,
IFNULL(kode_4,\"''\") as kode_4,
IFNULL(kode_5,\"''\") as kode_5,
IFNULL(kode_6,\"''\") as kode_6,
IFNULL(kode_7,\"''\") as kode_7,
IFNULL(kode_8,\"''\") as kode_8,
IFNULL(kode_9,\"''\") as kode_9,
IFNULL(kode_10,\"''\") as kode_10,
IFNULL(kode_11,\"''\") as kode_11,
IFNULL(kode_12,\"''\") as kode_12,
IFNULL(kode_13,\"''\") as kode_13,
IFNULL(kode_14,\"''\") as kode_14,
IFNULL(kode_15,\"''\") as kode_15,
IFNULL(kode_16,\"''\") as kode_16,
IFNULL(kode_17,\"''\") as kode_17,
IFNULL(kode_18,\"''\") as kode_18,
IFNULL(kode_19,\"''\") as kode_19,
IFNULL(kode_20,\"''\") as kode_20,
nilai_lalu FROM map_neraca ORDER BY kode");  
			foreach($query->result_array() as $res){
				
				$kode   = $res['kode'];
				$uraian = $res['uraian'];
				$seq    = $res['seq'];
				$normal = $res['normal'];
                $reallalu1 = $res['nilai_lalu'];
				$reallalu = number_format($reallalu1,"2",".",",");  
				$kode_1 = $res['kode_1'];
				$kode_2 = $res['kode_2'];
				$kode_3 = $res['kode_3'];
				$kode_4 = $res['kode_4'];
				$kode_5 = $res['kode_5'];
				$kode_6 = $res['kode_6'];
				$kode_7 = $res['kode_7'];
				$kode_8 = $res['kode_8'];
				$kode_9 = $res['kode_9'];
				$kode_10 = $res['kode_10'];
				$kode_11 = $res['kode_11'];
				$kode_12 = $res['kode_12'];
				$kode_13= $res['kode_13'];
				$kode_14 = $res['kode_14'];
				$kode_15 = $res['kode_15'];
				$kode_16 = $res['kode_16'];
				$kode_17 = $res['kode_17'];
				$kode_18 = $res['kode_18'];
				$kode_19 = $res['kode_19'];
				$kode_20 = $res['kode_20'];




                
                $test1 = '';
					if($kode_1 <> ''){
						$test  = explode(',',$kode_1);
						$test1 = strlen($test[0]);
					}										

				$q = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a 
											INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
											WHERE left(a.kd_rek5,3)<>'118' and SUBSTR(a.kd_rek5,1,$test1) 
											IN ($kode_1,$kode_2,$kode_3,$kode_4,$kode_5,$kode_6,$kode_7,$kode_8,$kode_9,$kode_10,$kode_11,$kode_12,$kode_13,$kode_14,$kode_15,$kode_16,$kode_17,$kode_18,$kode_19,$kode_20)
											AND ((MONTH(b.tgl_voucher)<='$bul'  AND YEAR(TGL_VOUCHER)='2016') or  tgl_voucher='2015-12-31')");  

				 foreach($q->result_array() as $r){
					$debet  = $r['debet'];
					$kredit = $r['kredit'];
				 }

//thnlalu
$qlalu = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a 
INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE left(a.kd_rek5,3)<>'118' and SUBSTR(a.kd_rek5,1,$test1) 
IN ($kode_1,$kode_2,$kode_3,$kode_4,$kode_5,$kode_6,$kode_7,$kode_8,$kode_9,$kode_10,$kode_11,$kode_12,$kode_13,$kode_14,$kode_15,$kode_16,$kode_17,$kode_18,$kode_19,$kode_20)
AND  tgl_voucher='2015-12-31'");  

foreach($qlalu->result_array() as $rlalu){
$debetlalu  = $rlalu['debet'];
$kreditlalu = $rlalu['kredit'];
}
//akhir
				
				if ($normal=='D'){
					$nilailalu=$debetlalu-$kreditlalu;
				
				}else{
					$nilailalu=$kreditlalu-$debetlalu;				
				
				}
                

				if ($debet=='') $debet=0;	if ($debetlalu=='') $debetlalu=0;
				if ($kredit=='') $kredit=0;				if ($kreditlalu=='') $kreditlalu=0;

				if ($normal=='D'){
				
					$nilai=$debet-$kredit;
				}else{
				
					$nilai=$kredit-$debet;				
				}
                
 





//case (($row4->seq==5)||($row4->seq==10)||($row4->seq==45)||($row4->seq==50)||($row4->seq==85)||($row4->seq==110)||($row4->seq==127)
  //                  	||($row4->seq==140)||($row4->seq==170)||($row4->seq==175)||($row4->seq==230)||($row4->seq==285)||($row4->seq==290)||($row4->seq==320)||($row4->seq==370)||($row4->seq==365)||($row4->seq==390)
                    	

    switch ($seq) {
                    case ($seq==5||$seq==15||$seq==110||$seq==115||$seq==145||$seq==175||$seq==225||$seq==245||$seq==295||$seq==305||$seq==350||$seq==390):
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    </tr>";
                        break; 
                  case ($seq==100||$seq==140||$seq==160||$seq==165||$seq==375||$seq==215||$seq==235||$seq==275||$seq==285||$seq==340||$seq==380):
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($nilai)."</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($nilailalu)."</b></td>
                                    </tr>";
                        break;
                                                      
                 
                 
                    case 395:
                        $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$ekuitas1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">".$this->angka($ekuitaslalu)."</td>
                                    </tr>";
                        break;                         
					 case 400:
                        $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"><b>$ekuitasakhir1</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" align=\"right\"><b>".$this->angka($ekuitasakhirlalu)."</b></td>
                                    </tr>";
                        break;                                                                                                               
                    default:
                if($uraian <> ''){
                    $cRet    .= "
                                <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>  
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$uraian</td>                                   
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">".$this->angka($nilai)."</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">".$this->angka($nilailalu)."</td>
                                 </tr>";
                }else{
					 $cRet    .= "
                                <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$uraian</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";	
				}

                }
                
			}
            
        $cRet .='</table>';	
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$skpd' and kode='PPK'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">$jabatan</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>$nip</b></td>
                        </tr>

                    </table>";             
            	 

			
			              
        $data['prev'] = $cRet;
        $data['sikap'] = 'preview';
        $judul = 'NERACA';
        $this->template->set('title', 'CETAK LAPORAN REALISASI ANGGARAN');
        switch ($cetak)
        {
            case 1;
               // $this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
		    $this->tukd_model->_mpdf('',$cRet,10,5,10,'0');	
                break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }

			
			
	}

	 function rpt_neraca_skpd($cetak=1){
	        $skpd     = $_REQUEST['kdskpd'];
			$cetak = $this->uri->segment(3);
			$thi      = $this->session->userdata('pcThang');
            $th1      = $thi-1;
            $bul      = $_REQUEST['bulan'];
            $bulan    = $this->tukd_model->getBulan($bul); 
            $tgl_ttd  = $_REQUEST['tgl_ctk'];  
             $thn_ang='2016';
             
             $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
                            
            $lastmoth = $thn.'-'.$bul.'-'.'01';
            $lastyear = date('Y-m-t',strtotime($lastmoth)); 
            $str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));               
             
           $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk 
                        FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$skpd'";
                     $sqlskpd=$this->db->query($sqldns);
                     foreach ($sqlskpd->result() as $rowdns)
                    {
                        $kd_urusan=$rowdns->kd_u;                    
                        $nm_urusan= $rowdns->nm_u;
                        $kd_skpd  = $rowdns->kd_sk;
                        $nm_skpd  = strtoupper($rowdns->nm_sk);
                    }             
            
			$cRet ='<TABLE width="100%">
                    <tr>        
						<td align="center" ><b>PEMERINTAH '.$kab.'</b></td>
					</tr>
					<tr>
						<td align="center" ><b>'.$nm_skpd.'</b></td>
					</tr>                    
					<TR>
						<TD align="center" ><b>LAPORAN NERACA</b></TD>
					</TR>
					<TR>
						<TD align="center" ><b>PER '.$str.' dan '.$th1.'</b></TD>
					</TR>
					</TABLE><br>';


			$cRet .='<TABLE border="1" cellspacing="0" cellpadding="0" width="100%" >
					 <thead>
                     <TR>
                        <TD width="5%" align="center" ><b>NO</b></TD>
						<TD width="45%" align="center" ><b>URAIAN</b></TD>
						<TD width="25%" align="center" ><b>'.$thi.'</b></TD>
						<TD width="25%" align="center" ><b>'.$th1.'</b></TD>
					 </TR>
                     </thead>
                     <tfoot>
                     <TR>
                        <TD width="5%" align="center" ><b></b></TD>
						<TD width="45%" align="center" ><b></b></TD>
						<TD width="25%" align="center" ><b></b></TD>
						<TD width="25%" align="center" ><b></b></TD>
					 </TR>					
				</tfoot>';
	
$jumlah_kewajiba=0;
$jumlah_kewajiban=0;
$jumlah_kewajibalalu=0;
$jumlah_kewajibanlalu=0;	
			$query = $this->db->query("SELECT kode,uraian,seq,bold,parent,normal,kode_1,kode_2,kode_3,kode_4,kode_5,kode_6,kode_7,
										kode_8,kode_9,kode_10,kode_11,kode_12,kode_13,kode_14,kode_15,nilai,
										(SELECT nilai_lalu FROM ms_neraca_skpd_lalu WHERE seq=a.seq AND kd_skpd='$skpd') AS nilai_lalu
										FROM map_neraca_skpd a ORDER BY kode");  
			foreach($query->result_array() as $res){
				
				$kode   = $res['kode'];
				$uraian = $res['uraian'];
				$seq    = $res['seq'];
				$parent = $res['parent'];
				$normal = $res['normal'];
				$nillal = $res['nilai_lalu'];
				
				
				if ($nillal < 0){
				$o1="(";$nillala=$nillal*-1;$p1=")";
				}else{$o1="";$nillala=$nillal*1;$p1="";
				}
				$nillalu= number_format($nillala,"2",".",",");
				
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);

				if ($kode_1=='') $kode_1='xxx';												
				if ($kode_2=='') $kode_2='xxx';												
				if ($kode_3=='') $kode_3='xxx';												
				if ($kode_4=='') $kode_4='xxx';												
				if ($kode_5=='') $kode_5='xxx';												
				if ($kode_6=='') $kode_6='xxx';												
				if ($kode_7=='') $kode_7='xxx';												
				if ($kode_8=='') $kode_8='xxx';												
				if ($kode_9=='') $kode_9='xxx';												
				if ($kode_10=='') $kode_10='xxx';												
				if ($kode_11=='') $kode_11='xxx';												
				if ($kode_12=='') $kode_12='xxx';												
				if ($kode_13=='') $kode_13='xxx';												
				if ($kode_14=='') $kode_14='xxx';												
				if ($kode_15=='') $kode_15='xxx';												

				$q = $this->db->query(" SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
                                        ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd and a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$skpd' 
										and (month(b.tgl_voucher)<='$bul' OR tgl_voucher='2015-12-31') and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%' or kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%' or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%' or kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%' or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or kd_rek5 like '$kode_15%')");  

				 foreach($q->result_array() as $r){
					$debet  = $r['debet'];
					$kredit = $r['kredit'];
				 }
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;
				if ($normal=='D'){
					$nilai=$debet-$kredit;
				}else{
					$nilai=$kredit-$debet;				
				}           
  $nil= $this->angka($nilai);


//TAHUN LALU
				$qlalu = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
                                        ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd and a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$skpd' 
										and tgl_voucher='2015-12-31' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%' or kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%' or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%' or kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%' or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or kd_rek5 like '$kode_15%')");  

				 foreach($qlalu->result_array() as $rlalu){
					$debetlalu  = $rlalu['debet'];
					$kreditlalu = $rlalu['kredit'];
				 }
				
				if ($debetlalu=='') $debetlalu=0;
				if ($kreditlalu=='') $kreditlalu=0;

				if ($normal=='D'){
					$nilailalu=$debetlalu-$kreditlalu;
				}else{
					$nilailalu=$kreditlalu-$debetlalu;				
				}           


  $nillalu= $this->angka($nilailalu);





/*//jumlah aset tetap tahunlalu		
  $slalu="SELECT IFNULL(SUM(nilai_lalu),0) as nilai_lalu  FROM ms_neraca_skpd_lalu WHERE seq='340' AND kd_skpd='$skpd'";
                    $qlalu    = $this->db->query($slalu);
                    $jllu       = $qlalu->row();
                    $asettetaplalu  = $jllu->nilai_lalu;  

 $slalu1="SELECT IFNULL(SUM(nilai_lalu),0) as nilai_lalu  FROM ms_neraca_skpd_lalu WHERE seq='379' AND kd_skpd='$skpd'";
                    $qlalu1    = $this->db->query($slalu1);
                    $jllu1       = $qlalu1->row();
                    $asettetaplalu1  = $jllu1->nilai_lalu;  


  //untuk seq 385
$jastet385=$nilai+$asettetaplalu1+$asettetaplalu;
$jastet385a= number_format($jastet385,"2",".",","); 
  //
*/

 //


				//
				
            
        $sql41="SELECT IFNULL(sum(kredit)-sum(debet),0) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(a.kd_rek5,1)='8' AND b.kd_skpd='$skpd'  and YEAR(tgl_voucher)='$thn_ang'";
                    $query41    = $this->db->query($sql41);
                    $jmlp       = $query41->row();
                    $jmlpendlo  = $jmlp->nilai;             

       $sql51="SELECT IFNULL(sum(debet)-sum(kredit),0) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(a.kd_rek5,1)='9' AND b.kd_skpd='$skpd' and YEAR(tgl_voucher)='$thn_ang'";                        
                    $query51    = $this->db->query($sql51);
                    $jmlb       = $query51->row();
                    $jmlbello   = $jmlb->nilai;







// lo tahun lalu 

        $sql41lalu="SELECT IFNULL(sum(kredit)-sum(debet),0) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE tgl_voucher='2015-12-31' AND LEFT(a.kd_rek5,1)='8' AND b.kd_skpd='$skpd'  ";
                    $query41lalu    = $this->db->query($sql41lalu);
                    $jmlplalu       = $query41lalu->row();
                    $jmlpendlolalu  = $jmlplalu->nilai;             

       $sql51lalu="SELECT IFNULL(sum(debet)-sum(kredit),0) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE tgl_voucher='2015-12-31'  AND LEFT(a.kd_rek5,1)='9' AND b.kd_skpd='$skpd' ";                        
                    $query51lalu    = $this->db->query($sql51lalu);
                    $jmlblalu       = $query51lalu->row();
                    $jmlbellolalu   = $jmlblalu->nilai;



$ekuitaslalu=0;






        $sql3110101="SELECT IFNULL(sum(kredit)-sum(debet),0) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' AND a.kd_rek5='3110101' AND b.kd_skpd='$skpd' and YEAR(tgl_voucher)='$thn_ang'";
                    $query311  = $this->db->query($sql3110101);
                    $j3110101     = $query311->row();
                    $j3110101a  = $j3110101->nilai;

//thn lalu
        $sql3110101lalu="SELECT IFNULL(sum(kredit)-sum(debet),0) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE tgl_voucher='2015-12-31' AND a.kd_rek5='3110101' AND b.kd_skpd='$skpd'";
                    $query311lalu  = $this->db->query($sql3110101lalu);
                    $j3110101lalu     = $query311lalu->row();
                    $j3110101lalua  = $j3110101lalu->nilai;



        $ekuitaslalu =  ($jmlpendlolalu - $jmlbellolalu) + $j3110101lalua;                   
        $ekuitas =  ($jmlpendlo - $jmlbello) + $j3110101a+$ekuitaslalu;













        $sql313="SELECT IFNULL(sum(kredit)-sum(debet),0) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE (MONTH(b.tgl_voucher)<='$bul' or  tgl_voucher='2015-12-31')  AND a.kd_rek5='3130101' AND b.kd_skpd='$skpd'";
                    $query313  = $this->db->query($sql313);
                    $jmlrk     = $query313->row();
                    $jmlrkppd  = $jmlrk->nilai;



        $sql313lalu="SELECT IFNULL(sum(kredit)-sum(debet),0) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE tgl_voucher='2015-12-31' AND a.kd_rek5='3130101' AND b.kd_skpd='$skpd'";
                    $query313lalu  = $this->db->query($sql313lalu);
                    $jmlrklalu     = $query313lalu->row();
                    $jmlrkppdlalu  = $jmlrklalu->nilai;





		$rkppd = $ekuitas+$jmlrkppd;

		$rkppdlalu = $ekuitaslalu+$jmlrkppdlalu;




		
		
    
if($seq=='465'){
$jumlah_kewajiba=$nilai;
$jumlah_kewajibalalu=$nilailalu;
}
$jumlah_kewajiban=$jumlah_kewajiba+$rkppd;
$jumlah_kewajibanlalu=$jumlah_kewajibalalu+$rkppdlalu;

		
		
       
		$ekuitas1=  $this->angka($ekuitas);


   
		$ekuitaslalu1=  $this->angka($ekuitaslalu);





		$rkppd1= $this->angka($rkppd);



		$rkppdlalu1=  $this->angka($rkppdlalu);



    switch ($seq) {
                    case 5:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"><b></b></td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
							</tr>";
                        break; 
                    case 15:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"><b></b></td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
							</tr>";
                        break;                               
                    case 170:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"25%\"><b>$nil</b></td>
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$nillalu</b></td>
							</tr>";
                        break;
                    case 185:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"><b></b></td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
							</tr>";
                        break;                        
					 case 340:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"25%\"><b>$nil</b></td>
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$nillalu</b></td>
							</tr>";
                        break;
                    case 350:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"><b></b></td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
							</tr>";
                        break; 
                    case 379:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$nil</b></td>
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$nillalu</b></td>
							</tr>";
                        break;                                               
                    case 385:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$nil</b></td>
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$nillalu</b></td>
							</tr>";
                        break;
                    case 395:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>  
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                   
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"><b></b></td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
							</tr>";
                        break; 
                    case 405:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"><b></b></td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
							</tr>";
                        break;                                               
                    case 460:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$nil</b></td>
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$nillalu</b></td>
							</tr>";
                        break;
					 case 465:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"25%\"><b>$nil</b></td>
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$nillalu</b></td>
							</tr>";
                        break;
                    case 475:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"><b></b></td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
							</tr>";
                        break;  
                    case 490:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"><b></b></td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
							</tr>";
                        break;  
                    case 495:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>   
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\">$uraian</td>                                  
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\">$ekuitas1</td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\">$ekuitaslalu1</td>
							</tr>";
                        break;                                                                    
					 case 550:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$rkppd1</b></td>
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$rkppdlalu1</b></td>
							</tr>";
                        break;
                    case 650:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"25%\" align=\"right\"><b>".number_format($jumlah_kewajiban,"2",".",",")."</b></td>
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"25%\" align=\"right\"><b>".number_format($jumlah_kewajibanlalu,"2",".",",")."</b></td>
							</tr>";
                        break;                 
                    default:
					if($uraian <> ''){
						
					
							$cRet .= "
									<tr>
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>  
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\">$uraian</td>                                   
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\">$nil</td>
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\">$nillalu</td>
									</tr>";							
						
					}else{
						$cRet .= "
								<tr>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\">$uraian</td>                                     
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
								 </tr>";	
					}
                }
			}
            
		$cRet .='</TABLE>';	
		$cRet .= " <br><br>";
		$sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$skpd' and kode='PA'");
	    foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	    }

				$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">$jabatan</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>NIP. $nip</b></td>
                        </tr>

                    </table>"; 


  $data['prev']= $cRet;
		$this->template->set('title', 'CETAK lpe PPKD');        
        
        switch($cetak) {
        case 1;
	//		$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
        $this->tukd_model->_mpdf('',$cRet,10,5,10,'0');	
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= neraca_skpd.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        
        }		

		}
	
/* 	

  function rpt_neraca_skpd(){
	        $skpd     = $_REQUEST['kdskpd'];
			$thi      = $this->session->userdata('pcThang');
            $th1      = $thi-1;
            $bul      = $_REQUEST['bulan'];
            $bulan    = $this->tukd_model->getBulan($bul); 
            $tgl_ttd  = $_REQUEST['tgl_ctk'];  
            
            $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
                            
            $lastmoth = $thn.'-'.$bul.'-'.'01';
            $lastyear = date('Y-m-t',strtotime($lastmoth)); 
            $str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));               
             
           $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk 
                        FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$skpd'";
                     $sqlskpd=$this->db->query($sqldns);
                     foreach ($sqlskpd->result() as $rowdns)
                    {
                        $kd_urusan=$rowdns->kd_u;                    
                        $nm_urusan= $rowdns->nm_u;
                        $kd_skpd  = $rowdns->kd_sk;
                        $nm_skpd  = $rowdns->nm_sk;
                    }             
            
			$cRet ='<TABLE width="100%">
                    <tr>        
						<td align="center" ><b>PEMERINTAH '.$kab.'</b></td>
					</tr>
					<tr>
						<td align="center" ><b>'.$nm_skpd.'</b></td>
					</tr>                    
					<TR>
						<TD align="center" ><b>LAPORAN NERACA</b></TD>
					</TR>
					<TR>
						<TD align="center" ><b>PER '.$str.' dan '.$th1.'</b></TD>
					</TR>
					</TABLE><br>';


			$cRet .='<TABLE border="1" cellspacing="0" cellpadding="0" width="100%" >
					 <thead>
                     <TR>
                        <TD width="5%" align="center" ><b>NO</b></TD>
						<TD width="45%" align="center" ><b>URAIAN</b></TD>
						<TD width="25%" align="center" ><b>'.$thi.'</b></TD>
						<TD width="25%" align="center" ><b>'.$th1.'</b></TD>
					 </TR>
                     </thead>
                     <tfoot>
                     <TR>
                        <TD width="5%" align="center" ><b></b></TD>
						<TD width="45%" align="center" ><b></b></TD>
						<TD width="25%" align="center" ><b></b></TD>
						<TD width="25%" align="center" ><b></b></TD>
					 </TR>					
				</tfoot>';
						
			$query = $this->db->query("SELECT kode,uraian,seq,bold,parent,normal,kode_1,kode_2,kode_3,kode_4,kode_5,kode_6,kode_7,
										kode_8,kode_9,kode_10,kode_11,kode_12,kode_13,kode_14,kode_15,nilai,
										(SELECT nilai_lalu FROM ms_neraca_skpd_lalu WHERE seq=a.seq AND kd_skpd='$skpd') AS nilai_lalu
										FROM map_neraca_skpd a ORDER BY kode");  
			foreach($query->result_array() as $res){
				
				$kode   = $res['kode'];
				$uraian = $res['uraian'];
				$seq    = $res['seq'];
				$parent = $res['parent'];
				$normal = $res['normal'];
				$nillal = $res['nilai_lalu'];
				if ($nillal < 0){$o1="(";$nillal=$nillal*-1;$p1=")";}else{$o1="";$nillal=$nillal*1;$p1="";}
				$nillalu= number_format($nillal,"2",".",",");
				
				$kode_1=trim($res['kode_1']);
				$kode_2=trim($res['kode_2']);
				$kode_3=trim($res['kode_3']);
				$kode_4=trim($res['kode_4']);
				$kode_5=trim($res['kode_5']);
				$kode_6=trim($res['kode_6']);
				$kode_7=trim($res['kode_7']);
				$kode_8=trim($res['kode_8']);
				$kode_9=trim($res['kode_9']);
				$kode_10=trim($res['kode_10']);
				$kode_11=trim($res['kode_11']);
				$kode_12=trim($res['kode_12']);
				$kode_13=trim($res['kode_13']);
				$kode_14=trim($res['kode_14']);
				$kode_15=trim($res['kode_15']);

				if ($kode_1=='') $kode_1='xxx';												
				if ($kode_2=='') $kode_2='xxx';												
				if ($kode_3=='') $kode_3='xxx';												
				if ($kode_4=='') $kode_4='xxx';												
				if ($kode_5=='') $kode_5='xxx';												
				if ($kode_6=='') $kode_6='xxx';												
				if ($kode_7=='') $kode_7='xxx';												
				if ($kode_8=='') $kode_8='xxx';												
				if ($kode_9=='') $kode_9='xxx';												
				if ($kode_10=='') $kode_10='xxx';												
				if ($kode_11=='') $kode_11='xxx';												
				if ($kode_12=='') $kode_12='xxx';												
				if ($kode_13=='') $kode_13='xxx';												
				if ($kode_14=='') $kode_14='xxx';												
				if ($kode_15=='') $kode_15='xxx';												

				$q = $this->db->query(" SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
                                        ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd and a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$skpd' 
										and month(b.tgl_voucher)<='$bul' and
										(kd_rek5 like '$kode_1%' or kd_rek5 like '$kode_2%' or kd_rek5 like '$kode_3%' or kd_rek5 like '$kode_4%' or 
										kd_rek5 like '$kode_5%' or kd_rek5 like '$kode_6%' or kd_rek5 like '$kode_7%' or kd_rek5 like '$kode_8%' or 
										kd_rek5 like '$kode_9%' or kd_rek5 like '$kode_10%' or kd_rek5 like '$kode_11%' or kd_rek5 like '$kode_12%' or 
										kd_rek5 like '$kode_13%' or kd_rek5 like '$kode_14%' or kd_rek5 like '$kode_15%')");  

				 foreach($q->result_array() as $r){
					$debet  = $r['debet'];
					$kredit = $r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal=='D'){
					$nilai=$debet-$kredit;
				}else{
					$nilai=$kredit-$debet;				
				}                
                $nil= number_format($nilai,"2",".",","); 

				$nil2 = $nilai + $nillal;
				$nil12= number_format($nil2,"2",".",","); 
				
            
        $sql41="SELECT IFNULL(sum(kredit)-sum(debet),0) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(a.kd_rek5,1)='8' AND b.kd_skpd='$skpd'";
                    $query41    = $this->db->query($sql41);
                    $jmlp       = $query41->row();
                    $jmlpendlo  = $jmlp->nilai;             

       $sql51="SELECT IFNULL(sum(debet)-sum(kredit),0) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(a.kd_rek5,1)='9' AND b.kd_skpd='$skpd'";                        
                    $query51    = $this->db->query($sql51);
                    $jmlb       = $query51->row();
                    $jmlbello   = $jmlb->nilai;
                   
        $ekuitas =  $jmlpendlo-$jmlbello+$nillal;
        if ($ekuitas < 0){$x="(";$ekuitas=$ekuitas*-1;$y=")";}else{$x="";$ekuitas=$ekuitas*1;$y="";}
		$ekuitas1= number_format($ekuitas,"2",".",",");

        $sql313="SELECT IFNULL(sum(debet)-sum(kredit),0) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' AND a.kd_rek5='3130101' AND b.kd_skpd='$skpd'";
                    $query313  = $this->db->query($sql313);
                    $jmlrk     = $query313->row();
                    $jmlrkppd  = $jmlrk->nilai;

		$rkppd = $ekuitas+$jmlrkppd;
        if ($rkppd > 0){$x1="(";$rkppd=$rkppd*1;$y1=")";}else{$x1="";$rkppd=$rkppd*-1;$y1="";}		
        $ekuitas2= number_format($rkppd,"2",".",",");
		
    switch ($seq) {
                    case 5:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"><b></b></td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
							</tr>";
                        break; 
                    case 15:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"><b></b></td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
							</tr>";
                        break;                               
                    case 170:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"25%\"><b>$nil</b></td>
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$o1$nillalu$p1</b></td>
							</tr>";
                        break;
                    case 185:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"><b></b></td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
							</tr>";
                        break;                        
					 case 340:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"25%\"><b>$nil12</b></td>
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$o1$nillalu$p1</b></td>
							</tr>";
                        break;
                    case 350:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"><b></b></td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
							</tr>";
                        break; 
                    case 379:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$nil12</b></td>
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$o1$nillalu$p1</b></td>
							</tr>";
                        break;                                               
                    case 385:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$nil12</b></td>
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$o1$nillalu$p1</b></td>
							</tr>";
                        break;
                    case 395:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>  
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                   
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"><b></b></td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
							</tr>";
                        break; 
                    case 405:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"><b></b></td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
							</tr>";
                        break;                                               
                    case 460:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$nil</b></td>
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$o1$nillalu$p1</b></td>
							</tr>";
                        break;
					 case 465:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"25%\"><b>$nil</b></td>
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$o1$nillalu$p1</b></td>
							</tr>";
                        break;
                    case 475:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"><b></b></td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
							</tr>";
                        break;  
                    case 490:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"><b></b></td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
							</tr>";
                        break;  
                    case 495:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>   
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\">$uraian</td>                                  
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\">$x$ekuitas1$y</td>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\">$o1$nillalu$p1</td>
							</tr>";
                        break;                                                                    
					 case 550:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>".number_format((($jmlpendlo-$jmlbello)-$jmlrkppd+$nillal),"2",".",",")."</b></td>
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b><b>$o1$nillalu$p1</b></b></td>
							</tr>";
                        break;
                    case 650:
                        $cRet.= "
							<tr>
								<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td> 
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                    
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"25%\" align=\"right\"><b>".number_format($nilai+($jmlpendlo-$jmlbello)+$nillal,"2",".",",")."</b></td>
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"25%\" align=\"right\"><b><b>$o1$nillalu$p1</b></b></td>
							</tr>";
                        break;                 
                    default:
					if($uraian <> ''){
						if($seq>='185' and $seq<='385'){
							$cRet .= "
									<tr>
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>  
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\">$uraian</td>                                   
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\">$nil12</td>
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\">$o1$nillalu$p1</td>
									</tr>";					
						}else if($seq=='500'){
							$cRet .= "
									<tr>
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>  
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\">$uraian</td>                                   
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\">$nil12</td>
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\">$o1$nillalu$p1</td>
									</tr>";	
						}else{
							$cRet .= "
									<tr>
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>  
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\">$uraian</td>                                   
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\">$nil</td>
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\">$o1$nillalu$p1</td>
									</tr>";							
						}
					}else{
						$cRet .= "
								<tr>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\">$uraian</td>                                     
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
								 </tr>";	
					}
                }
			}
            
		$cRet .='</TABLE>';	
		$cRet .= " <br><br>";
		$sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$skpd' and kode='PA'");
	    foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	    }

	$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
				<tr>
					<td width=\"25%\">&nbsp;</td>
					<td width=\"25%\">&nbsp;</td>
					<td width=\"50%\">&nbsp;</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td align=\"center\">$jabatan</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td align=\"center\"><b><u>$nama</u></b></td>
				</tr>
				<tr>
					<td>&nbsp;</td>
					<td>&nbsp;</td>
					<td align=\"center\"><b>$nip</b></td>
				</tr>
            </table>";             
		$this->tukd_model->_mpdf('',$cRet,10,5,10,'0');	
	}
 */
//================stop_neraca====================================     
/* //=================mulai_lpe=====================================    
    function ctk_lpe_pemda(){
        $thn_ang   = $this->session->userdata('pcThang');
        $id1       = $this->session->userdata('kdskpd');
        $nmskpd    = $this->tukd_model->get_nama($id1,'nm_skpd','ms_skpd','kd_skpd');
        $nmskpd    = strtoupper($nmskpd);
        $thn_ang_1 = $thn_ang-1;  
        $bul       = $_REQUEST['bulan'];
        $bulan     = $this->tukd_model->getBulan($bul); 
        $tgl_ttd   = $_REQUEST['tgl_ctk'];               
        
        $sqlsawal = "SELECT *  FROM map_lpe where nor='7'";
        $queryawal = $this->db->query($sqlsawal);
        $jmlsaldo = $queryawal->row();		
        $jmlsal = $jmlsaldo->thn_m1;			
		
        $sql41 = "SELECT ifnull(SUM(b.kredit),0)-ifnull(SUM(b.debet),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,1)='8' AND MONTH(a.tgl_voucher)<='$bul'";
        $query41 = $this->db->query($sql41);
        $jmlp = $query41->row();
        $jmlpendapatan = $jmlp->nilai;
        
        $sql51 = "SELECT ifnull(SUM(b.debet),0)-ifnull(SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,1)='9' AND MONTH(a.tgl_voucher)<='$bul'";
        $query51 = $this->db->query($sql51);
        $jmlb = $query51->row();
        $jmlbelanja = $jmlb->nilai;
        
        $surplus = $jmlpendapatan-$jmlbelanja;
		//$jum = $jmlsala + $surplus;	
		$jum = $jmlsal + $surplus;
		
        if ($surplus < 0){
    	$x="("; 
        $jum=$jum*-1; 
        $y=")";
        }else{
    	$x="";
        $jum=$jum; 
        $y="";}


       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
    
        $cRet = '';
        $lastmoth=$thn.'-'.$bul.'-'.'01';
		$lastyear=date('Y-m-t',strtotime($lastmoth)); 
		$str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH $kab</strong></td>                         
                    </tr>                   
                    <tr>
                         <td align=\"center\"><strong>LAPORAN PERUBAHAN EKUITAS </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK PERIODE YANG BERAKHIR SAMPAI DENGAN<br>$str dan $thn_ang_1</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Saldo $thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Saldo $thn_ang_1</b></td>  
                        </tr>  
                     </thead>";                   

                    //$sql = "SELECT * FROM map_lpe_skpd ORDER BY nor";               
					$sql = "SELECT * FROM map_lpe ORDER BY nor";               
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row)
                    {                     
                       $kd_rek   =$row->nor ;
                       $parent   =$row->parent;
                       $nama     =$row->uraian;
                       $nilai_1    =$row->thn_m1;
                       
                               switch ($kd_rek)
                                {
                                    case 1:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$x".number_format($jmlsal,2,",",".")."$y</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>".number_format($nilai_1,2,",",".")."</b></td>
                                                     </tr>";
                                            
                                    break; 
                                    case 2:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$x".number_format($surplus,2,",",".")."$y</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>".number_format($nilai_1,2,",",".")."</b></td>
                                                     </tr>";
                                            
                                    break; 
                                     case 3:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>".number_format($nilai_1,2,",",".")."</b></td>
                                                     </tr>";
                                            
                                    break; 
									case 4:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp; &nbsp; &nbsp; &nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">".number_format($nilai_1,2,",",".")."</td>
                                                     </tr>";
                                            
                                    break; 
									case 5:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp; &nbsp; &nbsp; &nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">".number_format($nilai_1,2,",",".")."</td>
                                                     </tr>";
                                            
                                    break; 
									case 6:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp; &nbsp; &nbsp; &nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">".number_format($nilai_1,2,",",".")."</td>
                                                     </tr>";
                                            
                                    break;
                                    case 7:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$x".number_format($jum,2,",",".")."$y</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$x".number_format($jmlsal,2,",",".")."$y</b></td>
                                                     </tr>";
                                            
                                    break; 
                                    default:  
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp; &nbsp; &nbsp; &nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp;</td>
                                                     </tr>";                      
                                } 
                    }
 
           $cRet .="<tr>
                    <td align=\"center\" width=\"5%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\" >&nbsp;</td>
                    <td align=\"center\" width=\"65%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td>
                    <td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td> 
                    <td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td>            
                    </tr>"; 
                    
        $cRet .= " </table>";
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id1' and kode='PPK'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">$jabatan</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>$nip</b></td>
                        </tr>";                                               

         $cRet .='</table>';               
         
                $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
    }
	 */
	 
	 
	 
	 	 
	  function ctk_lpe_pemda(){
        $thn_ang   = 2016;
        $id1       = $this->session->userdata('kdskpd');
        $nmskpd    = $this->tukd_model->get_nama($id1,'nm_skpd','ms_skpd','kd_skpd');
        $nmskpd    = strtoupper($nmskpd);
        $thn_ang_1 = $thn_ang-1;  
        $bul       = $_REQUEST['bulan'];
        $bulan     = $this->tukd_model->getBulan($bul); 
        $tgl_ttd   = $_REQUEST['tgl_ctk'];               
        
        $sqlsawal = "SELECT *  FROM map_lpe where nor='7'";
        $queryawal = $this->db->query($sqlsawal);
        $jmlsaldo = $queryawal->row();		
        $jmlsal = $jmlsaldo->thn_m1;	

//$cetak = $this->uri->segment(3);

			$cetak123=$this->uri->segment(3);
			
		$nnllu1=0;

		

$sqlsc="SELECT sum(nilai_tamp) as a from map_lpe ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {$nnllu1     = $rowsc->a;} 

		
		
		$nnllu11 = number_format($nnllu1, "2", ".", ",");
		
		
		
		






//lalu
		        $sql41lalu = "SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd_lalu a INNER JOIN trhju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE tgl_voucher='2015-12-31' AND LEFT(a.kd_rek5,1)='8'  ";
        $query41lalu = $this->db->query($sql41lalu);
        $jmlplalu = $query41lalu->row();
        $jmlpendapatanlalu = $jmlplalu->nilai;
        $jmlpendapatanlalu1 = number_format($jmlplalu->nilai, "2", ".", ",");
        
        $sql51lalu = "SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd_lalu a INNER JOIN trhju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE tgl_voucher='2015-12-31' AND LEFT(a.kd_rek5,1)='9' ";
        $query51lalu = $this->db->query($sql51lalu);
        $jmlblalu = $query51lalu->row();
        $jmlbelanjalalu = $jmlblalu->nilai;
        $jmlbelanjalalu1 = number_format($jmlblalu->nilai, "2", ".", ",");
		//

        
 $surpluslalu = ($jmlpendapatanlalu - $jmlbelanjalalu);
        
     

        $sql41 = "SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(a.kd_rek5,1)='8'   AND YEAR(tgl_voucher)='$thn_ang'";
        $query41 = $this->db->query($sql41);
        $jmlp = $query41->row();
        $jmlpendapatan = $jmlp->nilai;
        $jmlpendapatan1 = number_format($jmlp->nilai, "2", ".", ",");
        
        $sql51 = "SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(a.kd_rek5,1)='9'  AND YEAR(tgl_voucher)='$thn_ang'";
        $query51 = $this->db->query($sql51);
        $jmlb = $query51->row();
        $jmlbelanja = $jmlb->nilai;
        $jmlbelanja1 = number_format($jmlb->nilai, "2", ".", ",");
        
        $surplus = ($jmlpendapatan - $jmlbelanja);
   
		
		
		
		$ekuitas_akhir=$surplus+$nnllu1+$surpluslalu;

	
		
       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
    
        $cRet = '';
        $lastmoth=$thn.'-'.$bul.'-'.'01';
		$lastyear=date('Y-m-t',strtotime($lastmoth)); 
		$str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH $kab</strong></td>                         
                    </tr>

                    <tr>
                         <td align=\"center\"><strong>LAPORAN PERUBAHAN EKUITAS </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK PERIODE YANG BERAKHIR SAMPAI DENGAN<br>$str</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Saldo $thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Saldo $thn_ang_1</b></td>
                          
                        </tr>  
                     </thead>";                   

					 
					 
					   $sqlaa ="SELECT sum(nilai_tamp) as a from map_lpe where  nor='0'";
                    $hasil1aa= $this->db->query($sqlaa); 
					   $lain=0;
                    foreach ($hasil1aa->result() as $rowa)
                    {                    
                       $lain    =$rowa->a;
					}	


					 
                    $sql = "SELECT * FROM map_lpe ORDER BY seq";               
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row)
                    {                     
                       $kd_rek   =$row->nor ;
                       $parent   =$row->parent;
                       $nama     =$row->uraian;
                       $nilai_1    =$row->thn_m1;
                       $seque   =$row->seq;
					   
					    $sql1 ="SELECT sum(nilai_tamp) as a from map_lpe where  seq='$seque'";
                    $hasil1 = $this->db->query($sql1); 
					   $nilai_tamp=0;
                    foreach ($hasil1->result() as $row)
                    {                    
                       $nilai_tamp    =$row->a;
					}	

		
					
					   
                               switch ($kd_rek)
                                {
                                    case 1:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B>".$this->angka($surpluslalu+$nnllu1)."</b></td>
                                                       <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B>".$this->angka($nilai_tamp)."</B></td>
                                                    
                                                     </tr>";
                                            
                                    break; 
                                    case 2:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>".$this->angka($surplus)."</b></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>".$this->angka($surpluslalu)."</b></td>
                                                     </tr>";
                                            
                                    break; 
									case 3:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B></B></td>
                                                     </tr>";
                                            
                                    break; 
										case 4:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B></B></td>
                                                     </tr>";
                                            
                                    break; 
										case 5:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B></B></td>
                                                     </tr>";
                                            
                                    break; 
									case 6:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>0.00</b></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B> ".$this->angka($lain)."</B></td>
                                                     </tr>";
                                            
                                    break; 
                                    case 7:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>".$this->angka($ekuitas_akhir)."</b></td>
                                                    <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>".$this->angka($surpluslalu+$nnllu1)."</b></td>
                                                     </tr>";
                                            
                                    break; 
                                    default:  
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b></b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp; &nbsp; &nbsp; &nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> ".$this->angka($nilai_tamp)."</td>
                                                     </tr>";                      
                                } 
                    }
 
           $cRet .="<tr>
                    <td align=\"center\" width=\"5%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\" >&nbsp;</td>
                    <td align=\"center\" width=\"65%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td>
                    <td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td> 
                    <td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td> 
                           
                    </tr>"; 
                    
        $cRet .=       " </table>";
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id1' and kode='PA'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\">&nbsp;</td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td align=\"center\">$jabatan</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
                            <td align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
                            <td align=\"center\"><b>NIP. $nip</b></td>
                        </tr>";                                               

         $cRet .='</table>';               
         
              
				
					   $data['prev']= $cRet;    
        switch($cetak123) {        
        case 1;
            // $this->tukd_model->_mpdf('',$cRet,'5','5',5,'0');
           $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
		
			
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= lpe.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        }
		
    }
	
	

/* 	function ctk_lpe_skpd(){
        $thn_ang   = $this->session->userdata('pcThang');
        $id1       = $_REQUEST['kdskpd'];
        $nmskpd    = $this->tukd_model->get_nama($id1,'nm_skpd','ms_skpd','kd_skpd');
        $nmskpd    = strtoupper($nmskpd);
        $thn_ang_1 = $thn_ang-1;  
        $bul       = $_REQUEST['bulan'];
        $bulan     = $this->tukd_model->getBulan($bul); 
        $tgl_ttd   = $_REQUEST['tgl_ctk'];               
                
        $skpd = "AND kd_skpd='$id1'";
        $skpd1 = "AND b.kd_skpd='$id1'"; 
        
        //$sqlsawal = "SELECT nilai_lalu as nilai FROM ms_lpe_skpd_lalu  where nor='7' and kd_skpd='$id1'";
		$sqlsawal = "SELECT nilai_lalu as nilai FROM ms_lpe_skpd_lalu  where nor='7'";
        $queryawal = $this->db->query($sqlsawal);
        $jmlsaldo = $queryawal->row();
        $jmlsal = $jmlsaldo->nilai;

        if ($jmlsal < 0){
    	$xx="("; 
        $jmlsal=$jmlsal*-1; 
        $yy=")";
        }else{
    	$xx="";
        $jmlsal=$jmlsal; 
        $yy="";}
        
        $sql41 = "SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(a.kd_rek5,1)='8' AND b.kd_skpd='$id1'";
        $query41 = $this->db->query($sql41);
        $jmlp = $query41->row();
        $jmlpendapatan = $jmlp->nilai;
        $jmlpendapatan1 = number_format($jmlp->nilai, "2", ".", ",");
        
        $sql51 = "SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(a.kd_rek5,1)='9' AND b.kd_skpd='$id1'";
        $query51 = $this->db->query($sql51);
        $jmlb = $query51->row();
        $jmlbelanja = $jmlb->nilai;
        $jmlbelanja1 = number_format($jmlb->nilai, "2", ".", ",");
        
        $surplus = $jmlpendapatan - $jmlbelanja;
        
        if ($surplus < 0){
    	$x="("; 
        $surplus=$surplus*-1; 
        $y=")";
        }else{
    	$x="";
        $surplus=$surplus; 
        $y="";}


        $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
    
        $cRet = '';
        $lastmoth=$thn.'-'.$bul.'-'.'01';
		$lastyear=date('Y-m-t',strtotime($lastmoth)); 
		$str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH $kab</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>$nmskpd</strong></td>                         
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>LAPORAN PERUBAHAN EKUITAS </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK PERIODE YANG BERAKHIR SAMPAI DENGAN<br>$str dan $thn_ang_1</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Saldo $thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Saldo $thn_ang_1</b></td>  
                        </tr>  
                     </thead>";                   

                    $sql = "SELECT * FROM map_lpe_skpd ORDER BY nor";               
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row)
                    {                     
                       $kd_rek   =$row->nor ;
                       $parent   =$row->parent;
                       $nama     =$row->uraian;
                       //$nilai_1    =$row->thn_m1;

	               			 //$sql_lalu = "SELECT nilai_lalu FROM ms_lpe_skpd_lalu where nor = '$kd_rek' and kd_skpd ='$id1'";
							$sql_lalu = "SELECT nilai_lalu FROM ms_lpe_skpd_lalu where nor = '$kd_rek'";							 
	            			 $hasil_lalu = $this->db->query($sql_lalu); 
	            			 foreach ($hasil_lalu->result() as $row_lalu)
	            			 {
								$nilai_1    = $row_lalu->nilai_lalu ;

								if ($nilai_1 < 0){
								$xxx="("; 
								$nilai_1=$nilai_1*-1; 
								$yyy=")";
								}else{
								$xxx="";
								$nilai_1=$nilai_1; 
								$yyy="";}              			  
                       
		                                switch ($kd_rek)
		                                {
		                                    case 1:
		                                            $cRet .="<tr>
		                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
		                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
		                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$xx".number_format($jmlsal,2,",",".")."$yy</b></td>  
		                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$xxx".number_format($nilai_1,2,",",".")."$yyy</b></td>
		                                                     </tr>";                                            
		                                    break; 
		                                    case 2:
		                                            $cRet .="<tr>
		                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
		                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
		                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$x".number_format($surplus,2,",",".")."$y</b></td>
		                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$xxx".number_format($nilai_1,2,",",".")."$yyy</b></td>
		                                                     </tr>";                                            
		                                    break; 
		                                     case 3:
		                                            $cRet .="<tr>
		                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
		                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
		                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
		                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp;</td>
		                                                     </tr>";                                            
		                                    break; 
		                                    case 7:
		                                            $cRet .="<tr>
		                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
		                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
		                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$x".number_format($surplus,2,",",".")."$y</b></td>
		                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$xxx".number_format($nilai_1,2,",",".")."$yyy</b></td>
		                                                     </tr>";                                            
		                                    break; 
		                                    default:  
		                                            $cRet .="<tr>
		                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
		                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp; &nbsp; &nbsp; &nbsp;$nama</td>
		                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
		                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp;</td>
		                                                     </tr>";                      
		                                } 
                            }
                    }
			
            $cRet .="<tr>
                    <td align=\"center\" width=\"5%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\" >&nbsp;</td>
                    <td align=\"center\" width=\"65%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td>
                    <td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td> 
                    <td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td>            
                    </tr>"; 
                    
        $cRet .=       " </table>";
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id1' and kode='PA'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\">&nbsp;</td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
                            <td align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
                            <td align=\"center\">$jabatan</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td align=\"center\"><b>$nip</b></td>
                        </tr>";                                               

         $cRet .='</table>';               
         
                $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');

    }  
//=================Stop_lpe======================================	
 */
 
 
 	   
	function ctk_lpe_skpd(){
       $thn_ang   = $this->session->userdata('pcThang');
        $id1       = $_REQUEST['kdskpd'];
        $nmskpd    = $this->tukd_model->get_nama($id1,'nm_skpd','ms_skpd','kd_skpd');
        $nmskpd    = strtoupper($nmskpd);
        $thn_ang_1 = $thn_ang-1;  
        $bul       = $_REQUEST['bulan'];
        $bulan     = $this->tukd_model->getBulan($bul); 
        $tgl_ttd   = $_REQUEST['tgl_ctk'];               
                  
        $skpd = "AND kd_skpd='$id1'";
        $skpd1 = "AND b.kd_skpd='$id1'"; 
        
        $sqlsawal = "SELECT *  FROM map_lpe  where nor='7'";
        $queryawal = $this->db->query($sqlsawal);
        $jmlsaldo = $queryawal->row();
        $jmlsal = $jmlsaldo->thn_m1;
		
			$cetak123=1;
			
		$nnllu1=0;

		
			

$sqlsc="SELECT sum(nilai_tamp) as a from ms_lpe_skpd_tamp where kd_skpd='$id1' 
";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {$nnllu1     = $rowsc->a;} 

		
		
		$nnllu11 = number_format($nnllu1, "2", ".", ",");
		
		 $rkppkd="SELECT SUM(a.kredit)-SUM(a.debet) AS nrkppkd FROM trdju_pkd a INNER JOIN trhju_pkd b 
		ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd AND a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$id1' 
		AND MONTH(b.tgl_voucher)<='$bul' AND
		kd_rek5='3130101' AND YEAR(tgl_voucher)='$thn_ang'";
                 $qrkppkd=$this->db->query($rkppkd);
                 foreach ($qrkppkd->result() as $rowsas)
                {$nrkppkd     = $rowsas->nrkppkd;} 	
		$nnrkppkd1 = number_format($nrkppkd, "2", ".", ",");
		
		
		
		






//lalu
		        $sql41lalu = "SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd_lalu a INNER JOIN trhju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE tgl_voucher='2015-12-31' AND LEFT(a.kd_rek5,1)='8' AND b.kd_skpd='$id1'  ";
        $query41lalu = $this->db->query($sql41lalu);
        $jmlplalu = $query41lalu->row();
        $jmlpendapatanlalu = $jmlplalu->nilai;
        $jmlpendapatanlalu1 = number_format($jmlplalu->nilai, "2", ".", ",");
        
        $sql51lalu = "SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd_lalu a INNER JOIN trhju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE tgl_voucher='2015-12-31' AND LEFT(a.kd_rek5,1)='9' AND b.kd_skpd='$id1' ";
        $query51lalu = $this->db->query($sql51lalu);
        $jmlblalu = $query51lalu->row();
        $jmlbelanjalalu = $jmlblalu->nilai;
        $jmlbelanjalalu1 = number_format($jmlblalu->nilai, "2", ".", ",");
		//

        
 $surpluslalu = ($jmlpendapatanlalu - $jmlbelanjalalu);
        
     

        $sql41 = "SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(a.kd_rek5,1)='8' AND b.kd_skpd='$id1'  AND YEAR(tgl_voucher)='$thn_ang'";
        $query41 = $this->db->query($sql41);
        $jmlp = $query41->row();
        $jmlpendapatan = $jmlp->nilai;
        $jmlpendapatan1 = number_format($jmlp->nilai, "2", ".", ",");
        
        $sql51 = "SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(a.kd_rek5,1)='9' AND b.kd_skpd='$id1' AND YEAR(tgl_voucher)='$thn_ang'";
        $query51 = $this->db->query($sql51);
        $jmlb = $query51->row();
        $jmlbelanja = $jmlb->nilai;
        $jmlbelanja1 = number_format($jmlb->nilai, "2", ".", ",");
        
        $surplus = ($jmlpendapatan - $jmlbelanja);
   
		
		
		
		$ekuitas_akhir=$surplus+$nnllu1+$nrkppkd+$surpluslalu;

	
		
       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
    
        $cRet = '';
        $lastmoth=$thn.'-'.$bul.'-'.'01';
		$lastyear=date('Y-m-t',strtotime($lastmoth)); 
		$str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH $kab</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>$nmskpd</strong></td>                         
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>LAPORAN PERUBAHAN EKUITAS </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK PERIODE YANG BERAKHIR SAMPAI DENGAN<br>$str</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Saldo $thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Saldo $thn_ang_1</b></td>
                          
                        </tr>  
                     </thead>";                   

					 
					 
					   $sqlaa ="SELECT sum(nilai_tamp) as a from ms_lpe_skpd_tamp where kd_skpd='$id1' and kode='0'";
                    $hasil1aa= $this->db->query($sqlaa); 
					   $lain=0;
                    foreach ($hasil1aa->result() as $rowa)
                    {                    
                       $lain    =$rowa->a;
					}	


					 
                    $sql = "SELECT * FROM map_lpe_skpd ORDER BY seq";               
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row)
                    {                     
                       $kd_rek   =$row->nor ;
                       $parent   =$row->parent;
                       $nama     =$row->uraian;
                       $nilai_1    =$row->thn_m1;
                       $seque   =$row->seq;
					   
					    $sql1 ="SELECT sum(nilai_tamp) as a from ms_lpe_skpd_tamp where kd_skpd='$id1' and seq='$seque'";
                    $hasil1 = $this->db->query($sql1); 
					   $nilai_tamp=0;
                    foreach ($hasil1->result() as $row)
                    {                    
                       $nilai_tamp    =$row->a;
					}	

		
					
					   
                               switch ($kd_rek)
                                {
                                    case 1:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B>".$this->angka($surpluslalu+$nnllu1)."</b></td>
                                                       <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B>".$this->angka($nilai_tamp)."</B></td>
                                                    
                                                     </tr>";
                                            
                                    break; 
                                    case 2:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>".$this->angka($surplus)."</b></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>".$this->angka($surpluslalu)."</b></td>
                                                     </tr>";
                                            
                                    break; 
                                     case 3:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B>".$this->angka($nrkppkd)."</B></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B>".$this->angka($nilai_tamp)."</B></td></B></td>
                                                     </tr>";
                                            
                                    break; 
									case 4:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B></B></td>
                                                     </tr>";
                                            
                                    break; 
										case 5:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B></B></td>
                                                     </tr>";
                                            
                                    break; 
										case 6:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B></B></td>
                                                     </tr>";
                                            
                                    break; 
									case 7:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>0.00</b></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B> ".$this->angka($lain)."</B></td>
                                                     </tr>";
                                            
                                    break; 
                                    case 8:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>".$this->angka($ekuitas_akhir)."</b></td>
                                                    <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>".$this->angka($surpluslalu+$nnllu1)."</b></td>
                                                     </tr>";
                                            
                                    break; 
                                    default:  
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b></b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp; &nbsp; &nbsp; &nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> ".$this->angka($nilai_tamp)."</td>
                                                     </tr>";                      
                                } 
                    }
 
           $cRet .="<tr>
                    <td align=\"center\" width=\"5%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\" >&nbsp;</td>
                    <td align=\"center\" width=\"65%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td>
                    <td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td> 
                    <td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td> 
                           
                    </tr>"; 
                    
        $cRet .=       " </table>";
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id1' and kode='PA'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\">&nbsp;</td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td align=\"center\">$jabatan</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
                            <td align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
                            <td align=\"center\"><b>NIP. $nip</b></td>
                        </tr>";                                               

         $cRet .='</table>';               
         
              
				
					   $data['prev']= $cRet;    
        switch($cetak123) {        
        case 1;
            // $this->tukd_model->_mpdf('',$cRet,'5','5',5,'0');
           $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
		
			
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= lpe.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        }
    }
    

  function ctk_lpe_ppkd($cetak = 1){
        $thn_ang   = $this->session->userdata('pcThang');
        $id1       = $this->session->userdata('kdskpd');
        $nmskpd    = $this->tukd_model->get_nama($id1,'nm_skpd','ms_skpd','kd_skpd');
        $nmskpd    = strtoupper($nmskpd);
        $thn_ang_1 = $thn_ang-1;  
		$cetak123=$this->uri->segment(3);
        $bul       = $_REQUEST['tgl1'];
        $bulan     = $this->tukd_model->getBulan($bul); 
        $tgl_ttd   = $_REQUEST['tgl_ttd'];               
        
        $sqlsawal = "SELECT *  FROM map_lpe  where nor='7'";
        $queryawal = $this->db->query($sqlsawal);
        $jmlsaldo = $queryawal->row();
        $jmlsal = $jmlsaldo->thn_m1;
        

	

$sqlsc="SELECT sum(thn_m1) as a from map_lpe_ppkd ";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {$nnllu1     = $rowsc->a;} 

		
		
		$nnllu11 = number_format($nnllu1, "2", ".", ",");
		
		 $rkppkd="SELECT SUM(a.kredit)-SUM(a.debet) AS nrkppkd FROM trdju_pkd a INNER JOIN trhju_pkd b 
		ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd AND a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$id1' 
		AND MONTH(b.tgl_voucher)<='$bul' AND
		kd_rek5='1180101' AND YEAR(tgl_voucher)='$thn_ang'";
                 $qrkppkd=$this->db->query($rkppkd);
                 foreach ($qrkppkd->result() as $rowsas)
                {$nrkppkd     = $rowsas->nrkppkd;} 	

//lalu
		        $sql41lalu = "SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd_lalu a INNER JOIN trhju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE tgl_voucher='2015-12-31' AND LEFT(a.kd_rek5,1)='8' AND b.kd_skpd='$id1'  ";
        $query41lalu = $this->db->query($sql41lalu);
        $jmlplalu = $query41lalu->row();
        $jmlpendapatanlalu = $jmlplalu->nilai;
        $jmlpendapatanlalu1 = number_format($jmlplalu->nilai, "2", ".", ",");
        
        $sql51lalu = "SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd_lalu a INNER JOIN trhju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE tgl_voucher='2015-12-31' AND LEFT(a.kd_rek5,1)='9' AND b.kd_skpd='$id1' ";
        $query51lalu = $this->db->query($sql51lalu);
        $jmlblalu = $query51lalu->row();
        $jmlbelanjalalu = $jmlblalu->nilai;
        $jmlbelanjalalu1 = number_format($jmlblalu->nilai, "2", ".", ",");
		//

        
 $surpluslalu = ($jmlpendapatanlalu - $jmlbelanjalalu);
        
     

        $sql41 = "SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(a.kd_rek5,1)='8' AND b.kd_skpd='$id1'  AND YEAR(tgl_voucher)='$thn_ang'";
        $query41 = $this->db->query($sql41);
        $jmlp = $query41->row();
        $jmlpendapatan = $jmlp->nilai;
        $jmlpendapatan1 = number_format($jmlp->nilai, "2", ".", ",");
        
        $sql51 = "SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(a.kd_rek5,1)='9' AND b.kd_skpd='$id1' AND YEAR(tgl_voucher)='$thn_ang'";
        $query51 = $this->db->query($sql51);
        $jmlb = $query51->row();
        $jmlbelanja = $jmlb->nilai;
        $jmlbelanja1 = number_format($jmlb->nilai, "2", ".", ",");
        
        $surplus = ($jmlpendapatan - $jmlbelanja);
   
		
		
		
		$ekuitas_akhir=$surplus+$nnllu1+$nrkppkd+$surpluslalu;

	
		
       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
    
        $cRet = '';
        $lastmoth=$thn.'-'.$bul.'-'.'01';
		$lastyear=date('Y-m-t',strtotime($lastmoth)); 
		$str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH $kab</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>$nmskpd</strong></td>                         
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>LAPORAN PERUBAHAN EKUITAS </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK PERIODE YANG BERAKHIR SAMPAI DENGAN<br>$str</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Saldo $thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Saldo $thn_ang_1</b></td>
                          
                        </tr>  
                     </thead>";                   

					 
					 
					   $sqlaa ="SELECT sum(thn_m1) as a from map_lpe_ppkd where nor='0'";
                    $hasil1aa= $this->db->query($sqlaa); 
					   $lain=0;
                    foreach ($hasil1aa->result() as $rowa)
                    {                    
                       $lain    =$rowa->a;
					}	


					 
                    $sql = "SELECT * FROM map_lpe_ppkd ORDER BY seq";               
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row)
                    {                     
                       $kd_rek   =$row->nor ;
                       $parent   =$row->parent;
                       $nama     =$row->uraian;
                       $nilai_1    =$row->thn_m1;
                       $seque   =$row->seq;
					   
					    $sql1 ="SELECT sum(thn_m1) as a from map_lpe_ppkd where  seq='$seque'";
                    $hasil1 = $this->db->query($sql1); 
					   $nilai_tamp=0;
                    foreach ($hasil1->result() as $row)
                    {                    
                       $nilai_tamp    =$row->a;
					}	

		
					
					   
                               switch ($kd_rek)
                                {
                                    case 1:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B>".$this->angka($surpluslalu+$nnllu1)."</b></td>
                                                       <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B>".$this->angka($nilai_tamp)."</B></td>
                                                    
                                                     </tr>";
                                            
                                    break; 
                                    case 2:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>".$this->angka($surplus)."</b></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>".$this->angka($surpluslalu)."</b></td>
                                                     </tr>";
                                            
                                    break; 
                                     case 3:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B>".$this->angka($nrkppkd)."</B></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B>".$this->angka($nilai_tamp)."</B></td></B></td>
                                                     </tr>";
                                            
                                    break; 
									case 4:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B></B></td>
                                                     </tr>";
                                            
                                    break; 
										case 5:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B></B></td>
                                                     </tr>";
                                            
                                    break; 
										case 6:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B></B></td>
                                                     </tr>";
                                            
                                    break; 
									case 7:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>0.00</b></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><B> ".$this->angka($lain)."</B></td>
                                                     </tr>";
                                            
                                    break; 
                                    case 8:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>".$this->angka($ekuitas_akhir)."</b></td>
                                                    <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>".$this->angka($surpluslalu+$nnllu1)."</b></td>
                                                     </tr>";
                                            
                                    break; 
                                    default:  
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b></b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp; &nbsp; &nbsp; &nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> ".$this->angka($nilai_tamp)."</td>
                                                     </tr>";                      
                                } 
                    }
 
           $cRet .="<tr>
                    <td align=\"center\" width=\"5%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\" >&nbsp;</td>
                    <td align=\"center\" width=\"65%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td>
                    <td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td> 
                    <td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td> 
                           
                    </tr>"; 
                    
        $cRet .=       " </table>";
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id1' and kode='PA'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\">&nbsp;</td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td align=\"center\">$jabatan</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
                            <td align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
							<td>&nbsp;</td>
                            <td align=\"center\"><b>NIP. $nip</b></td>
                        </tr>";                                               

         $cRet .='</table>';               
         
              
				
					   $data['prev']= $cRet;    
        switch($cetak123) {        
        case 1;
            // $this->tukd_model->_mpdf('',$cRet,'5','5',5,'0');
           $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
		
			
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= lpe.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        }
    }   
	/*function ctk_lpsal($cetak = 1){
        $thn_ang = $this->session->userdata('pcThang');
        $thn_ang_1= $thn_ang-1;   
        
        $sqlsawal = "SELECT *  FROM map_lpsal  where nor='8'";
        $queryawal = $this->db->query($sqlsawal);
        $jmlsaldo = $queryawal->row();
        $jmlsal = $jmlsaldo->thn_m1;
        
        $sql41 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,1)='8' ";
        $query41 = $this->db->query($sql41);
        $jmlp = $query41->row();
        $jmlpendapatan = $jmlp->nilai;
        $jmlpendapatan1 = number_format($jmlp->nilai, "2", ",", ".");

        $sql51 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,1)='9' ";
        $query51 = $this->db->query($sql51);
        $jmlb = $query51->row();
        $jmlbelanja = $jmlb->nilai;
        $jmlbelanja1 = number_format($jmlb->nilai, "2", ",", ".");
        $sql523 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,3)='923' ";
        $query523 = $this->db->query($sql523);
        $jmlbm = $query523->row();
        $jmlbmbelanja = $jmlbm->nilai;
        $jmlbmbelanja1 = number_format($jmlbmbelanja, "2", ",", ".");
        $sql61 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,2)='71' ";
        $query61 = $this->db->query($sql61);
        $jmlpm = $query61->row();
        $jmlpmasuk = $jmlpm->nilai;
        $sql62 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,2)='72' ";
        $query62 = $this->db->query($sql62);
        $jmlpk = $query62->row();
        $jmlpkeluar = $jmlpk->nilai;
        $surplus = $jmlpendapatan - $jmlbelanja;
        
        $jum1=$jmlsal+$jmlpmasuk;
        
        $biaya_net = $jmlpmasuk - $jmlpkeluar;
        $silpa = ($jmlpendapatan + $jmlpmasuk) - ($jmlbelanja + $jmlpkeluar);
        if ($silpa < 0)
        {
            $a = "(";
            $silpa1 = $silpa*-1;
            $b = ")";
        } else
        {
            $a = "";
            $silpa1 = $silpa;
            $b = "";
        }
        $jum2=$jum1+$silpa;
        if ($jum2 < 0)
        {
            $c = "(";
            $jum2 = $jum2 * -1;
            $d = ")";
        } else
        {
            $c = "";
            $d = "";
        }
        $sal_akhir=$jum1+$silpa;
        if ($sal_akhir < 0)
        {
            $c = "(";
            $sal_akhir = $sal_akhir * -1;
            $d = ")";
        } else
        {
            $c = "";
            $d = "";
        }
                  
    
         $cRet = '';
         $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
         
            <tr>
                <td align=\"center\" colspan=\"4\" style=\"font-size:14px;border: solid 1px white;\"><b>PEMERINTAH KABUPATEN BIAK NUMFOR<br>LAPORAN PERUBAHAN SALDO ANGGARAN LEBIH<br>31 DESEMBER $thn_ang_1 DAN $thn_ang</b></td>
            </tr>
              <tr>
                <td align=\"left\" colspan=\"4\" style=\"font-size:14px;border: solid 1px white;\">&nbsp;</td>
            </tr>
            
            
            <tr>
                <td align=\"left\"  style=\"font-size:14px;border: solid 1px white;border-bottom:solid 2px black;\">&nbsp;</td>
                <td align=\"left\" colspan=\"3\" style=\"font-size:14px;border: solid 1px white;border-bottom:solid 2px black;\">&nbsp;</td>
            </tr>
      
            <tr>
                <td align=\"center\" width=\"5%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:solid 1px black;\" >NO</td>
                <td align=\"center\" width=\"65%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:solid 1px black;\">URAIAN</td>
                <td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:solid 1px black;\">$thn_ang_1</td> 
                <td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:solid 1px black;\">$thn_ang</td>            
            </tr>";
                                             
                
                    $sql = "SELECT * FROM map_lpsal  ORDER BY seq";
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row)
                    {
                      
                       $kd_rek   =$row->nor ;
                       $nama     =$row->uraian;
                       $nilai_1    =$row->thn_m1;
                       
                               switch ($kd_rek)
                                {
                                    case 1:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> ".number_format($nilai_1,2,',','.')."</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">".number_format($jmlsal,2,',','.')."</td>
                                                     </tr>";
                                            
                                    break; 
                                    case 2:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> ".number_format($nilai_1,2,',','.')."</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">".number_format($jmlpmasuk,2,',','.')."</td>
                                                     </tr>";
                                            
                                    break; 
                                     case 3:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> ".number_format($nilai_1,2,',','.')."</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">".number_format($jum1,2,',','.')."</td>
                                                     </tr>";
                                            
                                    break;
                                    case 4:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> ".number_format($nilai_1,2,',','.')."</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$a".number_format($silpa1,2,',','.')."$b</td>
                                                     </tr>";
                                            
                                    break; 
                                    case 5:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> ".number_format($nilai_1,2,',','.')."</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$c".number_format($jum2,2,',','.')."$d</td>
                                                     </tr>";
                                            
                                    break;
                                    case 8:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> ".number_format($nilai_1,2,',','.')."</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">$c".number_format($sal_akhir,2,',','.')."$d</td>
                                                     </tr>";
                                            
                                    break;  
                                    default:  
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp; &nbsp; &nbsp; &nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> ".number_format($nilai_1,2,',','.')."</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp;</td>
                                                     </tr>";                      
                                } 
                       
                    }
                 


  
           $cRet .="<tr>
                    <td align=\"center\" width=\"5%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\" >&nbsp;</td>
                    <td align=\"center\" width=\"65%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td>
                    <td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td> 
                    <td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td>            
                    </tr>";                            
           
        
                
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = 'LAPORAN PERUBAHAN SALDO ANGGARAN LEBIH';
        $this->template->set('title', 'LAPORAN PERUBAHAN SALDO ANGGARAN LEBIH');  
         switch ($cetak)
        {
            case 1;
                $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
                break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }

    }*/
	//11-09-2015
	
	
	
	function ctk_lpsal($cetak = 1){
        $thn_ang = $this->session->userdata('pcThang');
        $thn_ang_1= $thn_ang-1;   
        
        $sqlsawal = "SELECT * FROM map_lpsal  where nor='8'";
        $queryawal = $this->db->query($sqlsawal);
        $jmlsaldo = $queryawal->row();
        $jmlsal = $jmlsaldo->thn_m1;
        
        //$sql41 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,1)='8' ";
		$sql41 = "SELECT SUM(kredit)-SUM(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
		WHERE LEFT(a.kd_rek5,1)='8'";
        $query41 = $this->db->query($sql41);
        $jmlp = $query41->row();
        $jmlpendapatan = $jmlp->nilai;
        $jmlpendapatan1 = number_format($jmlp->nilai, "2", ",", ".");
		
        //$sql51 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,1)='9' ";
		$sql51 = "SELECT SUM(debet)-SUM(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
		WHERE LEFT(a.kd_rek5,1)='9'";
        $query51 = $this->db->query($sql51);
        $jmlb = $query51->row();
        $jmlbelanja = $jmlb->nilai;
        $jmlbelanja1 = number_format($jmlb->nilai, "2", ",", ".");
		
        //$sql523 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,3)='923' ";
		$sql523 = "SELECT SUM(debet)-SUM(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
		WHERE LEFT(a.kd_rek5,3)='923'";
        $query523 = $this->db->query($sql523);
        $jmlbm = $query523->row();
        $jmlbmbelanja = $jmlbm->nilai;
        $jmlbmbelanja1 = number_format($jmlbmbelanja, "2", ",", ".");
		
        //$sql61 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,2)='71'";
		$sql61 = "SELECT SUM(kredit)-SUM(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
		WHERE LEFT(a.kd_rek5,2)='71'";
        $query61 = $this->db->query($sql61);
        $jmlpm = $query61->row();
        $jmlpmasuk = $jmlpm->nilai;
		
        //$sql62 = "SELECT SUM(real_spj) as nilai FROM realisasi WHERE left(kd_rek5,2)='72'";
		$sql62 = "SELECT SUM(debet)-SUM(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
		WHERE LEFT(a.kd_rek5,2)='72'";
        $query62 = $this->db->query($sql62);
        $jmlpk = $query62->row();
        $jmlpkeluar = $jmlpk->nilai;
        $surplus = $jmlpendapatan - $jmlbelanja;
        
        $jum1=$jmlsal+$jmlpmasuk;
        
        $biaya_net = $jmlpmasuk - $jmlpkeluar;
        $silpa = ($jmlpendapatan + $jmlpmasuk) - ($jmlbelanja + $jmlpkeluar);
        if ($silpa < 0)
        {
            $a = "(";
            $silpa1 = $silpa * -1;
            $b = ")";
        } else
        {
            $a = "";
            $silpa1 = $silpa;
            $b = "";
        }
        $jum2=$jum1+$silpa;
        if ($jum2 < 0)
        {
            $c = "(";
            $jum2 = $jum2 * -1;
            $d = ")";
        } else
        {
            $c = "";
            $d = "";
        }
        $sal_akhir=$jum1+$silpa;
        if ($sal_akhir < 0)
        {
            $c = "(";
            $sal_akhir = $sal_akhir * -1;
            $d = ")";
        } else
        {
            $c = "";
            $d = "";
        }
                      
         $cRet = '';
         $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
         
            <tr>
                <td align=\"center\" colspan=\"4\" style=\"font-size:14px;border: solid 1px white;\"><b>PEMERINTAH KABUPATEN BIAK NUMFOR<br>LAPORAN PERUBAHAN SALDO ANGGARAN LEBIH<br>31 DESEMBER $thn_ang_1 DAN $thn_ang</b></td>
            </tr>
              <tr>
                <td align=\"left\" colspan=\"4\" style=\"font-size:14px;border: solid 1px white;\">&nbsp;</td>
            </tr>
            
            
            <tr>
                <td align=\"left\"  style=\"font-size:14px;border: solid 1px white;border-bottom:solid 2px black;\">&nbsp;</td>
                <td align=\"left\" colspan=\"3\" style=\"font-size:14px;border: solid 1px white;border-bottom:solid 2px black;\">&nbsp;</td>
            </tr>
      
            <tr>
                <td align=\"center\" width=\"5%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:solid 1px black;\" ><b>NO</b></td>
                <td align=\"center\" width=\"65%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:solid 1px black;\"><b>URAIAN</b></td>
                <td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:solid 1px black;\"><b>$thn_ang</b></td> 
                <td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:solid 1px black;\"><b>$thn_ang_1</b></td>            
            </tr>";
                                             
                
                    $sql = "SELECT * FROM map_lpsal  ORDER BY seq";
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row)
                    {
                      
                       $kd_rek   =$row->nor ;
                       $nama     =$row->uraian;
                       $nilai_1    =$row->thn_m1;
                       
                               switch ($kd_rek)
                                {
                                    case 1:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b> ".number_format($jmlsal,2,',','.')."</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>".number_format($nilai_1,2,',','.')."</b></td>
                                                     </tr>";
                                            
                                    break; 
                                    case 2:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>( ".number_format($jmlpmasuk,2,',','.').")</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>(".number_format($nilai_1,2,',','.').")</b></td>
                                                     </tr>";
                                            
                                    break; 
                                     case 3:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b> ".number_format($jum1,2,',','.')."</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>".number_format($nilai_1,2,',','.')."</b></td>
                                                     </tr>";
                                            
                                    break;
                                    case 4:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b> ".number_format($silpa1,2,',','.')."</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$a".number_format($nilai_1,2,',','.')."$b</b></td>
                                                     </tr>";
                                            
                                    break; 
                                    case 5:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b> ".number_format($jum2,2,',','.')."</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$c".number_format($nilai_1,2,',','.')."$d</b></td>
                                                     </tr>";
                                            
                                    break;
                                    case 8:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b> ".number_format($sal_akhir,2,',','.')."</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$c".number_format($nilai_1,2,',','.')."$d</b></td>
                                                     </tr>";
                                            
                                    break;  
                                    default:  
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp; &nbsp; &nbsp; &nbsp;$nama</td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">".number_format($nilai_1,2,',','.')."</td>
                                                     </tr>";                      
                                }                        
                    }
                 
           $cRet .="<tr>
                    <td align=\"center\" width=\"5%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\" >&nbsp;</td>
                    <td align=\"center\" width=\"65%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td>
                    <td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td> 
                    <td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td>            
                    </tr>";                            
           
        
                
        $cRet .='</table>';
                 
         $data['prev']= $cRet;  
         $data['sikap'] = 'preview';
         $judul = 'LAPORAN PERUBAHAN SALDO ANGGARAN LEBIH';
        $this->template->set('title', 'LAPORAN PERUBAHAN SALDO ANGGARAN LEBIH');  
         switch ($cetak)
        {
            case 1;
                $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
                break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }

    }
    
    function  tanggal_format_indonesia($tgl){
        $tanggal  = explode('-',$tgl); 
        $bulan  = $this-> getBulan($tanggal[1]);
        $tahun  =  $tanggal[0];
        return  $tanggal[2].' '.$bulan.' '.$tahun;

        }
         
    function  tanggal_indonesia($tgl){
        $tanggal  =  substr($tgl,8,2);
        $bulan  = substr($tgl,5,2);
        $tahun  =  substr($tgl,0,4);
        return  $tanggal.'-'.$bulan.'-'.$tahun;

        }
        
    function  getBulan($bln){
		switch  ($bln){
			case  1:
			return  "Januari";
			break;
			case  2:
			return  "Februari";
			break;
			case  3:
			return  "Maret";
			break;
			case  4:
			return  "April";
			break;
			case  5:
			return  "Mei";
			break;
			case  6:
			return  "Juni";
			break;
			case  7:
			return  "Juli";
			break;
			case  8:
			return  "Agustus";
			break;
			case  9:
			return  "September";
			break;
			case  10:
			return  "Oktober";
			break;
			case  11:
			return  "November";
			break;
			case  12:
			return  "Desember";
			break;
		}
    }	 

	function _mpdf1($judul='',$isi='',$lMargin=10,$rMargin=10,$font=10,$orientasi='',$skpd='',$hal='') {
        
        ini_set("memory_limit","-1");
        $this->load->library('mpdf');

        $this->mpdf->defaultheaderfontsize = 6;	/* in pts */
        $this->mpdf->defaultheaderfontstyle = BI;	/* blank, B, I, or BI */
        $this->mpdf->defaultheaderline = 1; 	/* 1 to include line below header/above footer */
		
        $this->mpdf->defaultfooterfontsize = 7;	/* in pts */
        $this->mpdf->defaultfooterfontstyle = B;	/* blank, B, I, or BI */
        $this->mpdf->defaultfooterline = 1; 

		$this->mpdf->SetBottomMargin('12');
		$initial='';
        $this->mpdf->SetFooter(''.$initial.' ||'.$skpd.' Halaman  : {PAGENO}| ');
        $this->mpdf->AddPage($orientasi,'',$hal,'1','off',$lMargin,$rMargin);

        if (!empty($judul)) $this->mpdf->writeHTML($judul);
        $this->mpdf->writeHTML($isi);         
        $this->mpdf->Output();
               
    }

    	function _mpdf1_tes($judul='',$isi='',$lMargin=10,$rMargin=10,$font=10,$orientasi='',$skpd='',$hal='',$waktu='') {
        
        ini_set("memory_limit","-1");
        $this->load->library('mpdf');

        $this->mpdf->defaultheaderfontsize = 6;	/* in pts */
        $this->mpdf->defaultheaderfontstyle = BI;	/* blank, B, I, or BI */
        $this->mpdf->defaultheaderline = 1; 	/* 1 to include line below header/above footer */
		
        $this->mpdf->defaultfooterfontsize = 7;	/* in pts */
        $this->mpdf->defaultfooterfontstyle = B;	/* blank, B, I, or BI */
        $this->mpdf->defaultfooterline = 1; 

		$this->mpdf->SetBottomMargin('12');
		$initial='';

	 $this->mpdf->SetFooter('Printed on SIMAKDA @ {DATE j-m-Y H:i:s} ||Halaman {PAGENO} / {nb}| ');
        //$this->mpdf->SetFooter(''.$initial.' ||'.$skpd.' Halaman  : {PAGENO}| ');
        $this->mpdf->AddPage($orientasi,'',$hal,'1','off',$lMargin,$rMargin);

        if (!empty($judul)) $this->mpdf->writeHTML($judul);
        $this->mpdf->writeHTML($isi);         
        $this->mpdf->Output();
               
    }

//==================mulai_prognosis================================
   /* function cetak_perda1_semester_skpd(){
        $id 	   = $_REQUEST['kdskpd']; 
        $thn_ang   = $this->session->userdata('pcThang');
        $tgl_ttd   = $_REQUEST['tgl_ctk'];       

       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
				
       $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk 
                    FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
     
        $sql="SELECT 
					ifnull((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='$id'
					AND LEFT(c.kd_rek64,1)='4'),0) AS angpen,
					ifnull((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='$id'
					AND LEFT(c.kd_rek64,1)='5'),0) AS angbel,
					ifnull((SELECT SUM(b.kredit)-SUM(b.debet) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE b.kd_skpd='$id' AND LEFT(b.kd_rek5,1)='4' AND MONTH(a.tgl_voucher)<='6'),0) AS totpen,
					ifnull((SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE b.kd_skpd='$id' AND LEFT(b.kd_rek5,1)='5' AND MONTH(a.tgl_voucher)<='6'),0) AS totbel
             ";    
                                                
                    $query   = $this->db->query($sql);
                    $hasil   = $query->row();
                    $angpen  = $hasil->angpen;
                    $angbel  = $hasil->angbel;
                    $totpen  = $hasil->totpen;
                    $totbel  = $hasil->totbel;                    
                 
        $surang = $angpen - $angbel;
        if ($surang < 0){
                    	$x1="("; 
                        $surang=$surang*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $surang=$surang*1; 
                        $y1="";
                        }
						
        $surang1= number_format($surang,"2",".",",");
        
        $surrel = $totpen - $totbel;
        if ($surrel < 0){
                    	$x1="("; 
                        $surrel=$surrel*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $surrel=$surrel*1; 
                        $y1="";
                        }  
						
        $surrel1= number_format($surrel,"2",".",",");
		
		$sursisa = $surang - $surrel;		
		$sursisa1  = number_format($sursisa,"2",".",",");			
        
        $cRet='';       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH $kab</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>LAPORAN REALISASI SEMESTER PERTAMA PENDAPATAN DAN BELANJA SKPD<br>SERTA PROGNOSIS 6 (ENAM) BULAN BERIKUTNYA</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>                         
                    </tr>                                       
                    <tr>
                         <td align=\"center\"><strong>Tahun Anggaran $thn_ang</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"3%\" align=\"center\"><b>NO</b></td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"37%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\"><b>Jumlah Anggaran</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\"><b>Realisasi Semester Pertama</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\" ><b>Sisa Anggaran<br>s.d<br>Semester Pertama</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\" ><b>Prognosis</b></td>  
							<td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\" ><b>Keterangan</b></td> 
                        </tr>  
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td> 
							<td style=\"border-top: none;\"></td>
                         </tr>
                     </tfoot>";

                 $sql4 ="SELECT nor,uraian,seq,
								(SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='$id' 
								AND (LEFT(c.kd_rek64,3)=a.kode_1 OR LEFT(c.kd_rek64,2)=a.kode_1 OR LEFT(c.kd_rek64,1)=a.kode_1)) AS anggaran,
								(SELECT SUM(debet) AS debet FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
								WHERE b.kd_skpd='$id' AND MONTH(a.tgl_voucher)<='6' 
								AND (LEFT(b.kd_rek5,3)=a.kode_1 OR LEFT(b.kd_rek5,2)=a.kode_1 OR LEFT(b.kd_rek5,1)=a.kode_1)) AS debet,
								(SELECT SUM(kredit) AS kredit FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
								WHERE b.kd_skpd='$id' AND MONTH(a.tgl_voucher)<='6' 
								AND (LEFT(b.kd_rek5,3)=a.kode_1 OR LEFT(b.kd_rek5,2)=a.kode_1 OR LEFT(b.kd_rek5,1)=a.kode_1)) AS kredit	
								FROM map_lra_skpd a ORDER BY nor";
                            
                $query4 = $this->db->query($sql4);                                  
                foreach ($query4->result() as $row4)
                {
                    $no         = $row4->nor;
                    $nama       = $row4->uraian;   
                    $anggaran   = $row4->anggaran;
                    $debet      = $row4->debet;
                    $kredit     = $row4->kredit;
                    $seq        = $row4->seq;
                    
                    $angg  = number_format($anggaran,"2",".",",");
                    if($row4->seq<'50'){
                      $nilai = $kredit-$debet;
                    }else{
                      $nilai = $debet-$kredit;    
                    }
                    $nil  = number_format($nilai,"2",".",",");
					
					$sisa = $anggaran - $nilai;
					if ($sisa < 0){
                    	$x="("; 
                        $sisa=$sisa*-1; 
                        $y=")";
                        }else {
                    	$x="";
                        $sisa=$sisa*1; 
                        $y="";
                        } 

					$sisaangg  = number_format($sisa,"2",".",",");
					
                    switch ($row4->seq) {
                    case 5:
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
					 case 10:
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                    case 30:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 40:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
					 case 50:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                    case 55:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 70:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;                                         
                    case 80:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 115:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 125:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 135:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$surang1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$surrel1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$sursisa1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$sursisa1$y1</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;                                                                          
                    default:
					if($nama <> ''){
                    $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$angg</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nil</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$x$sisaangg$y</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$x$sisaangg$y</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";
					}else{
					 $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";	
					}
                }         
                }

        $cRet .=       " </table>";
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id' and kode='PA'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>$jabatan<b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>$nip</b></td>
                        </tr>
                    </table>"; 

             $this->tukd_model->_mpdf('',$cRet,10,10,10,'1');
                 
    }    */
	
	//==================mulai_prognosis================================
     function cetak_perda1_semester_skpd(){ 
        $id 	    = $_REQUEST['kdskpd']; 
        $thn_ang    = $this->session->userdata('pcThang');
		$total_segment= $this->uri->total_segments();
		$hal = $this->uri->segment($total_segment);

		$mry=$_REQUEST['halamanwehgeus'];

       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
				
       $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk 
                    FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
     
        $sql="SELECT 
					ifnull((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='$id'
					AND LEFT(c.kd_rek64,1)='4'),0) AS angpen,
					ifnull((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='$id'
					AND LEFT(c.kd_rek64,1)='5'),0) AS angbel,
					ifnull((SELECT SUM(b.kredit)-SUM(b.debet) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE b.kd_skpd='$id' AND LEFT(b.kd_rek5,1)='4' AND MONTH(a.tgl_voucher)<='6'),0) AS totpen,
					ifnull((SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE b.kd_skpd='$id' AND LEFT(b.kd_rek5,1)='5' AND MONTH(a.tgl_voucher)<='6'),0) AS totbel
             ";    
                                                
                    $query   = $this->db->query($sql);
                    $hasil   = $query->row();
                    $angpen  = $hasil->angpen;
                    $angbel  = $hasil->angbel;
                    $totpen  = $hasil->totpen;
                    $totbel  = $hasil->totbel;                    
                 
        $surang = $angpen - $angbel;
        if ($surang < 0){
                    	$x1="("; 
                        $surang=$surang*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $surang=$surang*1; 
                        $y1="";
                        }
						
        $surang1= number_format($surang,"2",".",",");
        
        $surrel = $totpen - $totbel;
        if ($surrel < 0){
                    	$x1="("; 
                        $surrel=$surrel*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $surrel=$surrel*1; 
                        $y1="";
                        }  
						
        $surrel1= number_format($surrel,"2",".",",");
		
		$sursisa = $surang - $surrel;		
		$sursisa1  = number_format($sursisa,"2",".",",");			
        
        $cRet='';       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH $kab</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>LAPORAN REALISASI SEMESTER PERTAMA PENDAPATAN DAN BELANJA SKPD<br>SERTA PROGNOSIS 6 (ENAM) BULAN BERIKUTNYA</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>                         
                    </tr>                                       
                    <tr>
                         <td align=\"center\"><strong>Tahun Anggaran $thn_ang</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"3%\" align=\"center\"><b>NO</b></td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"37%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\"><b>Jumlah Anggaran</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\"><b>Realisasi Semester Pertama</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\" ><b>Sisa Anggaran<br>s.d<br>Semester Pertama</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\" ><b>Prognosis</b></td>  
							<td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\" ><b>Keterangan</b></td> 
                        </tr>  
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td> 
							<td style=\"border-top: none;\"></td>
                         </tr>
                     </tfoot>";

                 $sql4 ="SELECT nor,uraian,seq,
								(SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='$id' 
								AND (LEFT(c.kd_rek64,3)=a.kode_1 OR LEFT(c.kd_rek64,2)=a.kode_1 OR LEFT(c.kd_rek64,1)=a.kode_1)) AS anggaran,
								(SELECT SUM(debet) AS debet FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
								WHERE b.kd_skpd='$id' AND MONTH(a.tgl_voucher)<='6' 
								AND (LEFT(b.kd_rek5,3)=a.kode_1 OR LEFT(b.kd_rek5,2)=a.kode_1 OR LEFT(b.kd_rek5,1)=a.kode_1)) AS debet,
								(SELECT SUM(kredit) AS kredit FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
								WHERE b.kd_skpd='$id' AND MONTH(a.tgl_voucher)<='6' 
								AND (LEFT(b.kd_rek5,3)=a.kode_1 OR LEFT(b.kd_rek5,2)=a.kode_1 OR LEFT(b.kd_rek5,1)=a.kode_1)) AS kredit	
								FROM map_lra_skpd a ORDER BY nor";
                            
                $query4 = $this->db->query($sql4);                                  
                foreach ($query4->result() as $row4)
                {
                    $no         = $row4->nor;
                    $nama       = $row4->uraian;   
                    $anggaran   = $row4->anggaran;
                    $debet      = $row4->debet;
                    $kredit     = $row4->kredit;
                    $seq        = $row4->seq;
                    
                    $angg  = number_format($anggaran,"2",".",",");
                    if($row4->seq<'50'){
                      $nilai = $kredit-$debet;
                    }else{
                      $nilai = $debet-$kredit;    
                    }
                    $nil  = number_format($nilai,"2",".",",");
					
					$sisa = $anggaran - $nilai;
					if ($sisa < 0){
                    	$x="("; 
                        $sisa=$sisa*-1; 
                        $y=")";
                        }else {
                    	$x="";
                        $sisa=$sisa*1; 
                        $y="";
                        } 

					$sisaangg  = number_format($sisa,"2",".",",");
					
                    switch ($row4->seq) {
                    case 5:
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
					 case 10:
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                    case 30:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 40:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
					 case 50:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                    case 55:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 70:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;                                         
                    case 80:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 115:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 125:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 135:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$surang1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$surrel1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$sursisa1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$sursisa1$y1</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;                                                                          
                    default:
					if($nama <> ''){
                    $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$angg</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nil</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$x$sisaangg$y</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$x$sisaangg$y</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";
					}else{
					 $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";	
					}
                }         
                }

        $cRet .=       " </table>";
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id' and kode='PA'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }
		
		//nonaktif baladewa
		/*$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>$jabatan<b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>$nip</b></td>
                        </tr>
                    </table>"; */
		
		$skpdx=$kd_skpd.' '.$nm_skpd;
        $this->template->set('title', 'CETAK');    
        
          
	$cetak = $this->uri->segment(3);
$data['prev']= $cRet;
	  
        switch($cetak) {        
        case 1;
        $this->_mpdf1('',$cRet,25,10,10,'P',$skpdx,$mry);
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $skpdx.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        }			  
                 
    }    
    
	function cetak_perda1_semester_pemda(){
		$id   = $this->session->userdata('kdskpd');	
        $thn_ang   = $this->session->userdata('pcThang');
        $tgl_ttd   = $_REQUEST['tgl_ctk'];
		$mry   = $_REQUEST['halamanwehgeus'];		

       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                }  
     
        $sql="SELECT 
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,1)='4'),0) AS angpen,
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,1)='5'),0) AS angbel,
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='61'),0) AS angpentrans,
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='62'),0) AS angbeltrans,
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='71'),0) AS angpenepemb,
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='72'),0) AS angpengpemb,
IFNULL((SELECT SUM(b.kredit)-SUM(b.debet) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE LEFT(b.kd_rek5,1)='4' AND MONTH(a.tgl_voucher)<='6'),0) AS totpen,
IFNULL((SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE LEFT(b.kd_rek5,1)='5' AND MONTH(a.tgl_voucher)<='6'),0) AS totbel,
IFNULL((SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE LEFT(b.kd_rek5,2)='61' AND MONTH(a.tgl_voucher)<='6'),0) AS totpentrans,
IFNULL((SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE LEFT(b.kd_rek5,2)='62' AND MONTH(a.tgl_voucher)<='6'),0) AS totbeltrans,
IFNULL((SELECT SUM(b.kredit)-SUM(b.debet) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE LEFT(b.kd_rek5,2)='71' AND MONTH(a.tgl_voucher)<='6'),0) AS totpenepemb,
IFNULL((SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE LEFT(b.kd_rek5,2)='72' AND MONTH(a.tgl_voucher)<='6'),0) AS totpengpemb";    
			 
                    $query   = $this->db->query($sql);
                    $hasil   = $query->row();
                    $angpen  = $hasil->angpen;
                    $angbel  = $hasil->angbel;
					$angpentrans = $hasil->angpentrans;
					$angbeltrans = $hasil->angbeltrans;
					$angpenepemb = $hasil->angpenepemb;
					$angpengpemb = $hasil->angpengpemb;
                    $totpen  = $hasil->totpen;
                    $totbel  = $hasil->totbel;
					$totpentrans = $hasil->totpentrans;
					$totbeltrans = $hasil->totbeltrans;
					$totpenepemb = $hasil->totpenepemb;
					$totpengpemb = $hasil->totpengpemb;

		$apemby = $angpen-($angbel+$angpentrans+$angbeltrans)+($angpenepemb-$angpengpemb);
		if($apemby < 0) {
                    	$x1="("; 
                        $apemby=$apemby*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $apemby=$apemby*1; 
                        $y1="";
                        }
        $apemby1 = number_format($apemby,"2",".",",");
		
		$rpemby = $totpen-($totbel+$totpentrans+$totbeltrans)+($totpenepemb-$totpengpemb);
		if($rpemby < 0) {
                    	$x1="("; 
                        $rpemby=$rpemby*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $rpemby=$rpemby*1; 
                        $y1="";
                        }
        $rpemby1 = number_format($rpemby,"2",".",",");	

		$silpa = $apemby-$rpemby;
			if($silpa < 0) {
                    	$aw="("; 
                        $silpa=$silpa*-1; 
                        $ah=")";
                        }else{
                    	$aw="";
                        $silpa=$silpa*1; 
                        $ah="";
                        }
		$silpa1 = number_format($silpa,"2",".",",");
		
		$apemb = $angpenepemb - $angpengpemb;
		if($apemb < 0) {
                    	$x1="("; 
                        $apemb=$apemb*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $apemb=$apemb*1; 
                        $y1="";
                        }
        $apemb1 = number_format($apemb,"2",".",",");
		
		$rpemb = $totpenepemb - $totpengpemb;
		if($rpemb < 0) {
                    	$x1="("; 
                        $rpemb=$rpemb*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $rpemb=$rpemb*1; 
                        $y1="";
                        }
        $rpemb1 = number_format($rpemb,"2",".",",");	

		$neto = $apemb-$rpemb;
		if($neto < 0) {
                    	$x="("; 
                        $neto=$neto*-1; 
                        $y=")";
                        }else{
                    	$x="";
                        $neto=$neto*1; 
                        $y="";
                        }		
		$neto1 = number_format($neto,"2",".",",");		
		
		$abeltrans = $angbel + ($angpentrans + $angpentrans);
		if($abeltrans < 0) {
                    	$x1="("; 
                        $abeltrans=$abeltrans*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $abeltrans=$abeltrans*1; 
                        $y1="";
                        }
        $abeltrans1 = number_format($abeltrans,"2",".",",");

		$rbeltrans = $totbel + ($totpentrans + $totbeltrans);
		if($rbeltrans < 0) {
                    	$x1="("; 
                        $rbeltrans=$rbeltrans*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $rbeltrans=$rbeltrans*1; 
                        $y1="";
                        }
        $rbeltrans1 = number_format($rbeltrans,"2",".",",");
		
		$sisarbeltrans = $abeltrans-$rbeltrans;
		if($sisarbeltrans < 0) {
                    	$x="("; 
                        $sisarbeltrans=$sisarbeltrans*-1; 
                        $y=")";
                        }else{
                    	$x="";
                        $sisarbeltrans=$sisarbeltrans*1; 
                        $y="";
                        }		
		$sisarbeltrans1 = number_format($sisarbeltrans,"2",".",",");
		
        $surang = $angpen-($angbel+$angpentrans+$angbeltrans);
        if ($surang < 0){
                    	$x1="("; 
                        $surang=$surang*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $surang=$surang*1; 
                        $y1="";
                        }
						
        $surang1= number_format($surang,"2",".",",");
        
        $surrel = $totpen-($totbel+$totpentrans+$totbeltrans);
        if ($surrel < 0){
                    	$x1="("; 
                        $surrel=$surrel*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $surrel=$surrel*1; 
                        $y1="";
                        }  
						
        $surrel1= number_format($surrel,"2",".",",");
		
		$sursisa = $surang - $surrel;
		if($sursisa < 0) {
                    	$x2="("; 
                        $sursisa=$sursisa*-1; 
                        $y2=")";
                        }else{
                    	$x2="";
                        $sursisa=$sursisa*1; 
                        $y2="";
                        }			
		$sursisa1  = number_format($sursisa,"2",".",",");			
        
        $cRet='';       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH $kab</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>LAPORAN REALISASI SEMESTER PERTAMA PENDAPATAN DAN BELANJA SKPD<br>SERTA PROGNOSIS 6 (ENAM) BULAN BERIKUTNYA</strong></td>                         
                    </tr>                                      
                    <tr>
                         <td align=\"center\"><strong>Tahun Anggaran $thn_ang</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"3%\" align=\"center\"><b>NO</b></td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"37%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\"><b>Jumlah Anggaran</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\"><b>Realisasi Semester Pertama</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\" ><b>Sisa Anggaran<br>s.d<br>Semester Pertama</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\" ><b>Prognosis</b></td>  
							<td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\" ><b>Keterangan</b></td> 
                        </tr>  
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td> 
							<td style=\"border-top: none;\"></td>
                         </tr>
                     </tfoot>";

                 $sql4 ="SELECT nor,uraian,seq,normal,
(SELECT IFNULL(SUM(nilai),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE 
(LEFT(c.kd_rek64,5)=a.kode_1 OR LEFT(c.kd_rek64,3)=a.kode_1 OR LEFT(c.kd_rek64,2)=a.kode_1 OR LEFT(c.kd_rek64,1)=a.kode_1)) AS anggaran,
(SELECT IFNULL(SUM(debet),0) AS debet FROM trdju_pkd
WHERE (LEFT(kd_rek5,5)=a.kode_1 OR LEFT(kd_rek5,3)=a.kode_1 OR LEFT(kd_rek5,2)=a.kode_1 OR LEFT(kd_rek5,1)=a.kode_1) 
AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='6')) AS debet,
(SELECT IFNULL(SUM(kredit),0) AS kredit FROM trdju_pkd
WHERE (LEFT(kd_rek5,5)=a.kode_1 OR LEFT(kd_rek5,3)=a.kode_1 OR LEFT(kd_rek5,2)=a.kode_1 OR LEFT(kd_rek5,1)=a.kode_1) 
AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='6')) AS kredit		
FROM map_lra_kab1 a ORDER BY CAST(nor AS SIGNED)";
                            
                $query4 = $this->db->query($sql4);                                  
                foreach ($query4->result() as $row4)
                {
                    $no         = $row4->nor;
                    $nama       = $row4->uraian;   
                    $anggaran   = $row4->anggaran;
                    $debet      = $row4->debet;
                    $kredit     = $row4->kredit;
                    $seq        = $row4->seq;
                    $normal        = $row4->normal;
                    
                    $angg  = number_format($anggaran,"2",".",",");
                    /*if($row4->seq<'170' or ($row4->seq>'290' and $row4->seq<'325') 
							or ($row4->seq>'370' and $row4->seq<'455')){
                      $nilai = $kredit-$debet;
                    }else{
                      $nilai = $debet-$kredit;    
                    }*/

                    	if($normal=='K'){
			  $nilai = $kredit-$debet;
			}else{
			  $nilai = $debet-$kredit;    
			}

                    $nil  = number_format($nilai,"2",".",",");
					
					$sisa = $anggaran - $nilai;
					if ($sisa < 0){
                    	$x="("; 
                        $sisa=$sisa*-1; 
                        $y=")";
                        }else {
                    	$x="";
                        $sisa=$sisa*1; 
                        $y="";
                        } 

					$sisaangg  = number_format($sisa,"2",".",",");
					
                    switch ($row4->seq) {

                    	    case (($row4->seq==5)||($row4->seq==10)||($row4->seq==45)||($row4->seq==50)||($row4->seq==85)||($row4->seq==115)
						 ||($row4->seq==145)||($row4->seq==180)||($row4->seq==215)||($row4->seq==220)||($row4->seq==265)
						 ||($row4->seq==310)||($row4->seq==335)||($row4->seq==340)||($row4->seq==370)||($row4->seq==420)
						 ||($row4->seq==430)||($row4->seq==505)):
                          $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                    case (($row4->seq==35)||($row4->seq==75)||($row4->seq==105)||($row4->seq==135)||($row4->seq==165)||($row4->seq==170)
						 ||($row4->seq==200)||($row4->seq==205)
						 ||($row4->seq==255)||($row4->seq==300)||($row4->seq==320)||($row4->seq==325)||($row4->seq==360)||($row4->seq==390)
						 ||($row4->seq==395)||($row4->seq==495)||($row4->seq==570)):
                   $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;	


                    case 400:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$abeltrans1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$rbeltrans1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisarbeltrans1$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisarbeltrans1$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;		
                    case 410:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$surang1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$surrel1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sursisa1$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sursisa1$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;	
                 		
                    case 575:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$apemb1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$rpemb1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$neto1$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$neto1$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;		
                    case 585:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$apemby1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$rpemby1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$aw$silpa1$ah</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$aw$silpa1$ah</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;						
                    default:
					if($nama <> ''){
                    $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$angg</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nil</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$x$sisaangg$y</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$x$sisaangg$y</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";
					}else{
					 $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";	
					}
                }         
                }

        $cRet .=       " </table>";
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id' and kode='PA'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>$jabatan<b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>$nip</b></td>
                        </tr>
                    </table>"; 

             $this->template->set('title', 'CETAK');    
     
		
		
		$ctk = $this->uri->segment(3);
		   $data['prev']= $cRet;
            switch($ctk) {        
                case 1;
        $this->_mpdf1('',$cRet,25,10,10,'P','',1);

                break;
                case 2;        
                    header("Cache-Control: no-cache, no-store, must-revalidate");
                    header("Content-Type: application/vnd.ms-excel");
                    header("Content-Disposition: attachment; filename=keseluruhan.xls");
                    $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            } 
                 
    }    

	
	
    
	/*function cetak_perda1_semester_pemda(){
		$id   = $this->session->userdata('kdskpd');	
        $thn_ang   = $this->session->userdata('pcThang');
        $tgl_ttd   = $_REQUEST['tgl_ctk'];       

       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                }  
     
        $sql="SELECT 
					IFNULL((SELECT SUM(nilai_ubah) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,1)='4'),0) AS angpen,
					IFNULL((SELECT SUM(nilai_ubah) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,1)='5'),0) AS angbel,
					IFNULL((SELECT SUM(nilai_ubah) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='61'),0) AS angpentrans,
					IFNULL((SELECT SUM(nilai_ubah) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='62'),0) AS angbeltrans,
					IFNULL((SELECT SUM(nilai_ubah) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='71'),0) AS angpenepemb,
					IFNULL((SELECT SUM(nilai_ubah) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='72'),0) AS angpengpemb,
					IFNULL((SELECT SUM(b.kredit)-SUM(b.debet) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,1)='4' AND MONTH(a.tgl_voucher)<='6'),0) AS totpen,
					IFNULL((SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,1)='5' AND MONTH(a.tgl_voucher)<='6'),0) AS totbel,
					IFNULL((SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,2)='61' AND MONTH(a.tgl_voucher)<='6'),0) AS totpentrans,
					IFNULL((SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,2)='62' AND MONTH(a.tgl_voucher)<='6'),0) AS totbeltrans,
					IFNULL((SELECT SUM(b.kredit)-SUM(b.debet) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,2)='71' AND MONTH(a.tgl_voucher)<='6'),0) AS totpenepemb,
					IFNULL((SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,2)='72' AND MONTH(a.tgl_voucher)<='6'),0) AS totpengpemb";    
			 
                    $query   = $this->db->query($sql);
                    $hasil   = $query->row();
                    $angpen  = $hasil->angpen;
                    $angbel  = $hasil->angbel;
					$angpentrans = $hasil->angpentrans;
					$angbeltrans = $hasil->angbeltrans;
					$angpenepemb = $hasil->angpenepemb;
					$angpengpemb = $hasil->angpengpemb;
                    $totpen  = $hasil->totpen;
                    $totbel  = $hasil->totbel;
					$totpentrans = $hasil->totpentrans;
					$totbeltrans = $hasil->totbeltrans;
					$totpenepemb = $hasil->totpenepemb;
					$totpengpemb = $hasil->totpengpemb;

		$apemby = $angpen-($angbel+$angpentrans+$angbeltrans)+($angpenepemb-$angpengpemb);
		if($apemby < 0) {
                    	$x1="("; 
                        $apemby=$apemby*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $apemby=$apemby*1; 
                        $y1="";
                        }
        $apemby1 = number_format($apemby,"2",".",",");
		
		$rpemby = $totpen-($totbel+$totpentrans+$totbeltrans)+($totpenepemb-$totpengpemb);
		if($rpemby < 0) {
                    	$x1="("; 
                        $rpemby=$rpemby*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $rpemby=$rpemby*1; 
                        $y1="";
                        }
        $rpemby1 = number_format($rpemby,"2",".",",");	

		$silpa = $apemby-$rpemby;		
		$silpa1 = number_format($silpa,"2",".",",");
		
		$apemb = $angpenepemb - $angpengpemb;
		if($apemb < 0) {
                    	$x1="("; 
                        $apemb=$apemb*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $apemb=$apemb*1; 
                        $y1="";
                        }
        $apemb1 = number_format($apemb,"2",".",",");
		
		$rpemb = $totpenepemb - $totpengpemb;
		if($rpemb < 0) {
                    	$x1="("; 
                        $rpemb=$rpemb*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $rpemb=$rpemb*1; 
                        $y1="";
                        }
        $rpemb1 = number_format($rpemb,"2",".",",");	

		$neto = $apemb-$rpemb;
		if($neto < 0) {
                    	$x="("; 
                        $neto=$neto*-1; 
                        $y=")";
                        }else{
                    	$x="";
                        $neto=$neto*1; 
                        $y="";
                        }		
		$neto1 = number_format($neto,"2",".",",");		
		
		$abeltrans = $angbel + ($angpentrans + $angpentrans);
		if($abeltrans < 0) {
                    	$x1="("; 
                        $abeltrans=$abeltrans*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $abeltrans=$abeltrans*1; 
                        $y1="";
                        }
        $abeltrans1 = number_format($abeltrans,"2",".",",");

		$rbeltrans = $totbel + ($totpentrans + $totbeltrans);
		if($rbeltrans < 0) {
                    	$x1="("; 
                        $rbeltrans=$rbeltrans*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $rbeltrans=$rbeltrans*1; 
                        $y1="";
                        }
        $rbeltrans1 = number_format($rbeltrans,"2",".",",");
		
		$sisarbeltrans = $abeltrans-$rbeltrans;
		if($sisarbeltrans < 0) {
                    	$x="("; 
                        $sisarbeltrans=$sisarbeltrans*-1; 
                        $y=")";
                        }else{
                    	$x="";
                        $sisarbeltrans=$sisarbeltrans*1; 
                        $y="";
                        }		
		$sisarbeltrans1 = number_format($sisarbeltrans,"2",".",",");
		
        $surang = $angpen-($angbel+$angpentrans+$angbeltrans);
        if ($surang < 0){
                    	$x1="("; 
                        $surang=$surang*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $surang=$surang*1; 
                        $y1="";
                        }
						
        $surang1= number_format($surang,"2",".",",");
        
        $surrel = $totpen-($totbel+$totpentrans+$totbeltrans);
        if ($surrel < 0){
                    	$x1="("; 
                        $surrel=$surrel*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $surrel=$surrel*1; 
                        $y1="";
                        }  
						
        $surrel1= number_format($surrel,"2",".",",");
		
		$sursisa = $surang - $surrel;
		if($sursisa < 0) {
                    	$x2="("; 
                        $sursisa=$sursisa*-1; 
                        $y2=")";
                        }else{
                    	$x2="";
                        $sursisa=$sursisa*1; 
                        $y2="";
                        }			
		$sursisa1  = number_format($sursisa,"2",".",",");			
        
        $cRet='';       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH $kab</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>LAPORAN REALISASI SEMESTER PERTAMA PENDAPATAN DAN BELANJA SKPD<br>SERTA PROGNOSIS 6 (ENAM) BULAN BERIKUTNYA</strong></td>                         
                    </tr>                                      
                    <tr>
                         <td align=\"center\"><strong>Tahun Anggaran $thn_ang</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"3%\" align=\"center\"><b>NO</b></td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"37%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\"><b>Jumlah Anggaran</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\"><b>Realisasi Semester Pertama</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\" ><b>Sisa Anggaran<br>s.d<br>Semester Pertama</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\" ><b>Prognosis</b></td>  
							<td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\" ><b>Keterangan</b></td> 
                        </tr>  
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td> 
							<td style=\"border-top: none;\"></td>
                         </tr>
                     </tfoot>";

                 $sql4 ="SELECT nor,uraian,seq,
							(SELECT IFNULL(SUM(nilai_ubah),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE 
								(LEFT(c.kd_rek64,5)=a.kode_1 OR LEFT(c.kd_rek64,3)=a.kode_1 OR LEFT(c.kd_rek64,2)=a.kode_1 OR LEFT(c.kd_rek64,1)=a.kode_1)) AS anggaran,
							(SELECT IFNULL(SUM(debet),0) AS debet FROM trdju_pkd
								WHERE (LEFT(kd_rek5,5)=a.kode_1 OR LEFT(kd_rek5,3)=a.kode_1 OR LEFT(kd_rek5,2)=a.kode_1 OR LEFT(kd_rek5,1)=a.kode_1) 
								AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='6')) AS debet,
							(SELECT IFNULL(SUM(kredit),0) AS kredit FROM trdju_pkd
								WHERE (LEFT(kd_rek5,5)=a.kode_1 OR LEFT(kd_rek5,3)=a.kode_1 OR LEFT(kd_rek5,2)=a.kode_1 OR LEFT(kd_rek5,1)=a.kode_1) 
								AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='6')) AS kredit		
							FROM map_lra_kab a ORDER BY nor";
                            
                $query4 = $this->db->query($sql4);                                  
                foreach ($query4->result() as $row4)
                {
                    $no         = $row4->nor;
                    $nama       = $row4->uraian;   
                    $anggaran   = $row4->anggaran;
                    $debet      = $row4->debet;
                    $kredit     = $row4->kredit;
                    $seq        = $row4->seq;
                    
                    $angg  = number_format($anggaran,"2",".",",");
                    if($row4->seq<'170' or ($row4->seq>'290' and $row4->seq<'325') 
							or ($row4->seq>'370' and $row4->seq<'455')){
                      $nilai = $kredit-$debet;
                    }else{
                      $nilai = $debet-$kredit;    
                    }
                    $nil  = number_format($nilai,"2",".",",");
					
					$sisa = $anggaran - $nilai;
					if ($sisa < 0){
                    	$x="("; 
                        $sisa=$sisa*-1; 
                        $y=")";
                        }else {
                    	$x="";
                        $sisa=$sisa*1; 
                        $y="";
                        } 

					$sisaangg  = number_format($sisa,"2",".",",");
					
                    switch ($row4->seq) {
                    case 5:
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
					 case 10:
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                    case 35:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 45:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
					 case 50:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                    case 75:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 85:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;                                         
                    case 100:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						case 110:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 125:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;						
                    case 130:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 140:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break; 
                    case 160:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 165:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;	
                    case 175:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;		
                    case 180:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                    case 215:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;			
                    case 225:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;	
                    case 260:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;		
                    case 270:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;		
                    case 280:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;		
                    case 285:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;		
                    case 295:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;		
                    case 300:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;		
                    case 320:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;		
                    case 330:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;		
                    case 345:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;				
                    case 350:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;	
                    case 355:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$abeltrans1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$rbeltrans1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisarbeltrans1$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisarbeltrans1$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;		
                    case 365:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$surang1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$surrel1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sursisa1$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sursisa1$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;	
                    case 375:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;		
                    case 385:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;	
                    case 450:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;	
                    case 460:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;		
                    case 520:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;		
                    case 525:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$apemb1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$rpemb1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$neto1$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$neto1$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;		
                    case 535:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$apemby1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$rpemby1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x2$silpa1$y2</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x2$silpa1$y2</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;						
                    default:
					if($nama <> ''){
                    $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$angg</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nil</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$x$sisaangg$y</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$x$sisaangg$y</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";
					}else{
					 $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";	
					}
                }         
                }

        $cRet .=       " </table>";
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id' and kode='PA'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>$jabatan<b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>$nip</b></td>
                        </tr>
                    </table>"; 

             $this->tukd_model->_mpdf('',$cRet,10,10,10,'1');
                 
    }    
	*/
	
	//==================stop_prognosis================================= 	
//==================mulai_lo=======================================
 function cetak_lo_pemda(){
	
        $id        = $this->session->userdata('kdskpd');
        $thn_ang   = $this->session->userdata('pcThang');
        $bul       = $_REQUEST['bulan'];
        $bulan     = $this->tukd_model->getBulan($bul); 
        $tgl_ttd   = $_REQUEST['tgl_ctk'];       
        $thn_ang_1 = $thn_ang-1;
        $reallalu  = number_format(0,"2",".",",");  

       $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk 
                    FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
 
         $sql84="SELECT ifnull(SUM(b.kredit),0)-ifnull(SUM(b.debet),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,2)='84' AND MONTH(a.tgl_voucher)<='$bul' and YEAR(tgl_voucher)='$thn_ang'";
                    $query84   = $this->db->query($sql84);
                    $jmlp84    = $query84->row();
                    $jmlpend84 = $jmlp84->nilai;               

        $sql93="SELECT ifnull(SUM(b.debet),0)-ifnull(SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,3)='941' AND MONTH(a.tgl_voucher)<='$bul' and YEAR(tgl_voucher)='$thn_ang'";                                            
                    $query93   = $this->db->query($sql93);
                    $jmlb93    = $query93->row();
                    $jmlbel93  = $jmlb93->nilai;




//thn lalu
         $sql84lalu="SELECT ifnull(SUM(b.kredit),0)-ifnull(SUM(b.debet),0) AS nilai FROM trhju_pkd_LALU a INNER JOIN trdju_pkd_LALU b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,2)='84' and tgl_voucher='2015-12-31'";
                    $query84lalu   = $this->db->query($sql84lalu);
                    $jmlp84lalu    = $query84lalu->row();
                    $jmlpend84lalu = $jmlp84lalu->nilai;               

        $sql93lalu="SELECT ifnull(SUM(b.debet),0)-ifnull(SUM(b.kredit),0) AS nilai FROM trhju_pkd_LALU a INNER JOIN trdju_pkd_LALU b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,2)='93' and tgl_voucher='2015-12-31'";                                            
                    $query93lalu   = $this->db->query($sql93lalu);
                    $jmlb93lalu    = $query93lalu->row();
                    $jmlbel93lalu  = $jmlb93lalu->nilai;

                      $surplus8493lalu =  $jmlpend84lalu-$jmlbel93lalu;
        
        $surplus8493lalua =  $this->angka($surplus8493lalu);
// akhir
                
        $surplus8493 =  $jmlpend84-$jmlbel93;
     
        $surplus8493a =  $this->angka($surplus8493);
		
        $surplusx8493 =  $surplus8493-$surplus8493lalu;
     

        $surplusx8493a = $this->angka($surplusx8493);

if($surplus8493==0 && $surplus8493lalu<>0){

	$per6=100.00;
}else if ($surplus8493lalu==0 && $surplus8493<>0){

	$per6=100.00;
}else{
   $per6   = ($surplusx8493!=0)?($surplusx8493 / $surplus8493lalu ) * 100:0;
}

if($per6<0){
	$per6=$per6*-1;
}


                        $persen6= number_format($per6,2);		
            



        $sql851="SELECT ifnull(SUM(b.kredit),0)-ifnull(SUM(b.debet),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,3)='851' AND MONTH(a.tgl_voucher)<='$bul' and YEAR(tgl_voucher)='$thn_ang'";
                    $query851   = $this->db->query($sql851);
                    $jmlp851    = $query851->row();
                    $jmlpend851 = $jmlp851->nilai;               

       $sql941="SELECT ifnull(SUM(b.debet),0)-ifnull(SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,3)='941' AND MONTH(a.tgl_voucher)<='$bul' and YEAR(tgl_voucher)='$thn_ang'";                                         
                    $query941   = $this->db->query($sql941);
                    $jmlb941    = $query941->row();
                    $jmlbel941  = $jmlb941->nilai;


//thn lalu
        $sql851lalu="SELECT ifnull(SUM(b.kredit),0)-ifnull(SUM(b.debet),0) AS nilai FROM trhju_pkd_LALU a INNER JOIN trdju_pkd_LALU b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,3)='851' AND tgl_voucher='2015-12-31'";
                    $query851lalu   = $this->db->query($sql851lalu);
                    $jmlp851lalu    = $query851lalu->row();
                    $jmlpend851lalu = $jmlp851lalu->nilai;               

       $sql941lalu="SELECT ifnull(SUM(b.debet),0)-ifnull(SUM(b.kredit),0) AS nilai FROM trhju_pkd_LALU a INNER JOIN trdju_pkd_LALU b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,3)='941' AND tgl_voucher='2015-12-31'";                                         
                    $query941lalu   = $this->db->query($sql941lalu);
                    $jmlb941lalu    = $query941lalu->row();
                    $jmlbel941lalu  = $jmlb941lalu->nilai;


        $surplus89lalu =  $jmlpend851lalu-$jmlbel941lalu;
        
        $surplus89lalu1 = $this->angka($surplus89lalu);

//akhir                
        $surplus89 =  $jmlpend851-$jmlbel941;
     
        $surplus891 = $this->angka($surplus89);

        $surplusx89 =  $surplus89-$surplus89lalu1;
  
        $surplusx891 = $this->angka($surplusx89);
               


if($surplus89==0 && $surplus89lalu1<>0){

	$per9=100.00;
}else if ($surplus89lalu1==0 && $surplus89<>0){

	$per9=100.00;
}else{
   $per9   = ($surplusx89!=0)?($surplusx89 / $surplus89lalu1 ) * 100:0;
}

if($per9<0){
	$per9=$per9*-1;
}

                        $persen9= number_format($per9,2);
						
      
        $sql81="SELECT ifnull(SUM(b.kredit),0)-ifnull(SUM(b.debet),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,2) IN ('81','82','83') AND MONTH(a.tgl_voucher)<='$bul' and YEAR(tgl_voucher)='$thn_ang'";
                    $query81   = $this->db->query($sql81);
                    $jmlp81    = $query81->row();
                    $jmlpend81 = $jmlp81->nilai;               

       $sql91="SELECT ifnull(SUM(b.debet),0)-ifnull(SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd 
					WHERE LEFT(b.kd_rek5,2) IN ('91','92') AND MONTH(a.tgl_voucher)<='$bul' and YEAR(tgl_voucher)='$thn_ang'";                                           
                    $query91   = $this->db->query($sql91);
                    $jmlb91    = $query91->row();
                    $jmlbel91  = $jmlb91->nilai;






//thn lalu
     $sql81lalu="SELECT ifnull(SUM(b.kredit),0)-ifnull(SUM(b.debet),0) AS nilai FROM trhju_pkd_LALU a INNER JOIN trdju_pkd_LALU b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE LEFT(b.kd_rek5,2) IN ('81','82','83') AND tgl_voucher='2015-12-31'";
                    $query81lalu   = $this->db->query($sql81lalu);
                    $jmlp81lalu    = $query81lalu->row();
                    $jmlpend81lalu = $jmlp81lalu->nilai;               

       $sql91lalu="SELECT ifnull(SUM(b.debet),0)-ifnull(SUM(b.kredit),0) AS nilai FROM trhju_pkd_LALU a INNER JOIN trdju_pkd_LALU b 
					ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd 
					WHERE LEFT(b.kd_rek5,2) IN ('91','92') AND tgl_voucher='2015-12-31'";                                           
                    $query91lalu   = $this->db->query($sql91lalu);
                    $jmlb91lalu    = $query91lalu->row();
                    $jmlbel91lalu  = $jmlb91lalu->nilai;


                     $surplus89alalu =  $jmlpend81lalu-$jmlbel91lalu;
      
        $surplus891alalu = $this->angka($surplus89alalu);

                    //akhir


                
        $surplus89a =  $jmlpend81-$jmlbel91;
        
        $surplus891a = $this->angka($surplus89a);
		
        $surplus89xa =  $surplus89a-$surplus89alalu;

      
        $surplusx891a = $this->angka($surplus89xa);
                        if ($surplus89xa==0){
                            $tmp=1;
                        }else{
                            $tmp=$surplus89xa;
                        }



if($surplus89a==0 && $surplus89alalu<>0){

	$per5=100.00;
}else if ($surplus89alalu==0 && $surplus89a<>0){

	$per5=100.00;
}else{
   $per5   = ($surplus89xa!=0)?($surplus89xa / $surplus89alalu ) * 100:0;
}

if($per5<0){
	$per5=$per5*-1;
}


                       
                        $persen5= number_format($per5,2);		
        
        $surplus89aa =  $surplus8493+$surplus89a;
       
        $surplus89aa1 = $this->angka($surplus89aa);
 
//thn lalu
      $surplus89aalalu =  $surplus8493lalu+$surplus89alalu;
      
        $surplus89aalalu1 = $this->angka($surplus89aalalu);
//akhir

        $surplusx89aa =  $surplus89aa-$surplus89aalalu;
        
        $surplusx89aa1 =  $this->angka($surplusx89aa);
                      
                        if($surplus89aa==0 && $surplus89aalalu<>0){

	$per7=100.00;
}else if ($surplus89aalalu==0 && $surplus89aa<>0){

	$per7=100.00;
}else{
   $per7   = ($surplusx89aa!=0)?($surplusx89aa / $surplus89aalalu ) * 100:0;
}

if($per7<0){
	$per7=$per7*-1;
}

                        $persen7= number_format($per7,2);		
                        
        $surplus =  $surplus89aa+$surplus89;
      
        $surplus1= $this->angka($surplus);


//thnlalu
        $surpluslaluxxxxx = $surplus89aalalu+$surplus89lalu;
      
        $surpluslalu1aaaa= $this->angka($surpluslaluxxxxx);


//akhir
        $surplusx1 =  $surplus-$surpluslaluxxxxx;
        
        $surplusx1a = $this->angka($surplusx1);
                   
                  

                        if($surplus==0 && $surpluslaluxxxxx<>0){

	$per8=100.00;
}else if ($surpluslaluxxxxx==0 && $surplus<>0){

	$per8=100.00;
}else{
   $per8   = ($surplusx1!=0)?($surplusx1 / $surpluslaluxxxxx ) * 100:0;
}

if($per8<0){
	$per8=$per8*-1;
}

                     //   $per8   = ($surplusx1!=0)?($surplusx1/$tmp ) * 100:0; 



                        $persen8= number_format($per8,2);	        
        
                      
       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
        
        $cRet='';
        $lastmoth=$thn.'-'.$bul.'-'.'01';
		$lastyear=date('Y-m-t',strtotime($lastmoth)); 
		$str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));


        
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH $kab</strong></td>                         
                    </tr>                  
                    <tr>
                         <td align=\"center\"><strong>LAPORAN OPERASIONAL </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK PERIODE YANG BERAKHIR SAMPAI DENGAN <br>$str dan $thn_ang_1</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"45%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>$thn_ang_1</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>Kenaikan</br>(Penurunan)</b></td>
                            <td  bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>   
                        </tr>  
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>                           
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
                        </tr>";

                 $sql4="SELECT IFNULL(a.kode,'')AS kode,a.seq as seq,a.nor,a.uraian as uraian ,ifnull(a.kode_1,\"''\") as kode_1,thn_m1 as nilai_lo_lalu
                                FROM map_lo_kab a GROUP BY a.nor,a.uraian,a.kode_1 ORDER BY a.seq";
                              
                 
                                
                 $query4 = $this->db->query($sql4);
                $no=0;                                  
                foreach ($query4->result() as $row4)
                {
                    $kode      = $row4->kode;
                    $nama      = $row4->uraian;   
                    $n         = $row4->kode_1;
                    $nor       = $row4->nor;
                    //$reallalu  = number_format($row4->nilai_lo_lalu,"2",",",",");
                    $reallalu1  = $row4->nilai_lo_lalu;
                    $reallalu  = number_format($reallalu1,"2",",",",");
                   
                    
                    $test1 = '';
					if($n <> ''){
						$test  = explode(',',$n);
						$test1 = strlen($test[0]);
					}
                    
                   if($row4->seq<'165'){
                       $sql5="SELECT ifnull(SUM(b.kredit),0)-ifnull(SUM(b.debet),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b 
								ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
								WHERE SUBSTR(b.kd_rek5,1,$test1) IN (".$n.") AND MONTH(a.tgl_voucher)<='$bul' and YEAR(tgl_voucher)='$thn_ang'";

								                       $sql5lalu="SELECT ifnull(SUM(b.kredit),0)-ifnull(SUM(b.debet),0) AS nilai FROM trhju_pkd_LALU a INNER JOIN trdju_pkd_LALU b 
								ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
								WHERE SUBSTR(b.kd_rek5,1,$test1) IN (".$n.")  AND tgl_voucher='2015-12-31'";
                    }else{
                       $sql5="SELECT ifnull(SUM(b.debet),0)-ifnull(SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b 
								ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
								WHERE SUBSTR(b.kd_rek5,1,$test1) IN (".$n.") AND MONTH(a.tgl_voucher)<='$bul' and YEAR(tgl_voucher)='$thn_ang'";

								                       $sql5lalu="SELECT ifnull(SUM(b.debet),0)-ifnull(SUM(b.kredit),0) AS nilai FROM trhju_pkd_LALU a INNER JOIN trdju_pkd_LALU b 
								ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
								WHERE SUBSTR(b.kd_rek5,1,$test1) IN (".$n.") AND tgl_voucher='2015-12-31'";                                                                  
                    }    
                    
                    $query5 = $this->db->query($sql5);
                    $trh    = $query5->row();
                    $nil    = $trh->nilai;
                    $nilai  = number_format($trh->nilai,"2",".",",");

//thnlalu
    $query5lalu = $this->db->query($sql5lalu);
                    $trhlalu    = $query5lalu->row();
                    $nillalu    = $trhlalu->nilai;
                    $nilailalu  = number_format($trhlalu->nilai,"2",".",",");

//akhir




		$ini=0;
$ino=0;

if($row4->seq=='265'){
$ino=$nillalu-$jmlbel941lalu;   
$ini=$nil-$jmlbel941;

   $nilailalu  = number_format($ino,"2",".",",");
  $nilai  = number_format($ini,"2",".",",");

					}



                    $real_s = $nil - $nillalu ;
                    //$real_s = $nil-$nilai_lo_lalu;
                    
                 
                        
                    $selisih = $this->angka($real_s);
                    if ($trh->nilai==0){
                        $tmp=1;
                    }else{
                        $tmp=$trh->nilai;
                    }



if($nil==0 && $nillalu<>0){

	$per1=100.00;
}else if ($nillalu==0 && $nil<>0){

	$per1=100.00;
}else{
   $per1   = ($real_s!=0)?($real_s / $nillalu ) * 100:0;
}

if($per1<0){
	$per1=$per1*-1;
}


                    
                   // $per1   = ($real_s!=0)?($real_s / $tmp ) * 100:0; 
                    $persen1= number_format($per1,2);
                    
                    $surpluslalu = 0;        
                    $surp = $surplus-$surpluslalu ;
                        $surp1 = number_format($surp,"2",".",",");
                        if ($surp==0){
                            $tmp=1;
                        }else{
                            $tmp=$surp;
                        }


                        if($surplus==0 && $surpluslalu<>0){

	$per4=100.00;
}else if ($surpluslalu==0 && $surplus<>0){

	$per4=100.00;
}else{
   $per4   = ($real_s!=0)?($real_s / $surpluslalu ) * 100:0;
}

if($per4<0){
	$per4=$per4*-1;
}

                      // $per4   = ($surp!=0)?($surp / $tmp ) * 100:0; 
                        $persen4= number_format($per4,2);
                    
// case (($row4->seq==5)||($row4->seq==10)||($row4->seq==45)||($row4->seq==215)||($row4->seq==220)||($row4->seq==265)||($row4->seq==310)||($row4->seq==335)||($row4->seq==420)||($row4->seq==430)||($row4->seq==505)):

                    switch ($row4->seq) {
                    case (($row4->seq==5)||($row4->seq==10)||($row4->seq==45)||($row4->seq==50)||($row4->seq==85)||($row4->seq==110)||($row4->seq==127)
                    	||($row4->seq==140)||($row4->seq==170)||($row4->seq==175)||($row4->seq==230)||($row4->seq==285)||($row4->seq==290)||($row4->seq==320)||($row4->seq==370)||($row4->seq==365)||($row4->seq==390)
                    	):
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
					     
                   case (($row4->seq==35)||($row4->seq==75)||($row4->seq==100)||($row4->seq==125)||($row4->seq==131)||($row4->seq==132)||($row4->seq==155)||($row4->seq==160)||($row4->seq==220)||($row4->seq==260)
||($row4->seq==265)||($row4->seq==310)||($row4->seq==340)||($row4->seq==380)||($row4->seq==400)):
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilai</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilailalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$selisih</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen1</b></td>
                                    </tr>";
                        break;
             		 case 275:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surplus891a</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surplus891alalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surplusx891a</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen5</b></td>
                                    </tr>";
                        break; 
					 case 345:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surplus8493a</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surplus8493lalua</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surplusx8493a</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen6</b></td>
                                    </tr>";
                        break; 
					 case 355:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surplus89aa1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surplus89aalalu1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surplusx89aa1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen7</b></td>
                                    </tr>";
                        break; 
 case 405:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surplus891</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surplus89lalu1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surplusx891</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen9</b></td>
                                    </tr>";
                        break;  
					 case 415:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surplus1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surpluslalu1aaaa<b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surplusx1a</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen8</b></td>
                                    </tr>";
                        break;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                					 
                    default:
					if($nama<>''){
                    $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nilailalu</td> 
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$selisih</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$persen1</td>
                                 </tr>";
					}else{
					 $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";	
					
					}

                }         
                    
                }
               
        
        $cRet .=       " </table>";
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id' and kode='PPK'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">$jabatan</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>NIP. $nip</b></td>
                        </tr>

                    </table>"; 

//             $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');

	  
		  	
	$cetak = $this->uri->segment(3);
		
			 
			         $data['prev'] = $cRet;
        $data['sikap'] = 'preview';
        $judul = 'LO';
        //$this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
        switch ($cetak)
        {
            case 1;
             
           $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
			 
                break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= $judul.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }
              
                 
    	}
				
 function cetak_lo_skpd(){
        $id        = $_REQUEST['kdskpd'];
        $thn_ang   = $this->session->userdata('pcThang');
        $bul       = $_REQUEST['bulan'];
        $bulan     = $this->tukd_model->getBulan($bul); 
        $tgl_ttd   = $_REQUEST['tgl_ctk'];       
        $thn_ang_1 = $thn_ang-1;  

        	$cetak123=$this->uri->segment(3);
	   $skpd = "AND kd_skpd='$id'";
	   $skpd1 = "AND b.kd_skpd='$id'"; 

        $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk 
                    FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    //$nm_skpd  = $rowdns->nm_sk;
					$nm_skpd  = strtoupper($rowdns->nm_sk);
                } 
     
        $sql41="SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(a.kd_rek5,1)='8' AND b.kd_skpd='$id' and YEAR(tgl_voucher)='$thn_ang'";
                    $query41 = $this->db->query($sql41);
                    $jmlp = $query41->row();
                    $jmlpendapatan = $jmlp->nilai;
                    $jmlpendapatan1= number_format($jmlp->nilai,"2",".",",");
     
//tahun lalu


        $sql41lalu="SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd_lalu a INNER JOIN trhju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE  LEFT(a.kd_rek5,1)='8' AND b.kd_skpd='$id' and tgl_voucher='2015-12-31'";
                    $query41lalu = $this->db->query($sql41lalu);
                    $jmlplalu = $query41lalu->row();
                    $jmlpendapatanlalu= $jmlplalu->nilai;
                    $jmlpendapatan1lalu= number_format($jmlplalu->nilai,"2",".",",");

                    $reallalu_p = $jmlpendapatanlalu;
                    $reallalu_p1 =number_format($reallalu_p,"2",".",",");

 
                    $real_p   = $jmlpendapatan-$reallalu_p ;  

                    $selisihp = $this->angka($real_p);
              

if($reallalu_p==0 && $reallalu_p<>0){

	$per2=100.00;
}else if ($reallalu_p==0 && $reallalu_p<>0){

	$per2=100.00;
}else{
   $per2   = ($real_p!=0)?($real_p / $reallalu_p ) * 100:0;
}

if($per2<0){
	$per2=$per2*-1;
}


                    $persen2= number_format($per2,2);                    

       $sql51="SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(a.kd_rek5,1)='9' AND b.kd_skpd='$id' and YEAR(tgl_voucher)='$thn_ang'";                        
                    $query51 = $this->db->query($sql51);
                    $jmlb = $query51->row();
                    $jmlbelanja = $jmlb->nilai;
                    $jmlbelanja1= $this->angka($jmlbelanja);

//tahun lalu
      $sql51lalu="SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd_lalu a INNER JOIN trhju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE LEFT(a.kd_rek5,1)='9' AND b.kd_skpd='$id' and tgl_voucher='2015-12-31'";                        
                    $query51lalu = $this->db->query($sql51lalu);
                    $jmlblalu = $query51lalu->row();
                    $jmlbelanjalalu= $jmlblalu->nilai;
                    $jmlbelanja1lalu=  $this->angka($jmlbelanjalalu);

                    $reallalu_b = $jmlbelanjalalu;
   $reallalu_b1 =$this->angka($reallalu_b);

                    $real_b = $jmlbelanja-$reallalu_b ;
                    $selisihb =$this->angka($real_b);
                   

if($jmlbelanja==0 && $reallalu_b<>0){

	$per3=100.00;
}else if ($reallalu_b==0 && $jmlbelanja<>0){

	$per3=100.00;
}else{
   $per3   = ($real_b!=0)?($real_b / $reallalu_b ) * 100:0;
}

if($per3<0){
	$per3=$per3*-1;
}


                    $persen3= number_format($per3,2);                    
                 











        $surplus =  $jmlpendapatan-$jmlbelanja;
      
        $surplus1= $this->angka($surplus);




        $surpluslalu =  $jmlpendapatanlalu-$jmlbelanjalalu;
     
        $surpluslalu1=$this->angka($surpluslalu);
                      
       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
        
        $cRet='';
        $lastmoth=$thn.'-'.$bul.'-'.'01';
		$lastyear=date('Y-m-t',strtotime($lastmoth)); 
		$str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));
        
$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
<tr>
 <td align=\"center\"><strong>PEMERINTAH $kab</strong></td>                         
</tr>
<tr>
 <td align=\"center\"><strong>$nm_skpd</strong></td>                         
</tr>                    
<tr>
 <td align=\"center\"><strong>LAPORAN OPERASIONAL </strong></td>
</tr>                    
<tr>
 <td align=\"center\"><strong>UNTUK PERIODE YANG BERAKHIR SAMPAI DENGAN $str </strong></td>
</tr>
<tr>
 <td align=\"center\">&nbsp;</td>
</tr>
</table>";        

$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
<thead>                       
<tr><td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NO</b></td>                            
    <td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
<td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Saldo $thn_ang</b></td>
<td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Saldo $thn_ang_1</b></td>
<td  bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>Kenaikan</br>(Penurunan)</b></td>
<td  bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>  
  

</tr>  
</thead>
<tfoot>
<tr>
       <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>      
                        
 </tr>
</tfoot>

<tr><td style=\"vertical-align:to p;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>                            
    <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
    <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
	   <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>

</tr>";

$sql4="SELECT IFNULL(a.kode,'')AS kode,a.seq as seq,a.nor,a.uraian as uraian ,ifnull(a.kode_1,\"''\") as kode_1,thn_m1 AS lalu 
        FROM map_lo_skpd a GROUP BY a.nor,a.uraian,a.kode_1 ORDER BY a.seq";
$query4 = $this->db->query($sql4);
$no=0;                                  
foreach ($query4->result() as $row4)
{
$kode   = $row4->kode;
$nama   = $row4->uraian;   
$real_lalu = number_format($row4->lalu,"2",".",",");
$n  = $row4->kode_1;

if($row4->seq<'50'){
$sql5="SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                   WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(a.kd_rek5,3) IN (".$n.") AND b.kd_skpd='$id'  AND YEAR(tgl_voucher)='2016'";
}else{
$sql5="SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                   WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(a.kd_rek5,3) IN (".$n.") AND b.kd_skpd='$id'  AND YEAR(tgl_voucher)='2016'";                        
}    

$query5 = $this->db->query($sql5);
$trh = $query5->row();
$nil = $trh->nilai;
$nilai= number_format($trh->nilai,"2",".",",");





//thn_lalu
if($row4->seq<'50'){
$sql5lalu="SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd_lalu a INNER JOIN trhju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                   WHERE  LEFT(a.kd_rek5,3) IN (".$n.") AND b.kd_skpd='$id' and tgl_voucher='2015-12-31'";
}else{
$sql5lalu="SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd_lalu a INNER JOIN trhju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                   WHERE  LEFT(a.kd_rek5,3) IN (".$n.") AND b.kd_skpd='$id' and tgl_voucher='2015-12-31'";                        
}    

$query5lalu = $this->db->query($sql5lalu);
$trhlalu = $query5lalu->row();
$nillalu = $trhlalu->nilai;
$nilailalu= number_format($trhlalu->nilai,"2",".",",");





 



$real_s = $nil-$nillalu ;



$selisih = $this->angka($real_s);

if($trh->nilai==0 && $nillalu<>0){

	$per1=100.00;
}else if ($nillalu==0 && $trh->nilai<>0){

	$per1=100.00;
}else{
$per1   = ($real_s!=0)?($real_s / $nillalu ) * 100:0; 
}

if($per1<0){
	$per1=$per1*-1;
}
$persen1= number_format($per1,2);

$no=$no+ 1;

      
$surp = $surplus-$surpluslalu;


   




$surp1 =  $this->angka($surp);

if($surplus==0 && $surpluslalu<>0){

	$per4=100.00;
}else if ($surpluslalu==0 && $surplus<>0){

	$per4=100.00;
}else{
$per4   = ($surp!=0)?($surp / $surpluslalu ) * 100:0; 
}

if($per4<0){
	$per4=$per4*-1;
}

$persen4= number_format($per4,2);


                    switch ($row4->seq) {
                    case 5:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					 case 10:
                         $cRet    .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
                    case 30:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"40%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"20%\" align=\"right\"><b>$jmlpendapatan1</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"20%\" align=\"right\"><b>$reallalu_p1</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"15%\" align=\"right\"><b>$selisihp</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"right\"><b>$persen2</b></td>
                                 </tr>";
                        break;
                    case 50:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					 case 55:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";
                        break;
					 case 105:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"40%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"20%\" align=\"right\"><b>$jmlbelanja1</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"20%\" align=\"right\"><b>$nilailalu</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"15%\" align=\"right\"><b>$selisihb</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"right\"><b>$persen3</b></td>
                                 </tr>";
                        break;
                    case 115:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$jmlbelanja1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$reallalu_b1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$selisihb</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen3</b></td>
                                 </tr>";
                        break;                 
                    case 122:
                        $cRet    .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$surplus1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$surpluslalu1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$surp1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen4</b></td>
                                 </tr>";
                        break;
                    default:
					if($nama <> ''){
                    $cRet    .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"right\">$nilailalu</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\">$selisih</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                 </tr>";
					}else{
					 $cRet    .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                 </tr>";	
					
					}

                }         
                    
			  }

        $cRet .=       " </table>";
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id' and kode='PA'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td align=\"center\">$jabatan</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td>&nbsp;</td>
                        </tr>
						<tr>
							 <td>&nbsp;</td>
							 <td>&nbsp;</td>
							 <td>&nbsp;</td>
                        </tr>
						<tr>
							 <td>&nbsp;</td>
							 <td>&nbsp;</td>
							 <td>&nbsp;</td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td>&nbsp;</td>
                            <td>&nbsp;</td>
                            <td align=\"center\"><b>$nip</b></td>
                        </tr>
                    </table>"; 

          $cetak=$this->uri->segment(3);
			    $data['prev']= $cRet;    
        switch($cetak123) {        
        case 1;
            $this->tukd_model->_mpdf('',$cRet,20,20,10,'0');
			 
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= LO.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        }              
                 
    }
	//==================stop_lo========================================

    function ctk_lra_pemda(){
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/cetak_lra_pemda', $data);
    }

      function cetak_lra_skpd(){
        $id        = $_REQUEST['kdskpd']; 
        $thn_ang   = $this->session->userdata('pcThang');
        $bul       = $_REQUEST['bulan'];
        $bulan     = $this->tukd_model->getBulan($bul); 
        $tgl_ttd   = $_REQUEST['tgl_ctk'];       
        $thn_ang_1 = $thn_ang-1; 

          $apbd=$_REQUEST['apbd'];
				if($apbd==0){
				$rka='nilai';
				}else{
				$rka='nilai_ubah';
				} 
	
		if($id=='1.20.05.01'){
			//ppkd
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
			$sqlsclient=$this->db->query($sqlsc);
			foreach ($sqlsclient->result() as $rowsc){
				$tgl=$rowsc->tgl_rka;
				$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
				$kab     = $rowsc->kab_kota;
				$daerah  = $rowsc->daerah;
				$thn     = $rowsc->thn_ang;
			}  
     
        $sql="SELECT 
					(SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,1)='4' AND b.kd_skpd='$id') AS angpen,
					(SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,1)='5' AND b.kd_skpd='$id') AS angbel,
					(SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='61' AND b.kd_skpd='$id') AS angpentrans,
					(SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='62' AND b.kd_skpd='$id') AS angbeltrans,
					(SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='71' AND b.kd_skpd='$id') AS angpenepemb,
					(SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='72' AND b.kd_skpd='$id') AS angpengpemb,
					
					(SELECT IFNULL(SUM(b.kredit)-SUM(b.debet),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,1)='4' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang' AND a.kd_skpd='$id' AND b.kd_skpd='$id') AS totpen,
					(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,1)='5' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang' AND a.kd_skpd='$id' AND b.kd_skpd='$id') AS totbel,
					(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,2)='61' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang' AND a.kd_skpd='$id' AND b.kd_skpd='$id') AS totpentrans,
					(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0)  AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,2)='62' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang' AND a.kd_skpd='$id' AND b.kd_skpd='$id')AS totbeltrans,
					(SELECT IFNULL(SUM(b.kredit)-SUM(b.debet),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,2)='71' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang' AND a.kd_skpd='$id' AND b.kd_skpd='$id') AS totpenepemb,
					(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,2)='72' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang' AND a.kd_skpd='$id' AND b.kd_skpd='$id') AS totpengpemb,



(SELECT IFNULL(SUM(b.kredit)-SUM(b.debet),0) AS nilai FROM trhju_pkd_lalu a INNER JOIN trdju_pkd_lalu b ON a.no_voucher=b.no_voucher
WHERE LEFT(b.kd_rek5,1)='4' and tgl_voucher='2015-12-31'  AND a.kd_skpd='$id' AND b.kd_skpd='$id') AS totpenlalu,
(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd_lalu a INNER JOIN trdju_pkd_lalu b ON a.no_voucher=b.no_voucher
WHERE LEFT(b.kd_rek5,1)='5' and tgl_voucher='2015-12-31' AND a.kd_skpd='$id' AND b.kd_skpd='$id') AS totbellalu,
(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd_lalu a INNER JOIN trdju_pkd_lalu b ON a.no_voucher=b.no_voucher
WHERE LEFT(b.kd_rek5,2)='61' and tgl_voucher='2015-12-31' AND a.kd_skpd='$id' AND b.kd_skpd='$id') AS totpentranslalu,
(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0)  AS nilai FROM trhju_pkd_lalu a INNER JOIN trdju_pkd_lalu b ON a.no_voucher=b.no_voucher
WHERE LEFT(b.kd_rek5,2)='62'and tgl_voucher='2015-12-31'  AND a.kd_skpd='$id' AND b.kd_skpd='$id')AS totbeltranslalu,
(SELECT IFNULL(SUM(b.kredit)-SUM(b.debet),0) AS nilai FROM trhju_pkd_lalu a INNER JOIN trdju_pkd_lalu b ON a.no_voucher=b.no_voucher
WHERE LEFT(b.kd_rek5,2)='71' and tgl_voucher='2015-12-31' AND a.kd_skpd='$id' AND b.kd_skpd='$id') AS totpenepemblalu,
(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd_lalu a INNER JOIN trdju_pkd_lalu b ON a.no_voucher=b.no_voucher
WHERE LEFT(b.kd_rek5,2)='72' and tgl_voucher='2015-12-31' AND a.kd_skpd='$id' AND b.kd_skpd='$id') AS totpengpemblalu


";    
			 
				$query   = $this->db->query($sql);
				$hasil   = $query->row();
				$angpen  = $hasil->angpen;
				$angbel  = $hasil->angbel;
				$angpentrans = $hasil->angpentrans;
				$angbeltrans = $hasil->angbeltrans;
				$angtrans = $hasil->angpentrans+$hasil->angbeltrans;
				$angpenepemb = $hasil->angpenepemb;
				$angpengpemb = $hasil->angpengpemb;
				$silang	= $hasil->angpenepemb-$hasil->angpengpemb;




				$totpen  = $hasil->totpen;
				$totbel  = $hasil->totbel;
				$totpentrans = $hasil->totpentrans;
				$totbeltrans = $hasil->totbeltrans;
				$tottrans = $hasil->totpentrans+$hasil->totbeltrans;
				$totpenepemb = $hasil->totpenepemb;
				$totpengpemb = $hasil->totpengpemb;
				$silreal = $hasil->totpenepemb-$hasil->totpengpemb;




				$totpenlalu  = $hasil->totpenlalu;
				$totbellalu  = $hasil->totbellalu;
				$totpentranslalu = $hasil->totpentranslalu;
				$totbeltranslalu = $hasil->totbeltranslalu;
				$tottranslalu = $hasil->totpentranslalu+$hasil->totbeltranslalu;
				$totpenepemblalu = $hasil->totpenepemblalu;
				$totpengpemblalu = $hasil->totpengpemblalu;
				$silreallalu = $hasil->totpenepemblalu-$hasil->totpengpemblalu;

	//**--------------------------------transfer-----------------------------------------------	
		$abeltrans = $angbel+$angtrans;
		$abeltrans1 =$this->angka($abeltrans);
		
		$rbeltrans = $totbel+$tottrans;
		
        $rbeltrans1 = $this->angka($rbeltrans);



//lalu
        $rbeltranslalu = $totbellalu+$tottranslalu;
		
        $rbeltranslalu1 = $this->angka($rbeltranslalu);





		
		if ($abeltrans<>0){$per4 = ($abeltrans!=0)?($rbeltrans/$abeltrans)*100:0;}else if($abeltrans==0 and $rbeltrans!=0){$per4=100;} else{$per4=0;}                
		$persen4 = number_format($per4,"2",".",",");			
	//**--------------------------------surplus------------------------------------------------
        $surang = $angpen-($angbel+$angtrans);
      						
        $surang1= $this->angka($surang);
        
        $surrel = $totpen-($totbel+$tottrans);
     			
        $surrel1= $this->angka($surrel);

//lalu

        $surrellalu = $totpenlalu-($totbellalu+$tottranslalu);
     			
        $surrellalu1= $this->angka($surrellalu);




		if ($surang<>0){$per5 = ($surang!=0)?($surrel/$surang)*100:0;}else if($surang==0 and $surrel!=0){$per5=100;} else{$per5=0;}                
		$persen5 = number_format($per5,"2",".",",");		
	//**------------------------------netto Pemby------------------------------------------------	
		
        $apemb1 =  $this->angka($silang);
		

        $rpemb1 = $this->angka($silreal);


//lalu

		
        $rpemblalu1 = $this->angka($silreallalu);




		
		if ($silang<>0){$per2 = ($silang!=0)?($silreal/$silang)*100:0;}else if($silang==0 and $silreal!=0){$per2=100;} else{$per2=0;}                
		$persen2 = number_format($per2,"2",".",",");
	//**-----------------------------Silpa------------------------------------------------				
		$apemby = ($angpen+$silang)-($angbel+$angtrans);
		
        $apemby1 =  $this->angka($apemby);
		
		$rpemby = ($totpen+$silreal)-($totbel+$tottrans);
	
        $rpemby1 =  $this->angka($rpemby);



//lalu
     $rpembylalu = ($totpenlalu+$silreallalu)-($totbellalu+$tottranslalu);
	
         $rpembylalu1  =  $this->angka($rpembylalu);


		
		if ($apemby<>0){$per3 = ($apemby!=0)?($rpemby/$apemby)*100:0;}else if($apemby==0 and $rpemby!=0){$per3=100;}else{$per3=0;}                
		$persen3 = number_format($per3,"2",".",",");		
	
        $cRet='';
		$lastmoth=$thn.'-'.$bul.'-'.'01';
		$lastyear=date('Y-m-t',strtotime($lastmoth)); 
		$str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));		
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td style=\"font-size:18px;\" align=\"center\"><strong>&nbsp;</strong></td>                         
                    </tr>                    
					<tr>
                         <td style=\"font-size:18px;\" align=\"center\"><strong>PEMERINTAH $kab</strong></td>                         
                    </tr>
					<tr>
                         <td style=\"font-size:16px;\" align=\"center\"><strong>PPKD</strong></td>                         
                    </tr> 					
					<tr>
                         <td style=\"font-size:16px;\" align=\"center\"><strong>LAPORAN REALISASI ANGGARAN PENDAPATAN DAN BELANJA DAERAH</strong></td>                         
                    </tr>                                      
                    <tr>
                         <td align=\"center\"><strong>UNTUK PERIODE YANG BERAKHIR SAMPAI DENGAN<br>$str dan $thn_ang_1</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"3%\" align=\"center\"><b>NO URUT</b></td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"47%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Anggaran $thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Realisasi $thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>Realisasi $thn_ang_1</b></td>  
                        </tr>  
                        <tr><td bgcolor=\"#CCCCCC\" width=\"3%\" align=\"center\">1</td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"47%\" align=\"center\">2</td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">3</td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">4</td>
                            <td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">5</td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">6</td>  
                        </tr>
						</thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td> 
                         </tr>
                     </tfoot>";
                           
		  $sql4 ="SELECT nor,uraian,seq,normal,kode_1,
						(SELECT IFNULL(SUM(nilai_ubah),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='$id' 
						AND (LEFT(c.kd_rek64,5)=a.kode_1 OR LEFT(c.kd_rek64,3)=a.kode_1 OR LEFT(c.kd_rek64,2)=a.kode_1 OR LEFT(c.kd_rek64,1)=a.kode_1)) AS anggaran
						FROM map_lra_ppkd_kab a ORDER BY CAST(nor AS SIGNED)";

		$query4 = $this->db->query($sql4);                                  
		foreach ($query4->result() as $row4){
			$no         = $row4->nor;
			$nama       = $row4->uraian;   
			$anggaran   = $row4->anggaran;
			$angg  		= number_format($anggaran,"2",".",",");
			$seq        = $row4->seq;
			$normal     = $row4->normal;
			$kode1		= $row4->kode_1;
			
			$sqld = $this->db->query("SELECT IFNULL(SUM(debet),0) AS debet FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
					WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang'
					AND (LEFT(b.kd_rek5,5)='$kode1' OR LEFT(b.kd_rek5,3)='$kode1' OR LEFT(b.kd_rek5,2)='$kode1' OR LEFT(b.kd_rek5,1)='$kode1' OR b.kd_rek5='$kode1')");
			foreach($sqld->result() as $sqldeb){
			$debet = $sqldeb->debet ; 
}

//lalu
$sqldlalu = $this->db->query("SELECT IFNULL(SUM(debet),0) AS debet FROM trhju_pkd_lalu a INNER JOIN trdju_pkd_lalu b ON a.no_voucher=b.no_voucher
					WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' and tgl_voucher='2015-12-31'
					AND (LEFT(b.kd_rek5,5)='$kode1' OR LEFT(b.kd_rek5,3)='$kode1' OR LEFT(b.kd_rek5,2)='$kode1' OR LEFT(b.kd_rek5,1)='$kode1' OR b.kd_rek5='$kode1')");
			foreach($sqldlalu->result() as $sqldeblalu){
			$debetlalu = $sqldeblalu->debet ; 
}

$sqlklalu = $this->db->query("SELECT IFNULL(SUM(kredit),0) AS kredit FROM trhju_pkd_lalu a INNER JOIN trdju_pkd_lalu b ON a.no_voucher=b.no_voucher
					WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' and tgl_voucher='2015-12-31'
					AND (LEFT(b.kd_rek5,5)='$kode1' OR LEFT(b.kd_rek5,3)='$kode1' OR LEFT(b.kd_rek5,2)='$kode1' OR LEFT(b.kd_rek5,1)='$kode1' OR b.kd_rek5='$kode1')");
			foreach($sqlklalu->result() as $sqlkrelalu){
			$kreditlalu = $sqlkrelalu->kredit ; 
}
//



			$sqlk = $this->db->query("SELECT IFNULL(SUM(kredit),0) AS kredit FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
					WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang'
					AND (LEFT(b.kd_rek5,5)='$kode1' OR LEFT(b.kd_rek5,3)='$kode1' OR LEFT(b.kd_rek5,2)='$kode1' OR LEFT(b.kd_rek5,1)='$kode1' OR b.kd_rek5='$kode1')");
			foreach($sqlk->result() as $sqlkre){
			$kredit = $sqlkre->kredit ; 
}
			if($normal=='K'){
			  $nilai = $kredit-$debet;
			  $nilailalu = $kreditlalu-$debetlalu;
			}else{
			  $nilai = $debet-$kredit;    
			  $nilailalu = $debetlalu-$kreditlalu;    
			}

			$nil  = number_format($nilai,"2",".",",");
			$nilailalu1  = number_format($nilailalu,"2",".",",");
			
			if ($anggaran<>0){$per1 = ($anggaran!=0)?($nilai/$anggaran)*100:0;}else if($anggaran==0 and $nilai!=0){$per1=100;} else{$per1=0;}                
			$persen1 = number_format($per1,"2",".",",");
			
			
			switch ($row4->seq) {
				case (($row4->seq==5)||($row4->seq==10)||($row4->seq==45)||($row4->seq==50)||($row4->seq==85)||($row4->seq==115)
					 ||($row4->seq==145)||($row4->seq==180)||($row4->seq==215)||($row4->seq==220)||($row4->seq==265)
					 ||($row4->seq==310)||($row4->seq==335)||($row4->seq==340)||($row4->seq==370)||($row4->seq==420)
					 ||($row4->seq==430)||($row4->seq==505)):
					 $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
								 </tr>";
					break;
				case (($row4->seq==35)||($row4->seq==75)||($row4->seq==105)||($row4->seq==135)||($row4->seq==165)||($row4->seq==170)
					 ||($row4->seq==200)||($row4->seq==205)
					 ||($row4->seq==255)||($row4->seq==300)||($row4->seq==320)||($row4->seq==325)||($row4->seq==360)||($row4->seq==390)
					 ||($row4->seq==395)||($row4->seq==495)||($row4->seq==570)):
					$cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen1</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilailalu1</b></td>
								 </tr>";
					break;	
				case 400:
					$cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$abeltrans1</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$rbeltrans1</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen4</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$rbeltranslalu1</b></td>
								 </tr>";
					break;		
				case 410:
					$cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surang1</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surrel1</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen5</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surrellalu1</b></td>
								 </tr>";
					break;		
				case 575:
					$cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$apemb1</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$rpemb1</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen2</b></td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$rpemblalu1</b></td>
								 </tr>";
					break;		
				case 585:
					$cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$apemby1</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$rpemby1</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen3</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$rpembylalu1 </b></td>
								 </tr>";
					break;						
				default:
				if($nama <> ''){
				$cRet    .= "<tr>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$angg</td>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nil</td>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$persen1</td>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nilailalu1</td>
							 </tr>";
				}else{
				 $cRet    .= "<tr>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
							 </tr>";	
				}
			}         
		}

        $cRet .=       " </table>";
		$cRet .= " <br><br>";
		$sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id' and kode='PA'");
		foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	    }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>$jabatan<b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>NIP. $nip</b></td>
                        </tr>
                    </table>"; 

              //  $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');			


		$ctk = $this->uri->segment(3);
		   $data['prev']= $cRet;
            switch($ctk) {        
                case 1;
       $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');			


                break;
                case 2;        
                    header("Cache-Control: no-cache, no-store, must-revalidate");
                    header("Content-Type: application/vnd.ms-excel");
                    header("Content-Disposition: attachment; filename=lra.xls");
                    $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            } 
		}else{

			//skpd
			 $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk 
						FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
					$sqlskpd=$this->db->query($sqldns);
					foreach ($sqlskpd->result() as $rowdns){
						$kd_urusan=$rowdns->kd_u;                    
						$nm_urusan= $rowdns->nm_u;
						$kd_skpd  = $rowdns->kd_sk;
						$nm_skpd  = $rowdns->nm_sk;
					} 
		 
			$sql="SELECT 
					(SELECT SUM($rka) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='$id' 
					AND LEFT(c.kd_rek64,1)='4') AS angpen,
					(SELECT SUM($rka) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='$id' 
					AND LEFT(c.kd_rek64,1)='5') AS angbel,
					(SELECT SUM(b.kredit)-SUM(b.debet) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' AND LEFT(b.kd_rek5,1)='4' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang') AS totpen,
					(SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' AND LEFT(b.kd_rek5,1)='5' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang') AS totbel,

					(SELECT SUM(b.kredit)-SUM(b.debet) AS nilai FROM trhju_pkd_lalu a INNER JOIN trdju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' AND LEFT(b.kd_rek5,1)='4' and tgl_voucher='2015-12-31') AS totpenlalu,
					(SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd_lalu a INNER JOIN trdju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' AND LEFT(b.kd_rek5,1)='5' and tgl_voucher='2015-12-31') AS totbellalu			
				 ";    
													
						$query   = $this->db->query($sql);
						$hasil   = $query->row();
						$angpen  = $hasil->angpen;
						$angbel  = $hasil->angbel;
						$totpen  = $hasil->totpen;
						$totbel  = $hasil->totbel;                    
						$totpenlalu  = $hasil->totpenlalu;
						$totbellalu  = $hasil->totbellalu;   


$surrellalu = $totpenlalu-$totbellalu;
			
							
			$surrellalu1= $this->angka($surrellalu);


					 
			$surang =  $angpen-$angbel;
			

			$surang1=$this->angka($surang);
			
			$surrel = $totpen-$totbel;
			
							
			$surrel1= $this->angka($surrel);
			
			$per    = ($surrel!=0)?($surrel/$surang)*100:0; 
			$persen = number_format($per,"2",".",",");                       

			$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
			$sqlsclient=$this->db->query($sqlsc);
			foreach ($sqlsclient->result() as $rowsc){
				$tgl=$rowsc->tgl_rka;
				$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
				$kab     = $rowsc->kab_kota;
				$daerah  = $rowsc->daerah;
				$thn     = $rowsc->thn_ang;
			} 
			
			$cRet='';
			$lastmoth=$thn.'-'.$bul.'-'.'01';
			$lastyear=date('Y-m-t',strtotime($lastmoth)); 
			$str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));
			
			$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
						<tr>
							<td align=\"center\"><strong>PEMERINTAH $kab</strong></td>                         
						</tr>
						<tr>
							<td align=\"center\"><strong>$nm_skpd</strong></td>                         
						</tr>                    
						<tr>
							<td align=\"center\"><strong>LAPORAN REALISASI ANGGARAN PENDAPATAN  DAN BELANJA</strong></td>
						</tr>                    
						<tr>
							<td align=\"center\"><strong>UNTUK PERIODE YANG BERAKHIR SAMPAI DENGAN<br>$str dan $thn_ang_1</strong></td>
						</tr>
						<tr>
							<td align=\"center\">&nbsp;</td>
						</tr>
					  </table>";        
			
			$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
						 <thead>                       
							<tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
								<td bgcolor=\"#CCCCCC\" width=\"45%\" align=\"center\"><b>URAIAN</b></td>
								<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Anggaran $thn_ang</b></td>
								<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Realisasi $thn_ang</b></td>
								<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>(%)</b></td>
								<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>Realisasi $thn_ang_1</b></td>   
							</tr>  
						 </thead>
						 <tfoot>
							<tr>
								<td style=\"border-top: none;\"></td>
								<td style=\"border-top: none;\"></td>
								<td style=\"border-top: none;\"></td>
								<td style=\"border-top: none;\"></td>
								<td style=\"border-top: none;\"></td>
								<td style=\"border-top: none;\"></td>                           
							 </tr>
						 </tfoot>";

					 $sql4 ="SELECT nor,uraian,seq,
								(SELECT SUM($rka) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='$id' 
								AND (LEFT(c.kd_rek64,3)=a.kode_1 OR LEFT(c.kd_rek64,2)=a.kode_1 OR LEFT(c.kd_rek64,1)=a.kode_1)) AS anggaran,
								(SELECT SUM(debet) AS debet FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
								WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang' 
								AND (LEFT(b.kd_rek5,3)=a.kode_1 OR LEFT(b.kd_rek5,2)=a.kode_1 OR LEFT(b.kd_rek5,1)=a.kode_1)) AS debet,
								(SELECT SUM(kredit) AS kredit FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
								WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang'
								AND (LEFT(b.kd_rek5,3)=a.kode_1 OR LEFT(b.kd_rek5,2)=a.kode_1 OR LEFT(b.kd_rek5,1)=a.kode_1)) AS kredit,
(SELECT SUM(debet) AS debet FROM trhju_pkd_lalu a INNER JOIN trdju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' AND tgl_voucher='2015-12-31'
AND (LEFT(b.kd_rek5,3)=a.kode_1 OR LEFT(b.kd_rek5,2)=a.kode_1 OR LEFT(b.kd_rek5,1)=a.kode_1)) AS debetlalu,

(SELECT SUM(kredit) AS kredit FROM trhju_pkd_lalu a INNER JOIN trdju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' AND tgl_voucher='2015-12-31'
AND (LEFT(b.kd_rek5,3)=a.kode_1 OR LEFT(b.kd_rek5,2)=a.kode_1 OR LEFT(b.kd_rek5,1)=a.kode_1)) AS kreditlalu	

								FROM map_lra_skpd a ORDER BY nor";
								
				$query4 = $this->db->query($sql4);                                  
				foreach ($query4->result() as $row4){
					$no         = $row4->nor;
					$nama       = $row4->uraian;   
					$anggaran   = $row4->anggaran;
					$debet      = $row4->debet;
					$kredit     = $row4->kredit;
					$debetlalu      = $row4->debetlalu;
					$kreditlalu     = $row4->kreditlalu;
					$seq        = $row4->seq;
					
					$angg  = number_format($anggaran,"2",".",",");
					
					if($row4->seq<'50'){
					  $nilai = $kredit-$debet;
					  $nilailalu = $kreditlalu-$debetlalu;

					}else{
					  $nilai = $debet-$kredit;    
					  $nilailalu = $debetlalu-$kreditlalu;
					}
					$nil  = number_format($nilai,"2",".",",");
					$nillalu1  = number_format($nilailalu,"2",".",",");
					
					if ($anggaran<>0){
						$per1    = ($anggaran!=0)?($nilai/$anggaran)*100:0;
					}else if($anggaran==0 and $nilai!=0){ 
						$per1=100;

					} else{
						$per1=0;
					}                
					$persen1 = number_format($per1,"2",".",",");
					
					switch ($row4->seq){
						case 5:
							 $cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 </tr>";
							break;
						 case 10:
							 $cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 </tr>";
							break;
						case 30:
							$cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen1</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nillalu1</b></td>
										 </tr>";
							break;
						case 40:
							$cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen1</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nillalu1</b></td>
										 </tr>";
							break;
						 case 50:
							$cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 </tr>";
							break;
						case 55:
							$cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
										 </tr>";
							break;
						case 70:
							$cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen1</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nillalu1</b></td>
										 </tr>";
							break;                                         
						case 80:
							$cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
										 </tr>";
							break;
						case 115:
							$cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen1</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nillalu1</b></td>
										 </tr>";
							break;
						case 125:
							$cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen1</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nillalu1</b></td>
										 </tr>";
							break;
						case 135:
							$cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surang1</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surrel1</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surrellalu1</b></td>
										 </tr>";
							break;                                                                          
						default:
						if($nama <> ''){
						$cRet    .= "<tr>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$angg</td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nil</td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$persen1</td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nillalu1</td>
									 </tr>";
						}else{
						 $cRet    .= "<tr>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
									 </tr>";	
						}

					}         
					
				}
			$cRet .= " </table>";
			$cRet .= " <br><br>";
			$sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id' and kode='PA'");
			foreach($sqlttd->result() as $ttd){
				$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
				$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
				$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
			}

			$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
							<tr>
								<td width=\"25%\" align=\"center\"></td>
								<td width=\"25%\">&nbsp;</td>
								<td width=\"50%\">&nbsp;</td>
							</tr>
							<tr>
								<td width=\"25%\" align=\"center\"></td>
								<td width=\"25%\">&nbsp;</td>
								<td width=\"50%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
							</tr>
							<tr>
								<td width=\"25%\" align=\"center\"></td>
								<td width=\"25%\">&nbsp;</td>
								<td width=\"50%\" align=\"center\">$jabatan</td>
							</tr>
							<tr>
								<td width=\"25%\" align=\"center\"></td>
								<td width=\"25%\">&nbsp;</td>
								<td width=\"50%\">&nbsp;</td>
							</tr>
							<tr>
								<td width=\"25%\" align=\"center\"></td>
								<td width=\"25%\">&nbsp;</td>
								<td width=\"50%\">&nbsp;</td>
							</tr>
							<tr>
								<td width=\"25%\" align=\"center\"></td>
								<td width=\"25%\">&nbsp;</td>
								<td width=\"50%\">&nbsp;</td>
							</tr>
							<tr>
								<td width=\"25%\" align=\"center\"><b></b></td>
								<td width=\"25%\">&nbsp;</td>
								<td width=\"50%\" align=\"center\"><b><u>$nama</u></b></td>
							</tr>
							<tr>
								<td width=\"25%\" align=\"center\"><b></b></td>
								<td width=\"25%\">&nbsp;</td>
								<td width=\"50%\" align=\"center\"><b>NIP. $nip</b></td>
							</tr>
				</table>"; 
		
		$ctk = $this->uri->segment(3);
		   $data['prev']= $cRet;
            switch($ctk) {        
                case 1;
       $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');			


                break;
                case 2;        
                    header("Cache-Control: no-cache, no-store, must-revalidate");
                    header("Content-Type: application/vnd.ms-excel");
                    header("Content-Disposition: attachment; filename=$id.xls");
                    $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            }
		}
    }
    
	
		   
    function cetak_lra_pemda(){
	    $id        = $this->session->userdata('kdskpd');
$thn_ang   = $this->session->userdata('pcThang');
//		$thn_ang   = '2015';
        $bul       = $_REQUEST['bulan'];
        $bulan     = $this->tukd_model->getBulan($bul); 
        $tgl_ttd   = $_REQUEST['tgl_ctk']; 
		
		$apbd=$_REQUEST['apbd'];
		
        $thn_ang_1 = $thn_ang-1;
        $lastmoth  = $thn_ang.'-'.$bul.'-'.'01';
		$lastyear  = date('Y-m-t',strtotime($lastmoth)); 
		$str	   = strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear)); 		
		$cetak = $this->uri->segment(3);

       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                }  
				
				$apbd=$_REQUEST['apbd'];
				if($apbd==0){
				$rka='nilai';
				}else{
				$rka='nilai_ubah';
				}
     
$sql="SELECT 
		(SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,1)='4') AS angpen,
		(SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,1)='5') AS angbel,
		(SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='61') AS angpentrans,
		(SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='62') AS angbeltrans,
		(SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='71') AS angpenepemb,
		(SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='72') AS angpengpemb,
		
		(SELECT IFNULL(SUM(b.kredit)-SUM(b.debet),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
			WHERE LEFT(b.kd_rek5,1)='4' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang') AS totpen,
		(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
			WHERE LEFT(b.kd_rek5,1)='5' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang') AS totbel,
		(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
			WHERE LEFT(b.kd_rek5,2)='61' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang') AS totpentrans,
		(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0)  AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
			WHERE LEFT(b.kd_rek5,2)='62' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang')AS totbeltrans,
		(SELECT IFNULL(SUM(b.kredit)-SUM(b.debet),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
			WHERE LEFT(b.kd_rek5,2)='71' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang') AS totpenepemb,
		(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
			WHERE LEFT(b.kd_rek5,2)='72' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang') AS totpengpemb,



(SELECT IFNULL(SUM(b.kredit)-SUM(b.debet),0) AS nilai FROM trhju_pkd_lalu a INNER JOIN trdju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
			WHERE LEFT(b.kd_rek5,1)='4' and tgl_voucher='2015-12-31') AS totpenlalu,
		(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd_lalu a INNER JOIN trdju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
			WHERE LEFT(b.kd_rek5,1)='5' and tgl_voucher='2015-12-31') AS totbellalu,
		(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd_lalu a INNER JOIN trdju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
			WHERE LEFT(b.kd_rek5,2)='61' and tgl_voucher='2015-12-31') AS totpentranslalu,
		(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0)  AS nilai FROM trhju_pkd_lalu a INNER JOIN trdju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
			WHERE LEFT(b.kd_rek5,2)='62' and tgl_voucher='2015-12-31')AS totbeltranslalu,
		(SELECT IFNULL(SUM(b.kredit)-SUM(b.debet),0) AS nilai FROM trhju_pkd_lalu a INNER JOIN trdju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
			WHERE LEFT(b.kd_rek5,2)='71' and tgl_voucher='2015-12-31') AS totpenepemblalu,
		(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd_lalu a INNER JOIN trdju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
			WHERE LEFT(b.kd_rek5,2)='72' and tgl_voucher='2015-12-31') AS totpengpemblalu";
	
			 
			 
                    $query   = $this->db->query($sql);
                    $hasil   = $query->row();
                    $angpen  = $hasil->angpen;
                    $angbel  = $hasil->angbel;
					$angpentrans = $hasil->angpentrans;
					$angbeltrans = $hasil->angbeltrans;
					$angtrans = $hasil->angpentrans+$hasil->angbeltrans;
					$angpenepemb = $hasil->angpenepemb;
					$angpengpemb = $hasil->angpengpemb;
					$silang	= $hasil->angpenepemb-$hasil->angpengpemb;
                    

                    $totpen  = $hasil->totpen;
                    $totbel  = $hasil->totbel;
					$totpentrans = $hasil->totpentrans;
					$totbeltrans = $hasil->totbeltrans;
					$tottrans = $hasil->totpentrans+$hasil->totbeltrans;
					$totpenepemb = $hasil->totpenepemb;
					$totpengpemb = $hasil->totpengpemb;
					$silreal = $hasil->totpenepemb-$hasil->totpengpemb;
					$silreal1 = $hasil->totpenepemb-$hasil->totpengpemb;



					$totpenlalu  = $hasil->totpenlalu;
                    $totbellalu  = $hasil->totbellalu;
					$totpentranslalu = $hasil->totpentranslalu;
					$totbeltranslalu = $hasil->totbeltranslalu;
					$tottranslalu = $hasil->totpentranslalu+$hasil->totbeltranslalu;
					$totpenepemblalu = $hasil->totpenepemblalu;
					$totpengpemblalu = $hasil->totpengpemblalu;
					$silreallalu = $hasil->totpenepemblalu-$hasil->totpengpemblalu;
					$silreal1lalu = $hasil->totpenepemblalu-$hasil->totpengpemblalu;

	//**--------------------------------transfer-----------------------------------------------	
		$abeltrans = $angbel+$angtrans;
        $abeltrans1 =  $this->angka($abeltrans);
		
		$rbeltrans = $totbel+$tottrans;
        $rbeltrans1 = $this->angka($rbeltrans);



        //lalu
	$rbeltranslalu = $totbellalu+$tottranslalu;
    $rbeltranslalu1 = $this->angka($rbeltranslalu);
        //akhir
		
		if ($abeltrans<>0){$per4 = ($abeltrans!=0)?($rbeltrans/$abeltrans)*100:0;}else if($abeltrans==0 and $rbeltrans!=0){$per4=100;} else{$per4=0;}                
		$persen4 = number_format($per4,"2",".",",");			
	//**--------------------------------surplus------------------------------------------------
        $surang = $angpen-($angbel+$angtrans);
        $surang1= $this->angka($surang);
        
        $surrel = $totpen-($totbel+$tottrans);
        $surrel1=$this->angka($surrel);

        //lalu
        $surrellalu = $totpenlalu-($totbellalu+$tottranslalu);
        $surrel1lalu=$this->angka($surrellalu);
        //akhir

		if ($surang<>0){$per5 = ($surang!=0)?($surrel/$surang)*100:0;}else if($surang==0 and $surrel!=0){$per5=100;} else{$per5=0;}                
		$persen5 = number_format($per5,"2",".",",");		
	//**------------------------------netto Pemby------------------------------------------------	
		$apemb1 = $this->angka($silang);
        $rpemb1 = $this->angka($silreal);

//lalu
 $rpemb1lalu = $this->angka($silreallalu);
//

		
		if ($silang<>0){$per2 = ($silang!=0)?($silreal/$silang)*100:0;}else if($silang==0 and $silreal!=0){$per2=100;} else{$per2=0;}                
		$persen2 = number_format($per2,"2",".",",");
	//**-----------------------------Silpa------------------------------------------------				
		$apemby = ($angpen+$silang)-($angbel+$angtrans);
        $apemby1 = $this->angka($apemby);
		
	
		
		$rpemby=$totpen-($totbel+$tottrans)+$silreal1;		
        $rpemby1 = $this->angka($rpemby);

//lalu
		$rpembylalu=$totpenlalu-($totbellalu+$tottranslalu)+$silreal1lalu;		
        $rpembylalu1 = $this->angka($rpembylalu);

//

		
		if ($apemby<>0){$per3 = ($apemby!=0)?($rpemby/$apemby)*100:0;}else if($apemby==0 and $rpemby!=0){$per3=100;}else{$per3=0;}                
		$persen3 = number_format($per3,"2",".",",");		
	
        $cRet='';       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td style=\"font-size:18px;\" align=\"center\"><strong>&nbsp;</strong></td>                         
                    </tr>                    
					<tr>
                         <td style=\"font-size:18px;\" align=\"center\"><strong>PEMERINTAH $kab</strong></td>                         
                    </tr>
					<tr>
                         <td style=\"font-size:16px;\" align=\"center\"><strong>LAPORAN REALISASI ANGGARAN PENDAPATAN DAN BELANJA DAERAH</strong></td>                         
                    </tr>                                      
                    <tr>
                         <td align=\"center\"><strong>UNTUK PERIODE YANG BERAKHIR SAMPAI DENGAN<br>$str</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"8%\" align=\"center\"><b>NO URUT</b></td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"47%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>Anggaran $thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>Realisasi $thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"8%\" align=\"center\" ><b>%</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>Realisasi $thn_ang_1</b></td>
                            
                        </tr>  
                        <tr><td bgcolor=\"#CCCCCC\" align=\"center\">1</td>                            
                            <td bgcolor=\"#CCCCCC\"  align=\"center\">2</td>
                            <td bgcolor=\"#CCCCCC\"  align=\"center\">3</td>
                            <td bgcolor=\"#CCCCCC\"  align=\"center\">4</td>
                            <td bgcolor=\"#CCCCCC\" align=\"center\">5</td>
                               <td bgcolor=\"#CCCCCC\" align=\"center\">6</td>
                            
                        </tr>
						</thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                                <td style=\"border-top: none;\"></td>
                         </tr>
                     </tfoot>";



		  $sql4 ="SELECT nor,uraian,seq,normal,kode_1,
						(SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 
						WHERE (c.kd_rek64=a.kode_1 or LEFT(c.kd_rek64,5)=a.kode_1 OR LEFT(c.kd_rek64,3)=a.kode_1 OR LEFT(c.kd_rek64,2)=a.kode_1 OR LEFT(c.kd_rek64,1)=a.kode_1)) AS anggaran
						FROM map_lra_kab1 a ORDER BY CAST(nor AS SIGNED)";
		$query4 = $this->db->query($sql4);                                  
		foreach ($query4->result() as $row4){
			$no         = $row4->nor;
			$nama       = $row4->uraian;   
			$anggaran   = $row4->anggaran;
			$anggaran1   = $row4->anggaran;
			$angg  		= number_format($anggaran,"2",".",",");
			$seq        = $row4->seq;
			$normal     = $row4->normal;
			$kode1		= $row4->kode_1;
			
			$sqld = $this->db->query("SELECT IFNULL(SUM(debet),0) AS debet FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE MONTH(tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang'
					AND (kd_rek5='$kode1' or LEFT(kd_rek5,5)='$kode1' OR LEFT(kd_rek5,3)='$kode1' OR LEFT(kd_rek5,2)='$kode1' OR LEFT(kd_rek5,1)='$kode1' OR LEFT(kd_rek5,7)='$kode1')");
			foreach($sqld->result() as $sqldeb){
			$debet = $sqldeb->debet ; 
}
			$sqlk = $this->db->query("SELECT IFNULL(SUM(kredit),0) AS kredit FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE MONTH(tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang'
					AND (kd_rek5='$kode1' or LEFT(kd_rek5,5)='$kode1' OR LEFT(kd_rek5,3)='$kode1' OR LEFT(kd_rek5,2)='$kode1' OR LEFT(kd_rek5,1)='$kode1' OR LEFT(kd_rek5,7)='$kode1')");
			foreach($sqlk->result() as $sqlkre){
			$kredit = $sqlkre->kredit ; 
}


			$sqldlalu = $this->db->query("SELECT IFNULL(SUM(debet),0) AS debet FROM trhju_pkd_lalu a INNER JOIN trdju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE  tgl_voucher='2015-12-31'
					AND (kd_rek5='$kode1' or LEFT(kd_rek5,5)='$kode1' OR LEFT(kd_rek5,3)='$kode1' OR LEFT(kd_rek5,2)='$kode1' OR LEFT(kd_rek5,1)='$kode1' OR LEFT(kd_rek5,7)='$kode1')");
			foreach($sqldlalu->result() as $sqldeblalu){
			$debetlalu = $sqldeblalu->debet ; 
}
			$sqlklalu = $this->db->query("SELECT IFNULL(SUM(kredit),0) AS kredit FROM trhju_pkd_lalu a INNER JOIN trdju_pkd_lalu b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE  tgl_voucher='2015-12-31'
					AND (kd_rek5='$kode1' or LEFT(kd_rek5,5)='$kode1' OR LEFT(kd_rek5,3)='$kode1' OR LEFT(kd_rek5,2)='$kode1' OR LEFT(kd_rek5,1)='$kode1' OR LEFT(kd_rek5,7)='$kode1')");
			foreach($sqlklalu->result() as $sqlkrelalu){
			$kreditlalu = $sqlkrelalu->kredit ; 
}


			if($normal=='K'){
			  $nilai = $kredit-$debet;
			   $nilailalu = $kreditlalu-$debetlalu;
			}else{
			  $nilai = $debet-$kredit;  
			   $nilailalu = $debetlalu-$kreditlalu;    
			}
$nil  = number_format($nilai,"2",".",",");
$nilu  = number_format($nilailalu,"2",".",",");





	
					if ($anggaran<>0){$per1 = ($anggaran!=0)?($nilai/$anggaran)*100:0;}else if($anggaran==0 and $nilai!=0){$per1=100;} else{$per1=0;}                
			$persen1 = number_format($per1,"2",".",",");

						
                    switch ($row4->seq) {
                    case (($row4->seq==5)||($row4->seq==10)||($row4->seq==45)||($row4->seq==50)||($row4->seq==85)||($row4->seq==115)
						 ||($row4->seq==145)||($row4->seq==180)||($row4->seq==215)||($row4->seq==220)||($row4->seq==265)
						 ||($row4->seq==310)||($row4->seq==335)||($row4->seq==340)||($row4->seq==370)||($row4->seq==420)
						 ||($row4->seq==430)||($row4->seq==505)):
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"center\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                    case (($row4->seq==35)||($row4->seq==75)||($row4->seq==105)||($row4->seq==135)||($row4->seq==165)||($row4->seq==170)
						 ||($row4->seq==200)||($row4->seq==205)
						 ||($row4->seq==255)||($row4->seq==300)||($row4->seq==320)||($row4->seq==325)||($row4->seq==360)||($row4->seq==390)
						 ||($row4->seq==395)||($row4->seq==495)||($row4->seq==570)):
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"center\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen1</b></td>
                                        <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilu</b></td>
                                     </tr>";
                        break;	
                    case 400:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"center\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$abeltrans1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$rbeltrans1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen4</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$rbeltranslalu1</b></td>
                                     </tr>";
                        break;		
                    case 410:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"center\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surang1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surrel1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen5</b></td>
                                        <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$surrel1lalu</b></td>
                                     </tr>";
                        break;		
                    case 575:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"center\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$apemb1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$rpemb1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen2</b></td>
                                          <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$rpemb1lalu</b></td>
                                     </tr>";
                        break;		
                    case 585:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"center\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$apemby1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$rpemby1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen3</b></td>
                                        <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$rpembylalu1</b></td>
                                     </tr>";
                        break;						
                    default:
					if($nama <> ''){
                    $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$angg</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nil</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$persen1</td>
                                        <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nilu</td>
                                 </tr>";
					}else{
					 $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";	
					}
                }         
                }

        $cRet .=       " </table>";
		$cRet .= " <br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id' and kode='PA'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }


 $uye       = $_REQUEST['uye'];	   
	   
	   if($uye==1){
	   
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)." </td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>BUPATI BIAK NUMFOR<b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>THOMAS ONDY, SE.,MM</b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b></b></td>
                        </tr>
                    </table>"; 

					
					
					
					}else{
					
					
					
					
					
					
					
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                       
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><B>KEPALA BPKAD KABUPATEN BIAK NUMFOR</B> </td>
                        </tr>
						
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b><u>DR. ENIAS RUMBEWAS, SE., M.Si</u></b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>NIP. 19640623 199610 1 001</b></td>
                        </tr>
						
						
						
					

                    </table>";        
					
					
					}
					
					
					
					
					
					
            // $this->tukd_model->_mpdf('',$cRet,10,10,10,'1');

                    
        $data['prev'] = $cRet;
        $data['sikap'] = 'preview';
        $judul = 'LAPORAN LRA';
        $this->template->set('title', 'CETAK LAPORAN REALISASI ANGGARAN');
        switch ($cetak)
        {
            case 1;
              
             	$this->tukd_model->_mpdf('',$cRet,5,5,5,'0'); 
                break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= LAPORAN_LRA.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }

                 
    }    

	
//=================spj skpd==================================
    function ctk_spj_skpd(){
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/spj_skpd', $data);
    }	

 
 	
    function cetak_spj_skpd(){
		$lcskpd = $_REQUEST['skpd'];
		$nbulan	= $_REQUEST['tgl1'];
		$spasi	= $_REQUEST['spasi'];
		$tglttd	= $_REQUEST['tgl_ttd'];
		$thn_ang= $this->session->userdata('pcThang');
		
		if($lcskpd<>'1.20.05.01'){
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                 {
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
        $sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$lcskpd' and kode='PA'";
                 $sqlttd=$this->db->query($sqlttd1);
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip=$rowttd->nip;                    
                    $nama= $rowttd->nm;
                    $jabatan  = $rowttd->jab;
                }
        $sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$lcskpd' and kode='BK'";
                 $sqlttd=$this->db->query($sqlttd1);
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip1=$rowttd->nip;                    
                    $nama1= $rowttd->nm;
                    $jabatan1  = $rowttd->jab;
                }
        $skpd = $lcskpd;
        $nm_skpd=  $this->tukd_model->get_nama($lcskpd,'nm_skpd','ms_skpd','kd_skpd');
        $bulan= $this->tukd_model->getBulan($nbulan); 
        $cRet = '';
        $cRet = "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"1\" cellpadding=\"1\">";
        $cRet .="
            
            <tr>
                <td align=\"center\" style=\"font-size:14px;\" colspan=\"2\"><b>
                 PEMERINTAH KABUPATEN BIAK NUMFOR<br>
                  SURAT PENGESAHAN PERTANGGUNGJAWABAN BENDAHARA PENGELUARAN<br>
                  (SPJ BELANJA)<br>&nbsp;</b>
                </td>
            </tr>
            <tr>
                <td align=\"left\" style=\"font-size:12px;\" width=\"25%\">
                  SKPD
                </td> 
                <td width=\"75%\" style=\"font-size:12px;\">: $skpd - $nm_skpd
                </td>         
            </tr>
            <tr>
                <td align=\"left\" style=\"font-size:12px;\">
                  Pengguna Anggaran/Kuasa Pengguna Anggaran
                </td> 
                <td style=\"font-size:12px;\">: $nama
                </td>         
            </tr>
            <tr>
                <td align=\"left\" style=\"font-size:12px;\">
                  Bendahara Pengeluaran
                </td> 
                <td style=\"font-size:12px;\">: $nama1
                </td>         
            </tr>
            <tr>
                <td align=\"left\" style=\"font-size:12px;\">
                  Tahun Anggaran
                </td> 
                <td style=\"font-size:12px;\">: $thn_ang
                </td>         
            </tr>
            <tr>
                <td align=\"left\" style=\"font-size:12px;\">
                  Bulan
                </td> 
                <td style=\"font-size:12px;\">: $bulan
                </td>         
            </tr>
            <tr>
                <td align=\"left\" style=\"font-size:12px;\" colspan=\"2\">&nbsp;
                 
                </td> 
            </tr>
            
            </table>";
		$cRet    .="<table style=\"border-collapse:collapse; font-size:14;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"4\">
					<thead>
						<tr>
							 <td rowspan=\"2\" width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Kode Rekening<b></td>
							 <td rowspan=\"2\" width=\"30%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Uraian</b></td>
							 <td rowspan=\"2\" width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Jumlah Anggaran<b></td>
							 <td colspan=\"3\" width=\"30%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Spj Ls-Gaji<b></td>
							 <td colspan=\"3\" width=\"30%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Spj Ls-Barang & jasa<b></td>
							 <td colspan=\"3\" width=\"30%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Spj UP/GU/TU/LS BENDAHARA<b></td>
							 <td rowspan=\"2\" width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Jml SPJ <br>(LS+UP/GU/TU)<br>s.d bln ini<b></td>
							 <td rowspan=\"2\" width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Sisa Pagu<br>Anggaran<b></td>
						</tr>

						<tr>
							 <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>s.d Bln lalu<b></td>
							 <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Bulan ini</b></td>
							 <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>s.d Bln ini<b></td>
							  <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>s.d Bln lalu<b></td>
							 <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Bulan ini</b></td>
							 <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>s.d Bln ini<b></td>
							 <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>s.d Bln lalu<b></td>
							 <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Bulan ini</b></td>
							 <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>s.d Bln ini<b></td>
						</tr>
						<tr>
						 <td width=\"10%\" align=\"center\">1</td>
						 <td width=\"30%\" align=\"center\">2</td>
						 <td width=\"10%\" align=\"center\">3</td>
						 <td width=\"10%\" align=\"center\">4</td>
						 <td width=\"10%\" align=\"center\">5</td>
						 <td width=\"10%\" align=\"center\">6</td>
						 <td width=\"10%\" align=\"center\">7</td>
						 <td width=\"10%\" align=\"center\">8</td>
						 <td width=\"10%\" align=\"center\">9</td>
						 <td width=\"10%\" align=\"center\">10</td>
						 <td width=\"10%\" align=\"center\">11</td>
						 <td width=\"10%\" align=\"center\">12</td>
						 <td width=\"10%\" align=\"center\">13 =6+9+12</td>
						 <td width=\"10%\" align=\"center\">14</td>
					</tr>
					</thead>
					
					<tfoot>
						<tr>
							 <td colspan=\"14\" style=\"border-bottom:none;border-left:none;border-right:none;\"></td>
						</tr>
					</tfoot>
					<tr>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"></td>
						 <td width=\"30%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
					</tr>
					";
					
		$sqlww=$this->db->query("SELECT a.kd_skpd AS skpd,a.nm_skpd AS nmskpd,a.kd_program AS program,a.nm_program AS nmprogram,SUM(b.nilai_ubah) AS nilai FROM trskpd a 
		JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan
		WHERE LEFT(b.kd_rek5,2) IN ('51','52') AND a.kd_skpd='$lcskpd' GROUP BY a.kd_program");
		$grand1=0;$grand2=0;$grand3=0;$grand4=0;$grand5=0;$grand6=0;$grand7=0;$grand8=0;$grand9=0;$grand9=0;$grand10=0;$tot=0;$sis=0;
		foreach($sqlww->result() as $roww){
			$kdskpd=$roww->skpd;
			$progw=$roww->program;
			$nmprogw=$roww->nmprogram;
			$nilaiw=$roww->nilai;	

			$sql11=mysql_query("SELECT SUM(a.nilai) AS nilai2 FROM trdspp a
								INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='4' AND b.kd_skpd='$kdskpd'
								AND MONTH(b.tgl_kas)<'$nbulan' AND LEFT(a.kd_kegiatan,18)='$progw'");							   
			$hasil11=mysql_fetch_assoc($sql11);
			$sql1=mysql_query("SELECT SUM(a.nilai) AS nilai2 FROM trdspp a
								INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='4' AND b.kd_skpd='$kdskpd'
								AND MONTH(b.tgl_kas)='$nbulan' AND LEFT(a.kd_kegiatan,18)='$progw'");
			$hasil1=mysql_fetch_assoc($sql1);
			$sql111=mysql_query("SELECT SUM(a.nilai) AS nilai2 FROM trdspp a
								INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='4' AND b.kd_skpd='$kdskpd'
								AND MONTH(b.tgl_kas)<='$nbulan' AND LEFT(a.kd_kegiatan,18)='$progw'");
			$hasil111=mysql_fetch_assoc($sql111);
			
			//==================================================================
			$sql22=mysql_query("SELECT SUM(a.nilai) AS nilai5 FROM trdspp a
								INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='6' AND b.kd_skpd='$kdskpd'
								AND MONTH(b.tgl_kas)<'$nbulan' AND LEFT(a.kd_kegiatan,18)='$progw'");
			$hasil22=mysql_fetch_assoc($sql22);
			$sql2=mysql_query("SELECT SUM(a.nilai) AS nilai5 FROM trdspp a
								INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='6' AND b.kd_skpd='$kdskpd'
								AND MONTH(b.tgl_kas)='$nbulan' AND LEFT(a.kd_kegiatan,18)='$progw'");
			$hasil2=mysql_fetch_assoc($sql2);
			$sql222=mysql_query("SELECT SUM(a.nilai) AS nilai5 FROM trdspp a
								INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='6' AND b.kd_skpd='$kdskpd'
								AND MONTH(b.tgl_kas)<='$nbulan' AND LEFT(a.kd_kegiatan,18)='$progw'");
			$hasil222=mysql_fetch_assoc($sql222);
			//===================================================================
$sql33=mysql_query("SELECT SUM(nilai)AS nilai7 FROM trhtransout a 
			   INNER JOIN trdtransout b ON a.no_bukti=b.no_bukti WHERE a.jns_spp in ('1','2','3','7') 
			   AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_kas)<'$nbulan' and left(b.kd_kegiatan,18)='$progw'");
$hasil33=mysql_fetch_assoc($sql33);
$sql3=mysql_query("SELECT SUM(nilai)AS nilai7 FROM trhtransout a 
			   INNER JOIN trdtransout b ON a.no_bukti=b.no_bukti WHERE a.jns_spp in ('1','2','3','7') 
			   AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_kas)='$nbulan' and left(b.kd_kegiatan,18)='$progw'");
$hasil3=mysql_fetch_assoc($sql3);
$sql333=mysql_query("SELECT SUM(nilai)AS nilai7 FROM trhtransout a 
			   INNER JOIN trdtransout b ON a.no_bukti=b.no_bukti WHERE a.jns_spp in ('1','2','3','7') 
			   AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_kas)<='$nbulan' and left(b.kd_kegiatan,18)='$progw'");
$hasil333=mysql_fetch_assoc($sql333);


//KOREKSIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII
$sqlkoreksi = "SELECT IFNULL(SUM(b.nilaid),0) AS debit,IFNULL(SUM(b.nilaik),0) AS kredit FROM dkoreksi b 
                        INNER JOIN hkoreksi a ON a.no_bukti=b.no_bukti WHERE b.kd_skpd='$kdskpd' 
                        and month(a.tgl_bukti)<'$nbulan' 
                        and left(b.kd_kegiatan,18)='$progw'";
        $ahasil = $this->db->query($sqlkoreksi);
        foreach ($ahasil->result() as $rowx){
           $d = $rowx->debit;
           $k = $rowx->kredit;
        }



$sqlkoreksi1 = "SELECT IFNULL(SUM(b.nilaid),0) AS debit,IFNULL(SUM(b.nilaik),0) AS kredit FROM dkoreksi b 
                        INNER JOIN hkoreksi a ON a.no_bukti=b.no_bukti WHERE b.kd_skpd='$kdskpd' 
                        and month(a.tgl_bukti)='$nbulan' 
                         and left(b.kd_kegiatan,18)='$progw'";
        $ahasil1 = $this->db->query($sqlkoreksi1);
        foreach ($ahasil1->result() as $row1){
           $d1 = $row1->debit;
           $k1 = $row1->kredit;
        }


        $sqlkoreksi2 = "SELECT IFNULL(SUM(b.nilaid),0) AS debit,IFNULL(SUM(b.nilaik),0) AS kredit FROM dkoreksi b 
                        INNER JOIN hkoreksi a ON a.no_bukti=b.no_bukti WHERE b.kd_skpd='$kdskpd' 
                        and month(a.tgl_bukti)<='$nbulan' 
                        and left(b.kd_kegiatan,18)='$progw'";
        $ahasil2 = $this->db->query($sqlkoreksi2);
        foreach ($ahasil2->result() as $row2){
           $d2 = $row2->debit;
           $k2 = $row2->kredit;
        }
		
		
		
		
		
$alalu=(($hasil33['nilai7']-$d)+$k);
                         if($alalu < 0){
                            $f = "(";
                            $alalu = $alalu*-1;
                            $g = ")";
                        }else{
                            $f = "";
                            $alalu = $alalu;
                            $g = "";
                        }
                        $ok = number_format($alalu,"2",",",".");


$aini=(($hasil3['nilai7']-$d1)+$k1);
                         if($aini < 0){
                            $f1 = "(";
                            $aini = $aini*-1;
                            $g1 = ")";
                        }else{
                            $f1 = "";
                            $aini = $aini;
                            $g1 = "";
                        }
                        $ok1 = number_format($aini,"2",",",".");

$asdini=(($hasil333['nilai7']-$d2)+$k2);
                         if($asdini < 0){
                            $f11 = "(";
                            $asdini = $asdini*-1;
                            $g11 = ")";
                        }else{
                            $f11 = "";
                            $asdini = $asdini;
                            $g11 = "";
                        }
                        $ok2 = number_format($asdini,"2",",",".");



		
		
		
		
		
		


//KOREKSIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIIII






	//====================================kembali ls Gaji================================
			$sqlk1=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
									WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_sts)<'$nbulan' AND LEFT(b.kd_rek5,2)='51'
									and left(a.kd_kegiatan,18)='$progw'");
			$hasilk1a=mysql_fetch_assoc($sqlk1);
			$sqlk2=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
									WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_sts)='$nbulan' AND LEFT(b.kd_rek5,2)='51'
									and left(a.kd_kegiatan,18)='$progw'");
			$hasilk2a=mysql_fetch_assoc($sqlk2);
			$sqlk3=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
									WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)='51'
									and left(a.kd_kegiatan,18)='$progw'");
			$hasilk3a=mysql_fetch_assoc($sqlk3);
			//====================================kembali ls brg================================
			$sqlls1=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
									WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_sts)<'$nbulan' AND LEFT(b.kd_rek5,2)='52'
									and left(a.kd_kegiatan,18)='$progw'");
			$hasills1a=mysql_fetch_assoc($sqlls1);
			$sqlls2=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
									WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_sts)='$nbulan' AND LEFT(b.kd_rek5,2)='52'
									and left(a.kd_kegiatan,18)='$progw'");
			$hasills2a=mysql_fetch_assoc($sqlls2);
			$sqlls3=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
									WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)='52'
									and left(a.kd_kegiatan,18)='$progw'");
			$hasills3a=mysql_fetch_assoc($sqlls3);			

			$cRet    .="<tr>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"><b>$progw</b></td>
						 <td width=\"30%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"><b>$nmprogw</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($nilaiw)."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil11['nilai2']-$hasilk1a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil1['nilai2']-$hasilk2a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil111['nilai2']-$hasilk3a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil22['nilai5']-$hasills1a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil2['nilai5']-$hasills2a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil222['nilai5']-$hasills3a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$f$ok$g</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$f1$ok1$g1</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$f11$ok2$g11</b></td>
						  <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil111['nilai2']+$hasil222['nilai5']+(($hasil333['nilai7']-$d2)+$k2)-$hasilk3a['nilk']-$hasills3a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($nilaiw-$hasil111['nilai2']-$hasil222['nilai5']-(($hasil333['nilai7']-$d2)+$k2)+$hasilk3a['nilk']+$hasills3a['nilk'])."</b></td>
					</tr>";
					
		$sql=$this->db->query("	SELECT a.kd_skpd AS skpd,a.nm_skpd AS nmskpd,a.kd_kegiatan AS program,a.nm_kegiatan AS nmprogram,SUM(b.nilai_ubah) AS nilai FROM trskpd a 
		JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
		WHERE LEFT(b.kd_rek5,2) IN ('51','52') AND a.kd_skpd='$lcskpd' and a.kd_program='$progw' GROUP BY a.kd_kegiatan
		");

		foreach($sql->result() as $row){
			$kdskpd=$row->skpd;
			$prog=$row->program;
			$nmprog=$row->nmprogram;
			$nilai=$row->nilai;

			$sql11=mysql_query("SELECT SUM(a.nilai) AS nilai2 FROM trdspp a
								INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='4' AND b.kd_skpd='$kdskpd'
								AND MONTH(b.tgl_kas)<'$nbulan' AND a.kd_kegiatan='$prog'");							   
			$hasil11=mysql_fetch_assoc($sql11);
			$sql1=mysql_query("SELECT SUM(a.nilai) AS nilai2 FROM trdspp a
								INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='4' AND b.kd_skpd='$kdskpd'
								AND MONTH(b.tgl_kas)='$nbulan' AND a.kd_kegiatan='$prog'");
			$hasil1=mysql_fetch_assoc($sql1);
			$sql111=mysql_query("SELECT SUM(a.nilai) AS nilai2 FROM trdspp a
								INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='4' AND b.kd_skpd='$kdskpd'
								AND MONTH(b.tgl_kas)<='$nbulan' AND a.kd_kegiatan='$prog'");
			$hasil111=mysql_fetch_assoc($sql111);
			//==================================================================
			$sql22=mysql_query("SELECT SUM(a.nilai) AS nilai5 FROM trdspp a
								INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='6' AND b.kd_skpd='$kdskpd'
								AND MONTH(b.tgl_kas)<'$nbulan' AND a.kd_kegiatan='$prog'");
			$hasil22=mysql_fetch_assoc($sql22);
			$sql2=mysql_query("SELECT SUM(a.nilai) AS nilai5 FROM trdspp a
								INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='6' AND b.kd_skpd='$kdskpd'
								AND MONTH(b.tgl_kas)='$nbulan' AND a.kd_kegiatan='$prog'");
			$hasil2=mysql_fetch_assoc($sql2);
			$sql222=mysql_query("SELECT SUM(a.nilai) AS nilai5 FROM trdspp a
								INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='6' AND b.kd_skpd='$kdskpd'
								AND MONTH(b.tgl_kas)<='$nbulan' AND a.kd_kegiatan='$prog'");
			$hasil222=mysql_fetch_assoc($sql222);
			//===================================================================
$sql33=mysql_query("SELECT SUM(nilai)AS nilai7 FROM trhtransout a 
				   INNER JOIN trdtransout b ON a.no_bukti=b.no_bukti WHERE a.jns_spp in ('1','2','3','7') AND a.kd_skpd='$kdskpd' 
				   AND MONTH(a.tgl_kas)<'$nbulan' and b.kd_kegiatan='$prog'");
$hasil33=mysql_fetch_assoc($sql33);
$sql3=mysql_query("SELECT SUM(nilai)AS nilai7 FROM trhtransout a 
				   INNER JOIN trdtransout b ON a.no_bukti=b.no_bukti WHERE a.jns_spp in ('1','2','3','7') AND a.kd_skpd='$kdskpd' 
				   AND MONTH(a.tgl_kas)='$nbulan' and b.kd_kegiatan='$prog'");
$hasil3=mysql_fetch_assoc($sql3);
$sql333=mysql_query("SELECT SUM(nilai)AS nilai7 FROM trhtransout a 
				   INNER JOIN trdtransout b ON a.no_bukti=b.no_bukti WHERE a.jns_spp in ('1','2','3','7') AND a.kd_skpd='$kdskpd' 
				   AND MONTH(a.tgl_kas)<='$nbulan' and b.kd_kegiatan='$prog'");
$hasil333=mysql_fetch_assoc($sql333);



$sqlkoreksi = "SELECT IFNULL(SUM(b.nilaid),0) AS debit,IFNULL(SUM(b.nilaik),0) AS kredit FROM dkoreksi b 
                        INNER JOIN hkoreksi a ON a.no_bukti=b.no_bukti WHERE b.kd_skpd='$kdskpd' 
                        and month(a.tgl_bukti)<'$nbulan' 
                       and b.kd_kegiatan='$prog'";
        $ahasil = $this->db->query($sqlkoreksi);
        foreach ($ahasil->result() as $rowx){
           $d = $rowx->debit;
           $k = $rowx->kredit;
        }



$sqlkoreksi1 = "SELECT IFNULL(SUM(b.nilaid),0) AS debit,IFNULL(SUM(b.nilaik),0) AS kredit FROM dkoreksi b 
                        INNER JOIN hkoreksi a ON a.no_bukti=b.no_bukti WHERE b.kd_skpd='$kdskpd' 
                        and month(a.tgl_bukti)='$nbulan' 
                         and b.kd_kegiatan='$prog'";
        $ahasil1 = $this->db->query($sqlkoreksi1);
        foreach ($ahasil1->result() as $row1){
           $d1 = $row1->debit;
           $k1 = $row1->kredit;
        }


        $sqlkoreksi2 = "SELECT IFNULL(SUM(b.nilaid),0) AS debit,IFNULL(SUM(b.nilaik),0) AS kredit FROM dkoreksi b 
                        INNER JOIN hkoreksi a ON a.no_bukti=b.no_bukti WHERE b.kd_skpd='$kdskpd' 
                        and month(a.tgl_bukti)<='$nbulan' 
                         and b.kd_kegiatan='$prog'";
        $ahasil2 = $this->db->query($sqlkoreksi2);
        foreach ($ahasil2->result() as $row2){
           $d2 = $row2->debit;
           $k2 = $row2->kredit;
        }


$hlalu1=(($hasil33['nilai7']-$d)+$k);
                         if($hlalu1 < 0){
                            $b1 = "(";
                            $hlalu1 = $hlalu1*-1;
                            $c2 = ")";
                        }else{
                            $b1 = "";
                            $hlalu1 = $hlalu1;
                            $c2 = "";
                        }
                        $yes9 = number_format($hlalu1,"2",",",".");


$hini1=(($hasil3['nilai7']-$d1)+$k1);
                         if($hini1 < 0){
                            $b11 = "(";
                            $hini1 = $hini1*-1;
                            $c22 = ")";
                        }else{
                            $b11 = "";
                            $hini1 = $hini1;
                            $c22 = "";
                        }
                        $hbulanini = number_format($hini1,"2",",",".");

$hsdini1=(($hasil333['nilai7']-$d2)+$k2);
                         if($hsdini1 < 0){
                            $b111 = "(";
                            $hsdini1 = $hsdini1*-1;
                            $c222 = ")";
                        }else{
                            $b111 = "";
                            $hsdini1 = $hsdini1;
                            $c222 = "";
                        }
                        $yes29 = number_format($hsdini1,"2",",",".");













			//==================================kembali ls gaji==================================
			$sqlk1=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
									WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_sts)<'$nbulan' AND LEFT(b.kd_rek5,2)='51'
									and a.kd_kegiatan='$prog'");
			$hasilk1a=mysql_fetch_assoc($sqlk1);
			$sqlk2=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
									WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_sts)='$nbulan' AND LEFT(b.kd_rek5,2)='51'
									and a.kd_kegiatan='$prog'");
			$hasilk2a=mysql_fetch_assoc($sqlk2);
			$sqlk3=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
									WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)='51'
									and a.kd_kegiatan='$prog'");
			$hasilk3a=mysql_fetch_assoc($sqlk3);
			//====================================kembali ls brg================================
			$sqlls1=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
									WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_sts)<'$nbulan' AND LEFT(b.kd_rek5,2)='52'
									and a.kd_kegiatan='$prog'");
			$hasills1a=mysql_fetch_assoc($sqlls1);
			$sqlls2=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
									WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_sts)='$nbulan' AND LEFT(b.kd_rek5,2)='52'
									and a.kd_kegiatan='$prog'");
			$hasills2a=mysql_fetch_assoc($sqlls2);
			$sqlls3=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
									WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)='52'
									and a.kd_kegiatan='$prog'");
			$hasills3a=mysql_fetch_assoc($sqlls3);			
			
			//if(strlen($prog) > 18){
				$grand1=$grand1+$nilai;
			//}
			$cRet    .="<tr>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"><b>$prog</b></td>
						 <td width=\"30%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"><b>$nmprog</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($nilai)."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil11['nilai2']-$hasilk1a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil1['nilai2']-$hasilk2a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil111['nilai2']-$hasilk3a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil22['nilai5']-$hasills1a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil2['nilai5']-$hasills2a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil222['nilai5']-$hasills3a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$b1$yes9$c2</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$b11$hbulanini$c22</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$b111$yes29$c222</b></td>
						  <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil111['nilai2']+$hasil222['nilai5']+(($hasil333['nilai7']-$d2)+$k2)-$hasilk3a['nilk']-$hasills3a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($nilai-$hasil111['nilai2']-$hasil222['nilai5']-(($hasil333['nilai7']-$d2)+$k2)+$hasilk3a['nilk']+$hasills3a['nilk'])."</b></td>
					</tr>";		
			$sqlZ=$this->db->query("SELECT a.kd_skpd AS skpd,a.nm_skpd AS nmskpd,b.no_trdrka AS program,b.nm_rek5 AS nmprogram,SUM(b.nilai_ubah) AS nilai FROM trskpd a 
									JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan
									WHERE LEFT(b.kd_rek5,2) IN ('51','52') AND a.kd_skpd='$kdskpd' AND b.kd_kegiatan ='$prog' GROUP BY b.no_trdrka
									ORDER BY program");
				foreach($sqlZ->result() as $row2){
				$progy=$row2->program;
				$nmprogy=$row2->nmprogram;
				$nilaiy =$row2->nilai;
				
				$sqlxx=mysql_query("SELECT SUM(a.nilai) AS nilai2 FROM trdspp a
									INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='4' AND b.kd_skpd='$kdskpd'
									AND MONTH(b.tgl_kas)<'$nbulan' AND a.kd_kegiatan='$prog' AND a.kd_rek5=RIGHT('$progy',7)");							   
				$hasilxx=mysql_fetch_assoc($sqlxx);
				$sqlx=mysql_query("SELECT SUM(a.nilai) AS nilai2 FROM trdspp a
									INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='4' AND b.kd_skpd='$kdskpd'
									AND MONTH(b.tgl_kas)='$nbulan' AND a.kd_kegiatan='$prog' AND a.kd_rek5=RIGHT('$progy',7)");
				$hasilx=mysql_fetch_assoc($sqlx);
				$sqlxxx=mysql_query("SELECT SUM(a.nilai) AS nilai2 FROM trdspp a
									INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='4' AND b.kd_skpd='$kdskpd'
									AND MONTH(b.tgl_kas)<='$nbulan' AND a.kd_kegiatan='$prog' AND a.kd_rek5=RIGHT('$progy',7)");
				$hasilxxx=mysql_fetch_assoc($sqlxxx);
				//=============================================================
				$sqlyy=mysql_query("SELECT SUM(a.nilai) AS nilai5 FROM trdspp a
									INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='6' AND b.kd_skpd='$kdskpd'
									AND MONTH(b.tgl_kas)<'$nbulan' AND a.kd_kegiatan='$prog' AND a.kd_rek5=RIGHT('$progy',7)");
				$hasilyy=mysql_fetch_assoc($sqlyy);
				$sqly=mysql_query("SELECT SUM(a.nilai) AS nilai5 FROM trdspp a
									INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='6' AND b.kd_skpd='$kdskpd'
									AND MONTH(b.tgl_kas)='$nbulan' AND a.kd_kegiatan='$prog' AND a.kd_rek5=RIGHT('$progy',7)");
				$hasily=mysql_fetch_assoc($sqly);
				$sqlyyy=mysql_query("SELECT SUM(a.nilai) AS nilai5 FROM trdspp a
									INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='6' AND b.kd_skpd='$kdskpd'
									AND MONTH(b.tgl_kas)<='$nbulan' AND a.kd_kegiatan='$prog' AND a.kd_rek5=RIGHT('$progy',7)");
				$hasilyyy=mysql_fetch_assoc($sqlyyy);
				//============================================================
				$sqlzz=mysql_query("SELECT SUM(nilai)AS nilai7 FROM trhtransout a 
								   INNER JOIN trdtransout b ON a.no_bukti=b.no_bukti WHERE a.jns_spp in ('1','2','3','7') AND a.kd_skpd='$kdskpd' 
								   AND MONTH(a.tgl_kas)<'$nbulan' and b.kd_kegiatan='$prog' and b.kd_rek5=right('$progy',7)");
				$hasilzz=mysql_fetch_assoc($sqlzz);
				$sqlz=mysql_query("SELECT SUM(nilai)AS nilai7 FROM trhtransout a 
								   INNER JOIN trdtransout b ON a.no_bukti=b.no_bukti WHERE a.jns_spp in ('1','2','3','7') AND a.kd_skpd='$kdskpd' 
								   AND MONTH(a.tgl_kas)='$nbulan' and b.kd_kegiatan='$prog' and b.kd_rek5=right('$progy',7)");
				$hasilz=mysql_fetch_assoc($sqlz);
				$sqlzzz=mysql_query("SELECT SUM(nilai)AS nilai7 FROM trhtransout a 
								   INNER JOIN trdtransout b ON a.no_bukti=b.no_bukti WHERE a.jns_spp in ('1','2','3','7') AND a.kd_skpd='$kdskpd' 
								   AND MONTH(a.tgl_kas)<='$nbulan' and b.kd_kegiatan='$prog' and b.kd_rek5=right('$progy',7)");
				$hasilzzz=mysql_fetch_assoc($sqlzzz);





$asqlkoreksi = "SELECT IFNULL(SUM(b.nilaid),0) AS debit,IFNULL(SUM(b.nilaik),0) AS kredit FROM dkoreksi b 
                        INNER JOIN hkoreksi a ON a.no_bukti=b.no_bukti WHERE b.kd_skpd='$kdskpd' 
                        and month(a.tgl_bukti)<'$nbulan' 
                       and b.kd_kegiatan='$prog' and b.kd_rek5=right('$progy',7)";
        $aahasil = $this->db->query($asqlkoreksi);
        foreach ($aahasil->result() as $rowxx){
           $dbit = $rowxx->debit;
           $krdit = $rowxx->kredit;
        }



$asqlkoreksi1 = "SELECT IFNULL(SUM(b.nilaid),0) AS debit,IFNULL(SUM(b.nilaik),0) AS kredit FROM dkoreksi b 
                        INNER JOIN hkoreksi a ON a.no_bukti=b.no_bukti WHERE b.kd_skpd='$kdskpd' 
                        and month(a.tgl_bukti)='$nbulan' 
                        and b.kd_kegiatan='$prog' and b.kd_rek5=right('$progy',7)";
        $aahasil1 = $this->db->query($asqlkoreksi1);
        foreach ($aahasil1->result() as $row11){
           $dbit1 = $row11->debit;
           $krdit1 = $row11->kredit;
        }


        $asqlkoreksi2 = "SELECT IFNULL(SUM(b.nilaid),0) AS debit,IFNULL(SUM(b.nilaik),0) AS kredit FROM dkoreksi b 
                        INNER JOIN hkoreksi a ON a.no_bukti=b.no_bukti WHERE b.kd_skpd='$kdskpd' 
                        and month(a.tgl_bukti)<='$nbulan' 
                        and b.kd_kegiatan='$prog' and b.kd_rek5=right('$progy',7)";
        $aahasil2 = $this->db->query($asqlkoreksi2);
        foreach ($aahasil2->result() as $row22){
           $dbit2 = $row22->debit;
           $krdit2 = $row22->kredit;
        }



$hlalu=(($hasilzz['nilai7']-$dbit)+$krdit);
                         if($hlalu < 0){
                            $a1 = "(";
                            $hlalu = $hlalu*-1;
                            $a2 = ")";
                        }else{
                            $a1 = "";
                            $hlalu = $hlalu;
                            $a2 = "";
                        }
                        $yes = number_format($hlalu,"2",",",".");


$hini=(($hasilz['nilai7']-$dbit1)+$krdit1);
                         if($hini < 0){
                            $a11 = "(";
                            $hini = $hini*-1;
                            $a22 = ")";
                        }else{
                            $a11 = "";
                            $hini = $hini;
                            $a22 = "";
                        }
                        $yes1 = number_format($hini,"2",",",".");

$hsdini=(($hasilzzz['nilai7']-$dbit2)+$krdit2);
                         if($hsdini < 0){
                            $a111 = "(";
                            $hsdini = $hsdini*-1;
                            $a222 = ")";
                        }else{
                            $a111 = "";
                            $hsdini = $hsdini;
                            $a222 = "";
                        }
                        $yes2 = number_format($hsdini,"2",",",".");











				//============================kembali ls gaji========================================
				$sqlk1=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
										WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(tgl_sts)<'$nbulan' AND LEFT(b.kd_rek5,2)='51'
										and a.kd_kegiatan='$prog' and b.kd_rek5=right('$progy',7)");
				$hasilk1a=mysql_fetch_assoc($sqlk1);
				$sqlk2=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
										WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(tgl_sts)='$nbulan' AND LEFT(b.kd_rek5,2)='51'
										and a.kd_kegiatan='$prog' and b.kd_rek5=right('$progy',7)");
				$hasilk2a=mysql_fetch_assoc($sqlk2);
				$sqlk3=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
										WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)='51'
										and a.kd_kegiatan='$prog' and b.kd_rek5=right('$progy',7)");
				$hasilk3a=mysql_fetch_assoc($sqlk3);
				//============================kembali ls brg========================================
				$sqlls1=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
										WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(tgl_sts)<'$nbulan' AND LEFT(b.kd_rek5,2)='52'
										and a.kd_kegiatan='$prog' and b.kd_rek5=right('$progy',7)");
				$hasills1a=mysql_fetch_assoc($sqlls1);
				$sqlls2=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
										WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(tgl_sts)='$nbulan' AND LEFT(b.kd_rek5,2)='52'
										and a.kd_kegiatan='$prog' and b.kd_rek5=right('$progy',7)");
				$hasills2a=mysql_fetch_assoc($sqlls2);
				$sqlls3=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
										WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)='52'
										and a.kd_kegiatan='$prog' and b.kd_rek5=right('$progy',7)");
				$hasills3a=mysql_fetch_assoc($sqlls3);
				
					$cRet    .="<tr>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$progy</td>
									 <td width=\"30%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$nmprogy</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">".number_format($nilaiy)."</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">".number_format($hasilxx['nilai2']-$hasilk1a['nilk'])."</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">".number_format($hasilx['nilai2']-$hasilk2a['nilk'])."</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">".number_format($hasilxxx['nilai2']-$hasilk3a['nilk'])."</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">".number_format($hasilyy['nilai5']-$hasills1a['nilk'])."</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">".number_format($hasily['nilai5']-$hasills2a['nilk'])."</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">".number_format($hasilyyy['nilai5']-$hasills3a['nilk'])."</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$a1$yes$a2</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$a11$yes1$a22</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$a111$yes2$a222</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">".number_format($hasilxxx['nilai2']+$hasilyyy['nilai5']+(($hasilzzz['nilai7']-$dbit2)+$krdit2)-$hasilk3a['nilk']-$hasills3a['nilk'])."</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">".number_format($nilaiy-$hasilxxx['nilai2']-$hasilyyy['nilai5']-(($hasilzzz['nilai7']-$dbit2)+$krdit2)+$hasilk3a['nilk']+$hasills3a['nilk'])."</td>
								</tr>";	
					$grand2=$grand2+$hasilxx['nilai2']-$hasilk1a['nilk'];$grand3=$grand3+$hasilx['nilai2']-$hasilk2a['nilk'];$grand4=$grand4+$hasilxxx['nilai2']-$hasilk3a['nilk'];
					$grand5=$grand5+$hasilyy['nilai5']-$hasills1a['nilk'];$grand6=$grand6+$hasily['nilai5']-$hasills2a['nilk'];$grand7=$grand7+$hasilyyy['nilai5']-$hasills3a['nilk'];
					$grand8=$grand8+(($hasilzz['nilai7']-$dbit)+$krdit);$grand9=$grand9+(($hasilz['nilai7']-$dbit1)+$krdit1);$grand10=$grand10+(($hasilzzz['nilai7']-$dbit2)+$krdit2);
					
			}	
		  }
		}
		$tot = $grand4+$grand7+$grand10;//-($hasilk3a['nilk']+$hasills3a['nilk']);
		$sis = $grand1-$tot;
	   $cRet .= " <tr>
					<td align=\"center\" colspan=\"2\" width=\"40%\"><b>Jumlah</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($grand1)."</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($grand2)."</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($grand3)."</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($grand4)."</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($grand5)."</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($grand6)."</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($grand7)."</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($grand8)."</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($grand9)."</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($grand10)."</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($tot)."</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($sis)."</b></td>
				</tr>
				 <tr>
                <td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:none;\" rowspan=\"22\">&ensp;</td>
                <td align=\"left\" style=\"font-size:12px;border-bottom:none;\" colspan=\"2\">Penerimaan :</td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;\"></td>
                <td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:none;\" rowspan=\"22\">&nbsp;</td>
            </tr>";
            
            $csql = "SELECT (SELECT SUM(b.nilai) FROM trhsp2d a INNER JOIN trdspp b 
                    ON a.no_spp = b.no_spp INNER JOIN trhspp c
                    ON a.no_spp = c.no_spp WHERE a.kd_skpd = '$lcskpd' AND 
                    MONTH(a.tgl_kas)='$nbulan' AND c.jns_spp IN ('1','2','3','7') AND a.status='1') AS sp2d_up_ini,
                    (SELECT SUM(b.nilai) FROM trhsp2d a INNER JOIN trdspp b 
                    ON a.no_spp = b.no_spp INNER JOIN trhspp c
                    ON a.no_spp = c.no_spp WHERE a.kd_skpd = '$lcskpd' AND 
                    MONTH(a.tgl_kas)<'$nbulan' AND c.jns_spp IN ('1','2','3','7') AND a.status='1') AS sp2d_up_ll,
                    (SELECT SUM(b.nilai) FROM trhsp2d a INNER JOIN trdspp b 
                    ON a.no_spp = b.no_spp INNER JOIN trhspp c
                    ON a.no_spp = c.no_spp WHERE a.kd_skpd = '$lcskpd' AND 
                    MONTH(a.tgl_kas)='$nbulan' AND c.jns_spp ='4' AND a.status='1') AS sp2d_gj_ini,
                    (SELECT SUM(b.nilai) FROM trhsp2d a INNER JOIN trdspp b 
                    ON a.no_spp = b.no_spp INNER JOIN trhspp c
                    ON a.no_spp = c.no_spp WHERE a.kd_skpd = '$lcskpd' AND 
                    MONTH(a.tgl_kas)<'$nbulan' AND c.jns_spp ='4'  AND a.status='1') AS sp2d_gj_ll,
                    (SELECT SUM(b.nilai) FROM trhsp2d a INNER JOIN trdspp b 
                    ON a.no_spp = b.no_spp INNER JOIN trhspp c
                    ON a.no_spp = c.no_spp WHERE a.kd_skpd = '$lcskpd' AND 
                    MONTH(a.tgl_kas)='$nbulan' AND c.jns_spp ='6'  AND a.status='1') AS sp2d_brjs_ini,
                    (SELECT SUM(b.nilai) FROM trhsp2d a INNER JOIN trdspp b 
                    ON a.no_spp = b.no_spp INNER JOIN trhspp c
                    ON a.no_spp = c.no_spp WHERE a.kd_skpd = '$lcskpd' AND 
                    MONTH(a.tgl_kas)<'$nbulan' AND c.jns_spp ='6' AND a.status='1') AS sp2d_brjs_ll";
            
            $hasil = $this->db->query($csql);
            $trh1 = $hasil->row(); 
            $totalsp2d = $trh1->sp2d_gj_ll+$trh1->sp2d_gj_ini+$trh1->sp2d_brjs_ll+
                         $trh1->sp2d_brjs_ini+$trh1->sp2d_up_ll+$trh1->sp2d_up_ini;
                         
            $cobacoba = $trh1->sp2d_gj_ll;
            
            
            
            $cRet .="   
            <tr>
                <td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;- SP2D</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh1->sp2d_gj_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh1->sp2d_gj_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh1->sp2d_gj_ll + $trh1->sp2d_gj_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh1->sp2d_brjs_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh1->sp2d_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh1->sp2d_brjs_ll + $trh1->sp2d_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh1->sp2d_up_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh1->sp2d_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh1->sp2d_up_ll + $trh1->sp2d_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totalsp2d)."&nbsp;</td>
            </tr>            
            
            <tr>
                <td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;- Potongan Pajak</td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
            </tr>";
            
            $lcrek = '2110401'; // ppn terima
            $csql = "SELECT (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jppn_up_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jppn_up_ll,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='4') AS jppn_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='4') AS jppn_gaji_ll,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='6') AS jppn_brjs_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='6') AS jppn_brjs_ll";
            
            $hasil = $this->db->query($csql);
            $trh2 = $hasil->row();
            $totalppn = $trh2->jppn_up_ini + $trh2->jppn_up_ll + $trh2->jppn_gaji_ini + 
                        $trh2->jppn_gaji_ll + $trh2->jppn_brjs_ini + $trh2->jppn_brjs_ll;
            
            
            $cRet .=" 
            <tr>
                <td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;a.PPN</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh2->jppn_gaji_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh2->jppn_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh2->jppn_gaji_ll + $trh2->jppn_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh2->jppn_brjs_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh2->jppn_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh2->jppn_brjs_ll + $trh2->jppn_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh2->jppn_up_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh2->jppn_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh2->jppn_up_ll + $trh2->jppn_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totalppn)."&nbsp;</td>
            </tr>";
            
            $lcrek = '2110301'; // pph 21 terima
            $csql = "SELECT (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph21_up_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph21_up_ll,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='4') AS jpph21_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='4') AS jpph21_gaji_ll,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='6') AS jpph21_brjs_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='6') AS jpph21_brjs_ll";
            
            $hasil = $this->db->query($csql);
            $trh3 = $hasil->row();
            $totalpph21 = $trh3->jpph21_up_ini + $trh3->jpph21_up_ll + $trh3->jpph21_gaji_ini + 
                        $trh3->jpph21_gaji_ll + $trh3->jpph21_brjs_ini + $trh3->jpph21_brjs_ll;
            
            
            $cRet .="
             <tr>
                <td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;b.PPH 21</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh3->jpph21_gaji_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh3->jpph21_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh3->jpph21_gaji_ll + $trh3->jpph21_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh3->jpph21_brjs_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh3->jpph21_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh3->jpph21_brjs_ll + $trh3->jpph21_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh3->jpph21_up_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh3->jpph21_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh3->jpph21_up_ll + $trh3->jpph21_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totalpph21)."&nbsp;</td>
            </tr>";
            
            $lcrek = '2110302'; // pph 22 terima
            $csql = "SELECT (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph22_up_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph22_up_ll,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='4') AS jpph22_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='4') AS jpph22_gaji_ll,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='6') AS jpph22_brjs_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='6') AS jpph22_brjs_ll";
            
            $hasil = $this->db->query($csql);
            $trh4 = $hasil->row();
            $totalpph22 = $trh4->jpph22_up_ini + $trh4->jpph22_up_ll + $trh4->jpph22_gaji_ini + 
                        $trh4->jpph22_gaji_ll + $trh4->jpph22_brjs_ini + $trh4->jpph22_brjs_ll;
            
            
            $cRet .="
             <tr>
                <td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;c.PPH 22</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh4->jpph22_gaji_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh4->jpph22_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh4->jpph22_gaji_ll + $trh4->jpph22_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh4->jpph22_brjs_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh4->jpph22_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh4->jpph22_brjs_ll + $trh4->jpph22_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh4->jpph22_up_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh4->jpph22_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh4->jpph22_up_ll + $trh4->jpph22_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totalpph22)."&nbsp;</td>
            </tr>";
            
            $lcrek = '2110303'; // pph 23 terima
            $csql = "SELECT (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph23_up_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph23_up_ll,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='4') AS jpph23_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='4') AS jpph23_gaji_ll,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='6') AS jpph23_brjs_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='6') AS jpph23_brjs_ll";
            
            $hasil = $this->db->query($csql);
            $trh5 = $hasil->row();
            $totalpph23 = $trh5->jpph23_up_ini + $trh5->jpph23_up_ll + $trh5->jpph23_gaji_ini + 
                        $trh5->jpph23_gaji_ll + $trh5->jpph23_brjs_ini + $trh5->jpph23_brjs_ll;
            
            
            $cRet .="
             <tr>
                <td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;d.PPH 23</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh5->jpph23_gaji_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh5->jpph23_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh5->jpph23_gaji_ll + $trh5->jpph23_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh5->jpph23_brjs_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh5->jpph23_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh5->jpph23_brjs_ll + $trh5->jpph23_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh5->jpph23_up_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh5->jpph23_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh5->jpph23_up_ll + $trh5->jpph23_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totalpph23)."&nbsp;</td>
            </tr>";
            
            // lain terima
            $csql = "SELECT (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 NOT IN ('2110301','2110302','2110303','2110401') AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jlain_up_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 NOT IN ('2110301','2110302','2110303','2110401') AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jlain_up_ll,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 NOT IN ('2110301','2110302','2110303','2110401') AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='4') AS jlain_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 NOT IN ('2110301','2110302','2110303','2110401') AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='4') AS jlain_gaji_ll,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 NOT IN ('2110301','2110302','2110303','2110401') AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='6') AS jlain_brjs_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 NOT IN ('2110301','2110302','2110303','2110401') AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='6') AS jlain_brjs_ll";
            $hasil = $this->db->query($csql);
            $trh6 = $hasil->row();
            $totallain = $trh6->jlain_up_ini + $trh6->jlain_up_ll + $trh6->jlain_gaji_ini + 
                         $trh6->jlain_gaji_ll + $trh6->jlain_brjs_ini + $trh6->jlain_brjs_ll;
            
            
            $jmtrmgaji_ll =  $trh1->sp2d_gj_ll+ $trh2->jppn_gaji_ll + $trh3->jpph21_gaji_ll +
                             $trh4->jpph22_gaji_ll + $trh5->jpph23_gaji_ll + $trh6->jlain_gaji_ll;
            
            $jmtrmgaji_ini =  $trh1->sp2d_gj_ini + $trh2->jppn_gaji_ini + $trh3->jpph21_gaji_ini +
                             $trh4->jpph22_gaji_ini + $trh5->jpph23_gaji_ini + $trh6->jlain_gaji_ini;
                             
            $jmtrmgaji_sd = $jmtrmgaji_ll + $jmtrmgaji_ini;
            
            
            $jmtrmbrjs_ll =  $trh1->sp2d_brjs_ll + $trh2->jppn_brjs_ll + $trh3->jpph21_brjs_ll +
                             $trh4->jpph22_brjs_ll + $trh5->jpph23_brjs_ll + $trh6->jlain_brjs_ll;
                                                                                                 
            $jmtrmbrjs_ini =  $trh1->sp2d_brjs_ini + $trh2->jppn_brjs_ini + $trh3->jpph21_brjs_ini +
                             $trh4->jpph22_brjs_ini + $trh5->jpph23_brjs_ini + $trh6->jlain_brjs_ini;
                             
            $jmtrmbrjs_sd = $jmtrmbrjs_ll + $jmtrmbrjs_ini;
            
            $jmtrmup_ll =  $trh1->sp2d_up_ll + $trh2->jppn_up_ll + $trh3->jpph21_up_ll +
                             $trh4->jpph22_up_ll + $trh5->jpph23_up_ll + $trh6->jlain_up_ll;
            
            $jmtrmup_ll =  $trh1->sp2d_up_ll + $trh2->jppn_up_ll + $trh3->jpph21_up_ll +
                             $trh4->jpph22_up_ll + $trh5->jpph23_up_ll + $trh6->jlain_up_ll;                             
            
            $jmtrmup_ini =  $trh1->sp2d_up_ini + $trh2->jppn_up_ini + $trh3->jpph21_up_ini +
                             $trh4->jpph22_up_ini + $trh5->jpph23_up_ini + $trh6->jlain_up_ini;
            
            $jmtrmup_sd = $jmtrmup_ll + $jmtrmup_ini;
            
            
            $cRet .="
                       
            <tr>
                <td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;- Lain-lain</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh6->jlain_gaji_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh6->jlain_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh6->jlain_gaji_ll + $trh6->jlain_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh6->jlain_brjs_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh6->jlain_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh6->jlain_brjs_ll + $trh6->jlain_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh6->jlain_up_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh6->jlain_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh6->jlain_up_ll + $trh6->jlain_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totallain)."&nbsp;</td>
            </tr>
            
            <tr>
                <td align=\"left\" style=\"font-size:12px\" colspan=\"2\"><b>Jumlah Penerimaan :</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmgaji_ll)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmgaji_ini)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmgaji_sd)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmbrjs_ll)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmbrjs_ini)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmbrjs_sd)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmup_ll)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmup_ini)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmup_sd)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmgaji_sd + $jmtrmbrjs_sd + $jmtrmup_sd)."&nbsp;</b></td>
            </tr> 
           
           
            
            <tr>
                <td align=\"center\" style=\"font-size:12px;border-right:none;\" colspan=\"2\">&nbsp;</td>
                <td align=\"center\" style=\"font-size:12px;border-right:none;border-left:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-right:none;border-left:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-right:none;border-left:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-right:none;border-left:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-right:none;border-left:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-right:none;border-left:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-right:none;border-left:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-right:none;border-left:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-right:none;border-left:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-left:none;\"></td>
            </tr>
            
            <tr>
                <td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">Pengeluaran :</td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
            </tr>";

           $csql = "SELECT (SELECT SUM(IFNULL(a.nilai,0)) FROM trdtransout a INNER JOIN trhtransout b ON 
                    a.no_bukti = b.no_bukti WHERE b.kd_skpd = '$lcskpd' AND b.jns_spp IN('1','2','3','7')
                    AND MONTH(b.tgl_kas) = '$nbulan') AS spj_up_ini,
                    (SELECT SUM(IFNULL(a.nilai,0)) FROM trdtransout a INNER JOIN trhtransout b ON 
                    a.no_bukti = b.no_bukti WHERE b.kd_skpd = '$lcskpd' AND b.jns_spp IN('1','2','3','7')
                    AND MONTH(b.tgl_kas) < '$nbulan') AS spj_up_ll,
                    (SELECT SUM(b.nilai) FROM trhsp2d a INNER JOIN trdspp b 
                    ON a.no_spp = b.no_spp INNER JOIN trhspp c
                    ON a.no_spp = c.no_spp WHERE a.kd_skpd = '$lcskpd' AND 
                    MONTH(a.tgl_kas)<'$nbulan' AND c.jns_spp IN ('1','2','3','7') AND a.status='1') AS sp2d_up_ll,
                    (SELECT SUM(b.nilai) FROM trhsp2d a INNER JOIN trdspp b 
                    ON a.no_spp = b.no_spp INNER JOIN trhspp c
                    ON a.no_spp = c.no_spp WHERE a.kd_skpd = '$lcskpd' AND 
                    MONTH(a.tgl_kas)='$nbulan' AND c.jns_spp ='4' AND a.status='1') AS spj_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhsp2d a INNER JOIN trdspp b 
                    ON a.no_spp = b.no_spp INNER JOIN trhspp c
                    ON a.no_spp = c.no_spp WHERE a.kd_skpd = '$lcskpd' AND 
                    MONTH(a.tgl_kas)<'$nbulan' AND c.jns_spp ='4'  AND a.status='1') AS spj_gaji_ll,
                    (SELECT SUM(b.nilai) FROM trhsp2d a INNER JOIN trdspp b 
                    ON a.no_spp = b.no_spp INNER JOIN trhspp c
                    ON a.no_spp = c.no_spp WHERE a.kd_skpd = '$lcskpd' AND 
                    MONTH(a.tgl_kas)='$nbulan' AND c.jns_spp ='6'  AND a.status='1') AS spj_brjs_ini,
                    (SELECT SUM(b.nilai) FROM trhsp2d a INNER JOIN trdspp b 
                    ON a.no_spp = b.no_spp INNER JOIN trhspp c
                    ON a.no_spp = c.no_spp WHERE a.kd_skpd = '$lcskpd' AND 
                    MONTH(a.tgl_kas)<'$nbulan' AND c.jns_spp ='6' AND a.status='1') AS spj_brjs_ll,
					(SELECT SUM(b.rupiah) FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
					WHERE a.jns_trans='5' AND a.kd_skpd='$lcskpd' AND MONTH(tgl_sts)='$nbulan' AND left(b.kd_rek5,2)='51'
					) AS kem_gj_ini,
					(SELECT SUM(b.rupiah) FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
					WHERE a.jns_trans='5' AND a.kd_skpd='$lcskpd' AND MONTH(tgl_sts)<'$nbulan' AND left(b.kd_rek5,2)='51'
					) AS kem_gj_ll,
					(SELECT SUM(b.rupiah) FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
					WHERE a.jns_trans='5' AND a.kd_skpd='$lcskpd' AND MONTH(tgl_sts)='$nbulan' AND left(b.kd_rek5,2)='52'
					) AS kem_brg_ini,
					(SELECT SUM(b.rupiah) FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
					WHERE a.jns_trans='5' AND a.kd_skpd='$lcskpd' AND MONTH(tgl_sts)<'$nbulan' AND left(b.kd_rek5,2)='52'
					) AS kem_brg_ll";
					


           
           $hasil = $this->db->query($csql);
           $trh7 = $hasil->row(); 
           $totalspj = $trh7->spj_gaji_ll + $trh7->spj_gaji_ini + $trh7->spj_brjs_ll + 
                       $trh7->spj_brjs_ini + $trh7->spj_up_ll + $trh7->spj_up_ini - $trh7->kem_gj_ini - $trh7->kem_gj_ll - $trh7->kem_brg_ini - $trh7->kem_brg_ll;
                                                            
           $cRet .="
            <tr>
                <td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;- SPJ(LS + UP/GU/TU)</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh7->spj_gaji_ll - $trh7->kem_gj_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh7->spj_gaji_ini - $trh7->kem_gj_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh7->spj_gaji_ini + $trh7->spj_gaji_ll - $trh7->kem_gj_ll - $trh7->kem_gj_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh7->spj_brjs_ll - $trh7->kem_brg_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh7->spj_brjs_ini - $trh7->kem_brg_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh7->spj_brjs_ini + $trh7->spj_brjs_ll - $trh7->kem_brg_ll - $trh7->kem_brg_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh7->spj_up_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh7->spj_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh7->spj_up_ini + $trh7->spj_up_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totalspj)."&nbsp;</td>
            </tr>
            <tr>
                <td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;- Penyetoran Pajak</td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
                <td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
            </tr>";
            
           $lcrek = '2110401'; // ppn setor
           $csql = "SELECT (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jppn_up_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jppn_up_ll,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='4') AS jppn_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='4') AS jppn_gaji_ll,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='6') AS jppn_brjs_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='6') AS jppn_brjs_ll";
            
           $hasil = $this->db->query($csql);
           $trh8 = $hasil->row();
           $totalppn = $trh8->jppn_up_ini + $trh8->jppn_up_ll + $trh8->jppn_gaji_ini + 
                        $trh8->jppn_gaji_ll + $trh8->jppn_brjs_ini + $trh8->jppn_brjs_ll;
            
            $cRet .="
            <tr>
                <td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;a.PPN</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh8->jppn_gaji_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh8->jppn_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh8->jppn_gaji_ll + $trh8->jppn_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh8->jppn_brjs_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh8->jppn_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh8->jppn_brjs_ll + $trh8->jppn_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh8->jppn_up_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh8->jppn_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh8->jppn_up_ll + $trh8->jppn_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totalppn)."&nbsp;</td>
            </tr>";
            
            
            $lcrek = '2110301'; // pph 21 setor
            $csql = "SELECT (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph21_up_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph21_up_ll,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='4') AS jpph21_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='4') AS jpph21_gaji_ll,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='6') AS jpph21_brjs_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='6') AS jpph21_brjs_ll";
            
            $hasil = $this->db->query($csql);
            $trh9 = $hasil->row();
            $totalpph21 = $trh9->jpph21_up_ini + $trh9->jpph21_up_ll + $trh9->jpph21_gaji_ini + 
                          $trh9->jpph21_gaji_ll + $trh9->jpph21_brjs_ini + $trh9->jpph21_brjs_ll;
            
            
            $cRet .="
             <tr>
                <td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;b.PPH 21</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh9->jpph21_gaji_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh9->jpph21_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh9->jpph21_gaji_ll + $trh9->jpph21_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh9->jpph21_brjs_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh9->jpph21_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh9->jpph21_brjs_ll + $trh9->jpph21_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh9->jpph21_up_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh9->jpph21_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh9->jpph21_up_ll + $trh9->jpph21_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totalpph21)."&nbsp;</td>
            </tr>";
            
            $lcrek = '2110302'; // pph 22 setor
            $csql = "SELECT (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph22_up_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph22_up_ll,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='4') AS jpph22_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='4') AS jpph22_gaji_ll,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='6') AS jpph22_brjs_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='6') AS jpph22_brjs_ll";
            
            $hasil = $this->db->query($csql);
            $trh10 = $hasil->row();
            $totalpph22 = $trh10->jpph22_up_ini + $trh10->jpph22_up_ll + $trh10->jpph22_gaji_ini + 
                        $trh10->jpph22_gaji_ll + $trh10->jpph22_brjs_ini + $trh10->jpph22_brjs_ll;
            
            
            $cRet .="
             <tr>
                <td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;c.PPH 22</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh10->jpph22_gaji_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh10->jpph22_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh10->jpph22_gaji_ll + $trh10->jpph22_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh10->jpph22_brjs_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh10->jpph22_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh10->jpph22_brjs_ll + $trh10->jpph22_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh10->jpph22_up_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh10->jpph22_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh10->jpph22_up_ll + $trh10->jpph22_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totalpph22)."&nbsp;</td>
            </tr>";
            
            $lcrek = '2110303'; // pph 23 setor
            $csql = "SELECT (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph23_up_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph23_up_ll,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='4') AS jpph23_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='4') AS jpph23_gaji_ll,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='6') AS jpph23_brjs_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='6') AS jpph23_brjs_ll";
            
            $hasil = $this->db->query($csql);
            $trh11 = $hasil->row();
            $totalpph23 = $trh11->jpph23_up_ini + $trh11->jpph23_up_ll + $trh11->jpph23_gaji_ini + 
                        $trh11->jpph23_gaji_ll + $trh11->jpph23_brjs_ini + $trh11->jpph23_brjs_ll;
            
            
            $cRet .="
             <tr>
                <td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;d.PPH 23</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh11->jpph23_gaji_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh11->jpph23_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh11->jpph23_gaji_ll + $trh11->jpph23_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh11->jpph23_brjs_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh11->jpph23_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh11->jpph23_brjs_ll + $trh11->jpph23_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh11->jpph23_up_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh11->jpph23_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh11->jpph23_up_ll + $trh11->jpph23_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totalpph23)."&nbsp;</td>
            </tr>";
            
            
            // lain lain setoran
            $csql = "SELECT (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 NOT IN ('2110301','2110302','2110303','2110401') AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jlain_up_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 NOT IN ('2110301','2110302','2110303','2110401') AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jlain_up_ll,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 NOT IN ('2110301','2110302','2110303','2110401') AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='4') AS jlain_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 NOT IN ('2110301','2110302','2110303','2110401') AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='4') AS jlain_gaji_ll,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 NOT IN ('2110301','2110302','2110303','2110401') AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='6') AS jlain_brjs_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 NOT IN ('2110301','2110302','2110303','2110401') AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='6') AS jlain_brjs_ll";
            $hasil = $this->db->query($csql);
            $trh12 = $hasil->row();
            $totallain = $trh12->jlain_up_ini + $trh12->jlain_up_ll + $trh12->jlain_gaji_ini + 
                         $trh12->jlain_gaji_ll + $trh12->jlain_brjs_ini + $trh12->jlain_brjs_ll;         
            
            $jmsetgaji_ll =  $trh7->spj_gaji_ll+ $trh8->jppn_gaji_ll + $trh9->jpph21_gaji_ll +
                             $trh10->jpph22_gaji_ll + $trh11->jpph23_gaji_ll + $trh12->jlain_gaji_ll - $trh7->kem_gj_ll;
            
            $jmsetgaji_ini = $trh7->spj_gaji_ini + $trh8->jppn_gaji_ini + $trh9->jpph21_gaji_ini +
                             $trh10->jpph22_gaji_ini + $trh11->jpph23_gaji_ini + $trh12->jlain_gaji_ini - $trh7->kem_gj_ini;
                             
            $jmsetgaji_sd = $jmsetgaji_ll + $jmsetgaji_ini;
            
            
            $jmsetbrjs_ll =  $trh7->spj_brjs_ll + $trh8->jppn_brjs_ll + $trh9->jpph21_brjs_ll +
                             $trh10->jpph22_brjs_ll + $trh11->jpph23_brjs_ll + $trh12->jlain_brjs_ll  - $trh7->kem_brg_ll;
                                                                                                 
            $jmsetbrjs_ini =  $trh7->spj_brjs_ini + $trh8->jppn_brjs_ini + $trh9->jpph21_brjs_ini +
                             $trh10->jpph22_brjs_ini + $trh11->jpph23_brjs_ini + $trh12->jlain_brjs_ini  - $trh7->kem_brg_ini;
                             
            $jmsetbrjs_sd = $jmsetbrjs_ll + $jmsetbrjs_ini;
            
            $jmsetup_ll =  $trh7->spj_up_ll + $trh8->jppn_up_ll + $trh9->jpph21_up_ll +
                             $trh10->jpph22_up_ll + $trh11->jpph23_up_ll + $trh12->jlain_up_ll;
            
            $jmsetup_ll =  $trh7->spj_up_ll + $trh8->jppn_up_ll + $trh9->jpph21_up_ll +
                             $trh10->jpph22_up_ll + $trh11->jpph23_up_ll + $trh12->jlain_up_ll;                             
            
            $jmsetup_ini =  $trh7->spj_up_ini + $trh8->jppn_up_ini + $trh9->jpph21_up_ini +
                             $trh10->jpph22_up_ini + $trh11->jpph23_up_ini + $trh12->jlain_up_ini;
            
            $jmsetup_sd = $jmsetup_ll + $jmsetup_ini;
            
            // pengembalian Kas
            $csql = "SELECT(SELECT SUM(total) FROM trhkasin_pkd WHERE jns_trans='1' AND kd_skpd='$lcskpd' AND MONTH(tgl_kas)<'$nbulan') AS kemuplalu,
                    (SELECT SUM(total) FROM trhkasin_pkd WHERE jns_trans='1' AND kd_skpd='$lcskpd' AND MONTH(tgl_kas)='$nbulan') AS kemupini,
                    (SELECT SUM(total) FROM trhkasin_pkd 
                        WHERE jns_trans='5' AND kd_skpd='$lcskpd' AND MONTH(tgl_kas)<'$nbulan' AND SUBSTR(kd_Kegiatan,20,2)='02') AS kemlsgjlalu,
                    (SELECT SUM(total) FROM trhkasin_pkd 
                        WHERE jns_trans='5' AND kd_skpd='$lcskpd' AND MONTH(tgl_kas)='$nbulan' AND SUBSTR(kd_Kegiatan,20,2)='02') AS kemlsgjini,
                    (SELECT SUM(total) FROM trhkasin_pkd 
                        WHERE jns_trans='5' AND kd_skpd='$lcskpd' AND MONTH(tgl_kas)<'$nbulan' AND SUBSTR(kd_Kegiatan,20,2)<>'02') AS kemlsbrglalu,
                    (SELECT SUM(total) FROM trhkasin_pkd 
                        WHERE jns_trans='5' AND kd_skpd='$lcskpd' AND MONTH(tgl_kas)='$nbulan' AND SUBSTR(kd_Kegiatan,20,2)<>'02') AS kemlsbrgini";
            $setor = $this->db->query($csql);
            $str = $setor->row();
            $totstr = $str->kemuplalu + $str->kemupini + $str->kemlsgjlalu + 
                         $str->kemlsgjini + $str->kemlsbrglalu + $str->kemlsbrgini; 

            $totgj = $str->kemlsgjlalu + $str->kemlsgjini;
            $totbrg = $str->kemlsbrglalu + $str->kemlsbrgini;
            $totup = $str->kemuplalu + $str->kemupini;                                     
            
            $cRet .="
                       
            <tr>
                <td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;- Lain-lain</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh12->jlain_gaji_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh12->jlain_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh12->jlain_gaji_ll + $trh12->jlain_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh12->jlain_brjs_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh12->jlain_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh12->jlain_brjs_ll + $trh12->jlain_brjs_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh12->jlain_up_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh12->jlain_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh12->jlain_up_ll + $trh12->jlain_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totallain)."&nbsp;</td>
            </tr>";

            $cRet .="
            <tr>
                <td align=\"left\" style=\"font-size:12px\" colspan=\"2\"><b>Jumlah Pengeluaran :</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmsetgaji_ll)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmsetgaji_ini)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmsetgaji_sd)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmsetbrjs_ll)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmsetbrjs_ini)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmsetbrjs_sd)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmsetup_ll)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmsetup_ini)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmsetup_sd)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmsetgaji_sd + $jmsetbrjs_sd + $jmsetup_sd)."&nbsp;</td>
            </tr> 
            <tr>
                <td align=\"left\" style=\"font-size:12px\" colspan=\"2\">Pengembalian Kas</td>
                <td align=\"right\" style=\"font-size:12px\">".number_format($str->kemlsgjlalu)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px\">".number_format($str->kemlsgjini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px\">".number_format($totgj)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px\">".number_format($str->kemlsbrglalu)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px\">".number_format($str->kemlsbrgini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px\">".number_format($totbrg)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px\">".number_format($str->kemuplalu)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px\">".number_format($str->kemupini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px\">".number_format($totup)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px\">".number_format($totstr)."&nbsp;</td>
            </tr>
            <tr>
                <td align=\"left\" style=\"font-size:12px\" colspan=\"2\"><b>Saldo Kas</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmgaji_ll - $jmsetgaji_ll - $str->kemlsgjlalu)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmgaji_ini - $jmsetgaji_ini - $str->kemlsgjini)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmgaji_sd - $jmsetgaji_sd - $totgj)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmbrjs_ll - $jmsetbrjs_ll - $str->kemlsbrglalu)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmbrjs_ini - $jmsetbrjs_ini - $str->kemlsbrgini)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmbrjs_sd - $jmsetbrjs_sd - $totbrg)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmup_ll - $jmsetup_ll - $str->kemuplalu)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmup_ini - $jmsetup_ini - $str->kemupini)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmup_sd - $jmsetup_sd - $totup)."&nbsp;</b></td>
                <td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmgaji_sd + $jmtrmbrjs_sd + $jmtrmup_sd - $jmsetgaji_sd - $jmsetbrjs_sd - $jmsetup_sd - $totstr)."&nbsp;</b></td>
            </tr>
            <tr>
                <td align=\"center\" style=\"font-size:12px\" colspan=\"12\">&nbsp;</td>
            </tr>";
		$cRet .= " </table>";
        $zz=0;
            for($zz=0;$zz <=$spasi;$zz++){
                $cRet .="<br>";
            }
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">
                    <tr>
                        <td align=\"center\" width=\"25%\"></td>                    
                        <td align=\"center\" width=\"25%\"></td>
                        <td align=\"center\" width=\"25%\">&nbsp;</td>
                    </tr>
                    <tr>
                        <td align=\"center\" width=\"25%\">Mengetahui ,</td>                    
                        <td align=\"center\" width=\"25%\"></td>
                        <td align=\"center\" width=\"25%\">$daerah ,".$this->tukd_model->tanggal_format_indonesia($tglttd)."</td>
                    </tr>
                    <tr>
                        <td align=\"center\" width=\"25%\">$jabatan</td>                    
                        <td align=\"center\" width=\"25%\"></td>
                        <td align=\"center\" width=\"25%\">$jabatan1</td>
                    </tr>
                    <tr>
                        <td align=\"center\" width=\"25%\">&nbsp;</td>                    
                        <td align=\"center\" width=\"25%\">&nbsp;</td>
                        <td align=\"center\" width=\"25%\">&nbsp;</td>
                    </tr>
                     <tr>
                        <td align=\"center\" width=\"25%\">&nbsp;</td>                    
                        <td align=\"center\" width=\"25%\">&nbsp;</td>
                        <td align=\"center\" width=\"25%\">&nbsp;</td>
                    </tr>
                    <tr><td align=\"center\" width=\"25%\">$nama</td>                    
                        <td align=\"center\" width=\"25%\">&nbsp;</td>
                        <td align=\"center\" width=\"25%\">$nama1</td>
                    </tr>                              
                    <tr>";
                    if(strlen($nip) <=11){
                        $cRet.="<td align=\"center\" width=\"25%\">NRP. $nip</td>";
                    }else{
                        $cRet.="<td align=\"center\" width=\"25%\">NIP. $nip</td>";
                    }                    
                    $cRet.="    <td align=\"center\" width=\"25%\">&nbsp;</td>
                        <td align=\"center\" width=\"25%\">NIP. $nip1</td>
                    </tr>                              
                  </table>";
$data['prev']= $cRet;
	  $cetak = $this->uri->segment(3);
        switch($cetak) {        
        case 1;
             $this->_mpdf1('',$cRet,'5','5',5,'1');  
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= bku.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        }	
		}else{
		//skpd
		 $sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                 {
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                 }
        $sqlttd1 = "SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$lcskpd' and kode='PA'";
                 $sqlttd=$this->db->query($sqlttd1);
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip=$rowttd->nip;                    
                    $nama= $rowttd->nm;
                    $jabatan  = $rowttd->jab;
                }
        $sqlttd1 = "SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$lcskpd' and kode='BK'";
                 $sqlttd=$this->db->query($sqlttd1);
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip1=$rowttd->nip;                    
                    $nama1= $rowttd->nm;
                    $jabatan1  = $rowttd->jab;
                }
				
        $skpd 	= $lcskpd;
        $nm_skpd= $this->tukd_model->get_nama($lcskpd,'nm_skpd','ms_skpd','kd_skpd');
        $bulan	= $this->tukd_model->getBulan($nbulan); 
        $cRet 	= '';
        $cRet 	= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"1\" cellpadding=\"1\">";
        $cRet .="
				<tr>
					<td align=\"center\" style=\"font-size:14px;\" colspan=\"2\"><b>
					 PEMERINTAH KABUPATEN BIAK NUMFOR<br>
					  SURAT PENGESAHAN PERTANGGUNGJAWABAN BENDAHARA PPKD<br>
					  (SPJ BELANJA)<br>&nbsp;</b>
					</td>
				</tr>
				<tr>
					<td align=\"left\" style=\"font-size:12px;\" width=\"25%\">
					  SKPD
					</td> 
					<td width=\"75%\" style=\"font-size:12px;\">: $skpd - $nm_skpd
					</td>         
				</tr>
				<tr>
					<td align=\"left\" style=\"font-size:12px;\">
					  Pengguna Anggaran/Kuasa Pengguna Anggaran
					</td> 
					<td style=\"font-size:12px;\">: $nama
					</td>         
				</tr>
				<tr>
					<td align=\"left\" style=\"font-size:12px;\">
					  Bendahara Pengeluaran
					</td> 
					<td style=\"font-size:12px;\">: $nama1
					</td>         
				</tr>
				<tr>
					<td align=\"left\" style=\"font-size:12px;\">
					  Tahun Anggaran
					</td> 
					<td style=\"font-size:12px;\">: $thn_ang
					</td>         
				</tr>
				<tr>
					<td align=\"left\" style=\"font-size:12px;\">
					  Bulan
					</td> 
					<td style=\"font-size:12px;\">: $bulan
					</td>         
				</tr>
				<tr>
					<td align=\"left\" style=\"font-size:12px;\" colspan=\"2\">&nbsp;
					 
					</td> 
				</tr>
				</table>";
		$cRet .="<table style=\"border-collapse:collapse; font-size:14;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"4\">
					<thead>
						<tr>
							 <td rowspan=\"2\" width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>KODE REKENING<b></td>
							 <td rowspan=\"2\" width=\"30%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>URAIAN</b></td>
							 <td rowspan=\"2\" width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>JUMLAH ANGGARAN<b></td>
							 <td colspan=\"3\" width=\"30%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>SPJ LS-PPKD<b></td>
							 <td colspan=\"3\" width=\"30%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>SPJ UP/GU/TU<b></td>
							 <td rowspan=\"2\" width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>JUMLAH SPJ <br>(LS+UP/GU/TU)<br>s.d bln ini<b></td>
							 <td rowspan=\"2\" width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>SISA<br>ANGGARAN<b></td>
						</tr>
						<tr>
							 <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>s.d Bln lalu<b></td>
							 <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Bulan ini</b></td>
							 <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>s.d Bln ini<b></td>
							 <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>s.d Bln lalu<b></td>
							 <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Bulan ini</b></td>
							 <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>s.d Bln ini<b></td>
						</tr>
						<tr>
						 <td width=\"10%\" align=\"center\">1</td>
						 <td width=\"30%\" align=\"center\">2</td>
						 <td width=\"10%\" align=\"center\">3</td>
						 <td width=\"10%\" align=\"center\">4</td>
						 <td width=\"10%\" align=\"center\">5</td>
						 <td width=\"10%\" align=\"center\">6</td>
						 <td width=\"10%\" align=\"center\">7</td>
						 <td width=\"10%\" align=\"center\">8</td>
						 <td width=\"10%\" align=\"center\">9</td>
						 <td width=\"10%\" align=\"center\">10 =6+9</td>
						 <td width=\"10%\" align=\"center\">11</td>
					</tr>
					</thead>
					<tfoot>
						<tr>
							 <td colspan=\"11\" style=\"border-bottom:none;border-left:none;border-right:none;\"></td>
						</tr>
					</tfoot>
					<tr>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"></td>
						 <td width=\"30%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
					</tr>
					";
					
		$sqlww=$this->db->query("SELECT a.kd_skpd AS skpd,a.nm_skpd AS nmskpd,a.kd_program AS program,a.nm_program AS nmprogram,SUM(b.nilai_ubah) AS nilai 
									FROM trskpd a 
									JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan
									WHERE LEFT(b.kd_rek5,2) IN ('51','52') AND a.kd_skpd='$lcskpd' GROUP BY a.kd_program");
								
		$grand1=0;$grand2=0;$grand3=0;$grand4=0;$grand8=0;$grand9=0;$grand9=0;$grand10=0;$tot=0;$sis=0;
		foreach($sqlww->result() as $roww){
			$kdskpd=$roww->skpd;
			$progw=$roww->program;
			$nmprogw=$roww->nmprogram;
			$nilaiw=$roww->nilai;	
			$sql11=mysql_query("SELECT SUM(a.nilai) AS nilai2 FROM trdspp a
								INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='5' AND b.kd_skpd='$kdskpd'
								AND MONTH(b.tgl_kas)<'$nbulan' AND LEFT(a.kd_kegiatan,18)='$progw'");							   
			$hasil11=mysql_fetch_assoc($sql11);
			$sql1=mysql_query("SELECT SUM(a.nilai) AS nilai2 FROM trdspp a
								INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='5' AND b.kd_skpd='$kdskpd'
								AND MONTH(b.tgl_kas)='$nbulan' AND LEFT(a.kd_kegiatan,18)='$progw'");
			$hasil1=mysql_fetch_assoc($sql1);
			$sql111=mysql_query("SELECT SUM(a.nilai) AS nilai2 FROM trdspp a
								INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='5' AND b.kd_skpd='$kdskpd'
								AND MONTH(b.tgl_kas)<='$nbulan' AND LEFT(a.kd_kegiatan,18)='$progw'");
			$hasil111=mysql_fetch_assoc($sql111);
			
			//==================================================================
			$sql33=mysql_query("SELECT SUM(nilai)AS nilai7 FROM trhtransout a 
							   INNER JOIN trdtransout b ON a.no_bukti=b.no_bukti WHERE a.jns_spp in ('1','2','3','7') AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_kas)<'$nbulan' and left(b.kd_kegiatan,18)='$progw'");
			$hasil33=mysql_fetch_assoc($sql33);
			$sql3=mysql_query("SELECT SUM(nilai)AS nilai7 FROM trhtransout a 
							   INNER JOIN trdtransout b ON a.no_bukti=b.no_bukti WHERE a.jns_spp in ('1','2','3','7') AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_kas)='$nbulan' and left(b.kd_kegiatan,18)='$progw'");
			$hasil3=mysql_fetch_assoc($sql3);
			$sql333=mysql_query("SELECT SUM(nilai)AS nilai7 FROM trhtransout a 
							   INNER JOIN trdtransout b ON a.no_bukti=b.no_bukti WHERE a.jns_spp in ('1','2','3','7') AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_kas)<='$nbulan' and left(b.kd_kegiatan,18)='$progw'");
			$hasil333=mysql_fetch_assoc($sql333);
			//====================================kembali ls ================================
			$sqlk1=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
									WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_sts)<'$nbulan' AND LEFT(b.kd_rek5,2)='51'
									and left(a.kd_kegiatan,18)='$progw'");
			$hasilk1a=mysql_fetch_assoc($sqlk1);
			$sqlk2=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
									WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_sts)='$nbulan' AND LEFT(b.kd_rek5,2)='51'
									and left(a.kd_kegiatan,18)='$progw'");
			$hasilk2a=mysql_fetch_assoc($sqlk2);
			$sqlk3=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
									WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)='51'
									and left(a.kd_kegiatan,18)='$progw'");
			$hasilk3a=mysql_fetch_assoc($sqlk3);		

			$cRet    .="<tr>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"><b>$progw</b></td>
						 <td width=\"30%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"><b>$nmprogw</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($nilaiw)."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil11['nilai2']-$hasilk1a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil1['nilai2']-$hasilk2a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil111['nilai2']-$hasilk3a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil33['nilai7'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil3['nilai7'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil333['nilai7'])."</b></td>
						  <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil111['nilai2']+$hasil333['nilai7']-$hasilk3a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($nilaiw-$hasil111['nilai2']-$hasil333['nilai7']+$hasilk3a['nilk'])."</b></td>
					</tr>";
					
		$sql=$this->db->query("SELECT a.kd_skpd AS skpd,a.nm_skpd AS nmskpd,a.kd_kegiatan AS program,a.nm_kegiatan AS nmprogram,SUM(b.nilai_ubah) AS nilai 
								FROM trskpd a 
								JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
								WHERE LEFT(b.kd_rek5,2) IN ('51','52') AND a.kd_skpd='$lcskpd' and a.kd_program='$progw' GROUP BY a.kd_kegiatan");

		foreach($sql->result() as $row){
			$kdskpd=$row->skpd;
			$prog=$row->program;
			$nmprog=$row->nmprogram;
			$nilai=$row->nilai;

			$sql11=mysql_query("SELECT SUM(a.nilai) AS nilai2 FROM trdspp a
								INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='5' AND b.kd_skpd='$kdskpd'
								AND MONTH(b.tgl_kas)<'$nbulan' AND a.kd_kegiatan='$prog'");							   
			$hasil11=mysql_fetch_assoc($sql11);
			$sql1=mysql_query("SELECT SUM(a.nilai) AS nilai2 FROM trdspp a
								INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='5' AND b.kd_skpd='$kdskpd'
								AND MONTH(b.tgl_kas)='$nbulan' AND a.kd_kegiatan='$prog'");
			$hasil1=mysql_fetch_assoc($sql1);
			$sql111=mysql_query("SELECT SUM(a.nilai) AS nilai2 FROM trdspp a
								INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='5' AND b.kd_skpd='$kdskpd'
								AND MONTH(b.tgl_kas)<='$nbulan' AND a.kd_kegiatan='$prog'");
			$hasil111=mysql_fetch_assoc($sql111);
			//==================================================================
			$sql33=mysql_query("SELECT SUM(nilai)AS nilai7 FROM trhtransout a 
							   INNER JOIN trdtransout b ON a.no_bukti=b.no_bukti WHERE a.jns_spp in ('1','2','3','7') AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_kas)<'$nbulan' and b.kd_kegiatan='$prog'");
			$hasil33=mysql_fetch_assoc($sql33);
			$sql3=mysql_query("SELECT SUM(nilai)AS nilai7 FROM trhtransout a 
							   INNER JOIN trdtransout b ON a.no_bukti=b.no_bukti WHERE a.jns_spp in ('1','2','3','7') AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_kas)='$nbulan' and b.kd_kegiatan='$prog'");
			$hasil3=mysql_fetch_assoc($sql3);
			$sql333=mysql_query("SELECT SUM(nilai)AS nilai7 FROM trhtransout a 
							   INNER JOIN trdtransout b ON a.no_bukti=b.no_bukti WHERE a.jns_spp in ('1','2','3','7') AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_kas)<='$nbulan' and b.kd_kegiatan='$prog'");
			$hasil333=mysql_fetch_assoc($sql333);
			//==================================kembali ls==================================
			$sqlk1=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
									WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_sts)<'$nbulan' AND LEFT(b.kd_rek5,2)='51'
									and a.kd_kegiatan='$prog'");
			$hasilk1a=mysql_fetch_assoc($sqlk1);
			$sqlk2=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
									WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_sts)='$nbulan' AND LEFT(b.kd_rek5,2)='51'
									and a.kd_kegiatan='$prog'");
			$hasilk2a=mysql_fetch_assoc($sqlk2);
			$sqlk3=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
									WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)='51'
									and a.kd_kegiatan='$prog'");
			$hasilk3a=mysql_fetch_assoc($sqlk3);		
			
			$grand1=$grand1+$nilai;
			$cRet    .="<tr>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"><b>$prog</b></td>
						 <td width=\"30%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"><b>$nmprog</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($nilai)."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil11['nilai2']-$hasilk1a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil1['nilai2']-$hasilk2a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil111['nilai2']-$hasilk3a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil33['nilai7'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil3['nilai7'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil333['nilai7'])."</b></td>
						  <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($hasil111['nilai2']+$hasil333['nilai7']-$hasilk3a['nilk'])."</b></td>
						 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>".number_format($nilai-$hasil111['nilai2']-$hasil333['nilai7']+$hasilk3a['nilk'])."</b></td>
					</tr>";		
			$sqlZ=$this->db->query("SELECT a.kd_skpd AS skpd,a.nm_skpd AS nmskpd,b.no_trdrka AS program,b.nm_rek5 AS nmprogram,SUM(b.nilai_ubah) AS nilai FROM trskpd a 
									JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan
									WHERE LEFT(b.kd_rek5,2) IN ('51','52') AND a.kd_skpd='$kdskpd' AND b.kd_kegiatan ='$prog' GROUP BY b.no_trdrka
									ORDER BY program");
				foreach($sqlZ->result() as $row2){
				$progy=$row2->program;
				$nmprogy=$row2->nmprogram;
				$nilaiy =$row2->nilai;
				
				$sqlxx=mysql_query("SELECT SUM(a.nilai) AS nilai2 FROM trdspp a
									INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='5' AND b.kd_skpd='$kdskpd'
									AND MONTH(b.tgl_kas)<'$nbulan' AND a.kd_kegiatan='$prog' AND a.kd_rek5=RIGHT('$progy',7)");							   
				$hasilxx=mysql_fetch_assoc($sqlxx);
				$sqlx=mysql_query("SELECT SUM(a.nilai) AS nilai2 FROM trdspp a
									INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='5' AND b.kd_skpd='$kdskpd'
									AND MONTH(b.tgl_kas)='$nbulan' AND a.kd_kegiatan='$prog' AND a.kd_rek5=RIGHT('$progy',7)");
				$hasilx=mysql_fetch_assoc($sqlx);
				$sqlxxx=mysql_query("SELECT SUM(a.nilai) AS nilai2 FROM trdspp a
									INNER JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.no_kas<>'' AND b.jns_spp='5' AND b.kd_skpd='$kdskpd'
									AND MONTH(b.tgl_kas)<='$nbulan' AND a.kd_kegiatan='$prog' AND a.kd_rek5=RIGHT('$progy',7)");
				$hasilxxx=mysql_fetch_assoc($sqlxxx);
				//=============================================================
				$sqlzz=mysql_query("SELECT SUM(nilai)AS nilai7 FROM trhtransout a 
				   INNER JOIN trdtransout b ON a.no_bukti=b.no_bukti WHERE a.jns_spp in ('1','2','3','7') AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_kas)<'$nbulan' and b.kd_kegiatan='$prog' and b.kd_rek5=right('$progy',7)");
				$hasilzz=mysql_fetch_assoc($sqlzz);
				$sqlz=mysql_query("SELECT SUM(nilai)AS nilai7 FROM trhtransout a 
								   INNER JOIN trdtransout b ON a.no_bukti=b.no_bukti WHERE a.jns_spp in ('1','2','3','7') AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_kas)='$nbulan' and b.kd_kegiatan='$prog' and b.kd_rek5=right('$progy',7)");
				$hasilz=mysql_fetch_assoc($sqlz);
				$sqlzzz=mysql_query("SELECT SUM(nilai)AS nilai7 FROM trhtransout a 
				   INNER JOIN trdtransout b ON a.no_bukti=b.no_bukti WHERE a.jns_spp in ('1','2','3','7') AND a.kd_skpd='$kdskpd' AND MONTH(a.tgl_kas)<='$nbulan' and b.kd_kegiatan='$prog' and b.kd_rek5=right('$progy',7)");
				$hasilzzz=mysql_fetch_assoc($sqlzzz);
				//============================kembali ls========================================
				$sqlk1=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
										WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(tgl_sts)<'$nbulan' AND LEFT(b.kd_rek5,2)='51'
										and a.kd_kegiatan='$prog' and b.kd_rek5=right('$progy',7)");
				$hasilk1a=mysql_fetch_assoc($sqlk1);
				$sqlk2=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
										WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(tgl_sts)='$nbulan' AND LEFT(b.kd_rek5,2)='51'
										and a.kd_kegiatan='$prog' and b.kd_rek5=right('$progy',7)");
				$hasilk2a=mysql_fetch_assoc($sqlk2);
				$sqlk3=mysql_query("SELECT IFNULL(SUM(b.rupiah),0) AS nilk FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
										WHERE a.jns_trans='5' AND a.kd_skpd='$kdskpd' AND MONTH(tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)='51'
										and a.kd_kegiatan='$prog' and b.kd_rek5=right('$progy',7)");
				$hasilk3a=mysql_fetch_assoc($sqlk3);
				
					$cRet    .="<tr>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$progy</td>
									 <td width=\"30%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$nmprogy</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">".number_format($nilaiy)."</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">".number_format($hasilxx['nilai2']-$hasilk1a['nilk'])."</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">".number_format($hasilx['nilai2']-$hasilk2a['nilk'])."</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">".number_format($hasilxxx['nilai2']-$hasilk3a['nilk'])."</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">".number_format($hasilzz['nilai7'])."</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">".number_format($hasilz['nilai7'])."</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">".number_format($hasilzzz['nilai7'])."</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">".number_format($hasilxxx['nilai2']+$hasilzzz['nilai7']-$hasilk3a['nilk'])."</td>
									 <td width=\"10%\" style=\"border-bottom:none;border-top:none\" align=\"right\">".number_format($nilaiy-$hasilxxx['nilai2']-$hasilzzz['nilai7']+$hasilk3a['nilk'])."</td>
								</tr>";	
					$grand2	= $grand2+$hasilxx['nilai2']-$hasilk1a['nilk'];
					$grand3	= $grand3+$hasilx['nilai2']-$hasilk2a['nilk'];
					$grand4	= $grand4+$hasilxxx['nilai2']-$hasilk3a['nilk'];
					$grand8	= $grand8+$hasilzz['nilai7'];
					$grand9	= $grand9+$hasilz['nilai7'];
					$grand10= $grand10+$hasilzzz['nilai7'];
			}	
		}
		}
		
		$tot = $grand4+$grand10;
		$sis = $grand1-$tot;
	   $cRet .= " <tr>
					<td align=\"center\" colspan=\"2\" width=\"40%\"><b>Jumlah</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($grand1)."</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($grand2)."</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($grand3)."</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($grand4)."</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($grand8)."</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($grand9)."</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($grand10)."</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($tot)."</b></td>
					<td align=\"right\" width=\"10%\"><b>".number_format($sis)."</b></td>
				 </tr>
				 <tr>
					<td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:none;\" rowspan=\"22\">&ensp;</td>
					<td align=\"left\" style=\"font-size:12px;border-bottom:none;\" colspan=\"2\">Penerimaan :</td>
					<td align=\"center\" style=\"font-size:12px;border-bottom:none;\"></td>
					<td align=\"center\" style=\"font-size:12px;border-bottom:none;\"></td>
					<td align=\"center\" style=\"font-size:12px;border-bottom:none;\"></td>
					<td align=\"center\" style=\"font-size:12px;border-bottom:none;\"></td>
					<td align=\"center\" style=\"font-size:12px;border-bottom:none;\"></td>
					<td align=\"center\" style=\"font-size:12px;border-bottom:none;\"></td>
					<td align=\"center\" style=\"font-size:12px;border-bottom:none;\"></td>
					<td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:none;\" rowspan=\"22\">&nbsp;</td>
				 </tr>";
            
            $csql = "SELECT (SELECT SUM(b.nilai) FROM trhsp2d a INNER JOIN trdspp b 
                    ON a.no_spp = b.no_spp INNER JOIN trhspp c
                    ON a.no_spp = c.no_spp WHERE a.kd_skpd = '$lcskpd' AND 
                    MONTH(a.tgl_kas)='$nbulan' AND c.jns_spp IN ('1','2','3','7') AND a.status='1') AS sp2d_up_ini,
                    (SELECT SUM(b.nilai) FROM trhsp2d a INNER JOIN trdspp b 
                    ON a.no_spp = b.no_spp INNER JOIN trhspp c
                    ON a.no_spp = c.no_spp WHERE a.kd_skpd = '$lcskpd' AND 
                    MONTH(a.tgl_kas)<'$nbulan' AND c.jns_spp IN ('1','2','3','7') AND a.status='1') AS sp2d_up_ll,
                    (SELECT SUM(b.nilai) FROM trhsp2d a INNER JOIN trdspp b 
                    ON a.no_spp = b.no_spp INNER JOIN trhspp c
                    ON a.no_spp = c.no_spp WHERE a.kd_skpd = '$lcskpd' AND 
                    MONTH(a.tgl_kas)='$nbulan' AND c.jns_spp ='5' AND a.status='1') AS sp2d_gj_ini,
                    (SELECT SUM(b.nilai) FROM trhsp2d a INNER JOIN trdspp b 
                    ON a.no_spp = b.no_spp INNER JOIN trhspp c
                    ON a.no_spp = c.no_spp WHERE a.kd_skpd = '$lcskpd' AND 
                    MONTH(a.tgl_kas)<'$nbulan' AND c.jns_spp ='5'  AND a.status='1') AS sp2d_gj_ll";
            
            $hasil = $this->db->query($csql);
            $trh1  = $hasil->row(); 
            $totalsp2d = $trh1->sp2d_gj_ll+$trh1->sp2d_gj_ini+$trh1->sp2d_up_ll+$trh1->sp2d_up_ini;
            $cobacoba  = $trh1->sp2d_gj_ll;

            $cRet .="   
					<tr>
						<td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;- SP2D</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh1->sp2d_gj_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh1->sp2d_gj_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh1->sp2d_gj_ll + $trh1->sp2d_gj_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh1->sp2d_up_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh1->sp2d_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh1->sp2d_up_ll + $trh1->sp2d_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totalsp2d)."&nbsp;</td>
					</tr>            
					<tr>
						<td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;- Potongan Pajak</td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
					</tr>";
            
            $lcrek = '2110401'; // ppn terima
            $csql = "SELECT (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jppn_up_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jppn_up_ll,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='5') AS jppn_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='5') AS jppn_gaji_ll";
            
            $hasil = $this->db->query($csql);
            $trh2  = $hasil->row();
            $totalppn = $trh2->jppn_up_ini + $trh2->jppn_up_ll + $trh2->jppn_gaji_ini + $trh2->jppn_gaji_ll;

            $cRet .=" 
					<tr>
						<td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;a.PPN</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh2->jppn_gaji_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh2->jppn_gaji_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh2->jppn_gaji_ll + $trh2->jppn_gaji_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh2->jppn_up_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh2->jppn_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh2->jppn_up_ll + $trh2->jppn_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totalppn)."&nbsp;</td>
					</tr>";
            
            $lcrek = '2110301'; // pph 21 terima
            $csql = "SELECT (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph21_up_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph21_up_ll,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='5') AS jpph21_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='5') AS jpph21_gaji_ll";
            
            $hasil = $this->db->query($csql);
            $trh3 = $hasil->row();
            $totalpph21 = $trh3->jpph21_up_ini + $trh3->jpph21_up_ll + $trh3->jpph21_gaji_ini + $trh3->jpph21_gaji_ll;

            $cRet .="
             <tr>
                <td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;b.PPH 21</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh3->jpph21_gaji_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh3->jpph21_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh3->jpph21_gaji_ll + $trh3->jpph21_gaji_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh3->jpph21_up_ll)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh3->jpph21_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh3->jpph21_up_ll + $trh3->jpph21_up_ini)."&nbsp;</td>
                <td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totalpph21)."&nbsp;</td>
            </tr>";
            
            $lcrek = '2110302'; // pph 22 terima
            $csql = "SELECT (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph22_up_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph22_up_ll,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='5') AS jpph22_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='5') AS jpph22_gaji_ll";
            
            $hasil = $this->db->query($csql);
            $trh4 = $hasil->row();
            $totalpph22 = $trh4->jpph22_up_ini + $trh4->jpph22_up_ll + $trh4->jpph22_gaji_ini + $trh4->jpph22_gaji_ll;

            $cRet .="
					 <tr>
						<td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;c.PPH 22</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh4->jpph22_gaji_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh4->jpph22_gaji_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh4->jpph22_gaji_ll + $trh4->jpph22_gaji_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh4->jpph22_up_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh4->jpph22_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh4->jpph22_up_ll + $trh4->jpph22_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totalpph22)."&nbsp;</td>
					</tr>";
            
            $lcrek = '2110303'; // pph 23 terima
            $csql = "SELECT (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph23_up_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph23_up_ll,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='5') AS jpph23_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='5') AS jpph23_gaji_ll";
            
            $hasil = $this->db->query($csql);
            $trh5 = $hasil->row();
            $totalpph23 = $trh5->jpph23_up_ini + $trh5->jpph23_up_ll + $trh5->jpph23_gaji_ini + $trh5->jpph23_gaji_ll;

            $cRet .="
					 <tr>
						<td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;d.PPH 23</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh5->jpph23_gaji_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh5->jpph23_gaji_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh5->jpph23_gaji_ll + $trh5->jpph23_gaji_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh5->jpph23_up_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh5->jpph23_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh5->jpph23_up_ll + $trh5->jpph23_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totalpph23)."&nbsp;</td>
					</tr>";
            
            // lain terima
            $csql = "SELECT (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 NOT IN ('2110301','2110302','2110303','2110401') AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jlain_up_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 NOT IN ('2110301','2110302','2110303','2110401') AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jlain_up_ll,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 NOT IN ('2110301','2110302','2110303','2110401') AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='5') AS jlain_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhtrmpot a INNER JOIN trdtrmpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 NOT IN ('2110301','2110302','2110303','2110401') AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='5') AS jlain_gaji_ll";
            
			$hasil = $this->db->query($csql);
            $trh6 = $hasil->row();
            $totallain = $trh6->jlain_up_ini + $trh6->jlain_up_ll + $trh6->jlain_gaji_ini + $trh6->jlain_gaji_ll;

            $jmtrmgaji_ll  = $trh1->sp2d_gj_ll+ $trh2->jppn_gaji_ll + $trh3->jpph21_gaji_ll +
                             $trh4->jpph22_gaji_ll + $trh5->jpph23_gaji_ll + $trh6->jlain_gaji_ll;
            $jmtrmgaji_ini = $trh1->sp2d_gj_ini + $trh2->jppn_gaji_ini + $trh3->jpph21_gaji_ini +
                             $trh4->jpph22_gaji_ini + $trh5->jpph23_gaji_ini + $trh6->jlain_gaji_ini;
            $jmtrmgaji_sd  = $jmtrmgaji_ll + $jmtrmgaji_ini;
            
            $jmtrmup_ll =  $trh1->sp2d_up_ll + $trh2->jppn_up_ll + $trh3->jpph21_up_ll +
                             $trh4->jpph22_up_ll + $trh5->jpph23_up_ll + $trh6->jlain_up_ll;
            $jmtrmup_ll =  $trh1->sp2d_up_ll + $trh2->jppn_up_ll + $trh3->jpph21_up_ll +
                             $trh4->jpph22_up_ll + $trh5->jpph23_up_ll + $trh6->jlain_up_ll;                             
            $jmtrmup_ini =  $trh1->sp2d_up_ini + $trh2->jppn_up_ini + $trh3->jpph21_up_ini +
                             $trh4->jpph22_up_ini + $trh5->jpph23_up_ini + $trh6->jlain_up_ini;
            $jmtrmup_sd = $jmtrmup_ll + $jmtrmup_ini;
            
            $cRet .=" 
					<tr>
						<td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;- Lain-lain</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh6->jlain_gaji_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh6->jlain_gaji_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh6->jlain_gaji_ll + $trh6->jlain_gaji_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh6->jlain_up_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh6->jlain_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh6->jlain_up_ll + $trh6->jlain_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totallain)."&nbsp;</td>
					</tr>
					<tr>
						<td align=\"left\" style=\"font-size:12px\" colspan=\"2\"><b>Jumlah Penerimaan :</b></td>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmgaji_ll)."&nbsp;</b></td>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmgaji_ini)."&nbsp;</b></td>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmgaji_sd)."&nbsp;</b></td>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmup_ll)."&nbsp;</b></td>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmup_ini)."&nbsp;</b></td>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmup_sd)."&nbsp;</b></td>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmgaji_sd + $jmtrmup_sd)."&nbsp;</b></td>
					</tr> 
					<tr>
						<td align=\"center\" style=\"font-size:12px;border-right:none;\" colspan=\"2\">&nbsp;</td>
						<td align=\"center\" style=\"font-size:12px;border-right:none;border-left:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-right:none;border-left:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-right:none;border-left:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-right:none;border-left:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-right:none;border-left:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-right:none;border-left:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-left:none;\"></td>
					</tr>
					<tr>
						<td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">Pengeluaran :</td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
					</tr>";

           $csql = "SELECT (SELECT SUM(IFNULL(a.nilai,0)) FROM trdtransout a INNER JOIN trhtransout b ON 
                    a.no_bukti = b.no_bukti WHERE b.kd_skpd = '$lcskpd' AND b.jns_spp IN('1','2','3','7')
                    AND MONTH(b.tgl_kas) = '$nbulan') AS spj_up_ini,
                    (SELECT SUM(IFNULL(a.nilai,0)) FROM trdtransout a INNER JOIN trhtransout b ON 
                    a.no_bukti = b.no_bukti WHERE b.kd_skpd = '$lcskpd' AND b.jns_spp IN('1','2','3','7') AND MONTH(b.tgl_kas) < '$nbulan') AS spj_up_ll,
                    (SELECT SUM(b.nilai) FROM trhsp2d a INNER JOIN trdspp b 
                    ON a.no_spp = b.no_spp INNER JOIN trhspp c
                    ON a.no_spp = c.no_spp WHERE a.kd_skpd = '$lcskpd' AND MONTH(a.tgl_kas)<'$nbulan' AND c.jns_spp IN ('1','2','3','7') AND a.status='1') AS sp2d_up_ll,
                    (SELECT SUM(b.nilai) FROM trhsp2d a INNER JOIN trdspp b 
                    ON a.no_spp = b.no_spp INNER JOIN trhspp c
                    ON a.no_spp = c.no_spp WHERE a.kd_skpd = '$lcskpd' AND MONTH(a.tgl_kas)='$nbulan' AND c.jns_spp ='5' AND a.status='1') AS spj_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhsp2d a INNER JOIN trdspp b 
                    ON a.no_spp = b.no_spp INNER JOIN trhspp c
                    ON a.no_spp = c.no_spp WHERE a.kd_skpd = '$lcskpd' AND MONTH(a.tgl_kas)<'$nbulan' AND c.jns_spp ='5'  AND a.status='1') AS spj_gaji_ll,
					(SELECT SUM(b.rupiah) FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
					WHERE a.jns_trans='5' AND a.kd_skpd='$lcskpd' AND MONTH(tgl_sts)='$nbulan' AND left(b.kd_rek5,2)='51') AS kem_gj_ini,
					(SELECT SUM(b.rupiah) FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
					WHERE a.jns_trans='5' AND a.kd_skpd='$lcskpd' AND MONTH(tgl_sts)<'$nbulan' AND left(b.kd_rek5,2)='51') AS kem_gj_ll";

           $hasil = $this->db->query($csql);
           $trh7 = $hasil->row(); 
           $totalspj = $trh7->spj_gaji_ll + $trh7->spj_gaji_ini + $trh7->spj_up_ll + $trh7->spj_up_ini - $trh7->kem_gj_ini - $trh7->kem_gj_ll;
                                                            
           $cRet .="
					<tr>
						<td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;- SPJ(LS + UP/GU/TU)</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh7->spj_gaji_ll - $trh7->kem_gj_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh7->spj_gaji_ini - $trh7->kem_gj_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh7->spj_gaji_ini + $trh7->spj_gaji_ll - $trh7->kem_gj_ll - $trh7->kem_gj_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh7->spj_up_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh7->spj_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh7->spj_up_ini + $trh7->spj_up_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totalspj)."&nbsp;</td>
					</tr>
					<tr>
						<td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;- Penyetoran Pajak</td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
						<td align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none;\"></td>
					</tr>";
            
           $lcrek = '2110401'; // ppn setor
           $csql = "SELECT (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jppn_up_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jppn_up_ll,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='5') AS jppn_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='5') AS jppn_gaji_ll";
            
           $hasil = $this->db->query($csql);
           $trh8 = $hasil->row();
           $totalppn = $trh8->jppn_up_ini + $trh8->jppn_up_ll + $trh8->jppn_gaji_ini + $trh8->jppn_gaji_ll;
            
            $cRet .="
					<tr>
						<td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;a.PPN</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh8->jppn_gaji_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh8->jppn_gaji_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh8->jppn_gaji_ll + $trh8->jppn_gaji_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh8->jppn_up_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh8->jppn_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh8->jppn_up_ll + $trh8->jppn_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totalppn)."&nbsp;</td>
					</tr>";

            $lcrek = '2110301'; // pph 21 setor
            $csql = "SELECT (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph21_up_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph21_up_ll,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='5') AS jpph21_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='5') AS jpph21_gaji_ll";
            
            $hasil = $this->db->query($csql);
            $trh9 = $hasil->row();
            $totalpph21 = $trh9->jpph21_up_ini + $trh9->jpph21_up_ll + $trh9->jpph21_gaji_ini + $trh9->jpph21_gaji_ll;

            $cRet .="
					 <tr>
						<td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;b.PPH 21</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh9->jpph21_gaji_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh9->jpph21_gaji_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh9->jpph21_gaji_ll + $trh9->jpph21_gaji_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh9->jpph21_up_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh9->jpph21_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh9->jpph21_up_ll + $trh9->jpph21_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totalpph21)."&nbsp;</td>
					</tr>";
            
            $lcrek = '2110302'; // pph 22 setor
            $csql = "SELECT (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph22_up_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph22_up_ll,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='5') AS jpph22_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='5') AS jpph22_gaji_ll";
            
            $hasil = $this->db->query($csql);
            $trh10 = $hasil->row();
            $totalpph22 = $trh10->jpph22_up_ini + $trh10->jpph22_up_ll + $trh10->jpph22_gaji_ini + $trh10->jpph22_gaji_ll;

            $cRet .="
					 <tr>
						<td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;c.PPH 22</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh10->jpph22_gaji_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh10->jpph22_gaji_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh10->jpph22_gaji_ll + $trh10->jpph22_gaji_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh10->jpph22_up_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh10->jpph22_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh10->jpph22_up_ll + $trh10->jpph22_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totalpph22)."&nbsp;</td>
					</tr>";
            
            $lcrek = '2110303'; // pph 23 setor
            $csql = "SELECT (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph23_up_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jpph23_up_ll,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='5') AS jpph23_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 = '$lcrek' AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='5') AS jpph23_gaji_ll";
            
            $hasil = $this->db->query($csql);
            $trh11 = $hasil->row();
            $totalpph23 = $trh11->jpph23_up_ini + $trh11->jpph23_up_ll + $trh11->jpph23_gaji_ini + $trh11->jpph23_gaji_ll;

            $cRet .="
					 <tr>
						<td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;d.PPH 23</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh11->jpph23_gaji_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh11->jpph23_gaji_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh11->jpph23_gaji_ll + $trh11->jpph23_gaji_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh11->jpph23_up_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh11->jpph23_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh11->jpph23_up_ll + $trh11->jpph23_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totalpph23)."&nbsp;</td>
					</tr>";

            // lain lain setoran
            $csql = "SELECT (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 NOT IN ('2110301','2110302','2110303','2110401') AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jlain_up_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 NOT IN ('2110301','2110302','2110303','2110401') AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp IN('1','2','3','7')) AS jlain_up_ll,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 NOT IN ('2110301','2110302','2110303','2110401') AND MONTH(a.tgl_bukti)='$nbulan' AND 
                    a.jns_spp ='5') AS jlain_gaji_ini,
                    (SELECT SUM(b.nilai) FROM trhstrpot a INNER JOIN trdstrpot b
                    ON a.no_bukti = b.no_bukti WHERE a.kd_skpd = '$lcskpd' AND 
                    b.kd_rek5 NOT IN ('2110301','2110302','2110303','2110401') AND MONTH(a.tgl_bukti)<'$nbulan' AND 
                    a.jns_spp ='5') AS jlain_gaji_ll";
					
            $hasil = $this->db->query($csql);
            $trh12 = $hasil->row();
            $totallain 	  = $trh12->jlain_up_ini + $trh12->jlain_up_ll + $trh12->jlain_gaji_ini + $trh12->jlain_gaji_ll;         
            $jmsetgaji_ll = $trh7->spj_gaji_ll+ $trh8->jppn_gaji_ll + $trh9->jpph21_gaji_ll +
                            $trh10->jpph22_gaji_ll + $trh11->jpph23_gaji_ll + $trh12->jlain_gaji_ll - $trh7->kem_gj_ll;
            $jmsetgaji_ini= $trh7->spj_gaji_ini + $trh8->jppn_gaji_ini + $trh9->jpph21_gaji_ini +
                             $trh10->jpph22_gaji_ini + $trh11->jpph23_gaji_ini + $trh12->jlain_gaji_ini - $trh7->kem_gj_ini;
            $jmsetgaji_sd = $jmsetgaji_ll + $jmsetgaji_ini;
            
            $jmsetup_ll   = $trh7->spj_up_ll + $trh8->jppn_up_ll + $trh9->jpph21_up_ll +
                            $trh10->jpph22_up_ll + $trh11->jpph23_up_ll + $trh12->jlain_up_ll;
            $jmsetup_ll   = $trh7->spj_up_ll + $trh8->jppn_up_ll + $trh9->jpph21_up_ll +
                            $trh10->jpph22_up_ll + $trh11->jpph23_up_ll + $trh12->jlain_up_ll;                             
            $jmsetup_ini  = $trh7->spj_up_ini + $trh8->jppn_up_ini + $trh9->jpph21_up_ini +
                            $trh10->jpph22_up_ini + $trh11->jpph23_up_ini + $trh12->jlain_up_ini;
            $jmsetup_sd   = $jmsetup_ll + $jmsetup_ini;
            
            // pengembalian Kas
            $csql = "SELECT(SELECT SUM(total) FROM trhkasin_pkd WHERE jns_trans='1' AND kd_skpd='$lcskpd' AND MONTH(tgl_kas)<'$nbulan') AS kemuplalu,
                    (SELECT SUM(total) FROM trhkasin_pkd WHERE jns_trans='1' AND kd_skpd='$lcskpd' AND MONTH(tgl_kas)='$nbulan') AS kemupini,
                    (SELECT SUM(total) FROM trhkasin_pkd 
                        WHERE jns_trans='5' AND kd_skpd='$lcskpd' AND MONTH(tgl_kas)<'$nbulan' AND SUBSTR(kd_Kegiatan,20,2)='02') AS kemlsgjlalu,
                    (SELECT SUM(total) FROM trhkasin_pkd 
                        WHERE jns_trans='5' AND kd_skpd='$lcskpd' AND MONTH(tgl_kas)='$nbulan' AND SUBSTR(kd_Kegiatan,20,2)='02') AS kemlsgjini,
                    (SELECT SUM(total) FROM trhkasin_pkd 
                        WHERE jns_trans='5' AND kd_skpd='$lcskpd' AND MONTH(tgl_kas)<'$nbulan' AND SUBSTR(kd_Kegiatan,20,2)<>'02') AS kemlsbrglalu,
                    (SELECT SUM(total) FROM trhkasin_pkd 
                        WHERE jns_trans='5' AND kd_skpd='$lcskpd' AND MONTH(tgl_kas)='$nbulan' AND SUBSTR(kd_Kegiatan,20,2)<>'02') AS kemlsbrgini";
            $setor = $this->db->query($csql);
            $str = $setor->row();
            $totstr = $str->kemuplalu + $str->kemupini + $str->kemlsgjlalu + $str->kemlsgjini; 

            $totgj = $str->kemlsgjlalu + $str->kemlsgjini;
            $totup = $str->kemuplalu + $str->kemupini;                                     
            
            $cRet .=" 
					<tr>
						<td align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none;\" colspan=\"2\">&ensp;&ensp;- Lain-lain</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh12->jlain_gaji_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh12->jlain_gaji_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh12->jlain_gaji_ll + $trh12->jlain_gaji_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh12->jlain_up_ll)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh12->jlain_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($trh12->jlain_up_ll + $trh12->jlain_up_ini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none;\">".number_format($totallain)."&nbsp;</td>
					</tr>";

            $cRet .="
					<tr>
						<td align=\"left\" style=\"font-size:12px\" colspan=\"2\"><b>Jumlah Pengeluaran :</b></td>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmsetgaji_ll)."&nbsp;</b></td>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmsetgaji_ini)."&nbsp;</b></td>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmsetgaji_sd)."&nbsp;</b></td>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmsetup_ll)."&nbsp;</b></td>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmsetup_ini)."&nbsp;</b></td>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmsetup_sd)."&nbsp;</b></td>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmsetgaji_sd + $jmsetup_sd)."&nbsp;</td>
					</tr> 
					<tr>
						<td align=\"left\" style=\"font-size:12px\" colspan=\"2\">Pengembalian Kas</td>
						<td align=\"right\" style=\"font-size:12px\">".number_format($str->kemlsgjlalu)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px\">".number_format($str->kemlsgjini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px\">".number_format($totgj)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px\">".number_format($str->kemuplalu)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px\">".number_format($str->kemupini)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px\">".number_format($totup)."&nbsp;</td>
						<td align=\"right\" style=\"font-size:12px\">".number_format($totstr)."&nbsp;</td>
					</tr>
					<tr>
						<td align=\"left\" style=\"font-size:12px\" colspan=\"2\"><b>Saldo Kas</b></td>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmgaji_ll - $jmsetgaji_ll - $str->kemlsgjlalu)."&nbsp;</b></td>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmgaji_ini - $jmsetgaji_ini - $str->kemlsgjini)."&nbsp;</b></td>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmgaji_sd - $jmsetgaji_sd - $totgj)."&nbsp;</b></td>>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmup_ll - $jmsetup_ll - $str->kemuplalu)."&nbsp;</b></td>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmup_ini - $jmsetup_ini - $str->kemupini)."&nbsp;</b></td>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmup_sd - $jmsetup_sd - $totup)."&nbsp;</b></td>
						<td align=\"right\" style=\"font-size:12px\"><b>".number_format($jmtrmgaji_sd + $jmtrmup_sd - $jmsetgaji_sd - $jmsetup_sd - $totstr)."&nbsp;</b></td>
					</tr>
					<tr>
						<td align=\"center\" style=\"font-size:12px\" colspan=\"9\">&nbsp;</td>
					</tr>";
					
		$cRet .= " </table>";		
		$zz=0;
			for($zz=0;$zz <=$spasi;$zz++){
				$cRet .="<br>";
			}
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">
                    <tr>
						<td align=\"center\" width=\"25%\"></td>                    
						<td align=\"center\" width=\"25%\"></td>
						<td align=\"center\" width=\"25%\">&nbsp;</td>
					</tr>
                    <tr>
						<td align=\"center\" width=\"25%\">Mengetahui ,</td>                    
						<td align=\"center\" width=\"25%\"></td>
						<td align=\"center\" width=\"25%\">$daerah ,".$this->tukd_model->tanggal_format_indonesia($tglttd)."</td>
					</tr>
					<tr>
						<td align=\"center\" width=\"25%\">$jabatan</td>                    
						<td align=\"center\" width=\"25%\"></td>
						<td align=\"center\" width=\"25%\">$jabatan1</td>
					</tr>
                    <tr>
						<td align=\"center\" width=\"25%\">&nbsp;</td>                    
						<td align=\"center\" width=\"25%\">&nbsp;</td>
						<td align=\"center\" width=\"25%\">&nbsp;</td>
					</tr>
					 <tr>
						<td align=\"center\" width=\"25%\">&nbsp;</td>                    
						<td align=\"center\" width=\"25%\">&nbsp;</td>
						<td align=\"center\" width=\"25%\">&nbsp;</td>
					</tr>
                    <tr><td align=\"center\" width=\"25%\">$nama</td>                    
						<td align=\"center\" width=\"25%\">&nbsp;</td>
						<td align=\"center\" width=\"25%\">$nama1</td>
					</tr>                              
                    <tr>";
					if(strlen($nip) <=11){
						$cRet.="<td align=\"center\" width=\"25%\">NRP. $nip</td>";
					}else{
						$cRet.="<td align=\"center\" width=\"25%\">NIP. $nip</td>";
					}                    
					$cRet.="	<td align=\"center\" width=\"25%\">&nbsp;</td>
						<td align=\"center\" width=\"25%\">NIP. $nip1</td>
					</tr>                              
                  </table>";
			$cetak = $this->uri->segment(3);
			

$data['prev']= $cRet;
	  
        switch($cetak) {        
        case 1;
        $this->_mpdf1('',$cRet,'5','5',5,'1');
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= bku.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        }	
	}
	}

 
      
 
 
 
 
 
 
 function prognosis_skpkd(){
       $data['page_title'] = 'PROGNOSIS SKPKD';
        $this->template->set('title', 'PROGNOSIS SKPKD');
        $this->template->load('template', 'akuntansi/prognosis_skpkd', $data);
    }


//==================mulai_prognosis================================
    function cetak_perda1_semester_skpkd(){
	
	
        $id 	   = '1.20.05.01'; 
        $thn_ang   = $this->session->userdata('pcThang');
       // $tgl_ttd   = $_REQUEST['tgl_ctk'];
		$hala  = $_REQUEST['posx'];
       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
				
       $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk 
                    FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
     
        $sql="SELECT 
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='1.20.05.01'
AND LEFT(c.kd_rek64,1)='4'),0) AS angpen,
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='1.20.05.01'
AND LEFT(c.kd_rek64,1)='5'),0) AS angbel,
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='1.20.05.01'
AND LEFT(c.kd_rek64,1)='6'),0) AS angtansfer,
IFNULL((SELECT SUM(b.kredit)-SUM(b.debet) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE b.kd_skpd='1.20.05.01' AND LEFT(b.kd_rek5,1)='4' AND MONTH(a.tgl_voucher)<='6'),0) AS totpen,
IFNULL((SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE b.kd_skpd='1.20.05.01' AND LEFT(b.kd_rek5,1)='5' AND MONTH(a.tgl_voucher)<='6'),0) AS totbel,
IFNULL((SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE b.kd_skpd='1.20.05.01' AND LEFT(b.kd_rek5,1)='6' AND MONTH(a.tgl_voucher)<='6'),0) AS tottransfer
";    
                                                
                    $query   = $this->db->query($sql);
                    $hasil   = $query->row();
                    $angpen  = $hasil->angpen;
                    $angbel  = $hasil->angbel;
                    $angtf   = $hasil->angtansfer;
                    
                    $totpen  = $hasil->totpen;
                    $totbel  = $hasil->totbel;
                    $tottf   = $hasil->tottransfer;                 
              //total belanja + total transfer
        //anggaran
        $astaga=$angbel+$angtf;
        $astaga1= number_format($astaga,"2",".",",");
        //nilai
        $abdi=$totbel+$tottf;
        $abdi1= number_format($abdi,"2",".",",");

//sisa
        $sesana = $astaga-$abdi;
        if ($sesana < 0){
                    	$ac1="("; 
                        $sesana=$sesana*-1; 
                        $ca1=")";
                        }else{
                    	$ac1="";
                        $sesana=$sesana*1; 
                        $ca1="";
                        }
		$sesana1= number_format($sesana,"2",".",",");		

		//surplus = pendapatan -(total belanja + total transfer)
		//angaran
		$surplusacf=$angpen-$astaga;
        if ($surplusacf < 0){
                    	$x1="("; 
                        $surplusacf=$surplusacf*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $surplusacf=$surplusacf*1; 
                        $y1="";
                        }
		$surplusacf1= number_format($surplusacf,"2",".",",");			
		//surplus = pendapatan -(total belanja + total transfer)
		//nilai
		$surplusnilai=$totpen-$abdi;
		if ($surplusnilai < 0){
                    	$xx1="("; 
                        $surplusnilai=$surplusnilai*-1; 
                        $yy1=")";
                        }else{
                    	$xx1="";
                        $surplusnilai=$surplusnilai*1; 
                        $yy1="";
                        }
		$surplusnilai1= number_format($surplusnilai,"2",".",",");			

		$surplussisa=$surplusacf-$surplusnilai;
		if ($surplussisa < 0){
                    	$xxx1="("; 
                        $surplussisa=$surplussisa*-1; 
                        $yyy1=")";
                        }else{
                    	$xxx1="";
                        $surplussisa=$surplussisa*1; 
                        $yyy1="";
                        }
		$surplussisa1= number_format($surplussisa,"2",".",",");			




		$sqltotalitasah="SELECT 
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='1.20.05.01'
AND LEFT(c.kd_rek64,2)='71'),0) AS totpenbim,
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='1.20.05.01'
AND LEFT(c.kd_rek64,2)='72'),0) AS totpengbin,
IFNULL((SELECT SUM(b.kredit)-SUM(b.debet) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE b.kd_skpd='1.20.05.01' AND LEFT(b.kd_rek5,2) IN ('71','72') AND MONTH(a.tgl_voucher)<='6'),0) AS totpenil";
	$sqltotalitasah1=$this->db->query($sqltotalitasah);
                 foreach ($sqltotalitasah1->result() as $rowasa)
                {
                    $totpenbim=$rowasa->totpenbim;                    
                    $totpengbin= $rowasa->totpengbin;
                    $totpenil  = $rowasa->totpenil;
                    
                } 

	$lembur=$totpenbim-$totpengbin;
	$sisak=$lembur-$totpenil;
		
	$lembur1= number_format($lembur,"2",".",",");
	$sisak1= number_format($sisak,"2",".",",");
//anggran
	$silpaade=$surplusacf+$lembur;
	$silpaade1= number_format($silpaade,"2",".",",");
	$totpenil1=number_format($totpenil,"2",".",",");
	$sisanyaaja=($silpaade-$totpenil);
$sisanyaaja1= number_format($sisanyaaja,"2",".",",");

//nilai
	$silpaadenilai=$surplusnilai+$totpenil;
	$silpaadenilai1= number_format($silpaadenilai,"2",".",",");
//sisa
	$silpasisa=$silpaade-$silpaadenilai;
	if ($silpasisa < 0){
                    	$a12="("; 
                        $silpasisa=$silpasisa*-1; 
                        $c12=")";
                        }else{
                    	$a12="";
                        $silpasisa=$silpasisa*1; 
                        $c12="";
                        }
    $silpasisa= number_format($silpasisa,"2",".",",");

$angaransilpa=$angpen-($angbel+$angtf)+($lembur);

if ($angaransilpa < 0){
                    	$a12="("; 
                        $angaransilpa=$angaransilpa*-1; 
                        $c12=")";
                        }else{
                    	$a12="";
                        $angaransilpa=$angaransilpa*1; 
                        $c12="";
                        }
$angaransilpa1= number_format($angaransilpa,"2",".",",");
                    





       
        $cRet='';       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>PEMERINTAH $kab</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>LAPORAN REALISASI SEMESTER PERTAMA PENDAPATAN DAN BELANJA SKPD<br>SERTA PROGNOSIS 6 (ENAM) BULAN BERIKUTNYA</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>                         
                    </tr>                                       
                    <tr>
                         <td align=\"center\"><strong>Tahun Anggaran $thn_ang</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"1%\" align=\"center\"><b>NO</b></td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"11%\" align=\"center\"><b>Jumlah Anggaran</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Realisasi Semester Pertama</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\" ><b>Sisa Anggaran<br>s.d<br>Semester Pertama</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\" ><b>Prognosis</b></td>  
							<td bgcolor=\"#CCCCCC\" width=\"3%\" align=\"center\" ><b>Keterangan</b></td> 
                        </tr>  
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td> 
							<td style=\"border-top: none;\"></td>
                         </tr>
                     </tfoot>";

                 $sql4 ="SELECT nor,uraian,seq,
(SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='1.20.05.01' 
AND (LEFT(c.kd_rek64,5)=a.kode_1 OR LEFT(c.kd_rek64,4)=a.kode_1 OR LEFT(c.kd_rek64,3)=a.kode_1 OR LEFT(c.kd_rek64,2)=a.kode_1 OR LEFT(c.kd_rek64,1)=a.kode_1)) AS anggaran,

(SELECT SUM(debet) AS debet FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE b.kd_skpd='1.20.05.01' AND MONTH(a.tgl_voucher)<='6' 
AND (LEFT(b.kd_rek5,5)=a.kode_1 OR LEFT(b.kd_rek5,4)=a.kode_1 OR LEFT(b.kd_rek5,3)=a.kode_1 OR LEFT(b.kd_rek5,2)=a.kode_1 OR LEFT(b.kd_rek5,1)=a.kode_1)) AS debet,

(SELECT SUM(kredit) AS kredit FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE b.kd_skpd='1.20.05.01' AND MONTH(a.tgl_voucher)<='6' 
AND (LEFT(b.kd_rek5,5)=a.kode_1 OR LEFT(b.kd_rek5,4)=a.kode_1 OR LEFT(b.kd_rek5,3)=a.kode_1 OR LEFT(b.kd_rek5,2)=a.kode_1 OR LEFT(b.kd_rek5,1)=a.kode_1)) AS kredit	
FROM map_lra_ppkd_kab a ORDER BY CAST(nor AS SIGNED)";
                            
                $query4 = $this->db->query($sql4);                                  
                foreach ($query4->result() as $row4)
                {
                    $no         = $row4->nor;
                    $nama       = $row4->uraian;   
                    $anggaran   = $row4->anggaran;
                    $debet      = $row4->debet;
                    $kredit     = $row4->kredit;
                    $seq        = $row4->seq;
                    
                    $angg  = number_format($anggaran,"2",".",",");
                    if($row4->seq<'166'){
                      $nilai = $kredit-$debet;
                    }else{
                      $nilai = $debet-$kredit;    
                    }
                    
					
					if ($nilai < 0){
                    	$x='('; 
                        $nilai=$nilai*-1; 
                        $y=')';
                        }else {
                    	$x='';
                        $nilai=$nilai*1; 
                        $y='';
                        } 

                $nil  = number_format($nilai,"2",".",",");





					$sisa = $anggaran - $nilai;
					if ($sisa < 0){
                    	$x='('; 
                        $sisa=$sisa*-1; 
                        $y=')';
                        }else {
                    	$x='';
                        $sisa=$sisa*1; 
                        $y='';
                        } 

					$sisaangg  = number_format($sisa,"2",".",",");
					
                    switch ($row4->seq) {
                    case 5:
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
					 case 10:
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                        //JUMLAH
                    case 35:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 45 :
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
					 case 50:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                    case 75:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 85:
                        $cRet    .= "<tr>
                                          <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;                                         
                    case 105:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 115:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";

                        break;
                        case 135:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>";
                        break;

                   case 145:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";

                        break;

                 
                    case 145:
                        $cRet    .= "<tr>
                                        <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                         case 165:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						case 170:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						
                        
                          case 180:
                        $cRet    .= "<tr>
                                        <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
						
							case 205:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						case 215:
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
					 case 220:
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
						case 255:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
					  
					  
                       
                          
                         //header
                         case 310:
                        $cRet    .= "<tr>
                                        <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                        
                        //jumlah
                        case 320:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						case 325:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                         //header
                         case 335:
                        $cRet    .= "<tr>
                                        <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                       
                       
                         //jumlah
                        case 360:

                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						
						  //header
                         case 370:
                        $cRet    .= "<tr>
                                        <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                       
						
						   case 390:

                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						
						
						  case 395:

                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						
						
						
                         //belanja + transfer
                        case 400:
		
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$astaga1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$abdi1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$ac1$sesana1$ca1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$ac1$sesana1$ca1</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                       
         
		   case 410:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$surplusacf1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$xx1$surplusnilai1$yy1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$xxx1$surplussisa1$yyy1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$xxx1$surplussisa1$yyy1</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
		   //header
                         case 420:
                        $cRet    .= "<tr>
                                        <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
						
						              case 430:
                        $cRet    .= "<tr>
                                        <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
						
							case 495:

                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;

                        case 505:
                        $cRet    .= "<tr>
                                        <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
						
                         //jumlah
                        case 570:

                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						
						
						        case 575:

                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$lembur1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totpenil1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$sisak1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$sisak1</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						
						
						
						
						case 585:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angaransilpa1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$silpaadenilai1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$a12 $silpasisa $c12</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$a12 $silpasisa $c12</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						
						

                    default:
					if($nama <> ''){
                    $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$angg</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nil</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$x$sisaangg$y</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$x$sisaangg$y</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";
					}else{
					 $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";	
					}
                }         
                }

        $cRet .=       " </table>";
		$cRet .= " <br><br>";
 
	$skpdx=$kd_skpd.' '.$nm_skpd;
		
		 
		
		
			$ctk = $this->uri->segment(3);
		   $data['prev']= $cRet;
            switch($ctk) {        
                case 1;
                       $this->_mpdf1('',$cRet,25,10,10,'P',$skpdx,$hala);
                break;
                case 2;        
                    header("Cache-Control: no-cache, no-store, must-revalidate");
                    header("Content-Type: application/vnd.ms-excel");
                    header("Content-Disposition: attachment; filename=skpkd.xls");
                    $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            } 

          
            
                 
    }
//=================
	function neracasaldo(){
        $data['page_title']= 'CETAK NERACA SALDO';
        $this->template->set('title', 'CETAK NERACA SALDO');   
        $this->template->load('template','akuntansi/neracasaldo',$data) ;	
	}
	
	
	
	
	function cetak_neracasaldo(){
        $thn_ang	= $this->session->userdata('pcThang');
        $kd_skpd	= $_REQUEST['skpd'];
        $bulan		= $_REQUEST['tgl1'];
        $lcperiode  = $this->tukd_model->getBulan($bulan);
        $tgl_ttd	= $_REQUEST['tgl_ttd'];		
//		$ctk=1;
	$ctk = $this->uri->segment(3);

        $sqlsc = "SELECT kab_kota,daerah FROM sclient";
		$sqlsclient=$this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc){
			$kota   = $rowsc->kab_kota;
			$daerah = $rowsc->daerah;
		}

        $csql2 = "SELECT nm_skpd FROM ms_skpd WHERE kd_skpd = '$kd_skpd'";
            $hasil2   = $this->db->query($csql2);
            $trh4     = $hasil2->row();          
            $lcNmskpd = $trh4->nm_skpd;
			
        $sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$kd_skpd' and kode='ppk'";
		$sqlttd=$this->db->query($sqlttd1);
		$zz=0;
		foreach ($sqlttd->result() as $rowttd){
			$nip	 = $rowttd->nip;                    
			$nama	 = $rowttd->nm;
			$jabatan = $rowttd->jab;
			$zz++;
		}	


                
		if($zz == '0'){
			 $nip='Belum ada Nip';                    
			 $nama= 'Belum ada nama';
			 $jabatan  = 'Belum ada jabatan';
		}		

        $cRet = '';
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"1\" cellpadding=\"1\">
					<tr>
						<td colspan=\"4\" align=\"center\" style=\"font-size:14px;border: solid 1px white;\"><b>PEMERINTAH $kota<br>NERACA SALDO</b></td>
					</tr>
					<tr>
						<td colspan=\"4\" align=\"center\" style=\"font-size:14px;border: solid 1px white;\">Bulan $lcperiode</td>
					</tr> 			
					<tr>
						<td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
					</tr>
					<tr>
						<td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
					</tr>
					<tr>
						<td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
					</tr>
					<tr>
						<td width=\"5%\" align=\"left\" style=\"font-size:10px;border: solid 1px white;\">SKPD</td>
						<td width=\"95%\" align=\"left\" style=\"font-size:10px;border: solid 1px white;\">: $kd_skpd  $lcNmskpd</td>
					</tr>
					</table>";
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
            <thead>
			<tr>
                <td bgcolor=\"#CCCCCC\" rowspan=\"2\" align=\"center\" width=\"5%\" style=\"font-size:12px\">Kode Rekening</td>
                <td bgcolor=\"#CCCCCC\" rowspan=\"2\" align=\"center\" width=\"55%\" style=\"font-size:12px\">Nama Rekening</td>
                <td bgcolor=\"#CCCCCC\" colspan=\"2\" align=\"center\" width=\"40%\" style=\"font-size:12px\">Jumlah</td>          
            </tr> 
            <tr>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"20%\" style=\"font-size:12px\">Debet</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"20%\" style=\"font-size:12px\">Kredit</td>         
            </tr>			
            <tr>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">1</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">2</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">3</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">4</td>            
            </tr> 
			</thead>
			<tfoot>
				<tr><td style=\"border-bottom: none; border-left:none;border-right:none;\" colspan=\"4\"></td>
			</tfoot>            
            ";
			
			$sql = "SELECT a.kd_rek5,a.nm_rek5,
						IF(LEFT(a.kd_rek5,1) IN ('1','5','6','9') || LEFT(a.kd_rek5,2) IN ('72'),SUM(debet)-SUM(kredit),0) AS debet,
						IF(LEFT(a.kd_rek5,1) IN ('0','2','3','4','8') || LEFT(a.kd_rek5,2) IN ('71'),SUM(kredit)-SUM(debet),0) AS kredit 
						FROM trdju_pkd a 
						INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher 
						WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND MONTH(b.tgl_voucher)<='$bulan' and YEAR(tgl_voucher)='$thn_ang'
						GROUP BY a.kd_rek5
						ORDER BY a.kd_rek5
					";          

					$hasil = $this->db->query($sql);       
					$saldo=0;
					foreach ($hasil->result() as $row){
					   $kd_rek5  = $row->kd_rek5 ;
					   $nm_rek5  = $row->nm_rek5;
					   $debet    = $row->debet; 
					   $kredit   = $row->kredit;
					   
					if($debet<0){
						$xy="("; 
						$debet=$debet*-1; 
						$yx=")";						   
					}else{
						$xy=""; 
						$debet=$debet*1; 
						$yx="";					   
					}
					$debet1 = number_format($debet,2,',','.');
					
					if($kredit<0){
						$as="("; 
						$kredit=$kredit*-1; 
						$sa=")";						   
					}else{
						$as=""; 
						$kredit=$kredit*1; 
						$sa="";					   
					}
					$kredit1 = number_format($kredit,2,',','.');					

						$cRet .="<tr>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$kd_rek5</td>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$nm_rek5</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$xy$debet1$yx</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$as$kredit1$sa</td>                                    
								  </tr>";                              
					} 

		$sql = "SELECT SUM(debet) AS debet , SUM(kredit) AS kredit FROM(
			SELECT a.kd_rek5,
						IF(LEFT(a.kd_rek5,1) IN ('1','5','6','9') || LEFT(a.kd_rek5,2) IN ('72'),SUM(debet)-SUM(kredit),0) AS debet,
						IF(LEFT(a.kd_rek5,1) IN ('0','2','3','4','8') || LEFT(a.kd_rek5,2) IN ('71'),SUM(kredit)-SUM(debet),0) AS kredit 
						FROM trdju_pkd a 
						INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher 
						WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND MONTH(b.tgl_voucher)<='$bulan' and YEAR(tgl_voucher)='$thn_ang'
						GROUP BY a.kd_rek5
					)z";          
       

					$hasil = $this->db->query($sql);       
					$debeta1  = 0;
					$kredita1 = 0;
					foreach ($hasil->result() as $row){
					   $debet    = $row->debet; 
					   $kredit   = $row->kredit;
					 
					   $debeta1  = $debeta1+$debet;
					   $kredita1 = $kredita1+$kredit;
					   
						if($debeta1<0){
							$qw="("; 
							$debeta1=$debeta1*-1; 
							$wq=")";						   
						}else{
							$qw=""; 
							$debeta1=$debeta1*1; 
							$wq="";					   
						}
						$debeta11 = number_format($debeta1,2,',','.');
						
						if($kredita1<0){
							$zx="("; 
							$kredita1=$kredita1*-1; 
							$xz=")";						   
						}else{
							$zx=""; 
							$kredita1=$kredita1*1; 
							$xz="";					   
						}
						$kredit11 = number_format($kredita1,2,',','.');	                           
					}
						$cRet .="<tr>
								  <td colspan=\"2\" valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"><b>Total</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"><b>$qw$debeta11$wq</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"><b>$zx$kredit11$xz</b></td>                                    
								  </tr>";   					
         $cRet .="<tr>
                    <td valign=\"top\" align=\"left\" style=\"font-size:12px;border: solid 1px white;border-top:solid 1px black;\">&nbsp;</td>
                    <td valign=\"top\" align=\"center\" style=\"font-size:12px;border: solid 1px white;border-top:none;\">&nbsp;</td>
                    <td valign=\"top\" align=\"center\" style=\"font-size:12px;border: solid 1px white;border-top:none;\">&nbsp;</td>
                 </tr>

                <tr>
                    <td align=\"center\" colspan=\"3\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    <td align=\"center\" style=\"font-size:12px;border: solid 1px white;\">$daerah, tanggal ".$this->tanggal_format_indonesia($tgl_ttd)."</td>                                                                                                                                                                                
                </tr>
                <tr>                
                    <td align=\"center\" colspan=\"3\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    <td align=\"center\" style=\"font-size:12px;border: solid 1px white;\"><b>$jabatan</b></td>                    
                </tr>
                <tr>
                    <td align=\"left\" colspan=\"3\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    <td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
                </tr>
                <tr>
                    <td align=\"left\" colspan=\"3\" style=\"font-size:12px;border: solid 1px white;\">&nbsp;</td>
                    <td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
                </tr>
                <tr>
                    <td align=\"left\" colspan=\"3\" style=\"font-size:12px;border: solid 1px white;\">&nbsp;</td>
                    <td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
                </tr>
                <tr>
                    <td align=\"left\" colspan=\"3\" style=\"font-size:12px;border: solid 1px white;\">&nbsp;</td>
                    <td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
                </tr>
                <tr>
                    <td align=\"center\" colspan=\"3\" style=\"font-size:12px;border: solid 1px white;\"><u></u></td>
                    <td align=\"center\" style=\"font-size:12px;border: solid 1px white;\"><u>$nama</u></td>
                </tr>
                <tr>
                    <td align=\"center\" colspan=\"3\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    <td align=\"center\" style=\"font-size:12px;border: solid 1px white;\">$nip</td>
                </tr>";                     

         $cRet .='</table>';
         $data['prev']= $cRet;    
        // $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
		 
		 
		   $data['prev']= $cRet;
            switch($ctk) {        
                case 1;
                      $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
                break;
                case 2;        
                    header("Cache-Control: no-cache, no-store, must-revalidate");
                    header("Content-Type: application/vnd.ms-excel");
                    header("Content-Disposition: attachment; filename=neracasaldo.xls");
                    $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            } 

			 
    }
	
	
	function cetaklrareal(){
        $data['page_title']= 'CETAK NERACA SALDO';
        $this->template->set('title', 'CETAK NERACA SALDO');   
        $this->template->load('template','akuntansi/cetaklrareal',$data) ;	
	}

	function cetak_lra_real(){
        $nbulan	= $_REQUEST['nbulan'];
		$bulan	= $this->tukd_model->getBulan($nbulan);
        $tgl_ttd= $_REQUEST['tgl_ttd'];
        $thn_ang= $this->session->userdata('pcThang');
		$kdskpd = $this->session->userdata('kdskpd');

		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
		$sqlsclient=$this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc){
			$kab     = $rowsc->kab_kota;
			$daerah  = $rowsc->daerah;
			$thn     = $rowsc->thn_ang;
		}
		
        $sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$kdskpd' and kode='PA'";
		$sqlttd=$this->db->query($sqlttd1);
		foreach ($sqlttd->result() as $rowttd){
			$nip	 = $rowttd->nip;                    
			$nama	 = $rowttd->nm;
			$jabatan = $rowttd->jab;
		}		

        $cRet = '';
        $cRet = "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"1\" cellpadding=\"1\">";
        $cRet .="<tr>
					<td align=\"center\" style=\"font-size:14px;\"><b>PEMERINTAH $kab<br>LAPORAN REALISASI ANGGARAN</b></td>
				 </tr>
				 <tr>
					<td align=\"center\" style=\"font-size:14px;\"><b>Bulan $bulan $thn_ang</b></td>        
				 </tr>
				 <tr>
					<td align=\"left\" style=\"font-size:12px;\" colspan=\"2\">&nbsp;</td> 
				 </tr>
				</table>";
			
        $cRet .="<table style=\"border-collapse:collapse; font-size:14;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"4\">
				<thead>
					<tr>
						<td rowspan=\"2\" width=\"1%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>NO<b></td>
						<td rowspan=\"2\" width=\"49%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Uraian</b></td>
						<td colspan=\"2\" width=\"30%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Jumlah (Rp)<b></td>
						<td rowspan=\"2\" width=\"15%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Berambah/<br>(Berkurang)<b></td>
						<td rowspan=\"2\" width=\"5%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>%<b></td>
					</tr>
					<tr>
						<td width=\"15%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Anggaran<b></td>
						<td width=\"15%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Realisasi</b></td>
					</tr>
					<tr>
						<td width=\"1%\" bgcolor=\"#CCCCCC\" align=\"center\">1</td>
						<td width=\"49%\" bgcolor=\"#CCCCCC\" align=\"center\">2</td>
						<td width=\"15%\" bgcolor=\"#CCCCCC\" align=\"center\">3</td>
						<td width=\"15%\" bgcolor=\"#CCCCCC\" align=\"center\">4</td>
						<td width=\"15%\" bgcolor=\"#CCCCCC\" align=\"center\">5</td>
						<td width=\"5%\" bgcolor=\"#CCCCCC\" align=\"center\">6</td>
					</tr>
				</thead>
				<tfoot>
					<tr>
						<td colspan=\"6\" style=\"border-bottom:none;border-left:none;border-right:none;\"></td>
					</tr>
				</tfoot>
				<tr>
					<td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
					<td width=\"49%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
					<td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
					<td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
					<td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
					<td width=\"5%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
				</tr>";
//pendapatan				
        $sqlww = $this->db->query("SELECT * FROM(
								SELECT lra,kd_rek1 AS kode,nm_rek1 AS nama,
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,1)=e.kd_rek1) AS angg,
								(SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
									INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
									WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,1)=e.kd_rek1)+
								(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,1)=e.kd_rek1)				
								AS reali
								FROM ms_rek1 e WHERE LEFT(kd_rek1,1)='4'
								UNION
								SELECT lra,kd_rek2 AS kode,nm_rek2 AS nama, 
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,2)=w.kd_rek2) AS angg,
								(SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
									INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
									WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)=w.kd_rek2)+
								(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,2)=w.kd_rek2)				
								AS reali
								FROM ms_rek2 w WHERE LEFT(kd_rek2,1)='4'
								UNION
								SELECT lra,kd_rek3 AS kode,nm_rek3 AS nama, 
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,3)=q.kd_rek3) AS angg,
								(SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
									INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
									WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,3)=q.kd_rek3)+
								(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,3)=q.kd_rek3)			
								AS reali
								FROM ms_rek3 q WHERE LEFT(kd_rek3,1)='4'
								)a ORDER BY kode");
        foreach($sqlww->result() as $roww){
            $nor	= $roww->lra;
            $uraian	= $roww->nama;
            $kode1	= $roww->kode;
			$angg	= $roww->angg;
			$anggaran = number_format($angg,2,',','.');
			$real	= $roww->reali;
			$realisasi = number_format($real,2,',','.');
			$sel	= $real-$angg;
			//$sel	= $angg-$real;
			if ($sel < 0){
				$zx="(";
				$sel=$sel*-1;
				$xz=")";
			}else {
				$zx="";
				$sel=$sel;
				$xz="";
			}			
			$selisih = number_format($sel,2,',','.');
			
			if($real <> 0){
				$per   = ($real)?($real/$angg) * 100:0; 
			}else if($real==0){
				$per=0;
			}else{
				$per=100;
			}
			$persen = number_format($per,"2",",",".");
			
 			if((strlen($kode1)<=2)){
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$nor</td>
						 <td width=\"49%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"><b>$uraian</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$anggaran</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$realisasi</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$zx$selisih$xz</b></td>
						 <td width=\"5%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$persen</b></td>
					</tr>";
			}else{
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$nor</td>
						 <td width=\"49%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$uraian</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$anggaran</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$realisasi</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$zx$selisih$xz</td>
						 <td width=\"5%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$persen</td>
					</tr>";					
			}

		}
		$sqltp="SELECT
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,1)='4') AS totangg,		
					((SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
						INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
						WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,1)='4')+
						(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,1)='4')				
						)AS totreal";
		$sqlp=$this->db->query($sqltp);
		foreach ($sqlp->result() as $rowp){
		   $totangg1 = number_format($rowp->totangg,"2",",",".");
		   $totreal1 = number_format($rowp->totreal,"2",",",".");
		   $rumus2   = $rowp->totreal - $rowp->totangg;                   
		   //$rumus2   = $rowp->totangg-$rowp->totreal; 
		   
		   if ($rumus2 < 0){
				$x1="(";
				$rumus2=$rumus2*-1;
				$y1=")";
			}else {
				$x1="";
				$rumus2=$rumus2;
				$y1="";
			}
			$total2 = number_format($rumus2,"2",",",".");     

			if($rowp->totreal <> 0){
				$perx   = ($rowp->totreal!=0)?($rowp->totreal/$rowp->totangg) * 100:0; 
			}else if($rowp->totreal==0){
				$perx=0;
			}else{
				$perx=100;
			}
			$persenpen = number_format($perx,"2",",",".");				
			
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"></td>
						 <td width=\"49%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"justify\"><b>Jumlah Pendapatan</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$totangg1</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$totreal1</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$x1$total2$y1</b></td>
						 <td width=\"5%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$persenpen</b></td>
					</tr>";
		}		
//belanja
        $sqlww = $this->db->query("SELECT * FROM(
								SELECT lra,kd_rek1 AS kode,nm_rek1 AS nama,
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,1)=e.kd_rek1) AS angg,
								(SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
									INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
									WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2','3') AND LEFT(b.kd_rek5,1)=e.kd_rek1)+
								(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
									INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
									WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('4','5','6') AND LEFT(b.kd_rek5,1)=e.kd_rek1)+
								(SELECT IFNULL(SUM(b.rupiah*-1),0)
										FROM trdkasin_pkd b INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
										WHERE c.jns_trans=5 AND LEFT(b.kd_rek5,1)=5 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,1)=e.kd_rek1)			
								AS reali
								FROM ms_rek1 e WHERE LEFT(kd_rek1,1)='5'
								UNION
								SELECT lra,kd_rek2 AS kode,nm_rek2 AS nama, 
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,2)=w.kd_rek2) AS angg,
								(SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
									INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
									WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2','3') AND LEFT(b.kd_rek5,2)=w.kd_rek2)+
								(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
									INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
									WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('4','5','6') AND LEFT(b.kd_rek5,2)=w.kd_rek2)+
								(SELECT IFNULL(SUM(b.rupiah*-1),0)
										FROM trdkasin_pkd b INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
										WHERE c.jns_trans=5 AND LEFT(b.kd_rek5,1)=5 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)=w.kd_rek2)			
								AS reali
								FROM ms_rek2 w WHERE LEFT(kd_rek2,1)='5'
								UNION
								SELECT lra,kd_rek3 AS kode,nm_rek3 AS nama, 
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,3)=q.kd_rek3) AS angg,
								(SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
									INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
									WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2','3') AND LEFT(b.kd_rek5,3)=q.kd_rek3)+
								(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
									INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
									WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('4','5','6') AND LEFT(b.kd_rek5,3)=q.kd_rek3)+
								(SELECT IFNULL(SUM(b.rupiah*-1),0)
										FROM trdkasin_pkd b INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
										WHERE c.jns_trans=5 AND LEFT(b.kd_rek5,1)=5 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,3)=q.kd_rek3)		
								AS reali
								FROM ms_rek3 q WHERE LEFT(kd_rek3,1)='5'
								)a ORDER BY kode");
        foreach($sqlww->result() as $roww){
            $nor	= $roww->lra;
            $uraian	= $roww->nama;
            $kode1	= $roww->kode;
			$angg	= $roww->angg;
			$anggaran = number_format($angg,2,',','.');
			$real	= $roww->reali;
			$realisasi = number_format($real,2,',','.');
			$sel	= $real-$angg;
			//$sel	= $angg-$real;
			
			if ($sel < 0){
				$zx="(";
				$sel=$sel*-1;
				$xz=")";
			}else {
				$zx="";
				$sel=$sel;
				$xz="";
			}			
			$selisih = number_format($sel,2,',','.');	

			if($real <> 0){
				$per   = ($real)?($real/$angg) * 100:0; 
			}else if($real==0){
				$per=0;
			}else{
				$per=100;
			}
			$persen = number_format($per,"2",",",".");			
			
 			if((strlen($kode1)<=2)){
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$nor</td>
						 <td width=\"49%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"><b>$uraian</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$anggaran</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$realisasi</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$zx$selisih$xz</b></td>
						 <td width=\"5%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$persen</b></td>
					</tr>";
			}else{
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$nor</td>
						 <td width=\"49%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$uraian</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$anggaran</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$realisasi</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$zx$selisih$xz</td>
						 <td width=\"5%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$persen</td>
					</tr>";					
			}

		}
		$sqltp="SELECT
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,1)='5') AS totangg,		
					((SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
						INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
						WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2','3') AND LEFT(b.kd_rek5,1)='5')+
					(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
						INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
						WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('4','5','6') AND LEFT(b.kd_rek5,1)='5')+
					(SELECT IFNULL(SUM(b.rupiah*-1),0)
							FROM trdkasin_pkd b INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
							WHERE c.jns_trans=5 AND LEFT(b.kd_rek5,1)=5 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,1)='5')				
					)AS totreal";
		$sqlp=$this->db->query($sqltp);
		foreach ($sqlp->result() as $rowp){
		   $totangg1 = number_format($rowp->totangg,"2",",",".");
		   $totreal1 = number_format($rowp->totreal,"2",",",".");
		   $rumus2   = $rowp->totreal - $rowp->totangg;                   
		   //$rumus2   = $rowp->totangg-$rowp->totreal; 
		   
		   if ($rumus2 < 0){
				$x1="(";
				$rumus2=$rumus2*-1;
				$y1=")";
			}else {
				$x1="";
				$rumus2=$rumus2;
				$y1="";
			}
			$total2 = number_format($rumus2,"2",",",".");     

			if($rowp->totreal <> 0){
				$perx   = ($rowp->totreal!=0)?($rowp->totreal/$rowp->totangg) * 100:0; 
			}else if($rowp->totreal==0){
				$perx=0;
			}else{
				$perx=100;
			}
			$persenbel = number_format($perx,"2",",",".");				
			
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"></td>
						 <td width=\"49%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"justify\"><b>Jumlah Belanja</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$totangg1</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$totreal1</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$x1$total2$y1</b></td>
						 <td width=\"5%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$persenbel</b></td>
					</tr>";
		}
//surplus
		$sqltp="SELECT
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,1)='4') AS totanggpend,		
					((SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
						INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
						WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,1)='4')+
						(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,1)='4')				
						)AS totrealpend,		
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,1)='5') AS totanggbel,		
					((SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
						INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
						WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2','3') AND LEFT(b.kd_rek5,1)='5')+
					(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
						INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
						WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('4','5','6') AND LEFT(b.kd_rek5,1)='5')+
					(SELECT IFNULL(SUM(b.rupiah*-1),0)
							FROM trdkasin_pkd b INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
							WHERE c.jns_trans=5 AND LEFT(b.kd_rek5,1)=5 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,1)='5')				
					)AS totrealbel";
		$sqlp=$this->db->query($sqltp);
		foreach ($sqlp->result() as $rowp){
		   $surplus   = $rowp->totanggpend - $rowp->totanggbel;                   
		   if ($surplus < 0){
				$qw="(";
				$surplus=$surplus*-1;
				$wq=")";
			}else {
				$qw="";
				$surplus=$surplus;
				$wq="";
			}
			$surplus1 = number_format($surplus,"2",",","."); 
			
		   $surplus2   = $rowp->totrealpend - $rowp->totrealbel;                   
		   if ($surplus2 < 0){
				$we="(";
				$surplus2=$surplus2*-1;
				$ew=")";
			}else {
				$we="";
				$surplus2=$surplus2;
				$ew="";
			}
			$surplus3 = number_format($surplus2,"2",",","."); 			
			
		   $surplus4   = $surplus2 - $surplus;                   
		   //$surplus4   = $surplus-$surplus2;
		   if ($surplus4 < 0){
				$er="(";
				$surplus4=$surplus4*-1;
				$re=")";
			}else {
				$er="";
				$surplus4=$surplus4;
				$re="";
			}
			$surplus5 = number_format($surplus4,"2",",","."); 				
			
			if($surplus2 <> 0){
				$per1x   = ($surplus2!=0)?($surplus2/$surplus) * 100:0; 
			}else if($surplus2==0){
				$per1x=0;
			}else{
				$per1x=100;
			}
			$persensurplus = number_format($per1x,"2",",",".");	
			
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"></td>
						 <td width=\"49%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"justify\"><b>Surplus/(Defisit)</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$qw$surplus1$wq</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$we$surplus3$ew</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$er$surplus5$re</b></td>
						 <td width=\"5%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$persensurplus</b></td>
					</tr>";
		}		
//pembymasuk
        $sqlww = $this->db->query("SELECT * FROM(
								SELECT lra,kd_rek1 AS kode,nm_rek1 AS nama,
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,1)=e.kd_rek1) AS angg,
								(SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
									INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
									WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,1)=e.kd_rek1)+
								(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,1)=e.kd_rek1)				
								AS reali
								FROM ms_rek1 e WHERE LEFT(kd_rek1,1)='6'
								UNION
								SELECT lra,kd_rek2 AS kode,nm_rek2 AS nama, 
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,2)=w.kd_rek2) AS angg,
								(SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
									INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
									WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)=w.kd_rek2)+
								(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,2)=w.kd_rek2)				
								AS reali
								FROM ms_rek2 w WHERE LEFT(kd_rek2,2)='61'
								UNION
								SELECT lra,kd_rek3 AS kode,nm_rek3 AS nama, 
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,3)=q.kd_rek3) AS angg,
								(SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
									INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
									WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,3)=q.kd_rek3)+
								(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,3)=q.kd_rek3)			
								AS reali
								FROM ms_rek3 q WHERE LEFT(kd_rek3,2)='61'
								)a ORDER BY kode");
        foreach($sqlww->result() as $roww){
            $nor	= $roww->lra;
            $uraian	= $roww->nama;
            $kode1	= $roww->kode;
			$angg	= $roww->angg;
			$anggaran = number_format($angg,2,',','.');
			$real	= $roww->reali;
			$realisasi = number_format($real,2,',','.');
			$sel	= $real-$angg;
			//$sel	= $angg-$real;
			
			if ($sel < 0){
				$zx="(";
				$sel=$sel*-1;
				$xz=")";
			}else {
				$zx="";
				$sel=$sel;
				$xz="";
			}			
			$selisih = number_format($sel,2,',','.');	

			if($real <> 0){
				$per   = ($real)?($real/$angg) * 100:0; 
			}else if($real==0){
				$per=0;
			}else{
				$per=100;
			}
			$persen = number_format($per,"2",",",".");			
			
 			if((strlen($kode1)<=2)){
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$nor</td>
						 <td width=\"49%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"><b>$uraian</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$anggaran</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$realisasi</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$zx$selisih$xz</b></td>
						 <td width=\"5%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$persen</b></td>
					</tr>";
			}else{
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$nor</td>
						 <td width=\"49%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$uraian</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$anggaran</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$realisasi</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$zx$selisih$xz</td>
						 <td width=\"5%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$persen</td>
					</tr>";					
			}

		}
		$sqltp="SELECT
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,2)='61') AS totangg,
					(SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
						INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
						WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)='61')+
					(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,2)='61')				
					AS totreal";
		$sqlp=$this->db->query($sqltp);
		foreach ($sqlp->result() as $rowp){
		   $totangg1 = number_format($rowp->totangg,"2",",",".");
		   $totreal1 = number_format($rowp->totreal,"2",",",".");
		   $rumus2   = $rowp->totreal - $rowp->totangg;                   
		   //$rumus2   = $rowp->totangg-$rowp->totreal;
		   
		   if ($rumus2 < 0){
				$x1="(";
				$rumus2=$rumus2*-1;
				$y1=")";
			}else {
				$x1="";
				$rumus2=$rumus2;
				$y1="";
			}
			$total2 = number_format($rumus2,"2",",",".");     

			if($rowp->totreal <> 0){
				$per2x   = ($rowp->totreal!=0)?($rowp->totreal/$rowp->totangg) * 100:0; 
			}else if($rowp->totreal==0){
				$per2x=0;
			}else{
				$per2x=100;
			}
			$persenbymsk = number_format($per2x,"2",",",".");				
			
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"></td>
						 <td width=\"49%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"justify\"><b>Jumlah Penerimaan Pembiayaan</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$totangg1</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$totreal1</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$x1$total2$y1</b></td>
						 <td width=\"5%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$persenbymsk</b></td>
					</tr>";
		}
//pembykeluar
        $sqlww = $this->db->query("SELECT * FROM(
								SELECT lra,kd_rek2 AS kode,nm_rek2 AS nama, 
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,2)=w.kd_rek2) AS angg,
								(SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
									INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
									WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2','3') AND LEFT(b.kd_rek5,2)=w.kd_rek2)+
								(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
									INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
									WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('4','5','6') AND LEFT(b.kd_rek5,2)=w.kd_rek2)				
								AS reali
								FROM ms_rek2 w WHERE LEFT(kd_rek2,2)='62'
								UNION
								SELECT lra,kd_rek3 AS kode,nm_rek3 AS nama, 
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,3)=q.kd_rek3) AS angg,
								(SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
									INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
									WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2','3') AND LEFT(b.kd_rek5,3)=q.kd_rek3)+
								(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
									INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
									WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('4','5','6') AND LEFT(b.kd_rek5,3)=q.kd_rek3)			
								AS reali
								FROM ms_rek3 q WHERE LEFT(kd_rek3,2)='62'
								)a ORDER BY kode");
        foreach($sqlww->result() as $roww){
            $nor	= $roww->lra;
            $uraian	= $roww->nama;
            $kode1	= $roww->kode;
			$angg	= $roww->angg;
			$anggaran = number_format($angg,2,',','.');
			$real	= $roww->reali;
			$realisasi = number_format($real,2,',','.');
			$sel	= $real-$angg;
			//$sel	= $angg-$real;
						
			if ($sel < 0){
				$zx="(";
				$sel=$sel*-1;
				$xz=")";
			}else {
				$zx="";
				$sel=$sel;
				$xz="";
			}			
			$selisih = number_format($sel,2,',','.');

			if($real <> 0){
				$per   = ($real)?($real/$angg) * 100:0; 
			}else if($real==0){
				$per=0;
			}else{
				$per=100;
			}
			$persen = number_format($per,"2",",",".");			
			
 			if((strlen($kode1)<=2)){
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$nor</td>
						 <td width=\"49%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"><b>$uraian</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$anggaran</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$realisasi</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$zx$selisih$xz</b></td>
						 <td width=\"5%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$persen</b></td>
					</tr>";
			}else{
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$nor</td>
						 <td width=\"49%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$uraian</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$anggaran</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$realisasi</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$zx$selisih$xz</td>
						 <td width=\"5%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$persen</td>
					</tr>";					
			}

		}
		
		$sqltp="SELECT
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,2)='62') AS totangg,		
					(SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
						INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
						WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2','3') AND LEFT(b.kd_rek5,2)='62')+
					(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
						INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
						WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('4','5','6') AND LEFT(b.kd_rek5,2)='62')		
					AS totreal";
		$sqlp=$this->db->query($sqltp);
		foreach ($sqlp->result() as $rowp){
		   $totangg2 = number_format($rowp->totangg,"2",",",".");
		   $totreal2 = number_format($rowp->totreal,"2",",",".");
		   $rumus3   = $rowp->totreal - $rowp->totangg;                   
		   //$rumus3   = $rowp->totangg-$rowp->totreal;  
		   
		   if ($rumus3 < 0){
				$x1="(";
				$rumus3=$rumus3*-1;
				$y1=")";
			}else {
				$x1="";
				$rumus3=$rumus3;
				$y1="";
			}
			$total3 = number_format($rumus3,"2",",",".");     

			if($rowp->totreal <> 0){
				$per3x   = ($rowp->totreal!=0)?($rowp->totreal/$rowp->totangg) * 100:0; 
			}else if($rowp->totreal==0){
				$per3x=0;
			}else{
				$per3x=100;
			}
			$persenbykel = number_format($per3x,"2",",",".");			
			
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"></td>
						 <td width=\"49%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"justify\"><b>Jumlah Pengeluaran Pembiayaan</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$totangg2</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$totreal2</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$x1$total3$y1</b></td>
						 <td width=\"5%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$persenbykel</b></td>
					</tr>";
		}
//netto
		$sqltp="SELECT
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,2)='61') AS totanggmsk,
					(SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
						INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
						WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)='61')+
					(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,2)='61')				
					AS totrealmsk,
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,2)='62') AS totanggkel,		
					(SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
						INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
						WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2','3') AND LEFT(b.kd_rek5,2)='62')+
					(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
						INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
						WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('4','5','6') AND LEFT(b.kd_rek5,2)='62')		
					AS totrealkel";
		$sqlp=$this->db->query($sqltp);
		foreach ($sqlp->result() as $rowp){
		   $netto   = $rowp->totanggmsk - $rowp->totanggkel;                   
		   if ($netto < 0){
				$po="(";
				$netto=$netto*-1;
				$op=")";
			}else {
				$po="";
				$netto=$netto;
				$op="";
			}
			$netto1 = number_format($netto,"2",",","."); 
			
		   $netto2   = $rowp->totrealmsk - $rowp->totrealkel;                   
		   if ($netto2 < 0){
				$oi="(";
				$netto2=$netto2*-1;
				$io=")";
			}else {
				$oi="";
				$netto2=$netto2;
				$io="";
			}
			$netto3 = number_format($netto2,"2",",","."); 			
			
		   $netto4   = $netto2 - $netto;                   
		   //$netto4   = $netto-$netto2; 
		   if ($netto4 < 0){
				$iu="(";
				$netto4=$netto4*-1;
				$ui=")";
			}else {
				$iu="";
				$netto4=$netto4;
				$ui="";
			}
			$netto5 = number_format($netto4,"2",",","."); 	    

			if($netto2 <> 0){
				$per4x   = ($netto2!=0)?($netto2/$netto) * 100:0; 
			}else if($netto2==0){
				$per4x=100;
			}else{
				$per4x=0;
			}
			$persennetto4 = number_format($per4x,"2",",",".");			
			
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"></td>
						 <td width=\"49%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"justify\"><b>Pembiayaan Netto</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$po$netto1$op</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$oi$netto3$io</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$iu$netto5$ui</b></td>
						 <td width=\"5%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$persennetto4</b></td>
					</tr>";
		}
//silpa
		$sqltp="SELECT
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,1)='4') AS totanggpend,		
					((SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
						INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
						WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,1)='4')+
						(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,1)='4')				
						)AS totrealpend,		
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,1)='5') AS totanggbel,		
					((SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
						INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
						WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2','3') AND LEFT(b.kd_rek5,1)='5')+
					(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
						INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
						WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('4','5','6') AND LEFT(b.kd_rek5,1)='5')+
					(SELECT IFNULL(SUM(b.rupiah*-1),0)
							FROM trdkasin_pkd b INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
							WHERE c.jns_trans=5 AND LEFT(b.kd_rek5,1)=5 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,1)='5')				
					)AS totrealbel,		
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,2)='61') AS totanggmsk,
					(SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
						INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
						WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)='61')+
					(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,2)='61')				
					AS totrealmsk,
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,2)='62') AS totanggkel,		
					(SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
						INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
						WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2','3') AND LEFT(b.kd_rek5,2)='62')+
					(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
						INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
						WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('4','5','6') AND LEFT(b.kd_rek5,2)='62')		
					AS totrealkel";
		$sqlp=$this->db->query($sqltp);
		foreach ($sqlp->result() as $rowp){
		   $silpa   = ($rowp->totanggpend+$rowp->totanggmsk) - ($rowp->totanggbel+$rowp->totanggkel);                   
		   if ($silpa < 0){
				$rt="(";
				$silpa=$silpa*-1;
				$tr=")";
			}else {
				$rt="";
				$silpa=$silpa;
				$tr="";
			}
			$silpa1 = number_format($silpa,"2",",","."); 
			
		   $silpa2   = ($rowp->totrealpend+$rowp->totrealmsk) - ($rowp->totrealbel+$rowp->totrealkel);                   
		   if ($silpa2 < 0){
				$ty="(";
				$silpa2=$silpa2*-1;
				$yt=")";
			}else {
				$ty="";
				$silpa2=$silpa2;
				$yt="";
			}
			$silpa3 = number_format($silpa2,"2",",","."); 			
			
		   $silpa4   = $silpa - $silpa2;                   
		   if ($silpa4 < 0){
				$yu="(";
				$silpa4=$silpa4*-1;
				$uy=")";
			}else {
				$yu="";
				$silpa4=$silpa4;
				$uy="";
			}
			$silpa5 = number_format($silpa4,"2",",","."); 	
			
			if($silpa <> 0){
				$per5x   = ($silpa!=0)?($silpa4/$silpa) * 100:0; 
			}else if($silpa==0){
				$per5x=100;
			}else{
				$per5x=0;
			}
			$persensilpa = number_format($per5x,"2",",",".");
			
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"></td>
						 <td width=\"49%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"justify\"><b>Sisa Lebih Pembiayaan Anggaran Tahun Berkenaan</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$rt$silpa1$tr</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$ty$silpa3$yt</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$yu$silpa5$uy</b></td>
						 <td width=\"5%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$persensilpa</b></td>
					</tr>";
		}		

        $cRet .='</table>';
		$cRet .="<table style=\"border-collapse:collapse; font-size:12;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"1\" cellpadding=\"4\">
                <tr>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">$daerah, tanggal ".$this->tanggal_format_indonesia($tgl_ttd)."</td>                                                                                                                                                                                
                </tr>
                <tr>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">$jabatan</td>
                </tr>
                <tr>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                </tr>
                <tr>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                </tr>
                <tr>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                </tr>
                <tr>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                </tr>
                <tr>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">$nama</td>
                </tr>
                <tr>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">$nip</td>
                </tr>";                    

         $cRet .='</table>';		
        $data['prev']= $cRet;
        $this->_mpdf1('',$cRet,'5','5',5,'0');  
    }

	
	
	
	function cetak_lra_real1(){
        $nbulan	= $_REQUEST['nbulan'];
		$bulan	= $this->tukd_model->getBulan($nbulan);
        $tgl_ttd= $_REQUEST['tgl_ttd'];
        $thn_ang= $this->session->userdata('pcThang');
		$kdskpd = $this->session->userdata('kdskpd');

		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
		$sqlsclient=$this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc){
			$kab     = $rowsc->kab_kota;
			$daerah  = $rowsc->daerah;
			$thn     = $rowsc->thn_ang;
		}
		
        $sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$kdskpd' and kode='PA'";
		$sqlttd=$this->db->query($sqlttd1);
		foreach ($sqlttd->result() as $rowttd){
			$nip	 = $rowttd->nip;                    
			$nama	 = $rowttd->nm;
			$jabatan = $rowttd->jab;
		}		

        $cRet = '';
        $cRet = "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"1\" cellpadding=\"1\">";
        $cRet .="<tr>
					<td align=\"center\" style=\"font-size:14px;\"><b>PEMERINTAH $kab<br>LAPORAN REALISASI ANGGARAN</b></td>
				 </tr>
				 <tr>
					<td align=\"center\" style=\"font-size:14px;\"><b>Bulan $bulan $thn_ang</b></td>        
				 </tr>
				 <tr>
					<td align=\"left\" style=\"font-size:12px;\" colspan=\"2\">&nbsp;</td> 
				 </tr>
				</table>";
			
        $cRet .="<table style=\"border-collapse:collapse; font-size:14;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"4\">
				<thead>
					<tr>
						<td rowspan=\"2\" width=\"1%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>NO<b></td>
						<td rowspan=\"2\" width=\"49%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Uraian</b></td>
						<td colspan=\"2\" width=\"30%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Jumlah (Rp)<b></td>
						<td rowspan=\"2\" width=\"15%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Berambah/<br>(Berkurang)<b></td>
						<td rowspan=\"2\" width=\"5%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>%<b></td>
					</tr>
					<tr>
						<td width=\"15%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Anggaran<b></td>
						<td width=\"15%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Realisasi</b></td>
					</tr>
					<tr>
						<td width=\"1%\" bgcolor=\"#CCCCCC\" align=\"center\">1</td>
						<td width=\"49%\" bgcolor=\"#CCCCCC\" align=\"center\">2</td>
						<td width=\"15%\" bgcolor=\"#CCCCCC\" align=\"center\">3</td>
						<td width=\"15%\" bgcolor=\"#CCCCCC\" align=\"center\">4</td>
						<td width=\"15%\" bgcolor=\"#CCCCCC\" align=\"center\">5</td>
						<td width=\"5%\" bgcolor=\"#CCCCCC\" align=\"center\">6</td>
					</tr>
				</thead>
				<tfoot>
					<tr>
						<td colspan=\"6\" style=\"border-bottom:none;border-left:none;border-right:none;\"></td>
					</tr>
				</tfoot>
				<tr>
					<td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
					<td width=\"49%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
					<td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
					<td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
					<td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
					<td width=\"5%\" style=\"border-bottom:none;border-top:none\" align=\"center\"></td>
				</tr>";
//pendapatan				
        $sqlww = $this->db->query("SELECT * FROM(
								SELECT lra,kd_rek1 AS kode,nm_rek1 AS nama,
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,1)=e.kd_rek1) AS angg,
								(SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
									INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
									WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,1)=e.kd_rek1)+
								(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,1)=e.kd_rek1)				
								AS reali
								FROM ms_rek1 e WHERE LEFT(kd_rek1,1)='4'
								UNION
								SELECT lra,kd_rek2 AS kode,nm_rek2 AS nama, 
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,2)=w.kd_rek2) AS angg,
								(SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
									INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
									WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)=w.kd_rek2)+
								(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,2)=w.kd_rek2)				
								AS reali
								FROM ms_rek2 w WHERE LEFT(kd_rek2,1)='4'
								UNION
								SELECT lra,kd_rek3 AS kode,nm_rek3 AS nama, 
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,3)=q.kd_rek3) AS angg,
								(SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
									INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
									WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,3)=q.kd_rek3)+
								(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,3)=q.kd_rek3)			
								AS reali
								FROM ms_rek3 q WHERE LEFT(kd_rek3,1)='4'
								)a ORDER BY kode");
        foreach($sqlww->result() as $roww){
            $nor	= $roww->lra;
            $uraian	= $roww->nama;
            $kode1	= $roww->kode;
			$angg	= $roww->angg;
			$anggaran = number_format($angg,2,',','.');
			$real	= $roww->reali;
			$realisasi = number_format($real,2,',','.');
			//$sel	= $real-$angg;
			$sel	= $angg-$real;
			if ($sel < 0){
				$zx="(";
				$sel=$sel*-1;
				$xz=")";
			}else {
				$zx="";
				$sel=$sel;
				$xz="";
			}			
			$selisih = number_format($sel,2,',','.');
			
			if($real <> 0){
				$per   = ($real)?($real/$angg) * 100:0; 
			}else if($real==0){
				$per=0;
			}else{
				$per=100;
			}
			$persen = number_format($per,"2",",",".");
			
 			if((strlen($kode1)<=2)){
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$nor</td>
						 <td width=\"49%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"><b>$uraian</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$anggaran</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$realisasi</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$zx$selisih$xz</b></td>
						 <td width=\"5%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$persen</b></td>
					</tr>";
			}else{
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$nor</td>
						 <td width=\"49%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$uraian</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$anggaran</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$realisasi</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$zx$selisih$xz</td>
						 <td width=\"5%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$persen</td>
					</tr>";					
			}

		}
		$sqltp="SELECT
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,1)='4') AS totangg,		
					((SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
						INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
						WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,1)='4')+
						(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,1)='4')				
						)AS totreal";
		$sqlp=$this->db->query($sqltp);
		foreach ($sqlp->result() as $rowp){
		   $totangg1 = number_format($rowp->totangg,"2",",",".");
		   $totreal1 = number_format($rowp->totreal,"2",",",".");
		   //$rumus2   = $rowp->totreal - $rowp->totangg;                   
		   $rumus2   = $rowp->totangg-$rowp->totreal; 
		   
		   if ($rumus2 < 0){
				$x1="(";
				$rumus2=$rumus2*-1;
				$y1=")";
			}else {
				$x1="";
				$rumus2=$rumus2;
				$y1="";
			}
			$total2 = number_format($rumus2,"2",",",".");     

			if($rowp->totreal <> 0){
				$perx   = ($rowp->totreal!=0)?($rowp->totreal/$rowp->totangg) * 100:0; 
			}else if($rowp->totreal==0){
				$perx=0;
			}else{
				$perx=100;
			}
			$persenpen = number_format($perx,"2",",",".");				
			
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"></td>
						 <td width=\"49%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"justify\"><b>Jumlah Pendapatan</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$totangg1</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$totreal1</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$x1$total2$y1</b></td>
						 <td width=\"5%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$persenpen</b></td>
					</tr>";
		}		
//belanja
        $sqlww = $this->db->query("SELECT * FROM(
								SELECT lra,kd_rek1 AS kode,nm_rek1 AS nama,
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,1)=e.kd_rek1) AS angg,
								(SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
									INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
									WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2') AND LEFT(b.kd_rek5,1)=e.kd_rek1)+
								(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
									INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
									WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('3','4','5','6') AND LEFT(b.kd_rek5,1)=e.kd_rek1)+
								(SELECT IFNULL(SUM(b.rupiah*-1),0)
										FROM trdkasin_pkd b INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
										WHERE c.jns_trans=5 AND LEFT(b.kd_rek5,1)=5 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,1)=e.kd_rek1)			
								AS reali
								FROM ms_rek1 e WHERE LEFT(kd_rek1,1)='5'
								UNION
								SELECT lra,kd_rek2 AS kode,nm_rek2 AS nama, 
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,2)=w.kd_rek2) AS angg,
								(SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
									INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
									WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2') AND LEFT(b.kd_rek5,2)=w.kd_rek2)+
								(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
									INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
									WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('3','4','5','6') AND LEFT(b.kd_rek5,2)=w.kd_rek2)+
								(SELECT IFNULL(SUM(b.rupiah*-1),0)
										FROM trdkasin_pkd b INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
										WHERE c.jns_trans=5 AND LEFT(b.kd_rek5,1)=5 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)=w.kd_rek2)			
								AS reali
								FROM ms_rek2 w WHERE LEFT(kd_rek2,1)='5'
								UNION
								SELECT lra,kd_rek3 AS kode,nm_rek3 AS nama, 
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,3)=q.kd_rek3) AS angg,
								(SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
									INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
									WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2') AND LEFT(b.kd_rek5,3)=q.kd_rek3)+
								(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
									INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
									WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('3','4','5','6') AND LEFT(b.kd_rek5,3)=q.kd_rek3)+
								(SELECT IFNULL(SUM(b.rupiah*-1),0)
										FROM trdkasin_pkd b INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
										WHERE c.jns_trans=5 AND LEFT(b.kd_rek5,1)=5 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,3)=q.kd_rek3)		
								AS reali
								FROM ms_rek3 q WHERE LEFT(kd_rek3,1)='5'
								)a ORDER BY kode");
        foreach($sqlww->result() as $roww){
            $nor	= $roww->lra;
            $uraian	= $roww->nama;
            $kode1	= $roww->kode;
			$angg	= $roww->angg;
			$anggaran = number_format($angg,2,',','.');
			$real	= $roww->reali;
			$realisasi = number_format($real,2,',','.');
			//$sel	= $real-$angg;
			$sel	= $angg-$real;
			
			if ($sel < 0){
				$zx="(";
				$sel=$sel*-1;
				$xz=")";
			}else {
				$zx="";
				$sel=$sel;
				$xz="";
			}			
			$selisih = number_format($sel,2,',','.');	

			if($real <> 0){
				$per   = ($real)?($real/$angg) * 100:0; 
			}else if($real==0){
				$per=0;
			}else{
				$per=100;
			}
			$persen = number_format($per,"2",",",".");			
			
 			if((strlen($kode1)<=2)){
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$nor</td>
						 <td width=\"49%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"><b>$uraian</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$anggaran</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$realisasi</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$zx$selisih$xz</b></td>
						 <td width=\"5%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$persen</b></td>
					</tr>";
			}else{
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$nor</td>
						 <td width=\"49%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$uraian</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$anggaran</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$realisasi</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$zx$selisih$xz</td>
						 <td width=\"5%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$persen</td>
					</tr>";					
			}

		}
		$sqltp="SELECT
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,1)='5') AS totangg,		
					((SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
						INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
						WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2') AND LEFT(b.kd_rek5,1)='5')+
					(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
						INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
						WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('3','4','5','6') AND LEFT(b.kd_rek5,1)='5')+
					(SELECT IFNULL(SUM(b.rupiah*-1),0)
							FROM trdkasin_pkd b INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
							WHERE c.jns_trans=5 AND LEFT(b.kd_rek5,1)=5 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,1)='5')				
					)AS totreal";
		$sqlp=$this->db->query($sqltp);
		foreach ($sqlp->result() as $rowp){
		   $totangg1 = number_format($rowp->totangg,"2",",",".");
		   $totreal1 = number_format($rowp->totreal,"2",",",".");
		  // $rumus2   = $rowp->totreal - $rowp->totangg;                   
		   $rumus2   = $rowp->totangg-$rowp->totreal; 
		   
		   if ($rumus2 < 0){
				$x1="(";
				$rumus2=$rumus2*-1;
				$y1=")";
			}else {
				$x1="";
				$rumus2=$rumus2;
				$y1="";
			}
			$total2 = number_format($rumus2,"2",",",".");     

			if($rowp->totreal <> 0){
				$perx   = ($rowp->totreal!=0)?($rowp->totreal/$rowp->totangg) * 100:0; 
			}else if($rowp->totreal==0){
				$perx=0;
			}else{
				$perx=100;
			}
			$persenbel = number_format($perx,"2",",",".");				
			
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"></td>
						 <td width=\"49%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"justify\"><b>Jumlah Belanja</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$totangg1</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$totreal1</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$x1$total2$y1</b></td>
						 <td width=\"5%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$persenbel</b></td>
					</tr>";
		}
//surplus
		$sqltp="SELECT
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,1)='4') AS totanggpend,		
					((SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
						INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
						WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,1)='4')+
						(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,1)='4')				
						)AS totrealpend,		
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,1)='5') AS totanggbel,		
					((SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
						INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
						WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2') AND LEFT(b.kd_rek5,1)='5')+
					(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
						INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
						WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('3','4','5','6') AND LEFT(b.kd_rek5,1)='5')+
					(SELECT IFNULL(SUM(b.rupiah*-1),0)
							FROM trdkasin_pkd b INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
							WHERE c.jns_trans=5 AND LEFT(b.kd_rek5,1)=5 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,1)='5')				
					)AS totrealbel";
		$sqlp=$this->db->query($sqltp);
		foreach ($sqlp->result() as $rowp){
		   $surplus   = $rowp->totanggpend - $rowp->totanggbel;                   
		   if ($surplus < 0){
				$qw="(";
				$surplus=$surplus*-1;
				$wq=")";
			}else {
				$qw="";
				$surplus=$surplus;
				$wq="";
			}
			$surplus1 = number_format($surplus,"2",",","."); 
			
		   $surplus2   = $rowp->totrealpend - $rowp->totrealbel;                   
		   if ($surplus2 < 0){
				$we="(";
				$surplus2=$surplus2*-1;
				$ew=")";
			}else {
				$we="";
				$surplus2=$surplus2;
				$ew="";
			}
			$surplus3 = number_format($surplus2,"2",",","."); 			
			
		   //$surplus4   = $surplus2 - $surplus;                   
		   $surplus4   = $surplus-$surplus2;
		   if ($surplus4 < 0){
				$er="(";
				$surplus4=$surplus4*-1;
				$re=")";
			}else {
				$er="";
				$surplus4=$surplus4;
				$re="";
			}
			$surplus5 = number_format($surplus4,"2",",","."); 				
			
			if($surplus2 <> 0){
				$per1x   = ($surplus2!=0)?($surplus2/$surplus) * 100:0; 
			}else if($surplus2==0){
				$per1x=0;
			}else{
				$per1x=100;
			}
			$persensurplus = number_format($per1x,"2",",",".");	
			
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"></td>
						 <td width=\"49%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"justify\"><b>Surplus/(Defisit)</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$qw$surplus1$wq</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$we$surplus3$ew</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$er$surplus5$re</b></td>
						 <td width=\"5%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$persensurplus</b></td>
					</tr>";
		}		
//pembymasuk
        $sqlww = $this->db->query("SELECT * FROM(
								SELECT lra,kd_rek1 AS kode,nm_rek1 AS nama,
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,1)=e.kd_rek1) AS angg,
								(SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
									INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
									WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,1)=e.kd_rek1)+
								(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,1)=e.kd_rek1)				
								AS reali
								FROM ms_rek1 e WHERE LEFT(kd_rek1,1)='6'
								UNION
								SELECT lra,kd_rek2 AS kode,nm_rek2 AS nama, 
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,2)=w.kd_rek2) AS angg,
								(SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
									INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
									WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)=w.kd_rek2)+
								(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,2)=w.kd_rek2)				
								AS reali
								FROM ms_rek2 w WHERE LEFT(kd_rek2,2)='61'
								UNION
								SELECT lra,kd_rek3 AS kode,nm_rek3 AS nama, 
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,3)=q.kd_rek3) AS angg,
								(SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
									INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
									WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,3)=q.kd_rek3)+
								(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,3)=q.kd_rek3)			
								AS reali
								FROM ms_rek3 q WHERE LEFT(kd_rek3,2)='61'
								)a ORDER BY kode");
        foreach($sqlww->result() as $roww){
            $nor	= $roww->lra;
            $uraian	= $roww->nama;
            $kode1	= $roww->kode;
			$angg	= $roww->angg;
			$anggaran = number_format($angg,2,',','.');
			$real	= $roww->reali;
			$realisasi = number_format($real,2,',','.');
			//$sel	= $real-$angg;
			$sel	= $angg-$real;
			
			if ($sel < 0){
				$zx="(";
				$sel=$sel*-1;
				$xz=")";
			}else {
				$zx="";
				$sel=$sel;
				$xz="";
			}			
			$selisih = number_format($sel,2,',','.');	

			if($real <> 0){
				$per   = ($real)?($real/$angg) * 100:0; 
			}else if($real==0){
				$per=0;
			}else{
				$per=100;
			}
			$persen = number_format($per,"2",",",".");			
			
 			if((strlen($kode1)<=2)){
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$nor</td>
						 <td width=\"49%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"><b>$uraian</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$anggaran</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$realisasi</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$zx$selisih$xz</b></td>
						 <td width=\"5%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$persen</b></td>
					</tr>";
			}else{
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$nor</td>
						 <td width=\"49%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$uraian</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$anggaran</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$realisasi</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$zx$selisih$xz</td>
						 <td width=\"5%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$persen</td>
					</tr>";					
			}

		}
		$sqltp="SELECT
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,2)='61') AS totangg,
					(SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
						INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
						WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)='61')+
					(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,2)='61')				
					AS totreal";
		$sqlp=$this->db->query($sqltp);
		foreach ($sqlp->result() as $rowp){
		   $totangg1 = number_format($rowp->totangg,"2",",",".");
		   $totreal1 = number_format($rowp->totreal,"2",",",".");
		   //$rumus2   = $rowp->totreal - $rowp->totangg;                   
		   $rumus2   = $rowp->totangg-$rowp->totreal;
		   
		   if ($rumus2 < 0){
				$x1="(";
				$rumus2=$rumus2*-1;
				$y1=")";
			}else {
				$x1="";
				$rumus2=$rumus2;
				$y1="";
			}
			$total2 = number_format($rumus2,"2",",",".");     

			if($rowp->totreal <> 0){
				$per2x   = ($rowp->totreal!=0)?($rowp->totreal/$rowp->totangg) * 100:0; 
			}else if($rowp->totreal==0){
				$per2x=0;
			}else{
				$per2x=100;
			}
			$persenbymsk = number_format($per2x,"2",",",".");				
			
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"></td>
						 <td width=\"49%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"justify\"><b>Jumlah Penerimaan Pembiayaan</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$totangg1</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$totreal1</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$x1$total2$y1</b></td>
						 <td width=\"5%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$persenbymsk</b></td>
					</tr>";
		}
//pembykeluar
        $sqlww = $this->db->query("SELECT * FROM(
								SELECT lra,kd_rek2 AS kode,nm_rek2 AS nama, 
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,2)=w.kd_rek2) AS angg,
								(SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
									INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
									WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2') AND LEFT(b.kd_rek5,2)=w.kd_rek2)+
								(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
									INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
									WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('3','4','5','6') AND LEFT(b.kd_rek5,2)=w.kd_rek2)				
								AS reali
								FROM ms_rek2 w WHERE LEFT(kd_rek2,2)='62'
								UNION
								SELECT lra,kd_rek3 AS kode,nm_rek3 AS nama, 
								(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,3)=q.kd_rek3) AS angg,
								(SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
									INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
									WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2') AND LEFT(b.kd_rek5,3)=q.kd_rek3)+
								(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
									INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
									WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('3','4','5','6') AND LEFT(b.kd_rek5,3)=q.kd_rek3)			
								AS reali
								FROM ms_rek3 q WHERE LEFT(kd_rek3,2)='62'
								)a ORDER BY kode");
        foreach($sqlww->result() as $roww){
            $nor	= $roww->lra;
            $uraian	= $roww->nama;
            $kode1	= $roww->kode;
			$angg	= $roww->angg;
			$anggaran = number_format($angg,2,',','.');
			$real	= $roww->reali;
			$realisasi = number_format($real,2,',','.');
			//$sel	= $real-$angg;
			$sel	= $angg-$real;
						
			if ($sel < 0){
				$zx="(";
				$sel=$sel*-1;
				$xz=")";
			}else {
				$zx="";
				$sel=$sel;
				$xz="";
			}			
			$selisih = number_format($sel,2,',','.');

			if($real <> 0){
				$per   = ($real)?($real/$angg) * 100:0; 
			}else if($real==0){
				$per=0;
			}else{
				$per=100;
			}
			$persen = number_format($per,"2",",",".");			
			
 			if((strlen($kode1)<=2)){
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$nor</td>
						 <td width=\"49%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"><b>$uraian</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$anggaran</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$realisasi</b></td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$zx$selisih$xz</b></td>
						 <td width=\"5%\" style=\"border-bottom:none;border-top:none\" align=\"right\"><b>$persen</b></td>
					</tr>";
			}else{
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$nor</td>
						 <td width=\"49%\" style=\"border-bottom:none;border-top:none\" align=\"justify\">$uraian</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$anggaran</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$realisasi</td>
						 <td width=\"15%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$zx$selisih$xz</td>
						 <td width=\"5%\" style=\"border-bottom:none;border-top:none\" align=\"right\">$persen</td>
					</tr>";					
			}

		}
		
		$sqltp="SELECT
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,2)='62') AS totangg,		
					(SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
						INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
						WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2') AND LEFT(b.kd_rek5,2)='62')+
					(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
						INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
						WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('3','4','5','6') AND LEFT(b.kd_rek5,2)='62')		
					AS totreal";
		$sqlp=$this->db->query($sqltp);
		foreach ($sqlp->result() as $rowp){
		   $totangg2 = number_format($rowp->totangg,"2",",",".");
		   $totreal2 = number_format($rowp->totreal,"2",",",".");
		  // $rumus3   = $rowp->totreal - $rowp->totangg;                   
		   $rumus3   = $rowp->totangg-$rowp->totreal;  
		   
		   if ($rumus3 < 0){
				$x1="(";
				$rumus3=$rumus3*-1;
				$y1=")";
			}else {
				$x1="";
				$rumus3=$rumus3;
				$y1="";
			}
			$total3 = number_format($rumus3,"2",",",".");     

			if($rowp->totreal <> 0){
				$per3x   = ($rowp->totreal!=0)?($rowp->totreal/$rowp->totangg) * 100:0; 
			}else if($rowp->totreal==0){
				$per3x=0;
			}else{
				$per3x=100;
			}
			$persenbykel = number_format($per3x,"2",",",".");			
			
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"></td>
						 <td width=\"49%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"justify\"><b>Jumlah Pengeluaran Pembiayaan</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$totangg2</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$totreal2</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$x1$total3$y1</b></td>
						 <td width=\"5%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$persenbykel</b></td>
					</tr>";
		}
//netto
		$sqltp="SELECT
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,2)='61') AS totanggmsk,
					(SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
						INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
						WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)='61')+
					(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,2)='61')				
					AS totrealmsk,
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,2)='62') AS totanggkel,		
					(SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
						INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
						WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2') AND LEFT(b.kd_rek5,2)='62')+
					(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
						INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
						WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('3','4','5','6') AND LEFT(b.kd_rek5,2)='62')		
					AS totrealkel";
		$sqlp=$this->db->query($sqltp);
		foreach ($sqlp->result() as $rowp){
		   $netto   = $rowp->totanggmsk - $rowp->totanggkel;                   
		   if ($netto < 0){
				$po="(";
				$netto=$netto*-1;
				$op=")";
			}else {
				$po="";
				$netto=$netto;
				$op="";
			}
			$netto1 = number_format($netto,"2",",","."); 
			
		   $netto2   = $rowp->totrealmsk - $rowp->totrealkel;                   
		   if ($netto2 < 0){
				$oi="(";
				$netto2=$netto2*-1;
				$io=")";
			}else {
				$oi="";
				$netto2=$netto2;
				$io="";
			}
			$netto3 = number_format($netto2,"2",",","."); 			
			
		   //$netto4   = $netto2 - $netto;                   
		   $netto4   = $netto-$netto2; 
		   if ($netto4 < 0){
				$iu="(";
				$netto4=$netto4*-1;
				$ui=")";
			}else {
				$iu="";
				$netto4=$netto4;
				$ui="";
			}
			$netto5 = number_format($netto4,"2",",","."); 	    

			if($netto2 <> 0){
				$per4x   = ($netto2!=0)?($netto2/$netto) * 100:0; 
			}else if($netto2==0){
				$per4x=100;
			}else{
				$per4x=0;
			}
			$persennetto4 = number_format($per4x,"2",",",".");			
			
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"></td>
						 <td width=\"49%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"justify\"><b>Pembiayaan Netto</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$po$netto1$op</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$oi$netto3$io</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$iu$netto5$ui</b></td>
						 <td width=\"5%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$persennetto4</b></td>
					</tr>";
		}
//silpa
		$sqltp="SELECT
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,1)='4') AS totanggpend,		
					((SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
						INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
						WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,1)='4')+
						(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,1)='4')				
						)AS totrealpend,		
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,1)='5') AS totanggbel,		
					((SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
						INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
						WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2') AND LEFT(b.kd_rek5,1)='5')+
					(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
						INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
						WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('3','4','5','6') AND LEFT(b.kd_rek5,1)='5')+
					(SELECT IFNULL(SUM(b.rupiah*-1),0)
							FROM trdkasin_pkd b INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
							WHERE c.jns_trans=5 AND LEFT(b.kd_rek5,1)=5 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,1)='5')				
					)AS totrealbel,		
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,2)='61') AS totanggmsk,
					(SELECT IFNULL(SUM(b.rupiah),0)	FROM trdkasin_pkd b 
						INNER JOIN trhkasin_pkd c ON b.no_sts=c.no_sts AND b.kd_skpd=c.kd_skpd
						WHERE c.jns_trans=4 AND MONTH(c.tgl_sts)<='$nbulan' AND LEFT(b.kd_rek5,2)='61')+
					(SELECT IFNULL(SUM(nilai),0) FROM tr_terima_ppkd WHERE MONTH(tgl_terima)<='$nbulan' AND LEFT(kd_rek5,2)='61')				
					AS totrealmsk,
					(SELECT IFNULL(SUM(nilai_ubah),0) FROM trdrka WHERE LEFT(kd_rek5,2)='62') AS totanggkel,		
					(SELECT IFNULL(SUM(b.nilai),0) FROM trdtransout b 
						INNER JOIN trhtransout c ON b.no_bukti=c.no_bukti
						WHERE MONTH(c.tgl_bukti)<='$nbulan' AND c.jns_spp IN('1','2') AND LEFT(b.kd_rek5,2)='62')+
					(SELECT IFNULL(SUM(b.nilai),0) FROM trdspp b 
						INNER JOIN trhsp2d c ON b.no_spp=c.no_spp
						WHERE MONTH(c.tgl_sp2d)<='$nbulan' AND c.jns_spp IN('3','4','5','6') AND LEFT(b.kd_rek5,2)='62')		
					AS totrealkel";
		$sqlp=$this->db->query($sqltp);
		foreach ($sqlp->result() as $rowp){
		   $silpa   = ($rowp->totanggpend+$rowp->totanggmsk) - ($rowp->totanggbel+$rowp->totanggkel);                   
		   if ($silpa < 0){
				$rt="(";
				$silpa=$silpa*-1;
				$tr=")";
			}else {
				$rt="";
				$silpa=$silpa;
				$tr="";
			}
			$silpa1 = number_format($silpa,"2",",","."); 
			
		   $silpa2   = ($rowp->totrealpend+$rowp->totrealmsk) - ($rowp->totrealbel+$rowp->totrealkel);                   
		   if ($silpa2 < 0){
				$ty="(";
				$silpa2=$silpa2*-1;
				$yt=")";
			}else {
				$ty="";
				$silpa2=$silpa2;
				$yt="";
			}
			$silpa3 = number_format($silpa2,"2",",","."); 			
			
		   $silpa4   = $silpa - $silpa2;                   
		   if ($silpa4 < 0){
				$yu="(";
				$silpa4=$silpa4*-1;
				$uy=")";
			}else {
				$yu="";
				$silpa4=$silpa4;
				$uy="";
			}
			$silpa5 = number_format($silpa4,"2",",","."); 	
			
			if($silpa <> 0){
				$per5x   = ($silpa!=0)?($silpa4/$silpa) * 100:0; 
			}else if($silpa==0){
				$per5x=100;
			}else{
				$per5x=0;
			}
			$persensilpa = number_format($per5x,"2",",",".");
			
			$cRet    .="<tr>
						 <td width=\"1%\" style=\"border-bottom:none;border-top:none\" align=\"justify\"></td>
						 <td width=\"49%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"justify\"><b>Sisa Lebih Pembiayaan Anggaran Tahun Berkenaan</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$rt$silpa1$tr</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$ty$silpa3$yt</b></td>
						 <td width=\"15%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$yu$silpa5$uy</b></td>
						 <td width=\"5%\" style=\"border-bottom:solid 1px black;border-top:solid 1px black\" align=\"right\"><b>$persensilpa</b></td>
					</tr>";
		}		

        $cRet .='</table>';
		$cRet .="<table style=\"border-collapse:collapse; font-size:12;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"1\" cellpadding=\"4\">
                <tr>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">$daerah, tanggal ".$this->tanggal_format_indonesia($tgl_ttd)."</td>                                                                                                                                                                                
                </tr>
                <tr>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">$jabatan</td>
                </tr>
                <tr>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                </tr>
                <tr>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                </tr>
                <tr>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                </tr>
                <tr>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                </tr>
                <tr>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">$nama</td>
                </tr>
                <tr>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
                    <td align=\"center\" width=\"50%\" style=\"border-bottom:none;border-top:none;\">$nip</td>
                </tr>";                    

         $cRet .='</table>';		
        $data['prev']= $cRet;
        $this->_mpdf1('',$cRet,'5','5',5,'0');  
    }


	
	
	
	
	function realisasiangg(){
        $data['page_title']= 'CETAK REALISASI ANGGAARAN';
        $this->template->set('title', 'CETAK REALISASI ANGGARAN');   
        $this->template->load('template','akuntansi/realisasiangg',$data) ;	
	}

	function cetak_realisasiangg_MURNI1(){
        $data['page_title']= 'CETAK REALISASI ANGGAARAN';
        $this->template->set('title', 'CETAK REALISASI ANGGARAN');   
        $this->template->load('template','akuntansi/cetak_realisasiangg_MURNI1',$data) ;	
	}

		function realisasiangg1(){
        $data['page_title']= 'CETAK REALISASI ANGGAARAN';
        $this->template->set('title', 'CETAK REALISASI ANGGARAN');   
        $this->template->load('template','akuntansi/realisasiangg1',$data) ;	
	}
	
	
	function cetak_realisasiangg(){
		$cetak = $this->uri->segment(3);
        $thn_ang	= $this->session->userdata('pcThang');
        $kd_skpd	= $_REQUEST['skpd'];

        $pilih = $_REQUEST['cpilih'];
        if($pilih==2){
            $keg=$_REQUEST['keg'];
        }
		
        $sqlsc = "SELECT kab_kota,daerah FROM sclient";
		$sqlsclient=$this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc){
			$kota   = $rowsc->kab_kota;
			$daerah = $rowsc->daerah;
		}

        $csql2 = "SELECT nm_skpd FROM ms_skpd WHERE kd_skpd = '$kd_skpd'";
            $hasil2   = $this->db->query($csql2);
            $trh4     = $hasil2->row();          
            $lcNmskpd = $trh4->nm_skpd;			

        $cRet = '';
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
					<tr>
						<td colspan=\"4\" align=\"center\" style=\"font-size:14px;border: solid 1px white;\"><b>PEMERINTAH $kota<br>LAPORAN REALISASI SP2D</b></td>
					</tr>			
					<tr>
						<td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
					</tr>
					<tr>
						<td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
					</tr>
					<tr>
						<td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
					</tr>
					<tr>
						<td width=\"5%\" align=\"left\" style=\"font-size:10px;border: solid 1px white;\">SKPD</td>
						<td width=\"95%\" align=\"left\" style=\"font-size:10px;border: solid 1px white;\">: $kd_skpd  $lcNmskpd</td>
					</tr>
					</table>";
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
            <thead>
			<tr>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"15%\" style=\"font-size:12px\">Kode</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"40%\" style=\"font-size:12px\">Uraian</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"15%\" style=\"font-size:12px\">Anggaran</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"15%\" style=\"font-size:12px\">Anggaran Ubah</td> 
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"5%\" style=\"font-size:12px\">SUMBER<BR> DANA</td> 
				<td bgcolor=\"#CCCCCC\" align=\"center\" width=\"15%\" style=\"font-size:12px\">Realisasi</td>
				<td bgcolor=\"#CCCCCC\" align=\"center\" width=\"15%\" style=\"font-size:12px\">Sisa Anggaran</td> 
				<td bgcolor=\"#CCCCCC\" align=\"center\" width=\"9%\" style=\"font-size:12px\">Persen (%)</td> 
            </tr> 		
            <tr>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">1</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">2</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">3</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">4</td>  
				<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">5</td>
				<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">6</td>
				<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">7</td>
				<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">8</td>
            </tr> 
			</thead>
			<tfoot>
				<tr><td style=\"border-bottom: none; border-left:none;border-right:none;\" colspan=\"8\"></td>
			</tfoot>            
            ";
			
 			
				if($pilih==1){
				/*	$sql = "SELECT * FROM(
							SELECT a.kd_program AS kode,a.nm_program AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,
							IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
							WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('3','4','5','6') 
							AND LEFT(p.kd_kegiatan,18)=a.kd_program),0)+
							IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
							WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2')
							AND LEFT(l.kd_kegiatan,18)=a.kd_program),0) AS reali
							FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
							WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5'
							GROUP BY a.kd_program
							UNION ALL	
							SELECT a.kd_kegiatan AS kode,a.nm_kegiatan AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,
							IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
							WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('3','4','5','6') 
							AND LEFT(p.kd_kegiatan,18)=a.kd_program AND p.kd_kegiatan=b.kd_kegiatan),0)+
							IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
							WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2') 
							AND LEFT(l.kd_kegiatan,18)=a.kd_program AND l.kd_kegiatan=b.kd_kegiatan),0) AS reali
							FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
							WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5'
							GROUP BY a.kd_kegiatan
							UNION ALL
							SELECT CONCAT(kd_kegiatan,'.',kd_rek5) AS kode,nm_rek5 AS nama,nilai as angg_m, nilai_ubah AS angg,
							IFNULL((SELECT SUM(a.nilai) FROM trdspp a INNER JOIN trhsp2d b ON a.no_spp=b.no_spp 
							WHERE b.kd_skpd='$kd_skpd' AND a.kd_skpd='$kd_skpd' AND b.jns_spp IN('3','4','5','6') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5
							GROUP BY kd_rek5,kd_kegiatan),0)+
							IFNULL((SELECT SUM(a.nilai) FROM trdtransout a INNER JOIN trhtransout b ON a.no_bukti=b.no_bukti 
							WHERE b.kd_skpd='$kd_skpd' AND SUBSTR(a.kd_kegiatan,6,10)='$kd_skpd' AND b.jns_spp IN('1','2') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5
							GROUP BY kd_rek5,kd_kegiatan),0) AS reali
							FROM trdrka q WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek5,1)='5'
							)z ORDER BY kode
					";  */    
					if($kd_skpd=='1.20.05.01'){
							$sql = "SELECT * FROM(
						SELECT a.kd_program AS kode,a.nm_program AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,'' AS SUMBER,
						IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
						WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('4','5','6') 
						AND LEFT(p.kd_kegiatan,18)=a.kd_program),0)+
						IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
						WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2','3','7')
						AND LEFT(l.kd_kegiatan,18)=a.kd_program),0) -
						(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program)+
						(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program)AS reali
						FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' OR LEFT(b.kd_rek5,2)='62'
						GROUP BY a.kd_program
						UNION ALL	
						SELECT a.kd_kegiatan AS kode,a.nm_kegiatan AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,B.SUMBER_UBAH AS SUMBER,
						IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
						WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('4','5','6') 
						AND LEFT(p.kd_kegiatan,18)=a.kd_program AND p.kd_kegiatan=b.kd_kegiatan),0)+
						IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
						WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2','3','7') 
						AND LEFT(l.kd_kegiatan,18)=a.kd_program AND l.kd_kegiatan=b.kd_kegiatan),0) -
						(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program AND kd_kegiatan=b.kd_kegiatan)+
						(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program AND kd_kegiatan=b.kd_kegiatan) AS reali
						FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' OR LEFT(b.kd_rek5,2)='62'
						GROUP BY a.kd_kegiatan
						UNION ALL
						SELECT CONCAT(kd_kegiatan,'.',kd_rek5) AS kode,nm_rek5 AS nama,nilai AS angg_m, nilai_ubah AS angg,'' AS SUMBER,
						IFNULL((SELECT SUM(a.nilai) FROM trdspp a INNER JOIN trhsp2d b ON a.no_spp=b.no_spp 
						WHERE b.kd_skpd='$kd_skpd' AND a.kd_skpd='$kd_skpd' AND b.jns_spp IN('4','5','6') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5
						GROUP BY kd_rek5,kd_kegiatan),0)+
						IFNULL((SELECT SUM(a.nilai) FROM trdtransout a INNER JOIN trhtransout b ON a.no_bukti=b.no_bukti 
						WHERE b.kd_skpd='$kd_skpd' AND SUBSTR(a.kd_kegiatan,6,10)='$kd_skpd' AND b.jns_spp IN('1','2','3','7') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5
						GROUP BY kd_rek5,kd_kegiatan),0)   - 
						(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd'  AND kd_kegiatan=q.kd_kegiatan AND kk.kd_rek5=q.kd_rek5)+
						(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND kd_kegiatan=q.kd_kegiatan AND kk.kd_rek5=q.kd_rek5)
						AS reali
						FROM trdrka q WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek5,1)='5' OR LEFT(kd_rek5,2)='62'
						)z ORDER BY kode";          
    				}else{
    					$sql = "SELECT * FROM(
						SELECT a.kd_program AS kode,a.nm_program AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,'' AS SUMBER,
						IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
						WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('4','5','6') 
						AND LEFT(p.kd_kegiatan,18)=a.kd_program),0)+
						IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
						WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2','3','7')
						AND LEFT(l.kd_kegiatan,18)=a.kd_program),0) -
						(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program)+
						(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program)AS reali
						FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' 
						GROUP BY a.kd_program
						UNION ALL	
						SELECT a.kd_kegiatan AS kode,a.nm_kegiatan AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,B.SUMBER_UBAH AS SUMBER,
						IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
						WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('4','5','6') 
						AND LEFT(p.kd_kegiatan,18)=a.kd_program AND p.kd_kegiatan=b.kd_kegiatan),0)+
						IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
						WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2','3','7') 
						AND LEFT(l.kd_kegiatan,18)=a.kd_program AND l.kd_kegiatan=b.kd_kegiatan),0) -
						(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program AND kd_kegiatan=b.kd_kegiatan)+
						(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program AND kd_kegiatan=b.kd_kegiatan) AS reali
						FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' 
						GROUP BY a.kd_kegiatan
						UNION ALL
						SELECT CONCAT(kd_kegiatan,'.',kd_rek5) AS kode,nm_rek5 AS nama,nilai AS angg_m, nilai_ubah AS angg,'' AS SUMBER,
						IFNULL((SELECT SUM(a.nilai) FROM trdspp a INNER JOIN trhsp2d b ON a.no_spp=b.no_spp 
						WHERE b.kd_skpd='$kd_skpd' AND a.kd_skpd='$kd_skpd' AND b.jns_spp IN('4','5','6') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5
						GROUP BY kd_rek5,kd_kegiatan),0)+
						IFNULL((SELECT SUM(a.nilai) FROM trdtransout a INNER JOIN trhtransout b ON a.no_bukti=b.no_bukti 
						WHERE b.kd_skpd='$kd_skpd' AND SUBSTR(a.kd_kegiatan,6,10)='$kd_skpd' AND b.jns_spp IN('1','2','3','7') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5
						GROUP BY kd_rek5,kd_kegiatan),0)   - 
						(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd'  AND kd_kegiatan=q.kd_kegiatan AND kk.kd_rek5=q.kd_rek5)+
						(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND kd_kegiatan=q.kd_kegiatan AND kk.kd_rek5=q.kd_rek5)
						AS reali
						FROM trdrka q WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek5,1)='5'
						)z ORDER BY kode"; 
    				}

					$hasil = $this->db->query($sql);       
					$saldo=0;
					foreach ($hasil->result() as $row){
					   $kode  = $row->kode ;
					   $nama  = $row->nama;
					   $angg    = $row->angg; 
					   $reali   = $row->reali;
					   $angg_m    = $row->angg_m;
					   $SUMBER    = $row->SUMBER;
					   
					if($angg<0){
						$xy="("; 
						$angg=$angg*-1; 
						$yx=")";						   
					}else{
						$xy=""; 
						$angg=$angg*1; 
						$yx="";					   
					}
					$angg1 = number_format($angg,2,',','.');
					
					if($reali<0){
						$as="("; 
						$reali=$reali*-1; 
						$sa=")";						   
					}else{
						$as=""; 
						$reali=$reali*1; 
						$sa="";					   
					}
					$reali1 = number_format($reali,2,',','.');
					
					$sisa = $row->angg-$row->reali;
					if($sisa<0){
						$df="("; 
						$sisa=$sisa*-1; 
						$fd=")";						   
					}else{
						$df=""; 
						$sisa=$sisa*1; 
						$fd="";					   
					}
					$sisa1 = number_format($sisa,2,',','.');
					
					$reapers = $angg-$reali ;
					if($reapers == 0){
						if($angg == 0 and $reali == 0){
						$per5x=0;
						}else{
						$per5x   = 0;
						}					
					}else if($reapers < 0){
					$per5x= ($reali!=0)?($reapers/$angg) * 100:0; 
					}else if($reapers > 0){
					$per5x=($reapers/$angg) * 100;
					}else{
					$per5x=0;
					}

					if($per5x < 0){
						$xx="("; 
						$per5x=$per5x*-1; 
						$yy=")";						   
					}else{
						$xx=""; 
						$per5x=$per5x*1; 
						$yy="";					   
					}
					$persenrea = number_format($per5x,"2",",",".");
					
					if((strlen($kode)<=21)){
						$cRet .="<tr>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$kode</b></td>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$nama</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>".number_format($angg_m,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$xy$angg1$yx</b></td>
								  <td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$SUMBER</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$as$reali1$sa</b></td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$df$sisa1$fd</b></td>
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$xx$persenrea$yy</b></td>								  
								</tr>";
					}else{
						$cRet .="<tr>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$kode</td>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$nama</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">".number_format($angg_m,2,',','.')."</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$xy$angg1$yx</td>
								  <td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none\">$SUMBER</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$as$reali1$sa</td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$df$sisa1$fd</td> 
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$xx$persenrea$yy</td> 								  
								</tr>";   
					}					
					}
					if($kd_skpd=='1.20.05.01'){
					$sqltot="SELECT sum(angg_m)as tm,SUM(angg) AS tot, SUM(realix) AS treali FROM(
								SELECT a.kd_program AS kode,a.nm_program AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,
								IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
								WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('4','5','6') 
								AND LEFT(p.kd_kegiatan,18)=a.kd_program),0)+
								IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
								WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2','3','7')
								AND LEFT(l.kd_kegiatan,18)=a.kd_program),0) AS realix
								FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
								WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' OR LEFT(b.kd_rek5,2)='62'
								GROUP BY a.kd_program)cc";
						}else{
							$sqltot="SELECT sum(angg_m)as tm,SUM(angg) AS tot, SUM(realix) AS treali FROM(
								SELECT a.kd_program AS kode,a.nm_program AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,
								IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
								WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('4','5','6') 
								AND LEFT(p.kd_kegiatan,18)=a.kd_program),0)+
								IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
								WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2','3','7')
								AND LEFT(l.kd_kegiatan,18)=a.kd_program),0) AS realix
								FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
								WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5'
								GROUP BY a.kd_program)cc";
						}
							$hsl = $this->db->query($sqltot); 
							
							foreach ($hsl->result() as $row1){
					   			$totm=$row1->tm;
					   			$totangg    = $row1->tot; 
					   			$totreali   = $row1->treali;

					   			$rumus=$totangg-$totreali;

					   			if($totreali <> 0){
									$per5   = ($rumus!=0)?($rumus /$row1->tot) * 100:0; 
									}else if($totangg <> 0 and $totreali ==0){
										$per5=100;
									}else{
										$per5=0;
									}

                    			$persen5= number_format($per5,"2",".",",");
					   			
							}

							$cRet .="<tr>
								  <td valign=\"top\" colspan=\"2\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>TOTAL</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totm,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totangg,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totreali,2,',','.')."</b></td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($rumus,2,',','.')."</b></td> 
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($persen5,2,',','.')."</b></td> 								  
								</tr>";
					}else{
	$sql = "SELECT * FROM(
							SELECT a.kd_kegiatan AS kode,a.nm_kegiatan AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,B.SUMBER_UBAH AS SUMBER,
							IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
							WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('4','5','6') 
							AND LEFT(p.kd_kegiatan,18)=a.kd_program AND p.kd_kegiatan=b.kd_kegiatan),0)+
							IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
							WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2','3','7') 
							AND LEFT(l.kd_kegiatan,18)=a.kd_program AND l.kd_kegiatan=b.kd_kegiatan),0) AS reali
							FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
							WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' AND a.kd_kegiatan='$keg'
							GROUP BY a.kd_kegiatan
							UNION ALL
							SELECT CONCAT(kd_kegiatan,'.',kd_rek5) AS kode,nm_rek5 AS nama,nilai AS angg_m,nilai_ubah AS angg,''SUMBER,
							IFNULL((SELECT SUM(a.nilai) FROM trdspp a INNER JOIN trhsp2d b ON a.no_spp=b.no_spp 
							WHERE b.kd_skpd='$kd_skpd' AND a.kd_skpd='$kd_skpd' AND b.jns_spp IN('4','5','6') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5
							GROUP BY kd_rek5,kd_kegiatan),0)+
							IFNULL((SELECT SUM(a.nilai) FROM trdtransout a INNER JOIN trhtransout b ON a.no_bukti=b.no_bukti 
							WHERE b.kd_skpd='$kd_skpd' AND SUBSTR(a.kd_kegiatan,6,10)='$kd_skpd' AND b.jns_spp IN('1','2','3','7') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5
							GROUP BY kd_rek5,kd_kegiatan),0) - 
(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd'  AND kd_kegiatan=q.kd_kegiatan AND kk.kd_rek5=q.kd_rek5)+
(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND kd_kegiatan=q.kd_kegiatan AND kk.kd_rek5=q.kd_rek5)AS reali
FROM trdrka q WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek5,1)='5' AND kd_kegiatan='$keg'
							)z ORDER BY kode";          



					$hasil = $this->db->query($sql);       
					$saldo=0;
					foreach ($hasil->result() as $row){
					   $kode  = $row->kode ;
					   $nama  = $row->nama;
					   $angg    = $row->angg; 
					   $reali   = $row->reali;
					   $angg_m    = $row->angg_m;
					     $SUMBER    = $row->SUMBER;
					   
					if($angg<0){
						$xy="("; 
						$angg=$angg*-1; 
						$yx=")";						   
					}else{
						$xy=""; 
						$angg=$angg*1; 
						$yx="";					   
					}
					$angg1 = number_format($angg,2,',','.');
					
					if($reali<0){
						$as="("; 
						$reali=$reali*-1; 
						$sa=")";						   
					}else{
						$as=""; 
						$reali=$reali*1; 
						$sa="";					   
					}
					$reali1 = number_format($reali,2,',','.');
					
					$sisa = $row->angg-$row->reali;
					if($sisa<0){
						$df="("; 
						$sisa=$sisa*-1; 
						$fd=")";						   
					}else{
						$df=""; 
						$sisa=$sisa*1; 
						$fd="";					   
					}
					$sisa1 = number_format($sisa,2,',','.');
					
					$reapers = $angg-$reali ;
					if($reapers == 0){
						if($angg == 0 and $reali == 0){
						$per5x=0;
						}else{
						$per5x   = 0;
						}					
					}else if($reapers < 0){
					$per5x= ($reali!=0)?($reapers/$angg) * 100:0; 
					}else if($reapers > 0){
					$per5x=($reapers/$angg) * 100;
					}else{
					$per5x=0;
					}

					if($per5x < 0){
						$xx="("; 
						$per5x=$per5x*-1; 
						$yy=")";						   
					}else{
						$xx=""; 
						$per5x=$per5x*1; 
						$yy="";					   
					}
					$persenrea = number_format($per5x,"2",",",".");
					
					if((strlen($kode)<=21)){
						$cRet .="<tr>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$kode</b></td>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$nama</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>".number_format($angg_m,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$xy$angg1$yx</b></td>
								  <td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$SUMBER</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$as$reali1$sa</b></td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$df$sisa1$fd</b></td>
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$xx$persenrea$yy</b></td>								  
								</tr>";
					}else{
						$cRet .="<tr>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$kode</td>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$nama</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">".number_format($angg_m,2,',','.')."</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$xy$angg1$yx</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$as$reali1$sa</td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$df$sisa1$fd</td> 
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$xx$persenrea$yy</td> 								  
								</tr>";   
					}					
					}

					$sqltot="SELECT sum(angg_m)as tm,SUM(angg) AS tot, SUM(realix) AS treali,SUMBER FROM(
								SELECT a.kd_kegiatan AS kode,a.nm_kegiatan AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,B.SUMBER_UBAH AS SUMBER,
							IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
							WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('4','5','6') 
							AND LEFT(p.kd_kegiatan,18)=a.kd_program AND p.kd_kegiatan=b.kd_kegiatan),0)+
							IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
							WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2','3','7') 
							AND LEFT(l.kd_kegiatan,18)=a.kd_program AND l.kd_kegiatan=b.kd_kegiatan),0) AS realix
							FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
							WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' AND a.kd_kegiatan='$keg'
							GROUP BY a.kd_kegiatan)cc";
							$hsl = $this->db->query($sqltot); 
							
							foreach ($hsl->result() as $row1){
					   			$totm=$row1->tm;
					   			$totangg    = $row1->tot; 
					   			$totreali   = $row1->treali;
					   			$SUMBER   = $row1->SUMBER;

					   			$rumus=$totangg-$totreali;

					   			if($totreali <> 0){
									$per5   = ($rumus!=0)?($rumus /$row1->tot) * 100:0; 
									}else if($totangg <> 0 and $totreali ==0){
										$per5=100;
									}else{
										$per5=0;
									}

                    			$persen5= number_format($per5,"2",".",",");
					   			
							}

							$cRet .="<tr>
								  <td valign=\"top\" colspan=\"2\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>TOTAL</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totm,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totangg,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b></b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totreali,2,',','.')."</b></td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($rumus,2,',','.')."</b></td> 
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($persen5,2,',','.')."</b></td> 								  
								</tr>";
					}
				

        $cRet .='</table>';
        $data['prev']= $cRet;    
        //$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
        switch($cetak) {        
        case 1;
              $this->_mpdf1_tes('', $cRet, 10, 5, 10, '0');
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename=realisasi_belanja_skpd.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        }		
    }	

	


	function cetak_realisasianggtgl(){
		$cetak = $this->uri->segment(3);
        $thn_ang	= $this->session->userdata('pcThang');
        $kd_skpd	= $_REQUEST['skpd'];

        $pilih = $_REQUEST['cpilih'];
        if($pilih==2){
            $keg=$_REQUEST['keg'];
        }

        $tgl_r=$_REQUEST['tgl'];
        $tgl=$this->tanggal_format_indonesia($tgl_r);
		
        $sqlsc = "SELECT kab_kota,daerah FROM sclient";
		$sqlsclient=$this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc){
			$kota   = $rowsc->kab_kota;
			$daerah = $rowsc->daerah;
		}

        $csql2 = "SELECT nm_skpd FROM ms_skpd WHERE kd_skpd = '$kd_skpd'";
            $hasil2   = $this->db->query($csql2);
            $trh4     = $hasil2->row();          
            $lcNmskpd = $trh4->nm_skpd;			

        $cRet = '';
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
					<tr>
						<td colspan=\"4\" align=\"center\" style=\"font-size:14px;border: solid 1px white;\"><b>PEMERINTAH $kota<br>LAPORAN REALISASI SP2D<br>
						PER TANGGAL ".strtoupper($tgl)."</b></td>
					</tr>			
					<tr>
						<td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
					</tr>
					<tr>
						<td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
					</tr>
					<tr>
						<td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
					</tr>
					<tr>
						<td width=\"5%\" align=\"left\" style=\"font-size:10px;border: solid 1px white;\">SKPD</td>
						<td width=\"95%\" align=\"left\" style=\"font-size:10px;border: solid 1px white;\">: $kd_skpd  $lcNmskpd</td>
					</tr>
					</table>";
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
            <thead>
			<tr>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"15%\" style=\"font-size:12px\">Kode</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"40%\" style=\"font-size:12px\">Uraian</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"15%\" style=\"font-size:12px\">Anggaran</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"15%\" style=\"font-size:12px\">Anggaran Ubah</td>  
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"5%\" style=\"font-size:12px\">Sumber Dana</td>
				<td bgcolor=\"#CCCCCC\" align=\"center\" width=\"15%\" style=\"font-size:12px\">Realisasi</td>
				<td bgcolor=\"#CCCCCC\" align=\"center\" width=\"15%\" style=\"font-size:12px\">Sisa Anggaran</td> 
				<td bgcolor=\"#CCCCCC\" align=\"center\" width=\"9%\" style=\"font-size:12px\">Persen (%)</td> 
            </tr> 		
            <tr>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">1</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">2</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">3</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">4</td>  
				<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">5</td>
				<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">6</td>
				<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">7</td>
				<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">8</td>
            </tr> 
			</thead>
			<tfoot>
				<tr><td style=\"border-bottom: none; border-left:none;border-right:none;\" colspan=\"8\"></td>
			</tfoot>            
            ";
			
 			
				if($pilih==1){
				
					if($kd_skpd=='1.20.05.01'){
							$sql = "SELECT * FROM(
SELECT a.kd_program AS kode,a.nm_program AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,''SUMBER,
IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('3','4','5','6','7') AND tgl_sp2d<='$tgl_r'
AND LEFT(p.kd_kegiatan,18)=a.kd_program),0)+

IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2') AND tgl_bukti<='$tgl_r'
AND LEFT(l.kd_kegiatan,18)=a.kd_program),0) -

(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program AND ll.tgl_bukti<='$tgl_r' )+

(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program AND ll.tgl_bukti<='$tgl_r')AS reali
FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' OR LEFT(b.kd_rek5,2)='62'
GROUP BY a.kd_program
UNION ALL	

SELECT a.kd_kegiatan AS kode,a.nm_kegiatan AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,B.SUMBER_UBAH AS SUMBER,
IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('3','4','5','6','7')AND tgl_sp2d<='$tgl_r' 
AND LEFT(p.kd_kegiatan,18)=a.kd_program AND p.kd_kegiatan=b.kd_kegiatan),0)+
IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2') AND tgl_bukti<='$tgl_r' 
AND LEFT(l.kd_kegiatan,18)=a.kd_program AND l.kd_kegiatan=b.kd_kegiatan),0) -

(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program AND kd_kegiatan=b.kd_kegiatan AND ll.tgl_bukti<='$tgl_r')+

(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program AND kd_kegiatan=b.kd_kegiatan AND ll.tgl_bukti<='$tgl_r') AS reali
FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' OR LEFT(b.kd_rek5,2)='62'
GROUP BY a.kd_kegiatan

UNION ALL

SELECT CONCAT(kd_kegiatan,'.',kd_rek5) AS kode,nm_rek5 AS nama,nilai AS angg_m, nilai_ubah AS angg,''SUMBER,
IFNULL((SELECT SUM(a.nilai) FROM trdspp a INNER JOIN trhsp2d b ON a.no_spp=b.no_spp 
WHERE b.kd_skpd='$kd_skpd' AND a.kd_skpd='$kd_skpd' AND b.jns_spp IN('3','4','5','6','7') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5 AND tgl_sp2d<='$tgl_r'
GROUP BY kd_rek5,kd_kegiatan ),0)+

IFNULL((SELECT SUM(a.nilai) FROM trdtransout a INNER JOIN trhtransout b ON a.no_bukti=b.no_bukti 
WHERE b.kd_skpd='$kd_skpd' AND SUBSTR(a.kd_kegiatan,6,10)='$kd_skpd' AND b.jns_spp IN('1','2') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5 AND tgl_bukti<='$tgl_r'
GROUP BY kd_rek5,kd_kegiatan),0)   - 

(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd'  AND kd_kegiatan=q.kd_kegiatan AND kk.kd_rek5=q.kd_rek5 AND ll.tgl_bukti<='$tgl_r')+

(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND kd_kegiatan=q.kd_kegiatan AND kk.kd_rek5=q.kd_rek5 AND ll.tgl_bukti<='$tgl_r')
AS reali
FROM trdrka q WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek5,1)='5' OR LEFT(kd_rek5,2)='62'
)z ORDER BY kode";          
    				}else{
    					$sql = "SELECT * FROM(
SELECT a.kd_program AS kode,a.nm_program AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,''SUMBER,

IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('3','4','5','6','7') 
AND LEFT(p.kd_kegiatan,18)=a.kd_program AND tgl_sp2d<='$tgl_r'),0)+

IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2')
AND LEFT(l.kd_kegiatan,18)=a.kd_program AND tgl_bukti<='$tgl_r'),0) -

(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program  AND ll.tgl_bukti<='$tgl_r')+
(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program  AND ll.tgl_bukti<='$tgl_r')AS reali
FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' 
GROUP BY a.kd_program


UNION ALL	
SELECT a.kd_kegiatan AS kode,a.nm_kegiatan AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,B.SUMBER_UBAH AS SUMBER,
IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('3','4','5','6','7') 
AND LEFT(p.kd_kegiatan,18)=a.kd_program AND p.kd_kegiatan=b.kd_kegiatan AND tgl_sp2d<='$tgl_r'),0)+

IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2') 
AND LEFT(l.kd_kegiatan,18)=a.kd_program AND l.kd_kegiatan=b.kd_kegiatan AND tgl_bukti<='$tgl_r'),0) -

(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program AND kd_kegiatan=b.kd_kegiatan AND ll.tgl_bukti<='$tgl_r')+

(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program AND kd_kegiatan=b.kd_kegiatan AND ll.tgl_bukti<='$tgl_r') AS reali
FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 

WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' 
GROUP BY a.kd_kegiatan
UNION ALL

SELECT CONCAT(kd_kegiatan,'.',kd_rek5) AS kode,nm_rek5 AS nama,nilai AS angg_m, nilai_ubah AS angg,''SUMBER,
IFNULL((SELECT SUM(a.nilai) FROM trdspp a INNER JOIN trhsp2d b ON a.no_spp=b.no_spp 
WHERE b.kd_skpd='$kd_skpd' AND a.kd_skpd='$kd_skpd' AND b.jns_spp IN('3','4','5','6','7') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5 AND tgl_sp2d<='$tgl_r'
GROUP BY kd_rek5,kd_kegiatan),0)+

IFNULL((SELECT SUM(a.nilai) FROM trdtransout a INNER JOIN trhtransout b ON a.no_bukti=b.no_bukti 
WHERE b.kd_skpd='$kd_skpd' AND SUBSTR(a.kd_kegiatan,6,10)='$kd_skpd' AND b.jns_spp IN('1','2') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5 AND tgl_bukti<='$tgl_r'
GROUP BY kd_rek5,kd_kegiatan),0)   - 

(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd'  AND kd_kegiatan=q.kd_kegiatan AND kk.kd_rek5=q.kd_rek5  AND ll.tgl_bukti<='$tgl_r')+

(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND kd_kegiatan=q.kd_kegiatan AND kk.kd_rek5=q.kd_rek5  AND ll.tgl_bukti<='$tgl_r')

AS reali
FROM trdrka q WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek5,1)='5'
)z ORDER BY kode"; 
    				}

					$hasil = $this->db->query($sql);       
					$saldo=0;
					foreach ($hasil->result() as $row){
					   $kode  = $row->kode ;
					   $nama  = $row->nama;
					   $angg    = $row->angg; 
					   $reali   = $row->reali;
					   $angg_m    = $row->angg_m;
					   $SUMBER    = $row->SUMBER;
					   
					if($angg<0){
						$xy="("; 
						$angg=$angg*-1; 
						$yx=")";						   
					}else{
						$xy=""; 
						$angg=$angg*1; 
						$yx="";					   
					}
					$angg1 = number_format($angg,2,',','.');
					
					if($reali<0){
						$as="("; 
						$reali=$reali*-1; 
						$sa=")";						   
					}else{
						$as=""; 
						$reali=$reali*1; 
						$sa="";					   
					}
					$reali1 = number_format($reali,2,',','.');
					
					$sisa = $row->angg-$row->reali;
					if($sisa<0){
						$df="("; 
						$sisa=$sisa*-1; 
						$fd=")";						   
					}else{
						$df=""; 
						$sisa=$sisa*1; 
						$fd="";					   
					}
					$sisa1 = number_format($sisa,2,',','.');
					
					$reapers = $angg-$reali ;
					if($reapers == 0){
						if($angg == 0 and $reali == 0){
						$per5x=0;
						}else{
						$per5x   = 0;
						}					
					}else if($reapers < 0){
					$per5x= ($reali!=0)?($reapers/$angg) * 100:0; 
					}else if($reapers > 0){
					$per5x=($reapers/$angg) * 100;
					}else{
					$per5x=0;
					}

					if($per5x < 0){
						$xx="("; 
						$per5x=$per5x*-1; 
						$yy=")";						   
					}else{
						$xx=""; 
						$per5x=$per5x*1; 
						$yy="";					   
					}
					$persenrea = number_format($per5x,"2",",",".");
					
					if((strlen($kode)<=21)){
						$cRet .="<tr>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$kode</b></td>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$nama</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>".number_format($angg_m,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$xy$angg1$yx</b></td>
								  <td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$SUMBER</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$as$reali1$sa</b></td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$df$sisa1$fd</b></td>
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$xx$persenrea$yy</b></td>								  
								</tr>";
					}else{
						$cRet .="<tr>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$kode</td>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$nama</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">".number_format($angg_m,2,',','.')."</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$xy$angg1$yx</td>
								  <td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none\">$SUMBER</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$as$reali1$sa</td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$df$sisa1$fd</td> 
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$xx$persenrea$yy</td> 								  
								</tr>";   
					}					
					}
					if($kd_skpd=='1.20.05.01'){
					$sqltot="SELECT sum(angg_m)as tm,SUM(angg) AS tot, SUM(realix) AS treali ,SUMBER FROM(
								SELECT a.kd_program AS kode,a.nm_program AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg, B.SUMBER_UBAH AS SUMBER,
								IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
								WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('3','4','5','6','7')  AND tgl_sp2d<='$tgl_r'
								AND LEFT(p.kd_kegiatan,18)=a.kd_program),0)+
								IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
								WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2') AND tgl_bukti<='$tgl_r'
								AND LEFT(l.kd_kegiatan,18)=a.kd_program),0) AS realix
								FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
								WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' OR LEFT(b.kd_rek5,2)='62'
								GROUP BY a.kd_program)cc";
						}else{
							$sqltot="SELECT SUM(angg_m)AS tm,SUM(angg) AS tot, SUM(realix) AS treali,SUMBER FROM(
SELECT a.kd_program AS kode,a.nm_program AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg, B.SUMBER_UBAH AS SUMBER,
IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('3','4','5','6','7') AND tgl_sp2d<='$tgl_r'
AND LEFT(p.kd_kegiatan,18)=a.kd_program),0)+

IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2') AND tgl_bukti<='$tgl_r'
AND LEFT(l.kd_kegiatan,18)=a.kd_program),0) AS realix

FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5'
GROUP BY a.kd_program)cc";
						}
							$hsl = $this->db->query($sqltot); 
							
							foreach ($hsl->result() as $row1){
					   			$totm=$row1->tm;
					   			$totangg    = $row1->tot; 
					   			$totreali   = $row1->treali;

					   			$rumus=$totangg-$totreali;

					   			if($totreali <> 0){
									$per5   = ($rumus!=0)?($rumus /$row1->tot) * 100:0; 
									}else if($totangg <> 0 and $totreali ==0){
										$per5=100;
									}else{
										$per5=0;
									}

                    			$persen5= number_format($per5,"2",".",",");
					   			
							}

							$cRet .="<tr>
								  <td valign=\"top\" colspan=\"2\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>TOTAL</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totm,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totangg,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b></b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totreali,2,',','.')."</b></td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($rumus,2,',','.')."</b></td> 
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($persen5,2,',','.')."</b></td> 								  
								</tr>";
					}else{
						//per kegiatan
					/*$sql = "SELECT * FROM(
							SELECT a.kd_kegiatan AS kode,a.nm_kegiatan AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,
							IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
							WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('3','4','5','6') 
							AND LEFT(p.kd_kegiatan,18)=a.kd_program AND p.kd_kegiatan=b.kd_kegiatan),0)+
							IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
							WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2') 
							AND LEFT(l.kd_kegiatan,18)=a.kd_program AND l.kd_kegiatan=b.kd_kegiatan),0) AS reali
							FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
							WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' AND a.kd_kegiatan='$keg'
							GROUP BY a.kd_kegiatan
							UNION ALL
							SELECT CONCAT(kd_kegiatan,'.',kd_rek5) AS kode,nm_rek5 AS nama,nilai AS angg_m,nilai_ubah AS angg,
							IFNULL((SELECT SUM(a.nilai) FROM trdspp a INNER JOIN trhsp2d b ON a.no_spp=b.no_spp 
							WHERE b.kd_skpd='$kd_skpd' AND a.kd_skpd='$kd_skpd' AND b.jns_spp IN('3','4','5','6') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5
							GROUP BY kd_rek5,kd_kegiatan),0)+
							IFNULL((SELECT SUM(a.nilai) FROM trdtransout a INNER JOIN trhtransout b ON a.no_bukti=b.no_bukti 
							WHERE b.kd_skpd='$kd_skpd' AND SUBSTR(a.kd_kegiatan,6,10)='$kd_skpd' AND b.jns_spp IN('1','2') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5
							GROUP BY kd_rek5,kd_kegiatan),0) AS reali
							FROM trdrka q WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek5,1)='5' AND kd_kegiatan='$keg'
							)z ORDER BY kode";         */ 
	$sql = "SELECT * FROM(
SELECT a.kd_kegiatan AS kode,a.nm_kegiatan AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,B.SUMBER_UBAH AS SUMBER,
IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('3','4','5','6','7') AND tgl_sp2d<='$tgl_r'
AND LEFT(p.kd_kegiatan,18)=a.kd_program AND p.kd_kegiatan=b.kd_kegiatan),0)+

IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2') AND tgl_bukti<='$tgl_r' 
AND LEFT(l.kd_kegiatan,18)=a.kd_program AND l.kd_kegiatan=b.kd_kegiatan),0) AS reali
FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' AND a.kd_kegiatan='$keg'


GROUP BY a.kd_kegiatan
UNION ALL

SELECT CONCAT(kd_kegiatan,'.',kd_rek5) AS kode,nm_rek5 AS nama,nilai AS angg_m,nilai_ubah AS angg,'' AS SUMBER,
IFNULL((SELECT SUM(a.nilai) FROM trdspp a INNER JOIN trhsp2d b ON a.no_spp=b.no_spp 
WHERE b.kd_skpd='$kd_skpd' AND a.kd_skpd='$kd_skpd' AND b.jns_spp IN('3','4','5','6','7') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5 AND tgl_sp2d<='$tgl_r'
GROUP BY kd_rek5,kd_kegiatan),0)+

IFNULL((SELECT SUM(a.nilai) FROM trdtransout a INNER JOIN trhtransout b ON a.no_bukti=b.no_bukti 
WHERE b.kd_skpd='$kd_skpd' AND SUBSTR(a.kd_kegiatan,6,10)='$kd_skpd' AND b.jns_spp IN('1','2') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5 AND tgl_bukti<='$tgl_r' 
GROUP BY kd_rek5,kd_kegiatan),0) - 

(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd'  AND kd_kegiatan=q.kd_kegiatan AND kk.kd_rek5=q.kd_rek5 AND ll.tgl_bukti<='$tgl_r' )+

(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND kd_kegiatan=q.kd_kegiatan AND kk.kd_rek5=q.kd_rek5 AND ll.tgl_bukti<='$tgl_r' )AS reali
FROM trdrka q WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek5,1)='5' AND kd_kegiatan='$keg'
)z ORDER BY kode";          



					$hasil = $this->db->query($sql);       
					$saldo=0;
					foreach ($hasil->result() as $row){
					   $kode  = $row->kode ;
					   $nama  = $row->nama;
					   $angg    = $row->angg; 
					   $reali   = $row->reali;
					   $angg_m    = $row->angg_m;
					   $SUMBER    = $row->SUMBER;
					   
					if($angg<0){
						$xy="("; 
						$angg=$angg*-1; 
						$yx=")";						   
					}else{
						$xy=""; 
						$angg=$angg*1; 
						$yx="";					   
					}
					$angg1 = number_format($angg,2,',','.');
					
					if($reali<0){
						$as="("; 
						$reali=$reali*-1; 
						$sa=")";						   
					}else{
						$as=""; 
						$reali=$reali*1; 
						$sa="";					   
					}
					$reali1 = number_format($reali,2,',','.');
					
					$sisa = $row->angg-$row->reali;
					if($sisa<0){
						$df="("; 
						$sisa=$sisa*-1; 
						$fd=")";						   
					}else{
						$df=""; 
						$sisa=$sisa*1; 
						$fd="";					   
					}
					$sisa1 = number_format($sisa,2,',','.');
					
					$reapers = $angg-$reali ;
					if($reapers == 0){
						if($angg == 0 and $reali == 0){
						$per5x=0;
						}else{
						$per5x   = 0;
						}					
					}else if($reapers < 0){
					$per5x= ($reali!=0)?($reapers/$angg) * 100:0; 
					}else if($reapers > 0){
					$per5x=($reapers/$angg) * 100;
					}else{
					$per5x=0;
					}

					if($per5x < 0){
						$xx="("; 
						$per5x=$per5x*-1; 
						$yy=")";						   
					}else{
						$xx=""; 
						$per5x=$per5x*1; 
						$yy="";					   
					}
					$persenrea = number_format($per5x,"2",",",".");
					
					if((strlen($kode)<=21)){
						$cRet .="<tr>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$kode</b></td>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$nama</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>".number_format($angg_m,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$xy$angg1$yx</b></td>
								  <td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$SUMBER</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$as$reali1$sa</b></td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$df$sisa1$fd</b></td>
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$xx$persenrea$yy</b></td>								  
								</tr>";
					}else{
						$cRet .="<tr>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$kode</td>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$nama</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">".number_format($angg_m,2,',','.')."</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$xy$angg1$yx</td>
								  <td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none\">$SUMBER</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$as$reali1$sa</td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$df$sisa1$fd</td> 
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$xx$persenrea$yy</td> 								  
								</tr>";   
					}					
					}

					$sqltot="SELECT SUM(angg_m)AS tm,SUM(angg) AS tot, SUM(realix) AS treali FROM(

SELECT a.kd_kegiatan AS kode,a.nm_kegiatan AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,

IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('3','4','5','6','7') 
AND LEFT(p.kd_kegiatan,18)=a.kd_program AND p.kd_kegiatan=b.kd_kegiatan AND tgl_sp2d<='$tgl_r'),0)+

IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2') AND tgl_bukti<='$tgl_r'
AND LEFT(l.kd_kegiatan,18)=a.kd_program AND l.kd_kegiatan=b.kd_kegiatan),0) AS realix

FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' AND a.kd_kegiatan='$keg'
GROUP BY a.kd_kegiatan)cc";
							$hsl = $this->db->query($sqltot); 
							
							foreach ($hsl->result() as $row1){
					   			$totm=$row1->tm;
					   			$totangg    = $row1->tot; 
					   			$totreali   = $row1->treali;

					   			$rumus=$totangg-$totreali;

					   			if($totreali <> 0){
									$per5   = ($rumus!=0)?($rumus /$row1->tot) * 100:0; 
									}else if($totangg <> 0 and $totreali ==0){
										$per5=100;
									}else{
										$per5=0;
									}

                    			$persen5= number_format($per5,"2",".",",");
					   			
							}

							$cRet .="<tr>
								  <td valign=\"top\" colspan=\"2\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>TOTAL</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totm,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totangg,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b></b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totreali,2,',','.')."</b></td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($rumus,2,',','.')."</b></td> 
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($persen5,2,',','.')."</b></td> 								  
								</tr>";
					}
				

        $cRet .='</table>';
        $data['prev']= $cRet;    
        //$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
        switch($cetak) {        
        case 1;
              $this->_mpdf1_tes('', $cRet, 10, 5, 10, '0');
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename=realisasi_belanja_skpd.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        }		
    }	

	
	
	
	
	function ctkpenagihan(){
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/ctkpenagihan', $data);
    }
	
	function cetak_penagihan(){
		$thn_ang = $this->session->userdata('pcThang');
        $kd_skpd  = $_REQUEST['skpd'];
        $bulan= $_REQUEST['tgl1'];
        $lcperiode = $this->tukd_model->getBulan($bulan);
		
        $csql2 = "SELECT nm_skpd FROM ms_skpd WHERE kd_skpd = '$kd_skpd'";
            $hasil2     = $this->db->query($csql2);
            $trh4       = $hasil2->row();          
            $lcNmskpd   = $trh4->nm_skpd;		
		
        $sqlsc = "SELECT kab_kota,daerah FROM sclient";
		$sqlsclient=$this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc){
			$kota     = $rowsc->kab_kota;
			$daerah  = $rowsc->daerah;
		}

		$csql = "SELECT a.nama, a.nip, a.jabatan FROM ms_ttd a WHERE kode = 'BK' AND a.kd_skpd = '$kd_skpd'";
			$hasil      = $this->db->query($csql);
			$trh2       = $hasil->row();          
			$lcNmBk     = $trh2->nama;
			$lcNipBk    = $trh2->nip;
			$lcJabBk    = $trh2->jabatan;                  

		$csql1 = "SELECT a.nama, a.nip, a.jabatan FROM ms_ttd a WHERE kode = 'PA' AND a.kd_skpd = '$kd_skpd'";
			$hasil1     = $this->db->query($csql1);
			$trh3       = $hasil1->row();          
			$lcNmPA     = $trh3->nama;
			$lcNipPA    = $trh3->nip;                  
			$lcJabPA    = $trh3->jabatan;

         $cRet = '';
         $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
            <tr>
                <td align=\"center\" style=\"font-size:14px;border: solid 1px white;\"><b>$kota<br>DAFTAR PENAGIHAN</b></td>
            </tr>
              <tr>
                <td align=\"left\" style=\"font-size:12px;border: solid 1px white;\">&nbsp;</td>
                <td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
            </tr>
			<tr>
                <td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
            </tr>
			<tr>
                <td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
            </tr>
			<tr>
                <td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
            </tr>";
            $cRet .= "</table>";
         $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
            <tr>
                <td width=\"10%\" align=\"left\" style=\"font-size:14px;border: solid 1px white;\">SKPD</td>
                <td width=\"90%\" align=\"left\" style=\"font-size:14px;border: solid 1px white;\">: $kd_skpd  $lcNmskpd</td>
            </tr>  
            <tr>
                <td width=\"10%\" align=\"left\" style=\"font-size:14px;border: solid 1px white;\">Bulan</td>
                <td width=\"90%\" align=\"left\" style=\"font-size:14px;border: solid 1px white;\">: $lcperiode $thn_ang</td>
            </tr>                        
            <tr>
                <td align=\"left\" style=\"font-size:12px;border: solid 1px white;border-bottom:none;\"></td>
            </tr>";
                        
         $cRet .= "</table>";
         $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\"> 
            <thead>
            <tr>
                <td align=\"center\" width=\"10%\" style=\"font-size:12px\">No</td>
                <td align=\"center\" width=\"5%\" style=\"font-size:12px\">Tanggal</td>
                <td align=\"center\" width=\"40%\" style=\"font-size:12px\">Uraian</td>
                <td align=\"center\" width=\"10%\" style=\"font-size:12px\">Kode Rekening</td>
				<td align=\"center\" width=\"20%\" style=\"font-size:12px\">Nama Rekening</td>
                <td align=\"center\" width=\"15%\" style=\"font-size:12px\">Nilai</td>            
            </tr>
            </thead>
            <tfoot>
                <tr>
                <td colspan=\"6\" style=\"valign:top;font-size:10;border-top:none;border-buttom: 1px solid black\" width=\"5%\" align=\"center\"></td>
				
                </tr>
            </tfoot>"; 
            
              $sql = "SELECT b.`no_bukti`,b.`tgl_bukti`,b.`kd_skpd`,b.`nm_skpd`,b.`ket`,a.`kd_rek`,a.`nm_rek5`,a.`nilai` 
							FROM trdtagih a LEFT JOIN trhtagih b ON a.`no_bukti`=b.`no_bukti` 
							WHERE b.`kd_skpd`='$kd_skpd' AND MONTH(b.`tgl_bukti`)='$bulan'
							ORDER BY b.`tgl_bukti`,b.`no_bukti`";
			                             
                        $hasil = $this->db->query($sql);       
                        $saldo=0;
                        foreach ($hasil->result() as $row)
                        {
                           $no      = $row->no_bukti ;
                           $tgl     = $row->tgl_bukti;
                           $tgl     = $this->tanggal_indonesia($tgl);
                           $uraian  = $row->ket; 
                           $koderek = $row->kd_rek;
						   $nmrek   = $row->nm_rek5;
						   $nil     = $row->nilai;
							$nilai  = number_format($nil,2,',','.');
                
                          $cRet.= "<tr>
                                      <td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none\">$no</td>
                                      <td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none\">$tgl</td>
                                      <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$uraian</td>
                                      <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$koderek</td>
                                      <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$nmrek</td>
                                      <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$nilai</td>
                                      </tr> ";                            
                        }
						
              $sql1 = "SELECT IFNULL(SUM(a.`nilai`),0) AS total 
							FROM trdtagih a LEFT JOIN trhtagih b ON a.`no_bukti`=b.`no_bukti` 
							WHERE b.`kd_skpd`='$kd_skpd' AND MONTH(b.`tgl_bukti`)='$bulan'
							ORDER BY b.`tgl_bukti`,b.`no_bukti`";

                        $hasil1 = $this->db->query($sql1);       
                        foreach ($hasil1->result() as $row){
                           $tot   = $row->total ;
						   $total = number_format($tot,2,',','.');
						   
                          $cRet.= "<tr>
                                      <td colspan=\"5\" valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:solid 1px black\"><b>Jumlah</b></td>
                                      <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:solid 1px black\"><b>$total</b></td>
                                      </tr> ";  						   
						}
						
         $cRet .='</table>';
         $data['prev']= $cRet;    
         $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
    }
	
	
		function hitung_lpsal_pemda(){
$thn_ang='2016';
        $sqlsawal = "SELECT * FROM map_lpsal  where nor='8'";
        $queryawal = $this->db->query($sqlsawal);
        $jmlsaldo = $queryawal->row();
        $jmlsal = $jmlsaldo->thn_m1;
		
        $sql41 = "SELECT SUM(kredit)-SUM(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
		WHERE LEFT(a.kd_rek5,1)='4' AND YEAR(tgl_voucher)='$thn_ang'";
        $query41 = $this->db->query($sql41);
        $jmlp = $query41->row();
        $jmlpendapatan = $jmlp->nilai;
        $jmlpendapatan1 = number_format($jmlp->nilai, "2", ",", ".");
		        
		$sql51 = "SELECT SUM(debet)-SUM(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
		WHERE LEFT(a.kd_rek5,1)='5' AND YEAR(tgl_voucher)='$thn_ang'";
        $query51 = $this->db->query($sql51);
        $jmlb = $query51->row();
        $jmlbelanja = $jmlb->nilai;
        $jmlbelanja1 = number_format($jmlb->nilai, "2", ",", ".");
		
        $sql523 = "SELECT SUM(debet)-SUM(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
		WHERE LEFT(a.kd_rek5,3)='923' AND YEAR(tgl_voucher)='$thn_ang'";
        $query523 = $this->db->query($sql523);
        $jmlbm = $query523->row();
        $jmlbmbelanja = $jmlbm->nilai;
        $jmlbmbelanja1 = number_format($jmlbmbelanja, "2", ",", ".");
		
        $sql61 = "SELECT SUM(kredit)-SUM(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
		WHERE LEFT(a.kd_rek5,2)='71' AND YEAR(tgl_voucher)='$thn_ang'";
        $query61 = $this->db->query($sql61);
        $jmlpm = $query61->row();
        $jmlpmasuk = $jmlpm->nilai;
		
    	$sql62 = "SELECT SUM(debet)-SUM(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
		WHERE LEFT(a.kd_rek5,2)='72' AND YEAR(tgl_voucher)='$thn_ang'";
        $query62 = $this->db->query($sql62);
        $jmlpk = $query62->row();
        $jmlpkeluar = $jmlpk->nilai;
        $surplus = $jmlpendapatan - $jmlbelanja;
        
        $jum1=$jmlsal+$jmlpmasuk;
        
        $biaya_net = $jmlpmasuk - $jmlpkeluar;
        $silpa = ($jmlpendapatan + $jmlpmasuk) - ($jmlbelanja + $jmlpkeluar);
        if ($silpa < 0)
        {
            $a = "(";
            $silpa1 = $silpa * -1;
            $b = ")";
        } else
        {
            $a = "";
            $silpa1 = $silpa;
            $b = "";
        }
        $jum2=$jum1+$silpa;
        if ($jum2 < 0)
        {
            $c = "(";
            $jum2 = $jum2 * -1;
            $d = ")";
        } else
        {
            $c = "";
            $d = "";
        }
        $sal_akhir=$jum1+$silpa;
        if ($sal_akhir < 0)
        {
            $c = "(";
            $sal_akhir = $sal_akhir * -1;
            $d = ")";
        } else
        {
            $c = "";
            $d = "";
        }
                      		
			$a1 = $this->db->query("UPDATE map_lpsal SET thn_ini='$jmlsal' where nor='1'");
                if($a1){	
					$a2 = $this->db->query("UPDATE map_lpsal SET thn_ini='$jmlpmasuk'  where nor='2'");
						if($a2){
							$a3 = $this->db->query("UPDATE map_lpsal SET thn_ini='$jum1'  where nor='3'");
								if($a3){
									$a4 = $this->db->query("UPDATE map_lpsal SET thn_ini='$silpa1'  where nor='4'");						
										if($a4){
											$a5 = $this->db->query("UPDATE map_lpsal SET thn_ini='$jum2'  where nor='5'");						
												if($a5){											
													$a8 = $this->db->query("UPDATE map_lpsal SET thn_ini='$sal_akhir'  where nor='8'");						
														if($a8){
															$result=1;
														}else{
															$result=0;
														}													
												}
										}
								}
						}
				}
		
		echo json_encode($result);
		
	}
	
	
	
function hitung_lak_pemda(){
		//level 1
        $idx = 0;

		
		
				
$pfkk = "SELECT IFNULL(SUM(a.debet),0) AS debet, IFNULL(SUM(a.kredit),0) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd 
WHERE LEFT(kd_rek5,3)='211' ";
$pfkk1 = $this->db->query($pfkk);
$pfka = $pfkk1->row();
$de = $pfka->debet;	
$kk = $pfka->kredit;	


		
		
$sqllalu = "SELECT SUM(debet)-SUM(kredit) AS n_lalu FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd WHERE LEFT(kd_rek5,5) IN ('11101','11103') AND tgl_voucher='2015-12-31'";
$sql_lalu = $this->db->query($sqllalu);
$sql_lalua = $sql_lalu->row();
$jml_lalu = $sql_lalua->n_lalu;	

		//SALDO AKHIR
$ss = "SELECT SUM(debet)-SUM(kredit) AS n_lalu FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd WHERE LEFT(kd_rek5,5) IN ('11102') AND MONTH(tgl_voucher)<='12'";
$kasdd = $this->db->query($ss);
$kasdda = $kasdd->row();
$kas123 = $kasdda->n_lalu;	
		
		
			$akhirnya=0;


		$akhirnya=$jml_lalu+$kas123;
		
		
        $parent = '0';
        $no = '0';
        $query = $this->db->query("SELECT * FROM rg_lak ORDER BY nor ");
        foreach ($query->result_array() as $res)
        {

            $idx++;
            $no = $res['nor'];
            $uraian = $res['uraian'];
            $seq = $res['seq'];
            $parent = $res['parent'];
            $normal = $res['normal'];
            
            $rek1 = trim($res['rek1']);
            $rek2 = trim($res['rek2']);
            
            if ($rek1 == '')
                $rek1 = 'xxx';
            if ($rek2 == '')
                $rek2 = 'xxx';
            
            //$q = $this->db->query("SELECT IFNULL(SUM(a.debet),0) AS debet, IFNULL(SUM(a.kredit),0) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher where 
			//							kd_rek5 like '%$rek1%' or kd_rek5 like '%$rek2%'");
			
			
       
			
			$pajang = strlen($rek1);
			


						
			if($pajang==3){
			
			$q = $this->db->query("SELECT IFNULL(SUM(a.debet),0) AS debet, IFNULL(SUM(a.kredit),0) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_skpd where (left(kd_rek5,3)='$rek1' or left(kd_rek5,3)='$rek2')");
}else if($pajang==2){
$q = $this->db->query("SELECT IFNULL(SUM(a.debet),0) AS debet, IFNULL(SUM(a.kredit),0) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_skpd where (left(kd_rek5,2)='$rek1' or left(kd_rek5,2)='$rek2')");
}else if($pajang==5){
$q = $this->db->query("SELECT IFNULL(SUM(a.debet),0) AS debet, IFNULL(SUM(a.kredit),0) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_skpd where (left(kd_rek5,5)='$rek1' or left(kd_rek5,5)='$rek2')");
}else if($pajang==7){
$q = $this->db->query("SELECT IFNULL(SUM(a.debet),0) AS debet, IFNULL(SUM(a.kredit),0) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_skpd where (left(kd_rek5,7)='$rek1' or left(kd_rek5,7)='$rek2')");


}
            foreach($q->result_array() as $r){
					$debet=$r['debet'];
					$kredit=$r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

				if ($normal=='2'){
					$nilai=$debet-$kredit;
				}else{
					$nilai=$kredit-$debet;				
				}
				if ($nilai=='') {
					$nilai=0;}

				$q = $this->db->query("update rg_lak set nilai='$nilai' where nor='$no' ");				


$pf = $this->db->query(" update rg_lak set  nilai='$kk' where nor='84' and seq='425'");
$pfd = $this->db->query(" update rg_lak set  nilai='$de' where nor='87' and seq='440'");

        }
			
		$query = $this->db->query("SELECT 
(SELECT IFNULL(SUM(nilai),0) FROM rg_lak WHERE bold='1' AND nor BETWEEN 3 AND 16 OR nor='97') AS AKM1,
(SELECT IFNULL(SUM(nilai),0) FROM rg_lak WHERE bold='1' AND nor BETWEEN 19 AND 29 OR nor='96') AS AKK1,
(SELECT IFNULL(SUM(nilai),0) FROM rg_lak WHERE bold='1' AND nor BETWEEN 34 AND 42 OR seq='221' ) AS AKM2,
(SELECT IFNULL(SUM(nilai),0) FROM rg_lak WHERE bold='1' AND nor BETWEEN 45 AND 54) AS AKK2,
(SELECT IFNULL(SUM(nilai),0) FROM rg_lak WHERE  bold='1' AND nor BETWEEN 58 AND 67 ORDER BY seq) AS AKM3,
(SELECT IFNULL(SUM(nilai),0) FROM rg_lak WHERE  bold='1' AND nor BETWEEN 69 AND 78 OR nor='81') AS AKK3,
(SELECT IFNULL(SUM(nilai),0) FROM rg_lak WHERE bold='1' AND nor>='82' AND seq='425') AS AKM4,
(SELECT IFNULL(SUM(nilai),0) FROM rg_lak WHERE bold='1' AND nor>='87' AND seq='440') AS AKK4,
(SELECT IFNULL(SUM(nilai),0) FROM rg_lak WHERE  nor IN ('93','98')) AS xxx
FROM rg_lak WHERE bold='1' GROUP BY nor LIMIT 1");

        foreach ($query->result_array() as $res)
        {

        	$xxx = $res['xxx'];
            $akm1 = $res['AKM1'];
            $akk1 = $res['AKK1'];
			$jum_akm1 = $akm1-$akk1;											
			
			$akm2 = $res['AKM2'];
            $akk2 = $res['AKK2'];
			$jum_akm2 = $akm2-$akk2;
			
			$akm3 = $res['AKM3'];
            $akk3 = $res['AKK3'];
			$jum_akm3 = $akm3-$akk3;
			
			$akm4 = $res['AKM4'];
            $akk4 = $res['AKK4'];
			$jum_akm4 = $akm4-$akk4;			
			
			$ma = $this->db->query(" update rg_lak set  nilai='$akm1' where nor='17' and seq='90'");
			if($ma){
				$mb = $this->db->query(" update rg_lak set  nilai='$akk1' where nor='30' and seq='160'");
				if($mb){
					$mc = $this->db->query(" update rg_lak set  nilai='$akm2' where nor='43' and seq='225'");
					if($mc){
						$md = $this->db->query(" update rg_lak set  nilai='$akk2' where nor='55' and seq='280'");
						if($md){
							$me = $this->db->query(" update rg_lak set  nilai='$akm3' where nor='68' and seq='350'");
							if($me){
								$mf = $this->db->query(" update rg_lak set  nilai='$akk3' where nor='79' and seq='405'");
								if($mf){
									$mg = $this->db->query(" update rg_lak set  nilai='$akm4' where nor='85' and seq='430'");
									if($mg){
										$mg = $this->db->query(" update rg_lak set  nilai='$akk4' where nor='88' and seq='445'");
										if ($mg){
											
            $q = $this->db->query(" update rg_lak set  nilai='$jum_akm1' where nor='31' and seq='165'");
			if($q){
				$q1 = $this->db->query(" update rg_lak set  nilai='$jum_akm2' where nor='56' and seq ='285'");
				if($q1){
					$q2 = $this->db->query(" update rg_lak set  nilai='$jum_akm3' where nor='80' and seq='410'");
					if($q2){
						$q3 = $this->db->query(" update rg_lak set  nilai='$jum_akm4' where nor='89' and seq='450'");
						if($q3){
										
								$sql_a = $this->db->query("UPDATE rg_lak SET nilai='$jml_lalu' WHERE nor='92' and seq='465'");
								if ($sql_a){
									$sqln = "SELECT SUM(nilai) AS arus_kas FROM rg_lak WHERE bold='4'";
									$sql_n = $this->db->query($sqln);
									$sql_na = $sql_n->row();
									$jml_n = $sql_na->arus_kas;		
								
									$sql_b = $this->db->query("UPDATE rg_lak SET nilai='$jml_n' WHERE nor='91' and seq='460'");
									

									


									
									if ($sql_b){

										$AA = "SELECT SUM(NILAI)AS A FROM RG_LAK WHERE NOR IN('91','92')";
									$BB = $this->db->query($AA);
									$CC = $BB->row();
									$DD = $CC->A;	
		
$sql_ee = $this->db->query("UPDATE rg_lak SET nilai='$DD' WHERE nor='93' and seq='470'");
	
		
														
												$sql_saldo_akhir = $this->db->query("UPDATE rg_lak SET nilai='$xxx' WHERE nor='95' and seq='480'");
												if($sql_saldo_akhir){
													$result ='1';
												}else{
													$result ='0';
												}
										//}										
									}
								}		
							}							
					}
				}
			}
										}
									}
								}
							}
						}
					}
				}
			}					
			//					
		}	
		
		 echo json_encode($result);        
    }
	
	
	
	  function cetak_kas_bl(){
        $data['page_title'] = 'LAPORAN kas';
        $this->template->set('title', 'LAPORAN kas');
        $this->template->load('template', 'akuntansi/kas_bl', $data);
    }




function kas_bul(){
			$skpd	  = $this->session->userdata('kdskpd');
			$thi      = $this->session->userdata('pcThang');
            $th1      = $thi-1;
            $bul      = $_REQUEST['bulan'];
            $bulan    = $this->tukd_model->getBulan($bul); 
            $tgl_ttd  = $_REQUEST['tgl_ctk'];  
            
            $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $tgl     = $rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
                    
       
                                    
            $lastmoth = $thn.'-'.$bul.'-'.'01';
            $lastyear = date('Y-m-t',strtotime($lastmoth)); 
            $str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));                            
            



            


			$cRet ="<table style=\"border-collapse:collapse; font-size:12;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"2\">
                    <tr>        
						<td align=\"center\" style=\" border-bottom:none;\" width=\"20%\" colspan=\"2\"><b>LAPORAN POSISI KAS BULAN</b></td>
					</tr>                   
				
					<tr>       
					<td align=\"left\" style=\" border-right:none;border-top:none;border-bottom:none;\" width=\"15%\" ><b>Tahun Anggaran</b></td>

					<td align=\"left\" style=\"border-bottom:none;border-top:none;border-left:none\" ><b>: $thn</b></td>
					</tr>                   

					<tr>       
					<td align=\"left\" style=\" border-right:none;border-top:none;border-bottom:none\" ><b>Bulan</b></td>
					<td align=\"left\" style=\"border-bottom:none;border-top:none;border-left:none\" >: <b>$bulan</b></td>					
					</tr>                   

					<tr>       
					<td align=\"left\" style=\" border-right:none;border-top:none;border-bottom:none\" ><b>Nama Daerah</b></td>
					<td align=\"left\" style=\"border-bottom:none;border-top:none;border-left:none\" >: <b>$kab</b></td>					
					</tr><br> 

					</TABLE>";


			$cRet .='<TABLE border="1" style=\"font-size:12;\" cellspacing="0" cellpadding="0" width="100%" >
					 <thead>
                     <TR>
                        <TD width="5%" align="center" ><b>NO</b></TD>
						<TD width="45%" align="center" ><b>JENIS</b></TD>
						<TD width="25%" align="center" ><b>NILAI</b></TD>
					 </TR>
                     </thead>
                     <tfoot>
                     <TR>
                        <TD width="5%" align="center" ><b></b></TD>
						<TD width="45%" align="center" ><b></b></TD>
						<TD width="25%" align="center" ><b></b></TD>
						
					 </TR>
					
				</tfoot>';

			$query = $this->db->query("SELECT kode,uraian,seq,normal,ifnull(kode_1,\"''\") as kode_1,nilai_lalu FROM map_kas ORDER BY kode ");  
			foreach($query->result_array() as $res){
				
				$kode   = $res['kode'];
				$uraian = $res['uraian'];
				$seq    = $res['seq'];
				$normal = $res['normal'];
                $reallalu1 = $res['nilai_lalu'];
				$reallalu = number_format($reallalu1,"2",".",",");  
				$kode_1 = $res['kode_1'];
                

             
                $test1 = '';
					if($kode_1 <> ''){
						$test  = explode(',',$kode_1);
						$test1 = strlen($test[0]);
						if($test1>7){
							$test1 =7;

						}
					}										

				$q = $this->db->query("SELECT ifnull(SUM(a.debet),0) AS debet,ifnull(SUM(a.kredit),0) AS kredit FROM trdju_pkd a 
											INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
											WHERE SUBSTR(a.kd_rek5,1,$test1) IN ($kode_1)
											AND MONTH(b.tgl_voucher)<='$bul'");  
$debet=0;
$kredit=0;
				 foreach($q->result_array() as $r){
					$debet  = $r['debet'];
					$kredit = $r['kredit'];
				 }
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;

			
					$nilai=$debet-$kredit;
			

				   if ($seq=='105'){
                	$asik=$kredit-$debet;	
                	$asik1=$uraian;				
                	$asik2=$kode;	
                }

                
                $nil= number_format($nilai,"2",".",",");                

    switch ($seq) {
                    case 5:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                    
                                    </tr>";
                        break; 
                    case 30:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; &nbsp;&nbsp;&nbsp;<b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b>$nil</b></td>
                                    
                                    </tr>";
                        break;                               
                     case 40:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                    
                                    </tr>";
                        break; 
                    case 60:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b>$nil</b></td>
                                    
                                    </tr>";
                        break;     
                        case 65:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                    
                                    </tr>";
                        break; 
					     case 95:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b>$nil</b></td>
                                    
                                    </tr>";
                        break;   
					 case 145:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                    
                                    </tr>";
                        break;                        
                    case 100:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td> 
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$uraian</b></td>                                    
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$reallalu</b></td>
                                    
                                    </tr>";
                        break; 
                                                                                                                                 
                    default:
                if($uraian<>'' && $seq<'105'){
                    $cRet    .= "
                                <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>  
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>                                   
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nil</td>
                                    
                                 </tr>";
                }else if ($uraian=='' && $seq<'105' ){
					 $cRet    .= "
                                <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    
                                 </tr>";	
				}

                }

		
                
			}
            
        $cRet .='</table>';	
		
		
		
		
		
		
		
$cRet .="<table style=\"border-collapse:collapse; font-size:12;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"2\">
                    <tr>        
						<td align=\"LEFT\" style=\" border-bottom:none;\" width=\"20%\" colspan=\"2\">&nbsp;</td>
					</tr>

                    <tr>        
						<td align=\"LEFT\" style=\" border-bottom:none;border-top:none\" width=\"20%\" colspan=\"2\"><b>SiLPA TAHUN LALU YANG BERSUMBER DARI DANA <i>EARMARKED</i></b></td>
					</tr> 
					    ";


 $cRet .='</table>';
		
		
		$cRet .='<TABLE border="1" cellspacing="0" cellpadding="0" width="100%" >
					
                     <TR>
                        <TD width="5%" align="center" ><b>NO</b></TD>
						<TD width="45%" align="center" ><b>JENIS</b></TD>
						<TD width="25%" align="center" ><b>NILAI</b></TD>
					 </TR>
                    
                     <TR>
                        <TD width="5%" align="center" ><b></b></TD>
						<TD width="45%" align="center" ><b></b></TD>
						<TD width="25%" align="center" ><b></b></TD>
						
					 </TR>
					
				';
				
				
				
				
			
			$query = $this->db->query("SELECT kode,uraian,seq,normal,ifnull(kode_1,\"''\") as kode_1,nilai_lalu FROM map_kas ORDER BY kode ");  
			foreach($query->result_array() as $res){
				
				$kode   = $res['kode'];
				$uraian = $res['uraian'];
				$seq    = $res['seq'];
				$normal = $res['normal'];
                $reallalu1 = $res['nilai_lalu'];
				$reallalu = number_format($reallalu1,"2",".",",");  
				$kode_1 = $res['kode_1'];
                

             
                $test1 = '';
					if($kode_1 <> ''){
						$test  = explode(',',$kode_1);
						$test1 = strlen($test[0]);
						if($test1>7){
							$test1 =7;

						}
					}										

				$q = $this->db->query("SELECT ifnull(SUM(a.debet),0) AS debet,ifnull(SUM(a.kredit),0) AS kredit FROM trdju_pkd a 
											INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
											WHERE SUBSTR(a.kd_rek5,1,$test1) IN ($kode_1)
											AND MONTH(b.tgl_voucher)<='$bul'");  
$debet=0;
$kredit=0;
				 foreach($q->result_array() as $r){
					$debet1  = $r['debet'];
					$kredit1 = $r['kredit'];
				 }
				
				if ($debet1=='') $debet1=0;
				if ($kredit1=='') $kredit1=0;

			
			if($normal==0){
					$nilai=$debet1-$kredit1;
					}else{
					$nilai=$kredit1-$debet1;
					}
			

				

                
                $nil= number_format($nilai,"2",".",",");  	
				
							
    switch ($seq) {
                    case 110:
                         $cRet    .= "
                                                                        <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b>$nil</b></td>
                                    
                                    </tr>";
                        break; 
                    case 115:
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b>$nil</b></td>
                                    
                                    </tr>";
                        break;                               
                     case 120:
                         $cRet    .= "
                                                                       <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b>$nil</b></td>
                                    
                                    </tr>";
                        break; 
                   
				   case 165:
                         $cRet    .= "
                                                                       <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b>$nil</b></td>
                                    
                                    </tr>";
                        break; 
						case 170:
                         $cRet    .= "
                                                                       <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b>$nil</b></td>
                                    
                                    </tr>";
                        break; 
						case 175:
                         $cRet    .= "
                                                                       <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b>$nil</b></td>
                                    
                                    </tr>";
                        break; 
						case 180:
                         $cRet    .= "
                                                                       <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b>$nil</b></td>
                                    
                                    </tr>";
                        break; 
						case 185:
                         $cRet    .= "
                                               <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; <b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b>$nil</b></td>
                                    
                                    </tr>";
                        break; 
                                                                                                                                 
                    default:
                if($uraian<>'' && $seq>'106'){
                    $cRet    .= "
                                <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>  
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>                                   
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nil</td>
                                    
                                 </tr>";
                }else if ($uraian=='' && $seq>'106' ){
					 $cRet    .= "
                                <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                    
                                 </tr>";	
				}

                }

				
				}

	
				
				
				
			 $cRet .='</table>';
			 

$cRet .="<table style=\"border-collapse:collapse; font-size:12;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"2\">
              

                    <tr>        
						<td align=\"LEFT\" style=\" border-bottom:none;border-top:none\" width=\"20%\" colspan=\"2\"><b>LAPORAN POSISI KAS BULAN</b></td>
					</tr> 
					    ";


 $cRet .='</table>';













 
			$cRet .='<TABLE border="1" cellspacing="0" cellpadding="0" width="100%" >
					
                     <TR>
                        <TD width="5%" align="center" ><b>NO</b></TD>
						<TD width="45%" align="center" ><b>JENIS</b></TD>
						<TD width="25%" align="center" ><b>NILAI</b></TD>
					 </TR>
                    
                     <TR>
                        <TD width="5%" align="center" ><b></b></TD>
						<TD width="45%" align="center" ><b></b></TD>
						<TD width="25%" align="center" ><b></b></TD>
						
					 </TR>
					
				';

$cRet .="  <tr>
<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$asik2</td> 
<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$asik1</td> 
<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"RIGHT\">$asik</td> 

</tr>";

$pfk = $this->db->query("SELECT SUM(z.ls) as f FROM(
SELECT SUM(b.nilai) AS ls FROM trhsp2d a INNER JOIN trspmpot b ON a.no_spm=b.no_spm WHERE jns_spp IN ('4','5','6') AND MONTH(tgl_sp2d)<='$bul'
UNION ALL
SELECT SUM(c.nilai) AS ls FROM trhsp2d a INNER JOIN trhtrmpot b ON a.no_sp2d=b.no_sp2d INNER JOIN 
trdtrmpot c ON c.no_bukti=b.no_bukti WHERE a.jns_spp IN ('1','2','3') AND MONTH(tgl_sp2d)<='$bul'
)z");  

	 foreach($pfk->result_array() as $pf){

$kf = $pf['f'];
}

$cRet .="<tr>
<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">2</td> 
<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">Perhitungan Pihak Ketiga(PFK)</td> 
<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"RIGHT\">".number_format($kf,"2",".",",")."</td> 

</tr>";



	$qa = $this->db->query("SELECT IFNULL(SUM(b.nilai),0) as n FROM trhsp2d a INNER JOIN trdspp b ON a.no_spp=b.no_spp WHERE no_kas_bud='' OR no_kas_bud IS NULL AND MONTH(tgl_sp2d)='$bul'");  

				 foreach($qa->result_array() as $s){
				
					$sp2d = $s['n'];

}				 
$cRet.=" <tr>
<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">3</td> 
<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">SPM DAN SP2D YANG BELUM DICAIRKAN DI BANK</td> 
<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"RIGHT\">".number_format($sp2d,"2",".",",")."</td> 

</tr>
 ";


 $cRet .='</table>';	




			


		$cRet .= " <br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='1.20.05.00' AND kode='KD'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                       
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><B>KEPALA BPKAD KABUPATEN BIAK NUMFOR</B> </td>
                        </tr>
						
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b><u>DR. ENIAS RUMBEWAS, SE., M.Si</u></b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>NIP. 19640623 199610 1 001</b></td>
                        </tr>
						
						
						
					

                    </table>";             
            	 
		    //$this->tukd_model->_mpdf('',$cRet,10,5,10,'0');	
			
			$cetak = $this->uri->segment(3);
	  $data['prev']= $cRet;    
        switch($cetak) {
        case 0;
           // $this->template->load('template','anggaran/rka/perkadaII',$data);
		   $this->tukd_model->_mpdf('',$cRet,3,3,3,'0');	
        break;
        case 1;
			//$skpdx=$kd_skpd.' '.$nm_skpd;
             $this->tukd_model->_mpdf('',$cRet,3,3,3,'0');	
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= KAS_BUL.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        
        }
	}
	
	

	
function cetak_neracasaldo_all(){
        $thn_ang	= $this->session->userdata('pcThang');
        $kd_skpd	= '1.20.05.01';//$_REQUEST['skpd'];
        $bulan		= $_REQUEST['tgl1'];
        $lcperiode  = $this->tukd_model->getBulan($bulan);
        $tgl_ttd	= $_REQUEST['tgl_ttd'];		
		
        $sqlsc = "SELECT kab_kota,daerah FROM sclient";
		$sqlsclient=$this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc){
			$kota   = $rowsc->kab_kota;
			$daerah = $rowsc->daerah;
		}

        $csql2 = "SELECT nm_skpd FROM ms_skpd WHERE kd_skpd = '$kd_skpd'";
            $hasil2   = $this->db->query($csql2);
            $trh4     = $hasil2->row();          
            $lcNmskpd = $trh4->nm_skpd;
			
        $sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$kd_skpd' and kode='PA'";
		$sqlttd=$this->db->query($sqlttd1);
		foreach ($sqlttd->result() as $rowttd){
			$nip	 = $rowttd->nip;                    
			$nama	 = $rowttd->nm;
			$jabatan = $rowttd->jab;
		}			

        $cRet = '';
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
					<tr>
						<td colspan=\"4\" align=\"center\" style=\"font-size:14px;border: solid 1px white;\"><b>PEMERINTAH $kota<br>NERACA SALDO</b></td>
					</tr>
					<tr>
						<td colspan=\"4\" align=\"center\" style=\"font-size:14px;border: solid 1px white;\">Bulan $lcperiode</td>
					</tr> 			
					<tr>
						<td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
					</tr>
					<tr>
						<td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
					</tr>
					<tr>
						<td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
					</tr>
					
					</table>";
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
            <thead>
			<tr>
                <td bgcolor=\"#CCCCCC\" rowspan=\"2\" align=\"center\" width=\"5%\" style=\"font-size:12px\">Kode Rekening</td>
                <td bgcolor=\"#CCCCCC\" rowspan=\"2\" align=\"center\" width=\"55%\" style=\"font-size:12px\">Nama Rekening</td>
                <td bgcolor=\"#CCCCCC\" colspan=\"2\" align=\"center\" width=\"40%\" style=\"font-size:12px\">Jumlah</td>          
            </tr> 
            <tr>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"20%\" style=\"font-size:12px\">Debet</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"20%\" style=\"font-size:12px\">Kredit</td>         
            </tr>			
            <tr>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">1</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">2</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">3</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">4</td>            
            </tr> 
			</thead>
			<tfoot>
				<tr><td style=\"border-bottom: none; border-left:none;border-right:none;\" colspan=\"4\"></td>
			</tfoot>            
            ";
			
			$sql = "SELECT a.kd_rek5,a.nm_rek5,
						IF(LEFT(a.kd_rek5,1) IN ('1','5','6','9') || LEFT(a.kd_rek5,2) IN ('72'),SUM(debet)-SUM(kredit),0) AS debet,
						IF(LEFT(a.kd_rek5,1) IN ('0','2','3','4','8') || LEFT(a.kd_rek5,2) IN ('71'),SUM(kredit)-SUM(debet),0) AS kredit 
						FROM trdju_pkd a 
						INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
						WHERE  MONTH(b.tgl_voucher)<='$bulan' and YEAR(tgl_voucher)='$thn_ang'
						GROUP BY a.kd_rek5
						ORDER BY a.kd_rek5
					";          
      

					$hasil = $this->db->query($sql);       
					$saldo=0;
					foreach ($hasil->result() as $row){
					   $kd_rek5  = $row->kd_rek5 ;
					   $nm_rek5  = $row->nm_rek5;
					   $debet    = $row->debet; 
					   $kredit   = $row->kredit;
					   
					if($debet<0){
						$xy="("; 
						$debet=$debet*-1; 
						$yx=")";						   
					}else{
						$xy=""; 
						$debet=$debet*1; 
						$yx="";					   
					}
					$debet1 = number_format($debet,2,',','.');
					
					if($kredit<0){
						$as="("; 
						$kredit=$kredit*-1; 
						$sa=")";						   
					}else{
						$as=""; 
						$kredit=$kredit*1; 
						$sa="";					   
					}
					$kredit1 = number_format($kredit,2,',','.');					

						$cRet .="<tr>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$kd_rek5</td>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$nm_rek5</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$xy$debet1$yx</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$as$kredit1$sa</td>                                    
								  </tr>";                              
					} 

			$sql = "SELECT a.kd_rek5,
						IF(LEFT(a.kd_rek5,1) IN ('1','5','6','9') || LEFT(a.kd_rek5,2) IN ('72'),SUM(debet)-SUM(kredit),0) AS debet,
						IF(LEFT(a.kd_rek5,1) IN ('0','2','3','4','8') || LEFT(a.kd_rek5,2) IN ('71'),SUM(kredit)-SUM(debet),0) AS kredit 
						FROM trdju_pkd a 
						INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
						WHERE  MONTH(b.tgl_voucher)<='$bulan' and YEAR(tgl_voucher)='$thn_ang'
						GROUP BY a.kd_rek5
					";          

					$hasil = $this->db->query($sql);       
					$debeta1  = 0;
					$debeta11  = 0;
					$kredita1 = 0;
					foreach ($hasil->result() as $row){
					   $debet    = $row->debet; 
					   $kredit   = $row->kredit;
					 
					   $debeta1  = $debeta1+$debet;
					   $kredita1 = $kredita1+$kredit;
					   
						if($debeta1<0){
							$qw="("; 
							$debeta11=$debeta1*-1; 
							$wq=")";						   
						}else{
							$qw=""; 
							$debeta11=$debeta1*1; 
							$wq="";					   
						}
						$debeta11 = number_format($debeta11,2,',','.');
						
						if($kredita1<0){
							$zx="("; 
							$kredita11=$kredita1*-1; 
							$xz=")";						   
						}else{
							$zx=""; 
							$kredita11=$kredita1*1; 
							$xz="";					   
						}
						$kredit11 = number_format($kredita11,2,',','.');	                           
					}
						$cRet .="<tr>
								  <td colspan=\"2\" valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"><b>Total</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"><b>$qw$debeta11$wq</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"><b>$zx$kredit11$xz</b></td>                                    
								  </tr>";   					
         $cRet .="<tr>
                    <td valign=\"top\" align=\"left\" style=\"font-size:12px;border: solid 1px white;border-top:solid 1px black;\">&nbsp;</td>
                    <td valign=\"top\" align=\"center\" style=\"font-size:12px;border: solid 1px white;border-top:none;\">&nbsp;</td>
                    <td valign=\"top\" align=\"center\" style=\"font-size:12px;border: solid 1px white;border-top:none;\">&nbsp;</td>
                 </tr>

                <tr>
                    <td align=\"center\" colspan=\"3\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    <td align=\"center\" style=\"font-size:12px;border: solid 1px white;\">$daerah, tanggal ".$this->tanggal_format_indonesia($tgl_ttd)."</td>                                                                                                                                                                                
                </tr>
                <tr>                
                    <td align=\"center\" colspan=\"3\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    <td align=\"center\" style=\"font-size:12px;border: solid 1px white;\"><b>$jabatan</b></td>                    
                </tr>
                <tr>
                    <td align=\"left\" colspan=\"3\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    <td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
                </tr>
                <tr>
                    <td align=\"left\" colspan=\"3\" style=\"font-size:12px;border: solid 1px white;\">&nbsp;</td>
                    <td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
                </tr>
                <tr>
                    <td align=\"left\" colspan=\"3\" style=\"font-size:12px;border: solid 1px white;\">&nbsp;</td>
                    <td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
                </tr>
                <tr>
                    <td align=\"left\" colspan=\"3\" style=\"font-size:12px;border: solid 1px white;\">&nbsp;</td>
                    <td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
                </tr>
                <tr>
                    <td align=\"center\" colspan=\"3\" style=\"font-size:12px;border: solid 1px white;\"><u></u></td>
                    <td align=\"center\" style=\"font-size:12px;border: solid 1px white;\"><u>$nama</u></td>
                </tr>
                <tr>
                    <td align=\"center\" colspan=\"3\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    <td align=\"center\" style=\"font-size:12px;border: solid 1px white;\">$nip</td>
                </tr>";                     

         $cRet .='</table>';
         $data['prev']= $cRet;    
        // $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
		 
		 
		 
$ctk = $this->uri->segment(3);

            $data['prev']= $cRet;
            switch($ctk) {        
                case 1;
                   $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
                break;
                case 2;        
                    header("Cache-Control: no-cache, no-store, must-revalidate");
                    header("Content-Type: application/vnd.ms-excel");
                    header("Content-Disposition: attachment; filename=neracasaldo.xls");
                    $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            } 
    }
	
function neracasaldoall(){
        $data['page_title']= 'CETAK NERACA SALDO';
        $this->template->set('title', 'CETAK NERACA SALDO');   
        $this->template->load('template','akuntansi/neracasaldoall',$data) ;	
	}


	 function kertas_kerja(){
        $data['page_title'] = 'KERTAS KERJA';
        $this->template->set('title', 'KERTAS KERJA');
        $this->template->load('template', 'akuntansi/kertas_kerja', $data);
    }

	
function cetak_kertas_kerja1(){
	ini_set("memory_limit",-1);
	$cRet = '';
	$csqlskpd = "select * from ms_skpd where kd_skpd<>'' order by kd_skpd ";
$jmlsatker = $this->db->query($csqlskpd)->num_rows();//20;
$lbrkol = 70/(($jmlsatker+1)*2);

$tes = (($jmlsatker+1)*2)+2;

$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
<thead>
	<tr>
		<td bgcolor=\"#CCCCCC\" rowspan=\"2\" align=\"center\" width=\"5%\" style=\"font-size:12px\">Kode Rekening</td>
		<td bgcolor=\"#CCCCCC\" rowspan=\"2\" align=\"center\" width=\"2%\" style=\"font-size:12px\">Nama Rekening</td>";

		$lcrow = $this->db->query($csqlskpd);
		foreach($lcrow->result() as $row1){
			$cRet .="      
			<td bgcolor=\"#CCCCCC\" colspan=\"2\" align=\"center\" style=\"font-size:12px\">$row1->kd_skpd</td>  ";
		}


		$cRet .="   <td bgcolor=\"#CCCCCC\" colspan=\"2\" align=\"center\" style=\"font-size:12px\">Jumlah</td>          
	</tr> 
	<tr>";
		for($i=0;$i<$jmlsatker+1;$i++){
			$cRet .="
			<td bgcolor=\"#CCCCCC\" align=\"center\" width=\"$lbrkol%\" style=\"font-size:12px\">debet</td>
			<td bgcolor=\"#CCCCCC\" align=\"center\" width=\"$lbrkol%\" style=\"font-size:12px\">kredit</td>";         
		}
		$cRet .="

	</tr>           
</thead>
";

$sql = "SELECT a.kd_rek5,a.nm_rek5 
FROM trdju_pkd a  INNER JOIN TRHJU_PKD B ON A.no_voucher=B.no_voucher AND A.kd_skpd=B.kd_skpd WHERE YEAR(tgl_voucher)='2016'
GROUP BY a.kd_rek5
ORDER BY a.kd_rek5 
";          

$hslrek = $this->db->query($sql);
foreach($hslrek->result() as $rowrek){     
	$cRet .="<tr>
	<td align=\"left\" width=\"$lbrkol%\" style=\"font-size:12px\">$rowrek->kd_rek5</td>
	<td align=\"left\" width=\"$lbrkol%\" style=\"font-size:12px\">$rowrek->nm_rek5</td>
	";
	$clkdrek = $rowrek->kd_rek5;
	$jmlsamping_db = 0;
	$jmlsamping_kr = 0;
	foreach($lcrow->result() as $row2){
		$kd_skpd = $row2->kd_skpd;

		$sql2 = "SELECT sum(debet) as debet, sum(kredit) as kredit 
		FROM trdju_pkd a   INNER JOIN TRHJU_PKD B ON A.no_voucher=B.no_voucher AND A.kd_skpd=B.kd_skpd WHERE YEAR(tgl_voucher)='2016' 
		AND a.kd_skpd='$kd_skpd' and a.kd_rek5 = '$clkdrek'
		";    

		$hslangak = $this->db->query($sql2)->row();

		$jmlsamping_db = $jmlsamping_db + $hslangak->debet;
		$jmlsamping_kr = $jmlsamping_kr + $hslangak->kredit;    

		$cRet .="
		<td align=\"right\" width=\"$lbrkol%\" style=\"font-size:12px\">$hslangak->debet</td>
		<td align=\"right\" width=\"$lbrkol%\" style=\"font-size:12px\">$hslangak->kredit </td>";         
	}
	$cRet .="   
	<td align=\"right\" width=\"$lbrkol%\" style=\"font-size:12px\">$jmlsamping_db</td>
	<td align=\"right\" width=\"$lbrkol%\" style=\"font-size:12px\">$jmlsamping_kr</td>           
</tr>";

}

$cRet .="</table>";
$data['prev']= $cRet;
$cetak = 2;
$this->template->set('title', 'CETAK PERDA');
// $this->_mpdf1('',$cRet,25,10,10,'P','',$hal);

switch($cetak) {
	case 0;
	echo ("<title>L R A</title>"); 
	echo $cRet;
	break;      
	case 1;
	$this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
	break;
	case 2;        
	header("Cache-Control: no-cache, no-store, must-revalidate");
	header("Content-Type: application/vnd.ms-excel");
	header("Content-Disposition: attachment; filename= kertas_kerja.xls");
	$this->load->view('akuntansi/view_excel_word', $data);
	break;
	case 3;     
	header("Cache-Control: no-cache, no-store, must-revalidate");
	header("Content-Type: application/vnd.ms-word");
	header("Content-Disposition: attachment; filename= kertas_kerja.doc");
	$this->load->view('akuntansi/view_excel_word', $data);
	break;

}

}
      function bukubesarkonsol(){

        $data['page_title'] = 'CETAK BUKU BESAR';
        $this->template->set('title', 'BUKU BESAR');
        $this->template->load('template', 'akuntansi/bukubesarkonsol', $data);

    }

	
	function cetakbbkonsol(){
	
	$tglttd  = $_REQUEST['tglttd'];
			$dcetak  = $_REQUEST['dcetak'];
			$dcetak2 = $_REQUEST['dcetak2'];
			//$skpd 	 = $_REQUEST['skpd'];
			$rek5 	 = $_REQUEST['rek5'];
			$space 	 = $_REQUEST['space'];
			$nip     = $_REQUEST['nip'];		
			$nip1    = $_REQUEST['nip1'];	
				$gl    = $_REQUEST['gl'];
				
		 $cetak = $this->uri->segment(3);
						   
						   /*if($skpd=='1.20.05.01'){
								$skpd='1.20.08.00';
						   }else{
						   $skpd=$skpd;
						   }*/
            
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                $sqlsclient=$this->db->query($sqlsc);
                foreach ($sqlsclient->result() as $rowsc){
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                }
				       //$sqlttd="SELECT jabatan,nip,nama from ms_ttd where kd_skpd = '$skpd' and nip='$nip'";
					   $sqlttd="SELECT jabatan,nip,nama from ms_ttd where nip='$nip'";
         $z=0;
         $sqlsclient=$this->db->query($sqlttd);
         foreach ($sqlsclient->result() as $rowst)
        {
            $nipt     = $rowst->nip;
            $jabatant  = $rowst->jabatan;
            $namat     = $rowst->nama;
            $z++;
        }

            if($z=='0'){
                $nipt='BELUM ADA NIP';
                $namat='BELUM ADA NAMA';
                $jabatant='BELUM ADA JABATAN';
            
        } 

			//$sqlttd1="SELECT jabatan,nip,nama from ms_ttd where kd_skpd = '$skpd' and nip='$nip1'";
			$sqlttd1="SELECT jabatan,nip,nama from ms_ttd where nip='$nip1'";
					 $z=0;
					 $sqlsclient1=$this->db->query($sqlttd1);
					 foreach ($sqlsclient1->result() as $rowst1)
					{
						$nipt1     = $rowst1->nip;
						$jabatant1  = $rowst1->jabatan;
						$namat1     = $rowst1->nama;
						$z++;
					}

						if($z=='0'){
							$nipt1='BELUM ADA NIP';
							$namat1='BELUM ADA NAMA';
							$jabatant1='BELUM ADA JABATAN';
						
					} 				


if($rek5=='0000000'){

	$nmrek="Perubahan Sal";
}else{

		$sqlnm="SELECT nm_rek64 as nm_rek5 FROM ms_rek5 WHERE kd_rek64='$rek5'";
                $sqlnmrek=$this->db->query($sqlnm);
                foreach ($sqlnmrek->result() as $row){
                	$nmrek=$row->nm_rek5;
                	          }

}


		if((substr($rek5,0,1)=='0')||(substr($rek5,0,1)=='1')||(substr($rek5,0,1)=='2')||(substr($rek5,0,1)=='3')
				||(substr($rek5,0,1)=='8')||(substr($rek5,0,1)=='9')){
						$pokok = '0.00';
						$ubah  = '0.00';
		}else{
			/*$sqlpg="SELECT
						IFNULL((SELECT nilai FROM trdrka WHERE kd_skpd='$skpd' AND kd_rek5='$rek5'),0) AS pokok,
						IFNULL((SELECT nilai_ubah FROM trdrka WHERE kd_skpd='$skpd' AND kd_rek5='$rek5'),0) AS ubah";*/
			$sqlpg="SELECT
						IFNULL((SELECT sum(nilai) FROM trdrka WHERE kd_rek5='$rek5'),0) AS pokok,
						IFNULL((SELECT sum(nilai_ubah) FROM trdrka WHERE kd_rek5='$rek5'),0) AS ubah FROM trdrka limit 1";
					$sqlnilpg=$this->db->query($sqlpg);
					foreach ($sqlnilpg->result() as $row){
						if($row->pokok==0.00){
						$pok = '0.00';
						}else{
						$pok = $row->pokok;
						}
						if($row->ubah==0.00){
						$uba = '0.00';
						}else{
						$uba = $row->ubah;
						}
						$pokok = number_format($pok,'2',',','.');
						$ubah  = number_format($uba,'2',',','.');
					}		
		}
		//$cRet .="<TABLE style="border-collapse:collapse;" width="100%" align="center" border="1" cellspacing="0" cellpadding="4">

				$cRet ="<table width=\"100%\" border=\"0\" >
					<tr>
						<td align=\"RIGHT\" style=\"font-size:8\"><b>PEMERINTAH $kab</b></td>
					</tr>
					<tr>
						<td align=\"RIGHT\" style=\"font-size:8\"><b>BADAN PENGELOLA KEUANGAN DAN ASET DAERAH</b></td>
					</tr>
					<tr>
						<td align=\"RIGHT\" style=\"font-size:8\"><b>BIDANG AKUNTANSI</b></td>
					</tr>
					</table>";
		
			$cRet .="<table width=\"100%\">
					<tr>
						<td align=\"center\" ><b>BUKU BESAR </b></td>
					</tr>
					</table>";
			$cRet .="<br>";
			/*
			<tr>
						<td align=\"left\" width=\"25%\" >SKPD</td>
						<td align=\"left\" width=\"75%\" >: $skpd ".$this->tukd_model->get_nama($skpd,'nm_skpd','ms_skpd','kd_skpd')."</td>
					 </tr>
			*/	
			$cRet .="<table width=\"100%\">					 
					 <tr>
						<td align=\"left\" width=\"25%\" >KODE REKENING</td>
						<td align=\"left\" width=\"75%\" >: $rek5</td>
					 </tr>
					 <tr>
						<td align=\"left\" width=\"25%\" >NAMA REKENING</td>
						<td align=\"left\" width=\"75%\" >: $nmrek</td>
					 </tr> 
					 <tr>
						<td align=\"left\" width=\"25%\" >PAGU APBD</td>
						<td align=\"left\" width=\"75%\" >: $pokok</td>
					 </tr>
					 <tr>
						<td align=\"left\" width=\"25%\" >PAGU PERUBAHAN APBD</td>
						<td align=\"left\" width=\"75%\" >: $ubah</td>
					 </tr>                                                              
					 <tr>
						<td align=\"left\" width=\"25%\" >Periode</td>
						<td align=\"left\" width=\"75%\" >: ".$this->tukd_model->tanggal_format_indonesia($dcetak)." s/d ".$this->tukd_model->tanggal_format_indonesia($dcetak2)."</td>
					 </tr>
					 </table>";

			$cRet .='<TABLE style="border-collapse:collapse;" width="100%" align="center" border="1" cellspacing="0" cellpadding="4">
					 <THEAD>
					 <TR>
						<TD width="20%"  bgcolor="#CCCCCC" align="center" >TANGGAL</TD>
						<TD width="30%" bgcolor="#CCCCCC" align="center" >URAIAN</TD>
						<TD width="5%" bgcolor="#CCCCCC" align="center" >REF</TD>
						<TD width="15%" bgcolor="#CCCCCC" align="center" >DEBET</TD>
						<TD width="15%" bgcolor="#CCCCCC" align="center" >KREDIT</TD>
						<TD width="15%" bgcolor="#CCCCCC" align="center" >SALDO</TD>
					 </TR>
					 <TR>
						<TD width="20%" bgcolor="#CCCCCC" align="center">1</TD>
						<TD width="30%" bgcolor="#CCCCCC" align="center">2</TD>
						<TD width="5%" bgcolor="#CCCCCC" align="center">3</TD>
						<TD width="15%" bgcolor="#CCCCCC" align="center">4</TD>
						<TD width="15%" bgcolor="#CCCCCC" align="center">5</TD>
						<TD width="15%" bgcolor="#CCCCCC" align="center">6</TD>
					 </TR>                     
					 </THEAD>';
					 
			$thn_ang=$this->session->userdata('pcThang')-1;

         $csql3 = "SELECT IF(SUM(a.debet)IS NULL,0,SUM(a.debet)) AS debet,IF(SUM(a.kredit)IS NULL,0,SUM(a.kredit)) AS kredit FROM trdju_pkd a 
                        LEFT JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_skpd WHERE a.kd_rek5='$rek5' 
                        and b.tgl_voucher <'$dcetak'";
						
         $hasil = $this->db->query($csql3);
         $trh4 = $hasil->row(); 
         $awaldebet = $trh4->debet;
         $awalkredit = $trh4->kredit;		 
                    
					if ((substr($rek5,0,1)=='9') or (substr($rek5,0,1)=='5') or (substr($rek5,0,2)=='62') or (substr($rek5,0,2)=='72') or (substr($rek5,0,1)=='1')){					
						$saldo=$awaldebet-$awalkredit;
					}else{
						$saldo=$awalkredit-$awaldebet;
					} 
                    
                    $cRet .='<TR>
								<TD width="20%" align="left" ></TD>
								<TD width="35%" align="left" >saldo awal</TD>
								<TD width="5%" align="left" ></TD>
								<TD width="15%" align="right" >'.number_format($awaldebet,2,',','.').'</TD>
								<TD width="15%" align="right" >'.number_format($awalkredit,2,',','.').'</TD>
								<TD width="15%" align="right" >'.number_format($saldo,2,',','.').'</TD>
							 </TR>';	      
                
				$idx=1;
				$query = $this->db->query("SELECT a.kd_rek5,a.debet,a.kredit,b.tgl_voucher,b.ket,b.no_voucher FROM trdju_pkd a 
                                           LEFT JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_skpd WHERE a.kd_rek5='$rek5' 
                                           AND b.tgl_voucher between '$dcetak' AND '$dcetak2'
                                           ORDER BY b.tgl_voucher,a.no_voucher,a.urut");                                                   
				if ($query->num_rows() > 0){
					$jdebet=0;
					$jkredit=0;
					foreach($query->result_array() as $res){
											
						$tgl_voucher=$res['tgl_voucher'];
						$ket=$res['ket'];
						$ref=$res['no_voucher'];
						$debet=$res['debet'];
						$kredit=$res['kredit'];
						$idx++;
						
						$saldo=$saldo;
						if ((substr($rek5,0,1)=='9') or (substr($rek5,0,1)=='5') or (substr($rek5,0,2)=='62') 
                                    or (substr($rek5,0,2)=='72') or (substr($rek5,0,1)=='1')){					
							$saldo=$saldo+$debet-$kredit;
							
						}else{
							$saldo=$saldo+$kredit-$debet;
							
						}						
						$cRet .='<TR>
									<TD width="20%" align="left" >'.$this->tukd_model->tanggal_format_indonesia($tgl_voucher).'</TD>
									<TD width="35%" align="left" >'.$ket.'</TD>
									<TD width="5%" align="left" >'.$ref.'</TD>
									<TD width="15%" align="right" >'.number_format($debet,2,',','.').'</TD>
									<TD width="15%" align="right" >'.number_format($kredit,2,',','.').'</TD>
									<TD width="15%" align="right" >'.number_format($saldo,2,',','.').'</TD>
								 </TR>';
								 
						$jdebet=$jdebet+$debet;
						$jkredit = $jkredit + $kredit;

					}
					$cRet .='<TR>
                                <TD align="left" ></TD>
        						<TD colspan=\"3\" align="right" ><b>JUMLAH</b></TD>
                                <TD align="left" ></TD>
        						<TD align="right" ><b>'.number_format($jdebet,2,',','.').'</b></TD>
        						<TD align="right" ><b>'.number_format($jkredit,2,',','.').'</b></TD>
        						<TD align="right" ><b>'.number_format($saldo,2,',','.').'</b></TD>
        					 </TR>';
					$cRet .='</TABLE>';				 
				} else{
				$cRet .='</TABLE>';
				}
			
/*	   $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$skpd' and kode='PA'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

	  $sqlttd2=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$skpd' and kode='BK'");
	   foreach($sqlttd2->result() as $ttd2){
			$nip1=empty($ttd2->nip) || $ttd2->nip== null ?'&nbsp;' :$ttd2->nip;
			$nama1=empty($ttd2->nama) || $ttd2->nama== null ?'&nbsp;' :$ttd2->nama;
			$jabatan1=empty($ttd2->jabatan) || $ttd2->jabatan== null ?'&nbsp;' :$ttd2->jabatan;
	   }
	   $sqld=$this->db->query("select daerah from sclient");
	   $hasil=$sqld->row();
	   $daerah=$hasil->daerah;*/
		  $last=date('Y-m-t',strtotime($dcetak2));




		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\"  style=\"font-size:12\" align=\"left\" border=\"0\">";
                           for($i=0;$i<=$space;$i++){
                $cRet .="<tr>
                            <td colspan=\"3\">&nbsp;</td>
                        </tr>";
            }

                        $cRet.="<tr>
							<td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td>
                        </tr>
						<tr>
							<td colspan=\"2\" width=\"41%\" align=\"center\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tglttd)."</td>
                        </tr>
						<tr>
							<td colspan=\"2\" width=\"41%\" align=\"center\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\"><b>DIBUAT OLEH</b></td>
                        </tr>
						
						<tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
						<tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
						<tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
						
						<tr>
							<td colspan=\"2\" width=\"41%\" align=\"center\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\"><b><u>$namat</u></b></td>
                        </tr>
						<tr>
							<td colspan=\"2\" width=\"41%\" align=\"center\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\"><b>NIP : $nipt</b></td>
                        </tr>

                    </table>"; 

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" style=\"font-size:12\" align=\"left\" border=\"0\">
                      	<tr><td colspan=\"3\" width=\"41%\" align=\"center\">MENGETAHUI,</td></tr>
						
						<tr>
							<td width=\"41%\" align=\"center\"><b>KEPALA BIDANG AKUNTANSI</b></td>
                            <td width=\"18%\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\"><b>$jabatant1</b></td>
                        </tr>
							<tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
							<tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
							<tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
						<tr>
							<td width=\"41%\" align=\"center\"><b><u>ROMEL TIMISELA,S.Sos., MM</u></b></td>
                            <td width=\"18%\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\"><b><u>$namat1</u></b></td>
                        </tr>
						<tr>
							<td width=\"41%\" align=\"center\"><b>NIP : 19710501 199703 1 002</b></td>
                            <td width=\"18%\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\"><b>NIP : $nipt1</b></td>
                        </tr>

                    </table>"; 
                    		$cRet .="<table style=\"border-collapse:collapse;\" style=\"font-size:12\" width=\"100%\" align=\"left\" border=\"0\">
                      <tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
						<tr>
							<tr><td colspan=\"3\" width=\"41%\" align=\"center\">MENYETUJUI,</td></tr>
                        </tr>
						<tr><td colspan=\"3\" width=\"41%\" align=\"center\"><B>KEPALA BPKAD BIAK NUMFOR</td></B></tr>
						<tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
						<tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
						<tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>";
						
						
						if($gl==1){
                
						$cRet .="<tr>
							<td colspan=\"3\" width=\"41%\" align=\"center\"><b><u>ENIAS RUMBEWAS,SE.,M.Si</u></b></td>
                       
                        </tr>";
}else{
						$cRet .="<tr>
							<td colspan=\"3\" width=\"41%\" align=\"center\"><b><u>DR. ENIAS RUMBEWAS,SE.,M.Si</u></b></td>
                       
                        </tr>";
}


						
						
						
					$cRet .="<tr>
						<td colspan=\"3\" width=\"41%\" align=\"center\"><b>NIP : 19640623 199610 1 001</b></td>
                        </tr>

                    </table>"; 
	
			/*$data['prev']= 'BUKU BESAR';
            $this->tukd_model->_mpdf('',$cRet,10,5,10,'0');	*/
			ini_set("memory_limit",-1);






 $data['prev']= $cRet;
          
          $this->template->set('title', 'CETAK PERDA');
       // $this->_mpdf1('',$cRet,25,10,10,'P','',$hal);
         
        switch($cetak) {
			case 0;
				 echo ("<title>L R A</title>"); 
				 echo $cRet;
			break;		
			case 1;
				$this->tukd_model->_mpdf('',$cRet,10,5,10,'0');	
			break;
			case 2;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= kertas_kerja.xls");
				$this->load->view('akuntansi/view_excel_word', $data);
			break;
			case 3;     
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= kertas_kerja.doc");
				$this->load->view('akuntansi/view_excel_word', $data);
			break;
        
        }

		}
 //konsinyering



	
	
	
	
  function cpro()
    {
        $data['page_title'] = '  ';
        $this->template->set('title', ' ');
        $this->template->load('template', 'akuntansi/cemes', $data);
    }

		   
    function prognosis2106(){
	    $id        = $this->session->userdata('kdskpd');
$thn_ang   = $this->session->userdata('pcThang');

        $tgl_ttd   = $_REQUEST['tgl_ctk']; 
  	
		$cetak = $this->uri->segment(3);

       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                }  
     




			
$sqlaja="SELECT
(SELECT IFNULL(SUM(kredit)-SUM(debet),0) AS bone FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE MONTH(tgl_voucher)BETWEEN 1 AND 3  
AND LEFT(kd_rek5,1)='4')AS pone,
(SELECT IFNULL(SUM(debet)-SUM(kredit),0) AS bone FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE MONTH(tgl_voucher)BETWEEN 1 AND 3  
AND LEFT(kd_rek5,1)='5')AS bone,
(SELECT IFNULL(SUM(debet)-SUM(kredit),0) AS tone FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE MONTH(tgl_voucher)BETWEEN 1 AND 3  
AND LEFT(kd_rek5,1)='6')AS tone,
(SELECT IFNULL(SUM(kredit)-SUM(debet),0) AS btri FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE MONTH(tgl_voucher)BETWEEN 1 AND 6  
AND LEFT(kd_rek5,1)='4')AS ptri,
(SELECT IFNULL(SUM(debet)-SUM(kredit),0) AS btri FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE MONTH(tgl_voucher)BETWEEN 1 AND 6  
AND LEFT(kd_rek5,1)='5')AS btri,
(SELECT IFNULL(SUM(debet)-SUM(kredit),0) AS ttri FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE MONTH(tgl_voucher)BETWEEN 1 AND 6  
AND LEFT(kd_rek5,1)='6')AS ttri";

$queryaja   = $this->db->query($sqlaja);
$hasilaja  = $queryaja->row();	

$tbone=0;
$tbtri=0;
$sone=0;
$stri=0;

$pone  = $hasilaja->pone;
$bone  = $hasilaja->bone;
$tone  = $hasilaja->tone;
$btri  = $hasilaja->btri;
$ttri  = $hasilaja->ttri;
$ptri  = $hasilaja->ptri;


$tbone=$bone+$tone;
$tbtri=$btri+$ttri;





$tbone1 = number_format($tbone,"2",".",",");			
$tbtri1  = number_format($tbtri,"2",".",",");			



//surplus
//pendapatan-belanja+transfer

$sone=$pone-$tbone;
$stri=$ptri-$tbtri;

if($sone < 0){
	$s1="(";
	$sone=$sone*-1;
	$s2=")";
}else{
	$s1="";
	$sone=$sone;
	$s2="";
}
$sone1  = number_format($sone,"2",".",",");			



if($stri < 0){
	$s1="(";
	$stri=$stri*-1;
	$s2=")";
}else{
	$s1="";
	$stri=$stri;
	$s2="";
}
$stri1  = number_format($stri,"2",".",",");			


$sqlone="SELECT IFNULL(SUM(debet)-SUM(kredit),0) AS one FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE MONTH(tgl_voucher)BETWEEN 1 AND 3  
AND (kd_rek5='62' OR LEFT(kd_rek5,5)='62' OR LEFT(kd_rek5,3)='62' OR LEFT(kd_rek5,2)='62' OR LEFT(kd_rek5,1)='62' OR LEFT(kd_rek5,7)='62')
";

$query111   = $this->db->query($sqlone);
$hasilone   = $query111->row();	
$one  = $hasilone->one;

$sqltri="SELECT IFNULL(SUM(debet)-SUM(kredit),0) AS tri FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE MONTH(tgl_voucher)BETWEEN 1 AND 6  
AND (kd_rek5='62' OR LEFT(kd_rek5,5)='62' OR LEFT(kd_rek5,3)='62' OR LEFT(kd_rek5,2)='62' OR LEFT(kd_rek5,1)='62' OR LEFT(kd_rek5,7)='62')
";

$query1112   = $this->db->query($sqltri);
$hasiltri   = $query1112->row();	
$tri  = $hasiltri->tri;



	
        $cRet='';       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td style=\"font-size:18px;\" align=\"center\"><strong>&nbsp;</strong></td>                         
                    </tr>                    
					<tr>
                         <td style=\"font-size:18px;\" align=\"center\"><strong>PEMERINTAH $kab</strong></td>                         
                    </tr>
					<tr>
                         <td style=\"font-size:16px;\" align=\"center\"><strong>LAPORAN REALISASI APBD s.d SEMESTER I</strong></td>                         
                    </tr>                                      
                    <tr>
                         <td align=\"center\"><strong>TAHUN ANGGARAN $thn_ang</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
                    <td bgcolor=\"#CCCCCC\" width=\"8%\" align=\"center\"><b>NO URUT</b></td>                            
                    <td bgcolor=\"#CCCCCC\" width=\"60%\" align=\"center\"><b>URAIAN</b></td>
                    <td bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>Realisasi s/d  Triwulan I (Januari s/d Maret)</b></td>
					<td bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>Realisasi s/d  Semester I (Januari s/d Juni)</b></td>
                            
                            
                        </tr>  
                        <tr><td bgcolor=\"#CCCCCC\" align=\"center\">1</td>                            
                            <td bgcolor=\"#CCCCCC\"  align=\"center\">2</td>
                            <td bgcolor=\"#CCCCCC\"  align=\"center\">3</td>
                            <td bgcolor=\"#CCCCCC\"  align=\"center\">4</td>
                            
                            
                        </tr>
						</thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                        
                            
                         </tr>
                     </tfoot>";



		  $sql4 ="SELECT level,nor,uraian,seq,normal,kode_1
FROM map_prognosis_2016 a ORDER BY CAST(nor AS SIGNED)";
		$query4 = $this->db->query($sql4);                                  
		foreach ($query4->result() as $row4){
			$level      = $row4->level;
			$no         = $row4->nor;
			$nama       = $row4->uraian;   
			$seq        = $row4->seq;
			$normal     = $row4->normal;
			$kode1		= $row4->kode_1;

			 	$le='';
			 $lclen=strlen($level);

			 if($lclen=='3'){

			 	$le='&nbsp;&nbsp;&nbsp;';
			 }

			
			$sqld = $this->db->query("SELECT IFNULL(SUM(debet),0) AS debet FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE MONTH(tgl_voucher)BETWEEN 1 AND 3  
					AND (kd_rek5='$kode1' or LEFT(kd_rek5,5)='$kode1' OR LEFT(kd_rek5,3)='$kode1' OR LEFT(kd_rek5,2)='$kode1' OR LEFT(kd_rek5,1)='$kode1' OR LEFT(kd_rek5,7)='$kode1')");
			foreach($sqld->result() as $sqldeb){
			$debet = $sqldeb->debet ; 
 
			$sqlk = $this->db->query("SELECT IFNULL(SUM(kredit),0) AS kredit FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE MONTH(tgl_voucher)BETWEEN 1 AND 3  
					AND (kd_rek5='$kode1' or LEFT(kd_rek5,5)='$kode1' OR LEFT(kd_rek5,3)='$kode1' OR LEFT(kd_rek5,2)='$kode1' OR LEFT(kd_rek5,1)='$kode1' OR LEFT(kd_rek5,7)='$kode1')");
			foreach($sqlk->result() as $sqlkre){
			$kredit = $sqlkre->kredit ; 

			if($normal=='K'){
			  $nilai = $kredit-$debet;
			}else{
			  $nilai = $debet-$kredit;    
			}


if($nilai < 0){
	$t1="(";
	$nilai=$nilai*-1;
	$t2=")";
}else{
	$t1="";
	$nilai=$nilai;
	$t2="";
}

$nil  = number_format($nilai,"2",".",",");					
			}					}
			
			



			
	$sqld1 = $this->db->query("SELECT IFNULL(SUM(debet),0) AS debet FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE MONTH(tgl_voucher)BETWEEN 1 AND 6  
					AND (kd_rek5='$kode1' or LEFT(kd_rek5,5)='$kode1' OR LEFT(kd_rek5,3)='$kode1' OR LEFT(kd_rek5,2)='$kode1' OR LEFT(kd_rek5,1)='$kode1' OR LEFT(kd_rek5,7)='$kode1')");
			foreach($sqld1->result() as $sqldeb1){
			$debet1 = $sqldeb1->debet ; 
 
			$sqlk1 = $this->db->query("SELECT IFNULL(SUM(kredit),0) AS kredit FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE MONTH(tgl_voucher)BETWEEN 1 AND 6  
					AND (kd_rek5='$kode1' or LEFT(kd_rek5,5)='$kode1' OR LEFT(kd_rek5,3)='$kode1' OR LEFT(kd_rek5,2)='$kode1' OR LEFT(kd_rek5,1)='$kode1' OR LEFT(kd_rek5,7)='$kode1')");
			foreach($sqlk1->result() as $sqlkre1){
			$kredit1 = $sqlkre1->kredit ; 

			if($normal=='K'){
			  $nilai1 = $kredit1-$debet1;
			}else{
			  $nilai1 = $debet1-$kredit1;    
			}



if($nilai1 < 0){
	$r1="(";
	$nilai1=$nilai1*-1;
	$r2=")";
}else{
	$r1="";
	$nilai1=$nilai1;
	$r2="";
}







$nil1  = number_format($nilai1,"2",".",",");					
			}					}
$o=0;
$o1=0;		
			
			if($seq=='220'||$seq=='215'){

$o=$nilai+$one;
$o1=$nilai1+$tri;		

$nil  = number_format($o,"2",".",",");				
$nil1  = number_format($o1,"2",".",",");				
		}
			
                    switch ($row4->seq) {
                    case (($row4->seq==5)||($row4->seq==10)||($row4->seq==45)||($row4->seq==215)||($row4->seq==220)||($row4->seq==265)
						 ||($row4->seq==310)||($row4->seq==335)||($row4->seq==420)||($row4->seq==430)||($row4->seq==505)):
                         $cRet    .= "
                         			<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$level</b></td> 
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$le<b>$nama</b></td>                                    
                                     <td  align=\"right\"><b>$t1$nil$t2</b></td>
                                     <td  align=\"right\"><b>$r1$nil1$r2</b></td>
                                    </tr>";




                        break;

                         case (($row4->seq==50)||($row4->seq==196)||($row4->seq==85)||($row4->seq==115)||($row4->seq==180)):
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$level<b></td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         
                                       
                                     </tr>";
                        break;



                    case 400:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$level</td> 
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>    
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$tbone1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$tbtri1</b></td>
	


                                       
                                     </tr>";
                        break;		
                    case 410:
                        $cRet    .= "<tr>
  										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$level</td> 
                                     	<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>                                             
                                     	<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$sone1</b></td>
                                        <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $stri1</b></td>

                                         
                                       
                                     </tr>";
                        break;		
                   		
                    default:
					if($nama <> ''){
                    $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"LEFT\">$level</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nil</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nil1</td>
                                     
                                     
                                 </tr>";
					}else{
					 $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"LEFT\">$level</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     
                                     
                                 </tr>";	
					}
                }         
                }
                

        $cRet .=       " </table>";
		$cRet .= " <br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id' and kode='PA'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)." </td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>BUPATI BIAK NUMFOR<b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>THOMAS ONDY, SE.,MM</b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b></b></td>
                        </tr>
                    </table>"; 

            // $this->tukd_model->_mpdf('',$cRet,10,10,10,'1');

                    
        $data['prev'] = $cRet;
        $data['sikap'] = 'preview';
        $judul = 'LAPORAN LRA';
        $this->template->set('title', 'CETAK LAPORAN REALISASI ANGGARAN');
        switch ($cetak)
        {
            case 1;
              
             	$this->tukd_model->_mpdf('',$cRet,5,5,5,'0'); 
                break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= LAPORAN_LRA.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }    
	}
	
	
	
	
	
	//BARU  5 AUGST 2016 21.43 WIT
	
	

		    function cetak_baru_bulan(){
	    $id        = $this->session->userdata('kdskpd');
$thn_ang   = $this->session->userdata('pcThang');
//		$thn_ang   = '2015';
        $bul       = $_REQUEST['bulan'];
        $bulan     = $this->tukd_model->getBulan($bul); 
        $tgl_ttd   = $_REQUEST['tgl_ctk']; 
		
		$apbd=$_REQUEST['apbd'];
		
        $thn_ang_1 = $thn_ang-1;
        $lastmoth  = $thn_ang.'-'.$bul.'-'.'01';
		$lastyear  = date('Y-m-t',strtotime($lastmoth)); 
		$str	   = strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear)); 		
		$cetak = $this->uri->segment(3);

       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                }  
				
				
				if($apbd==0){
				$rka='nilai';
				}else{
				$rka='nilai_ubah';
				}
     
$sql="SELECT 
		(SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,1)='4') AS angpen,
		(SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,1)='5') AS angbel,
		(SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='61') AS angpentrans,
		(SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='62') AS angbeltrans,
		(SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='71') AS angpenepemb,
		(SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='72') AS angpengpemb,
		(SELECT IFNULL(SUM(b.kredit)-SUM(b.debet),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
			WHERE LEFT(b.kd_rek5,1)='4' AND MONTH(a.tgl_voucher)<='$bul') AS totpen,
		(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
			WHERE LEFT(b.kd_rek5,1)='5' AND MONTH(a.tgl_voucher)<='$bul') AS totbel,
		(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
			WHERE LEFT(b.kd_rek5,2)='61' AND MONTH(a.tgl_voucher)<='$bul') AS totpentrans,
		(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0)  AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
			WHERE LEFT(b.kd_rek5,2)='62' AND MONTH(a.tgl_voucher)<='$bul')AS totbeltrans,
		(SELECT IFNULL(SUM(b.kredit)-SUM(b.debet),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
			WHERE LEFT(b.kd_rek5,2)='71' AND MONTH(a.tgl_voucher)<='$bul') AS totpenepemb,
		(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
			WHERE LEFT(b.kd_rek5,2)='72' AND MONTH(a.tgl_voucher)<='$bul') AS totpengpemb";
	
			 
			 
                    $query   = $this->db->query($sql);
                    $hasil   = $query->row();
                    $angpen  = $hasil->angpen;
                    $angbel  = $hasil->angbel;
					$angpentrans = $hasil->angpentrans;
					$angbeltrans = $hasil->angbeltrans;
					$angtrans = $hasil->angpentrans+$hasil->angbeltrans;
					$angpenepemb = $hasil->angpenepemb;
					$angpengpemb = $hasil->angpengpemb;
					$silang	= $hasil->angpenepemb-$hasil->angpengpemb;
                    $totpen  = $hasil->totpen;
                    $totbel  = $hasil->totbel;
					$totpentrans = $hasil->totpentrans;
					$totbeltrans = $hasil->totbeltrans;
					$tottrans = $hasil->totpentrans+$hasil->totbeltrans;
					$totpenepemb = $hasil->totpenepemb;
					$totpengpemb = $hasil->totpengpemb;
					$silreal = $hasil->totpenepemb-$hasil->totpengpemb;
					$silreal1 = $hasil->totpenepemb-$hasil->totpengpemb;

	//**--------------------------------transfer-----------------------------------------------	
		$abeltrans = $angbel+$angtrans;
		if($abeltrans < 0){$q1="(";$abeltrans=$abeltrans*-1;$q2=")";}else{$q1="";$abeltrans=$abeltrans;$q2="";}
        $abeltrans1 = number_format($abeltrans,"2",".",",");
		
		$rbeltrans = $totbel+$tottrans;
		if($rbeltrans < 0){$q3="(";$rbeltrans=$rbeltrans*-1;$q4=")";}else{$q3="";$rbeltrans=$rbeltrans;$q4="";}
        $rbeltrans1 = number_format($rbeltrans,"2",".",",");
		
		if ($abeltrans<>0){$per4 = ($abeltrans!=0)?($rbeltrans/$abeltrans)*100:0;}else if($abeltrans==0 and $rbeltrans!=0){$per4=100;} else{$per4=0;}                
		$persen4 = number_format($per4,"2",".",",");			
	//**--------------------------------surplus------------------------------------------------
        $surang = $angpen-($angbel+$angtrans);
        if ($surang < 0){$w1="(";$surang=$surang*-1;$w2=")";}else{$w1="";$surang=$surang;$w2="";}						
        $surang1= number_format($surang,"2",".",",");
        
        $surrel = $totpen-($totbel+$tottrans);
        if ($surrel < 0){$w3="(";$surrel=$surrel*-1;$w4=")";}else{$w3="";$surrel=$surrel;$w4="";}				
        $surrel1= number_format($surrel,"2",".",",");	

		if ($surang<>0){$per5 = ($surang!=0)?($surrel/$surang)*100:0;}else if($surang==0 and $surrel!=0){$per5=100;} else{$per5=0;}                
		$persen5 = number_format($per5,"2",".",",");		
	//**------------------------------netto Pemby------------------------------------------------	
		if($silang < 0){$e1="(";$silang=$silang*-1;$e2=")";}else{$e1="";$silang=$silang;$e2="";}
        $apemb1 = number_format($silang,"2",".",",");
		
		if($silreal < 0){$e3="(";$silreal=$silreal*-1;$e4=")";}else{$e3="";$silreal=$silreal;$e4="";}
        $rpemb1 = number_format($silreal,"2",".",",");
		
		if ($silang<>0){$per2 = ($silang!=0)?($silreal/$silang)*100:0;}else if($silang==0 and $silreal!=0){$per2=100;} else{$per2=0;}                
		$persen2 = number_format($per2,"2",".",",");
	//**-----------------------------Silpa------------------------------------------------				
		$apemby = ($angpen+$silang)-($angbel+$angtrans);
		if($apemby < 0){$r1="(";$apemby=$apemby*-1;$r2=")";}else{$r1="";$apemby=$apemby;$r2="";}
        $apemby1 = number_format($apemby,"2",".",",");
		
		//$rpemby = ($totpen+$silreal1)-($totbel+$tottrans);
		
		$rpemby=$totpen-($totbel+$tottrans)+$silreal1;
		if($rpemby < 0){$r3="(";$rpemby=$rpemby*-1;$r4=")";}else{$r3="";$rpemby=$rpemby;$r4="";}
        $rpemby1 = number_format($rpemby,"2",".",",");
		
		if ($apemby<>0){$per3 = ($apemby!=0)?($rpemby/$apemby)*100:0;}else if($apemby==0 and $rpemby!=0){$per3=100;}else{$per3=0;}                
		$persen3 = number_format($per3,"2",".",",");		
	
        $cRet='';       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                                  
					<tr>
                         <td  COLSPAN=\"2\" style=\"font-size:14px;\" align=\"center\"><strong>RINGKASAN REALISASI APBD BULANAN</strong></td>
                    </tr>
					<tr>       
					<td align=\"left\" style=\" border-right:none;font-size:12px;border-top:none;border-bottom:none;\" width=\"15%\" ><b>Tahun Anggaran</b></td>

					<td align=\"left\" style=\"border-bottom:none;font-size:12px;border-top:none;border-left:none\" ><b>: $thn</b></td>
					</tr>                   

					<tr>       
					<td align=\"left\" style=\" border-right:none;border-top:none;font-size:12px;border-bottom:none\" ><b>Bulan</b></td>
					<td align=\"left\" style=\"border-bottom:none;font-size:12px;border-top:none;border-left:none\" >: <b>$bulan</b></td>					
					</tr>                   

					<tr>       
					<td align=\"left\" style=\" border-right:none;font-size:12px;border-top:none;border-bottom:none\" ><b>Nama Daerah</b></td>
					<td align=\"left\" style=\"border-bottom:none;font-size:12px;border-top:none;border-left:none\" >: <b>$kab</b></td>					
					</tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"8%\" align=\"center\"><b>NO URUT</b></td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"47%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>Anggaran $thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>Realisasi $thn_ang</b></td>
                          
                            
                        </tr>  
                        <tr><td bgcolor=\"#CCCCCC\" align=\"center\">1</td>                            
                            <td bgcolor=\"#CCCCCC\"  align=\"center\">2</td>
                            <td bgcolor=\"#CCCCCC\"  align=\"center\">3</td>
                            <td bgcolor=\"#CCCCCC\"  align=\"center\">4</td>
                          
                            
                        </tr>
						</thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                          
                            
                         </tr>
                     </tfoot>";


/* //dana desa
 $sqldesa ="SELECT IFNULL(SUM(kredit)-SUM(debet),0) AS nildesa FROM  trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE MONTH(tgl_voucher)<='$bul' AND kd_rek5='4220306'";
$querydesa = $this->db->query($sqldesa);                                  
		foreach ($querydesa->result() as $rowd){
				$nildesa         = $rowd->nildesa;
			}

 $sqlangdesa ="SELECT IFNULL(SUM(nilai_ubah),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 
WHERE (c.kd_rek64='4220306')";
$queryangdesa = $this->db->query($sqlangdesa);                                  
		foreach ($queryangdesa->result() as $rowda){
				$anggnil         = $rowda->nilai;
			}
// */
		  $sql4 ="SELECT nor,uraian,seq,normal,kode_1,
						(SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 
						WHERE (c.kd_rek64=a.kode_1 or LEFT(c.kd_rek64,5)=a.kode_1 OR LEFT(c.kd_rek64,3)=a.kode_1 OR LEFT(c.kd_rek64,2)=a.kode_1 OR LEFT(c.kd_rek64,1)=a.kode_1)) AS anggaran
						FROM map_bul_baru a ORDER BY CAST(nor AS SIGNED)";
		$query4 = $this->db->query($sql4);                                  
		foreach ($query4->result() as $row4){
			$no         = $row4->nor;
			$nama       = $row4->uraian;   
			$anggaran   = $row4->anggaran;
			$anggaran1   = $row4->anggaran;
			$angg  		= number_format($anggaran,"2",".",",");
			$seq        = $row4->seq;
			$normal     = $row4->normal;
			$kode1		= $row4->kode_1;
			
			$sqld = $this->db->query("SELECT IFNULL(SUM(debet),0) AS debet FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE MONTH(tgl_voucher)<='$bul' 
					AND (kd_rek5='$kode1' or LEFT(kd_rek5,5)='$kode1' OR LEFT(kd_rek5,3)='$kode1' OR LEFT(kd_rek5,2)='$kode1' OR LEFT(kd_rek5,1)='$kode1' OR LEFT(kd_rek5,7)='$kode1')");
			foreach($sqld->result() as $sqldeb){
			$debet = $sqldeb->debet ; 

			$sqlk = $this->db->query("SELECT IFNULL(SUM(kredit),0) AS kredit FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE MONTH(tgl_voucher)<='$bul' 
					AND (kd_rek5='$kode1' or LEFT(kd_rek5,5)='$kode1' OR LEFT(kd_rek5,3)='$kode1' OR LEFT(kd_rek5,2)='$kode1' OR LEFT(kd_rek5,1)='$kode1' OR LEFT(kd_rek5,7)='$kode1')");
			foreach($sqlk->result() as $sqlkre){
			$kredit = $sqlkre->kredit ; 

			if($normal=='K'){
			  $nilai = $kredit-$debet;
			}else{
			  $nilai = $debet-$kredit;    
			}
$nil  = number_format($nilai,"2",".",",");






//Jumlah Transfer Pemerintah Pusat-Dana Transfer 

if($seq=='70'){

$transfer=0;
$transfer1=0;
 $trans ="SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 
WHERE LEFT(c.kd_rek64,5) IN ('42101','42102','42103')";
$querytrans = $this->db->query($trans);                                  
		foreach ($querytrans->result() as $rowe){
				$tf         = $rowe->nilai;

$transfer=$tf;
				$angg  		= number_format($transfer,"2",".",",");
			}

 $trans1 ="SELECT IFNULL(SUM(kredit)-SUM(debet),0) AS aaa FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE MONTH(tgl_voucher)<='$bul' 
AND LEFT(kd_rek5,5) IN ('42101','42102','42103')";
$querytrans1 = $this->db->query($trans1);                                  
		foreach ($querytrans1->result() as $rowe){
				$aaa         = $rowe->aaa;
			}

$transfer1=$aaa;
$nil  = number_format($transfer1,"2",".",",");
}




//dakDana Alokasi Khusus Fisik
if($seq=='80'){

$daki=0;
$daki1=0;
 $sqldak ="SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 
WHERE c.kd_rek64='4210423'";
$querydesa = $this->db->query($sqldak);                                  
		foreach ($querydesa->result() as $rowd){
				$dak         = $rowd->nilai;

$daki=$anggaran-$dak;
				$angg  		= number_format($daki,"2",".",",");
			}

 $sqldak1 ="SELECT IFNULL(SUM(kredit)-SUM(debet),0) AS aaa FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE MONTH(tgl_voucher)<='$bul' 
AND kd_rek5='4210423'";
$querydesa1 = $this->db->query($sqldak1);                                  
		foreach ($querydesa1->result() as $rowd){
				$aaa         = $rowd->aaa;
			}

$daki1=$nilai-$aaa;
$nil  = number_format($daki1,"2",".",",");
}







//Dana Insentif Daerah

if($seq=='100'){

$suaian=0;
$suaian1=0;
 $sqldakii ="SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 
WHERE c.kd_rek64='4220306'";
$querysuai = $this->db->query($sqldakii);                                  
		foreach ($querysuai->result() as $rowd){
				$dak         = $rowd->nilai;

$suaian=$anggaran-$dak;
				$angg  		= number_format($suaian,"2",".",",");
			}

 $sqldakii1 ="SELECT IFNULL(SUM(kredit)-SUM(debet),0) AS aaa FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE MONTH(tgl_voucher)<='$bul' 
AND kd_rek5='4220306'";
$querysuai1 = $this->db->query($sqldakii1);                                  
		foreach ($querysuai1->result() as $rowd){
				$aaa         = $rowd->aaa;
			}

$suaian1=$nilai-$aaa;
$nil  = number_format($suaian1,"2",".",",");
}


//Total Transfer Pemerintah Pusat
if($seq=='125'){

$tottransfer=0;
$tottransfer1=0;
 $trans ="SELECT IFNULL(SUM($rka),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 
WHERE LEFT(c.kd_rek64,3) IN ('421','422')";
$querytotransfer = $this->db->query($trans);                                  
		foreach ($querytotransfer->result() as $rowe){
				$tf         = $rowe->nilai;

$tottransfer=$tf;
				$angg  		= number_format($tottransfer,"2",".",",");
			}

 $trans1 ="SELECT IFNULL(SUM(kredit)-SUM(debet),0) AS aaa FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE MONTH(tgl_voucher)<='$bul' 
AND LEFT(kd_rek5,3) IN ('421','422')";
$querytotransfer1 = $this->db->query($trans1);                                  
		foreach ($querytotransfer1->result() as $rowe){
				$aaa         = $rowe->aaa;
			}

$tottransfer1=$aaa;
$nil  = number_format($tottransfer1,"2",".",",");
}





	
					if ($anggaran<>0){$per1 = ($anggaran!=0)?($nilai/$anggaran)*100:0;}else if($anggaran==0 and $nilai!=0){$per1=100;} else{$per1=0;}                
			$persen1 = number_format($per1,"2",".",",");
/* 
if($seq==105){


$ok=$anggaran1-$anggnil;
	$angg= number_format($ok,"2",".",",");


$desa=$nilai-$nildesa ;
$nil  = number_format($desa,"2",".",",");



		if ($ok<>0){$per1 = ($ok!=0)?($desa/$ok)*100:0;}else if($ok==0 and $desa!=0){$per1=100;} else{$per1=0;}                
			$persen1 = number_format($per1,"2",".",",");
}else if($seq==165) {

	$ok=$anggaran1+$anggnil;
	$angg  		= number_format($ok,"2",".",",");

	$desa=$nilai+$nildesa ;
$nil  = number_format($desa,"2",".",",");

if ($ok<>0){$per1 = ($ok!=0)?($desa/$ok)*100:0;}else if($ok==0 and $desa!=0){$per1=100;} else{$per1=0;}                
			$persen1 = number_format($per1,"2",".",",");
	# code...
}
	 */		
			}}					
                    switch ($row4->seq) {
                    case (($row4->seq==5)||($row4->seq==10)||($row4->seq==45)||($row4->seq==50)||($row4->seq==75)||($row4->seq==95)
						 ||($row4->seq==130)||($row4->seq==150)||($row4->seq==180)||($row4->seq==215)||($row4->seq==220)
						 ||($row4->seq==265)||($row4->seq==310)||($row4->seq==335)||($row4->seq==340)||($row4->seq==370)
						 ||($row4->seq==420)||($row4->seq==430)||($row4->seq==505)):
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"center\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         
                                       
                                     </tr>";
                        break;
                    case (($row4->seq==35)||($row4->seq==70)||($row4->seq==90)||($row4->seq==120)||($row4->seq==125)||($row4->seq==145)
						 ||($row4->seq==170)||($row4->seq==175)||($row4->seq==200)
						 ||($row4->seq==205)||($row4->seq==255)||($row4->seq==300)||($row4->seq==325)||($row4->seq==320)||($row4->seq==360)||($row4->seq==395)||($row4->seq==390)
						||($row4->seq==500)||($row4->seq==580)):
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"center\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         
                                       
                                     </tr>";
                        break;	
                    case 400:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"center\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$q1$abeltrans1$q2</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$q3$rbeltrans1$q4</b></td>
                                         
                                       
                                     </tr>";
                        break;		
                    case 410:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"center\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$w1$surang1$w2</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$w3$surrel1$w4</b></td>
                                         
                                       
                                     </tr>";
                        break;		
                   
                    case 585:
                                              $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"center\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$e1$apemb1$e2</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$e3$rpemb1$e4</b></td>
                                        
                                       
                                     </tr>";
                        break;						
                    default:
					if($nama <> ''){
                    $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$angg</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nil</td>
                                     
                                     
                                 </tr>";
					}else{
					 $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"center\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     
                                     
                                 </tr>";	
					}
                }         
                }

        $cRet .=       " </table>";
		$cRet .= " <br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id' and kode='PA'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }


 $uye       = $_REQUEST['uye'];	   
	   
	   if($uye==1){
	   
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                      
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)." </td>
                        </tr>
					
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>BUPATI BIAK NUMFOR<b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>THOMAS ONDY, SE.,MM</b></td>
                        </tr>
					
                    </table>"; 

					
					
					
					}else{
					
					
					
					
					
					
					
					
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                   
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)." </td>
                        </tr>
					
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>KEPALA BPKAD BIAK NUMFOR<b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>DR.ENIAS RUMBEWAS,SE.,M.Si</b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>NIP : 19640623 199610 1 001</b></td>
                        </tr>
                    </table>"; 
					
					
					}
					
					
					
					
					
					
            // $this->tukd_model->_mpdf('',$cRet,10,10,10,'1');

                    
        $data['prev'] = $cRet;
        $data['sikap'] = 'preview';
        $judul = 'LAPORAN LRA';
        $this->template->set('title', 'CETAK LAPORAN REALISASI ANGGARAN');
        switch ($cetak)
        {
            case 1;
              
             	$this->tukd_model->_mpdf('',$cRet,5,5,0,'0'); 
                break;
            case 2;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= LAPORAN_LRA.xls");

                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            case 3;
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= $judul.doc");
                $this->load->view('anggaran/rka/perkadaII', $data);
                break;
        }

                 
    }   
	
	
	//".$this->angka($btl)."
	
	function angka($nilai){

//$this->angka($surplus89lalu);
	if($nilai<0){
		$lc = '('.number_format(abs($nilai),2,'.',',').')';
	}else{
		if($nilai==0){
			$lc ="0.00";
		}else{
			$lc = number_format($nilai,2,'.',',');
		}
	}

	return $lc;
}
	
	
	
	
	
	function cetak_sp2d_semester(){
		$cetak = $this->uri->segment(3);
        $thn_ang	= $this->session->userdata('pcThang');
        $kd_skpd	= $_REQUEST['skpd'];

        $pilih = $_REQUEST['cpilih'];
        if($pilih==2){
            $keg=$_REQUEST['keg'];
        }
		
        $sqlsc = "SELECT kab_kota,daerah FROM sclient";
		$sqlsclient=$this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc){
			$kota   = $rowsc->kab_kota;
			$daerah = $rowsc->daerah;
		}

        $csql2 = "SELECT nm_skpd FROM ms_skpd WHERE kd_skpd = '$kd_skpd'";
            $hasil2   = $this->db->query($csql2);
            $trh4     = $hasil2->row();          
            $lcNmskpd = $trh4->nm_skpd;			

        $cRet = '';
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
					<tr>
						<td colspan=\"4\" align=\"center\" style=\"font-size:14px;border: solid 1px white;\"><b>PEMERINTAH $kota<br>LAPORAN REALISASI SP2D</b></td>
					</tr>			
					<tr>
						<td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
					</tr>
					<tr>
						<td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
					</tr>
					<tr>
						<td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
					</tr>
					<tr>
						<td width=\"5%\" align=\"left\" style=\"font-size:10px;border: solid 1px white;\">SKPD</td>
						<td width=\"95%\" align=\"left\" style=\"font-size:10px;border: solid 1px white;\">: $kd_skpd  $lcNmskpd</td>
					</tr>
					</table>";
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
            <thead>
			<tr>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"15%\" style=\"font-size:12px\">Kode</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"40%\" style=\"font-size:12px\">Uraian</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"15%\" style=\"font-size:12px\">Anggaran</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"15%\" style=\"font-size:12px\">Anggaran Ubah</td>  
				<td bgcolor=\"#CCCCCC\" align=\"center\" width=\"15%\" style=\"font-size:12px\">Realisasi</td>
				<td bgcolor=\"#CCCCCC\" align=\"center\" width=\"15%\" style=\"font-size:12px\">Sisa Anggaran</td> 
				<td bgcolor=\"#CCCCCC\" align=\"center\" width=\"9%\" style=\"font-size:12px\">Persen (%)</td> 
            </tr> 		
            <tr>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">1</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">2</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">3</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">4</td>  
				<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">5</td>
				<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">6</td>
				<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">6</td>
            </tr> 
			</thead>
			<tfoot>
				<tr><td style=\"border-bottom: none; border-left:none;border-right:none;\" colspan=\"7\"></td>
			</tfoot>            
            ";
			
 			
				if($pilih==1){
				
					if($kd_skpd=='1.20.05.01'){
							$sql = "SELECT * FROM(
SELECT a.kd_program AS kode,a.nm_program AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,
IFNULL((SELECT SUM(x.nilai) FROM trdspp X INNER JOIN trhsp2d Y ON x.no_spp=y.no_spp 
WHERE x.kd_Skpd='$kd_skpd' AND LEFT(kd_kegiatan,18)=a.kd_program AND MONTH(tgl_sp2d)<='6' ),0)
AS reali
FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' OR LEFT(b.kd_rek5,2)='62'
GROUP BY a.kd_program
UNION ALL
SELECT a.kd_kegiatan AS kode,a.nm_kegiatan AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,
IFNULL((SELECT SUM(x.nilai) FROM trdspp X INNER JOIN trhsp2d Y ON x.no_spp=y.no_spp WHERE x.kd_Skpd='$kd_skpd' 
AND LEFT(kd_kegiatan,18)=a.kd_program AND kd_kegiatan=a.kd_kegiatan AND MONTH(tgl_sp2d)<='6'),0)
AS reali
FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' OR LEFT(b.kd_rek5,2)='62'
GROUP BY a.kd_kegiatan
UNION
SELECT CONCAT(kd_kegiatan,'.',kd_rek5) AS kode,nm_rek5 AS nama,nilai AS angg_m, nilai_ubah AS angg,
IFNULL((SELECT SUM(x.nilai) FROM trdspp X INNER JOIN trhsp2d Y ON x.no_spp=y.no_spp 
WHERE x.kd_Skpd='$kd_skpd' AND kd_kegiatan=a.kd_kegiatan AND kd_rek5=a.kd_rek5 AND MONTH(tgl_sp2d)<='6'),0)
AS reali
FROM trdrka a WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek5,1)='5' OR LEFT(b.kd_rek5,2)='62'
)z ORDER BY kode";          
    				}else{
    					$sql = "SELECT * FROM(
SELECT a.kd_program AS kode,a.nm_program AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,
IFNULL((SELECT SUM(x.nilai) FROM trdspp X INNER JOIN trhsp2d Y ON x.no_spp=y.no_spp 
WHERE x.kd_Skpd='$kd_skpd' AND LEFT(kd_kegiatan,18)=a.kd_program AND MONTH(tgl_sp2d)<='6' ),0)
AS reali
FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' 
GROUP BY a.kd_program
UNION ALL
SELECT a.kd_kegiatan AS kode,a.nm_kegiatan AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,
IFNULL((SELECT SUM(x.nilai) FROM trdspp X INNER JOIN trhsp2d Y ON x.no_spp=y.no_spp WHERE x.kd_Skpd='$kd_skpd' 
AND LEFT(kd_kegiatan,18)=a.kd_program AND kd_kegiatan=a.kd_kegiatan AND MONTH(tgl_sp2d)<='6'),0)
AS reali
FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' 
GROUP BY a.kd_kegiatan
UNION
SELECT CONCAT(kd_kegiatan,'.',kd_rek5) AS kode,nm_rek5 AS nama,nilai AS angg_m, nilai_ubah AS angg,
IFNULL((SELECT SUM(x.nilai) FROM trdspp X INNER JOIN trhsp2d Y ON x.no_spp=y.no_spp 
WHERE x.kd_Skpd='$kd_skpd' AND kd_kegiatan=a.kd_kegiatan AND kd_rek5=a.kd_rek5 AND MONTH(tgl_sp2d)<='6'),0)
AS reali
FROM trdrka a WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek5,1)='5' 
)z ORDER BY kode"; 
    				}

					$hasil = $this->db->query($sql);       
					$saldo=0;
					foreach ($hasil->result() as $row){
					   $kode  = $row->kode ;
					   $nama  = $row->nama;
					   $angg    = $row->angg; 
					   $reali   = $row->reali;
					   $angg_m    = $row->angg_m;
					   
					if($angg<0){
						$xy="("; 
						$angg=$angg*-1; 
						$yx=")";						   
					}else{
						$xy=""; 
						$angg=$angg*1; 
						$yx="";					   
					}
					$angg1 = number_format($angg,2,',','.');
					
					if($reali<0){
						$as="("; 
						$reali=$reali*-1; 
						$sa=")";						   
					}else{
						$as=""; 
						$reali=$reali*1; 
						$sa="";					   
					}
					$reali1 = number_format($reali,2,',','.');
					
					$sisa = $row->angg-$row->reali;
					if($sisa<0){
						$df="("; 
						$sisa=$sisa*-1; 
						$fd=")";						   
					}else{
						$df=""; 
						$sisa=$sisa*1; 
						$fd="";					   
					}
					$sisa1 = number_format($sisa,2,',','.');
					
					$reapers = $angg-$reali ;
					if($reapers == 0){
						if($angg == 0 and $reali == 0){
						$per5x=0;
						}else{
						$per5x   = 0;
						}					
					}else if($reapers < 0){
					$per5x= ($reali!=0)?($reapers/$angg) * 100:0; 
					}else if($reapers > 0){
					$per5x=($reapers/$angg) * 100;
					}else{
					$per5x=0;
					}

					if($per5x < 0){
						$xx="("; 
						$per5x=$per5x*-1; 
						$yy=")";						   
					}else{
						$xx=""; 
						$per5x=$per5x*1; 
						$yy="";					   
					}
					$persenrea = number_format($per5x,"2",",",".");
					
					if((strlen($kode)<=21)){
						$cRet .="<tr>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$kode</b></td>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$nama</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>".number_format($angg_m,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$xy$angg1$yx</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$as$reali1$sa</b></td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$df$sisa1$fd</b></td>
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$xx$persenrea$yy</b></td>								  
								</tr>";
					}else{
						$cRet .="<tr>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$kode</td>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$nama</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">".number_format($angg_m,2,',','.')."</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$xy$angg1$yx</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$as$reali1$sa</td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$df$sisa1$fd</td> 
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$xx$persenrea$yy</td> 								  
								</tr>";   
					}					
					}
					if($kd_skpd=='1.20.05.01'){
					$sqltot="SELECT SUM(angg_m)AS tm,SUM(angg) AS tot, SUM(realix) AS treali FROM(
SELECT a.kd_program AS kode,a.nm_program AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,
IFNULL((SELECT SUM(x.nilai) FROM trdspp X INNER JOIN trhsp2d Y ON x.no_spp=y.no_spp 
WHERE x.kd_Skpd='$kd_skpd' AND LEFT(kd_kegiatan,18)=a.kd_program AND MONTH(tgl_sp2d)<='6' ),0)
AS realix
FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' OR LEFT(b.kd_rek5,2)='62'
GROUP BY a.kd_program)cc";
						}else{
							$sqltot="SELECT SUM(angg_m)AS tm,SUM(angg) AS tot, SUM(realix) AS treali FROM(
SELECT a.kd_program AS kode,a.nm_program AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,
IFNULL((SELECT SUM(x.nilai) FROM trdspp X INNER JOIN trhsp2d Y ON x.no_spp=y.no_spp 
WHERE x.kd_Skpd='$kd_skpd' AND LEFT(kd_kegiatan,18)=a.kd_program AND MONTH(tgl_sp2d)<='6' ),0)
AS realix
FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' 
GROUP BY a.kd_program)cc";
						}
							$hsl = $this->db->query($sqltot); 
							
							foreach ($hsl->result() as $row1){
					   			$totm=$row1->tm;
					   			$totangg    = $row1->tot; 
					   			$totreali   = $row1->treali;

					   			$rumus=$totangg-$totreali;

					   			if($totreali <> 0){
									$per5   = ($rumus!=0)?($rumus /$row1->tot) * 100:0; 
									}else if($totangg <> 0 and $totreali ==0){
										$per5=100;
									}else{
										$per5=0;
									}

                    			$persen5= number_format($per5,"2",".",",");
					   			
							}

							$cRet .="<tr>
								  <td valign=\"top\" colspan=\"2\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>TOTAL</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totm,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totangg,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totreali,2,',','.')."</b></td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($rumus,2,',','.')."</b></td> 
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($persen5,2,',','.')."</b></td> 								  
								</tr>";
					}else{
						
	$sql = "SELECT * FROM(
						SELECT a.kd_kegiatan AS kode,a.nm_kegiatan AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,
IFNULL((SELECT SUM(x.nilai) FROM trdspp X INNER JOIN trhsp2d Y ON x.no_spp=y.no_spp WHERE x.kd_Skpd='$kd_skpd' 
AND LEFT(kd_kegiatan,18)=a.kd_program AND kd_kegiatan=a.kd_kegiatan AND MONTH(tgl_sp2d)<='6'),0)
AS reali
FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' AND a.kd_kegiatan='$keg'
GROUP BY a.kd_kegiatan
UNION
SELECT CONCAT(kd_kegiatan,'.',kd_rek5) AS kode,nm_rek5 AS nama,nilai AS angg_m, nilai_ubah AS angg,
IFNULL((SELECT SUM(x.nilai) FROM trdspp X INNER JOIN trhsp2d Y ON x.no_spp=y.no_spp 
WHERE x.kd_Skpd='$kd_skpd' AND kd_kegiatan=a.kd_kegiatan AND kd_rek5=a.kd_rek5 AND MONTH(tgl_sp2d)<='6'),0)
AS reali
FROM trdrka a WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek5,1)='5' AND a.kd_kegiatan='$keg'
							)z ORDER BY kode";          



					$hasil = $this->db->query($sql);       
					$saldo=0;
					foreach ($hasil->result() as $row){
					   $kode  = $row->kode ;
					   $nama  = $row->nama;
					   $angg    = $row->angg; 
					   $reali   = $row->reali;
					   $angg_m    = $row->angg_m;
					   
					if($angg<0){
						$xy="("; 
						$angg=$angg*-1; 
						$yx=")";						   
					}else{
						$xy=""; 
						$angg=$angg*1; 
						$yx="";					   
					}
					$angg1 = number_format($angg,2,',','.');
					
					if($reali<0){
						$as="("; 
						$reali=$reali*-1; 
						$sa=")";						   
					}else{
						$as=""; 
						$reali=$reali*1; 
						$sa="";					   
					}
					$reali1 = number_format($reali,2,',','.');
					
					$sisa = $row->angg-$row->reali;
					if($sisa<0){
						$df="("; 
						$sisa=$sisa*-1; 
						$fd=")";						   
					}else{
						$df=""; 
						$sisa=$sisa*1; 
						$fd="";					   
					}
					$sisa1 = number_format($sisa,2,',','.');
					
					$reapers = $angg-$reali ;
					if($reapers == 0){
						if($angg == 0 and $reali == 0){
						$per5x=0;
						}else{
						$per5x   = 0;
						}					
					}else if($reapers < 0){
					$per5x= ($reali!=0)?($reapers/$angg) * 100:0; 
					}else if($reapers > 0){
					$per5x=($reapers/$angg) * 100;
					}else{
					$per5x=0;
					}

					if($per5x < 0){
						$xx="("; 
						$per5x=$per5x*-1; 
						$yy=")";						   
					}else{
						$xx=""; 
						$per5x=$per5x*1; 
						$yy="";					   
					}
					$persenrea = number_format($per5x,"2",",",".");
					
					if((strlen($kode)<=21)){
						$cRet .="<tr>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$kode</b></td>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$nama</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>".number_format($angg_m,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$xy$angg1$yx</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$as$reali1$sa</b></td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$df$sisa1$fd</b></td>
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$xx$persenrea$yy</b></td>								  
								</tr>";
					}else{
						$cRet .="<tr>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$kode</td>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$nama</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">".number_format($angg_m,2,',','.')."</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$xy$angg1$yx</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$as$reali1$sa</td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$df$sisa1$fd</td> 
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$xx$persenrea$yy</td> 								  
								</tr>";   
					}					
					}

					$sqltot="SELECT SUM(angg_m)AS tm,SUM(angg) AS tot, SUM(realix) AS treali FROM(
SELECT a.kd_kegiatan AS kode,a.nm_kegiatan AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,
IFNULL((SELECT SUM(x.nilai) FROM trdspp X INNER JOIN trhsp2d Y ON x.no_spp=y.no_spp WHERE x.kd_Skpd='$kd_skpd' 
AND LEFT(kd_kegiatan,18)=a.kd_program AND kd_kegiatan=a.kd_kegiatan AND MONTH(tgl_sp2d)<='6'),0)
AS realix
FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' AND a.kd_kegiatan='$keg'
GROUP BY a.kd_kegiatan
)cc";
							$hsl = $this->db->query($sqltot); 
							
							foreach ($hsl->result() as $row1){
					   			$totm=$row1->tm;
					   			$totangg    = $row1->tot; 
					   			$totreali   = $row1->treali;

					   			$rumus=$totangg-$totreali;

					   			if($totreali <> 0){
									$per5   = ($rumus!=0)?($rumus /$row1->tot) * 100:0; 
									}else if($totangg <> 0 and $totreali ==0){
										$per5=100;
									}else{
										$per5=0;
									}

                    			$persen5= number_format($per5,"2",".",",");
					   			
							}

							$cRet .="<tr>
								  <td valign=\"top\" colspan=\"2\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>TOTAL</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totm,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totangg,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totreali,2,',','.')."</b></td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($rumus,2,',','.')."</b></td> 
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($persen5,2,',','.')."</b></td> 								  
								</tr>";
					}
				

        $cRet .='</table>';
        $data['prev']= $cRet;    
        //$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
        switch($cetak) {        
        case 1;
              $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename=realisasi_belanja_skpd.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        }		
    }	

	
	
function reg_sp2d_mod_demansyah(){
       /* $cetak = $this->uri->segment(3);
        $posx  = $_REQUEST['posx'];
        $posy  = $_REQUEST['posy'];
        $space = $_REQUEST['sp'];
        $ttdd = $_REQUEST['ttdd'];
        $tglttd = $_REQUEST['tglttd'];
        $atulah=$this->tukd_model->tanggal_format_indonesia($tglttd);
        $periode='';
        $where = '';
        if($posx <>'' and $posy <>''){
            $where =" and tgl_kas_bud between '$posx' and '$posy'";
            $tagx=$this->tukd_model->tanggal_format_indonesia($posx);
            $tagy=$this->tukd_model->tanggal_format_indonesia($posy);
            $periode="PERIODE $tagx S/D $tagy ";
        }
        $cRet ='';

        $sqlsc="SELECT provinsi,upper(kab_kota) as kab_kota,daerah,thn_ang FROM sclient";
         $sqlsclient=$this->db->query($sqlsc);
         foreach ($sqlsclient->result() as $rowsc)
        {
            $kab     = $rowsc->kab_kota;
            $daerah  = $rowsc->daerah;
            $thn     = $rowsc->thn_ang;
        }
        
    
         $sqlttd2="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where nip='19640623 199610 1 001' and kode='PA'";
         $sqlttd2=$this->db->query($sqlttd2);
         $tesjab2=0;
         foreach ($sqlttd2->result() as $rowttd)
        {
            $nip2=$rowttd->nip;                    
            $nama2= $rowttd->nm;
            $jabatan2  = $rowttd->jab;
            $tesjab2++;
        }
        if($tesjab2==0){
            $nip2='belum ada nip';
            $nama2= 'belum ada nama';
            $jabatan2  = 'belum ada jabatan';
        }

        $sqlttd="SELECT jabatan,nip,nama from ms_ttd where nip='$ttdd'";
         $z=0;
         $sqlsclient=$this->db->query($sqlttd);
         foreach ($sqlsclient->result() as $rowst)
        {
            $nipt     = $rowst->nip;
            $jabatant  = $rowst->jabatan;
            $namat     = $rowst->nama;
            $z++;
        }

            if($z=='0'){
                $nipt='BELUM ADA NIP';
                $namat='BELUM ADA NAMA';
                $jabatant='BELUM ADA JABATAN';
            
            }*/
            $cetak=2;

        $cRet ='';
        $cRet .="<table style=\"border-collapse:collapse; font-size:12;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"2\" cellpadding=\"4\">
        
            <tr>
                <td align=\"center\" style=\"font-size:16;border-top:none;border-bottom:none;\"><stong><b>LAPORAN REALISASI PAJAK PAJAK PER SKPD<b></strong></td>
            </tr>
            <tr>
                <td align=\"center\" style=\"font-size:16;border-bottom:none;\"><stong><b>KABUPATEN BIAK NUMFOR</b></strong></td>
            </tr>
            <tr>
                <td align=\"center\" style=\"font-size:16;border-top:none;border-bottom:none;\"><stong><b>PER TANGGAL 01 JANUARI S/D 31 OKTOBER 2015<b></strong></td>
            </tr>
            
            <tr>
                <td align=\"center\" style=\"font-size:12;\">&nbsp;</td>
            </tr></table>";
            $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"4\">
                <thead>
                    <tr>
                        <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"3%\" align=\"center\"><b>NO.</b></td>
                        <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>SKPD</b></td>
                        <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>Nama Bendahara</b></td>
                        <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>Total APBD</b></td>
                        <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NPWP</b></td>
                        <td colspan=\"5\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>Rincian Pagu Anggaran</b></td>
                        <td colspan=\"5\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>Realisasi</b></td>
                        <td colspan=\"6\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>Pajak</b></td>
                     </tr>
                    <tr>
                        <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">Belanja Pegawai Langsung</td>
                        <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">Belanja Pegawai T L</td>
                        <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">Belanja Barang & Jasa</td>
                        <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">Belanja Modal</td>
                        <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">BANSOS/<br>HIBAH/<br>BANTUAN/<br>KEUANGAN</td>
                        <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">Belanja Pegawai Langsung</td>
                        <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">Belanja Pegawai Tidak Langsung</td>
                        <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">Belanja Barang & Jasa</td>
                        <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">Belanja Modal</td>
                        <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">BANSOS/<br>HIBAH/<BR>BANTUAN/<br>KEUANGAN</td>
                         <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">PPh 21 <br>Gaji Rutin</td>
                        <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">PPh 21</td>
                        <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">PPh 22</td>
                        <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">PPh 23</td>
                        <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">PPh Pasal 4<br>Ayat 2</td>
                        <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">PPN</td>
                    </tr>
                  </thead>
                <tfoot>
                    <tr>
                        <td colspan=\"21\" style=\"border:solid 1px white; border-top: solid 1px black;\"></td>
                    </tr>
                </tfoot>";

                 $csql = "SELECT kd_skpd,nm_skpd,
                        SUM(IF(LEFT(kd_rek5,1)='5',nilai_ubah,0))AS totapbd,
                        SUM(IF(LEFT(kd_rek5,3)='521',nilai_ubah,0))AS pagublpeg,
                        SUM(IF(LEFT(kd_rek5,3)='511',nilai_ubah,0))AS pagubtl,
                        SUM(IF(LEFT(kd_rek5,3)='522',nilai_ubah,0))AS pagubl,
                        SUM(IF(LEFT(kd_rek5,3)='523',nilai_ubah,0))AS modal,
                        SUM(IF(LEFT(kd_rek5,3) IN ('514','515','517','518'),nilai_ubah,0))AS paguhibah FROM trdrka  GROUP BY kd_skpd ";
            $hasil = $this->db->QUERY($csql);
            $i=0;
            $z=0;
            $gapdb=0;$gpgpeg=0;$gpgbtl=0;$gpgbl=0;$gpgmod=0;$gpghibah=0;
            $grandpotgaji=0; $grandpn=0; $grandph21=0; $grandph22=0; $grandph23=0; $grandph24=0;
            $grandrblpeg=0;$grandrlbtl=0;$grandrlbl=0;$grandrlmodal=0;$grandrlhibah=0;
            foreach($hasil->result() AS $trh){
                $skpd=$trh->kd_skpd;
                $nm=$trh->nm_skpd;
                $apbd=$trh->totapbd;
                $pagupeg=$trh->pagublpeg;
                $pagubtlx=$trh->pagubtl;
                $pagublx=$trh->pagubl;
                $modalx=$trh->modal;
                $hibahx=$trh->paguhibah;


        $gapdb=$gapdb+$trh->totapbd;
        $gpgpeg=$gpgpeg+$trh->pagublpeg;
        $gpgbtl=$gpgbtl+$trh->pagubtl;
        $gpgbl=$gpgbl+$trh->pagubl;
        $gpgmod=$gpgmod+$trh->modal;
        $gpghibah=$gpghibah+$trh->paguhibah;


                $i++;

                $cRet .="<tr>
                            <td width=\"3%\" align=\"right\" >$i</td>                                     
                             <td width=\"20%\" align=\"left\" >$nm</td>";
                             $sqlnpbn=mysql_query("SELECT a.kd_skpd,a.npwp,b.nama FROM ms_skpd a JOIN ms_ttd b ON a.kd_skpd=b.kd_skpd WHERE a.kd_skpd='$skpd' and b.kode='bk'");
                             $npbn   =mysql_fetch_assoc($sqlnpbn);
                                $wp   = $npbn['npwp'];
                                $nb   =$npbn['nama'];
                             $cRet .="<td width=\"10%\" align=\"left\" >$nb</td>
                             <td width=\"10%\" align=\"right\" >".number_format($apbd,2,',','.')."</td>
                             <td width=\"10%\" align=\"right\" >$wp</td>                                     
                             <td width=\"10%\" align=\"right\" >".number_format($pagupeg,2,',','.')."</td>
                             <td width=\"10%\" align=\"right\" >".number_format($pagubtlx,2,',','.')."</td>
                             <td width=\"10%\" align=\"right\" >".number_format($pagublx,2,',','.')."</td>
                             <td width=\"10%\" align=\"right\" >".number_format($modalx,2,',','.')."</td>                                     
                             <td width=\"10%\" align=\"right\" >".number_format($hibahx,2,',','.')."</td>";
                             
                            /* $real=mysql_query("SELECT a.kd_skpd,a.nm_skpd,
                                                SUM(IF(LEFT(b.kd_rek5,3)='521',b.nilai,0))AS realblpeg,
                                                SUM(IF(LEFT(b.kd_rek5,3)='511',b.nilai,0))AS realbtl,
                                                SUM(IF(LEFT(b.kd_rek5,3)='522',b.nilai,0))AS realbl,
                                                SUM(IF(LEFT(b.kd_rek5,3)='523',b.nilai,0))AS realmodal,
                                                SUM(IF(LEFT(b.kd_rek5,3) IN ('514','515','517','518'),b.nilai,0))AS realhibah 
                                                FROM trhtransout a JOIN trdtransout b ON a.no_bukti=b.no_bukti where a.kd_skpd='$skpd' and month(a.tgl_bukti)<='6'");*/
                            $real=mysql_query("SELECT SUM(realblpeg) AS realblpeg,SUM(realbtl)as realbtl,SUM(realbl)AS realbl,SUM(realmodal)AS realmodal,SUM(realhibah)AS realhibah FROM(
                                                SELECT b.kd_skpd,b.nm_skpd,
                                                SUM(IF(LEFT(a.kd_rek5,3)='521',a.nilai,0))AS realblpeg,
                                                SUM(IF(LEFT(a.kd_rek5,3)='511',a.nilai,0))AS realbtl,
                                                SUM(IF(LEFT(a.kd_rek5,3)='522',a.nilai,0))AS realbl,
                                                SUM(IF(LEFT(a.kd_rek5,3)='523',a.nilai,0))AS realmodal,
                                                SUM(IF(LEFT(a.kd_rek5,3) IN ('514','515','517','518'),b.nilai,0))AS realhibah 
                                                FROM trdspp a JOIN trhsp2d b ON a.no_spp=b.no_spp WHERE b.kd_skpd='$skpd' AND b.jns_spp IN('4','5','6') AND MONTH(b.tgl_sp2d)<='10'
                                                UNION ALL
                                                SELECT a.kd_skpd,a.nm_skpd,
                                                SUM(IF(LEFT(b.kd_rek5,3)='521',b.nilai,0))AS realblpeg,
                                                SUM(IF(LEFT(b.kd_rek5,3)='511',b.nilai,0))AS realbtl,
                                                SUM(IF(LEFT(b.kd_rek5,3)='522',b.nilai,0))AS realbl,
                                                SUM(IF(LEFT(b.kd_rek5,3)='523',b.nilai,0))AS realmodal,
                                                SUM(IF(LEFT(b.kd_rek5,3) IN ('514','515','517','518'),b.nilai,0))AS realhibah 
                                                FROM trhtransout a JOIN trdtransout b ON a.no_bukti=b.no_bukti WHERE a.kd_skpd='$skpd' AND a.jns_spp IN('1','2','3') AND MONTH(a.tgl_bukti)<='10')zz");
                             $rl=mysql_fetch_array($real);
                                $rblpeg=$rl['realblpeg'];
                                $rlbtl=$rl['realbtl'];
                                $rlbl=$rl['realbl'];
                                $rlmodal=$rl['realmodal'];
                                $rlhibah=$rl['realhibah'];

                            

                                $grandrblpeg=$grandrblpeg+$rl['realblpeg'];
                                $grandrlbtl=$grandrlbtl+$rl['realbtl'];
                                $grandrlbl=$grandrlbl+$rlbl=$rl['realbl'];
                                $grandrlmodal=$grandrlmodal+ $rlmodal=$rl['realmodal'];
                                $grandrlhibah=$grandrlhibah+$rlhibah=$rl['realhibah'];


                            $cRet .=" <td width=\"10%\" align=\"right\" >".number_format($rblpeg,2,',','.')."</td>
                             <td width=\"10%\" align=\"right\" >".number_format($rlbtl,2,',','.')."</td>
                             <td width=\"10%\" align=\"right\" >".number_format($rlbl,2,',','.')."</td>                                     
                             <td width=\"10%\" align=\"right\" >".number_format($rlmodal,2,',','.')."</td>
                             <td width=\"10%\" align=\"right\" >".number_format($rlhibah,2,',','.')."</td>";
                             
                            $sqlpotgj=mysql_query("SELECT a.kd_skpd,a.no_sp2d,
                                                    SUM(IF(b.kd_rek5='2110401',b.nilai,0))AS ppn,
                                                    SUM(IF(b.kd_rek5='2110301',b.nilai,0))AS pph21,
                                                    SUM(IF(b.kd_rek5='2110302',b.nilai,0))AS pph22,
                                                    SUM(IF(b.kd_rek5='2110303',b.nilai,0))AS pph23,
                                                    SUM(IF(b.kd_rek5='2110704',b.nilai,0))AS psl4 
                                                    FROM trhsp2d a INNER JOIN trspmpot b ON a.no_spm=b.no_spm 
                                                    WHERE a.kd_skpd='$skpd' AND a.jns_spp='4' and month(a.tgl_kas)<='10' ");
                            $potgj=mysql_fetch_array($sqlpotgj);
                            $ph21gj= $potgj['pph21'] ;

                            $grandpotgaji= $grandpotgaji+$potgj['pph21'] ;


                             $cRet .="<td width=\"10%\" align=\"right\" >".number_format($ph21gj,2,',','.')."</td>";
                                $sqlpot=mysql_query("SELECT a.kd_skpd,a.no_sp2d,
                                                    SUM(IF(b.kd_rek5='2110401',b.nilai,0))AS ppn,
                                                    SUM(IF(b.kd_rek5='2110301',b.nilai,0))AS pph21,
                                                    SUM(IF(b.kd_rek5='2110302',b.nilai,0))AS pph22,
                                                    SUM(IF(b.kd_rek5='2110303',b.nilai,0))AS pph23,
                                                    SUM(IF(b.kd_rek5='2110704',b.nilai,0))AS psl4 
                                                    FROM trhsp2d a INNER JOIN trspmpot b ON a.no_spm=b.no_spm 
                                                    WHERE a.kd_skpd='$skpd' AND a.jns_spp!='4' and month(a.tgl_kas)<='10'");
                            $pot=mysql_fetch_array($sqlpot);
                            $pn=$pot['ppn'];
                            $ph21=$pot['pph21'];
                            $ph22=$pot['pph22'];
                            $ph23=$pot['pph23'];
                            $ph24=$pot['psl4'];

                            $grandpn=$grandpn+$pn=$pot['ppn'];
                            $grandph21=$grandph21+$ph21=$pot['pph21'];
                            $grandph22=$grandph22+ $ph22=$pot['pph22'];
                            $grandph23=$grandph23+$ph23=$pot['pph23'];
                            $grandph24=$grandph24+$ph24=$pot['psl4'];

                             $cRet .="<td width=\"10%\" align=\"right\" >".number_format($ph21,2,',','.')."</td>
                             <td width=\"10%\" align=\"right\" >".number_format($ph22,2,',','.')."</td>                                     
                             <td width=\"10%\" align=\"right\" >".number_format($ph23,2,',','.')."</td>
                             <td width=\"10%\" align=\"right\" >".number_format($ph24,2,',','.')."</td>
                             <td width=\"10%\" align=\"right\" >".number_format($pn,2,',','.')."</td>
                             
                        </tr>";

              }       
            


                    $cRet .= "<tr>
                    <td colspan =\"3\" width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\"><B>JUMLAH</B></td>
                    <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">".number_format($gapdb,2,',','.')."</td>
                    <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\"></td>
                    <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">".number_format($gpgpeg,2,',','.')."</td>
                    <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">".number_format($gpgbtl,2,',','.')."</td>
                    <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">".number_format($gpgbl,2,',','.')."</td>
                    <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">".number_format($gpgmod,2,',','.')."</td>
                    <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">".number_format($gpghibah,2,',','.')."</td>

                    <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">".number_format($grandrblpeg,2,',','.')."</td>
                    <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">".number_format($grandrlbtl,2,',','.')."</td>
                    <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">".number_format($grandrlbl,2,',','.')."</td>
                    <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">".number_format($grandrlmodal,2,',','.')."</td>
                    <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">".number_format($grandrlhibah,2,',','.')."</td>

                    <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">".number_format($grandpotgaji,2,',','.')."</td>

                    <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">".number_format($grandph21,2,',','.')."</td>
                    <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">".number_format($grandph22,2,',','.')."</td>
                    <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">".number_format($grandph23,2,',','.')."</td>
                    <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">".number_format($grandph24,2,',','.')."</td>
                    <td width=\"8%\" bgcolor=\"#CCCCCC\" align=\"center\">".number_format($grandpn,2,',','.')."</td>

                    </tr>";
                $cRet .="</table>";
                $data['prev']= $cRet;
                switch($cetak) {        
                case 1;
                      $this->_mpdftn('', $cRet, 5, 5, 5, '1');
                break;
                case 2;        
                    header("Cache-Control: no-cache, no-store, must-revalidate");
                    header("Content-Type: application/vnd.ms-excel");
                    header("Content-Disposition: attachment; filename=pajak.xls");
                    $this->load->view('anggaran/rka/perkadaII', $data);
                break;
                }
        }


 function nomor_ju(){
    $kd_skpd = $_REQUEST['cskpd'];
       $identitas    = $_REQUEST['identitas'];
    $msg=array();
   $sqlz=mysql_query("SELECT IF(MAX(a.no_voucher)IS NULL,LPAD('1',4,0),LPAD(MAX(a.no_voucher)+1,4,0)) AS nomor FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.kd_skpd=b.kd_skpd and a.no_voucher=b.no_voucher WHERE a.kd_skpd='$kd_skpd' AND identitas='$identitas'");
    
    $hasil=mysql_fetch_assoc($sqlz);
    $num=$hasil['nomor'];
   
    
    $data=array('nomor'=>$num);
    echo json_encode($data);
  
  }


     function cek_novo(){
		$novo=$this->input->post('no');
		$skpd=$this->input->post('skpd');
		$sql=mysql_query("select COUNT(1) AS cek from trhju_pkd where kd_skpd='$skpd' and no_voucher='$novo'");
		$hasil=mysql_fetch_assoc($sql);
		$cek=$hasil['cek'];
		echo json_encode($cek);	
	} 




	function cetak_realisasiangg_MURNI(){
		$cetak = $this->uri->segment(3);
        $thn_ang	= $this->session->userdata('pcThang');
        $kd_skpd	= $_REQUEST['skpd'];

        $pilih = $_REQUEST['cpilih'];
        if($pilih==2){
            $keg=$_REQUEST['keg'];
        }
		
        $sqlsc = "SELECT kab_kota,daerah FROM sclient";
		$sqlsclient=$this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc){
			$kota   = $rowsc->kab_kota;
			$daerah = $rowsc->daerah;
		}

        $csql2 = "SELECT nm_skpd FROM ms_skpd WHERE kd_skpd = '$kd_skpd'";
            $hasil2   = $this->db->query($csql2);
            $trh4     = $hasil2->row();          
            $lcNmskpd = $trh4->nm_skpd;			

        $cRet = '';
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
					<tr>
						<td colspan=\"4\" align=\"center\" style=\"font-size:14px;border: solid 1px white;\"><b>PEMERINTAH $kota<br>LAPORAN REALISASI SP2D</b></td>
					</tr>			
					<tr>
						<td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
					</tr>
					<tr>
						<td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
					</tr>
					<tr>
						<td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
					</tr>
					<tr>
						<td width=\"5%\" align=\"left\" style=\"font-size:10px;border: solid 1px white;\">SKPD</td>
						<td width=\"95%\" align=\"left\" style=\"font-size:10px;border: solid 1px white;\">: $kd_skpd  $lcNmskpd</td>
					</tr>
					</table>";
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
            <thead>
			<tr>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"15%\" style=\"font-size:12px\">Kode</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"40%\" style=\"font-size:12px\">Uraian</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"15%\" style=\"font-size:12px\">Anggaran</td>               
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"5%\" style=\"font-size:12px\">SUMBER<BR> DANA</td> 
				<td bgcolor=\"#CCCCCC\" align=\"center\" width=\"15%\" style=\"font-size:12px\">Realisasi</td>
				<td bgcolor=\"#CCCCCC\" align=\"center\" width=\"15%\" style=\"font-size:12px\">Sisa Anggaran</td> 
				<td bgcolor=\"#CCCCCC\" align=\"center\" width=\"9%\" style=\"font-size:12px\">Persen (%)</td> 
            </tr> 		
            <tr>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">1</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">2</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">3</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">4</td>  
				<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">5</td>
				<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">6</td>
				<td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">7</td>
				
            </tr> 
			</thead>
			<tfoot>
				<tr><td style=\"border-bottom: none; border-left:none;border-right:none;\" colspan=\"7\"></td>
			</tfoot>            
            ";
			
 			
				if($pilih==1){
				/*	$sql = "SELECT * FROM(
							SELECT a.kd_program AS kode,a.nm_program AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,
							IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
							WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('3','4','5','6') 
							AND LEFT(p.kd_kegiatan,18)=a.kd_program),0)+
							IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
							WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2')
							AND LEFT(l.kd_kegiatan,18)=a.kd_program),0) AS reali
							FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
							WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5'
							GROUP BY a.kd_program
							UNION ALL	
							SELECT a.kd_kegiatan AS kode,a.nm_kegiatan AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,
							IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
							WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('3','4','5','6') 
							AND LEFT(p.kd_kegiatan,18)=a.kd_program AND p.kd_kegiatan=b.kd_kegiatan),0)+
							IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
							WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2') 
							AND LEFT(l.kd_kegiatan,18)=a.kd_program AND l.kd_kegiatan=b.kd_kegiatan),0) AS reali
							FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
							WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5'
							GROUP BY a.kd_kegiatan
							UNION ALL
							SELECT CONCAT(kd_kegiatan,'.',kd_rek5) AS kode,nm_rek5 AS nama,nilai as angg_m, nilai_ubah AS angg,
							IFNULL((SELECT SUM(a.nilai) FROM trdspp a INNER JOIN trhsp2d b ON a.no_spp=b.no_spp 
							WHERE b.kd_skpd='$kd_skpd' AND a.kd_skpd='$kd_skpd' AND b.jns_spp IN('3','4','5','6') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5
							GROUP BY kd_rek5,kd_kegiatan),0)+
							IFNULL((SELECT SUM(a.nilai) FROM trdtransout a INNER JOIN trhtransout b ON a.no_bukti=b.no_bukti 
							WHERE b.kd_skpd='$kd_skpd' AND SUBSTR(a.kd_kegiatan,6,10)='$kd_skpd' AND b.jns_spp IN('1','2') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5
							GROUP BY kd_rek5,kd_kegiatan),0) AS reali
							FROM trdrka q WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek5,1)='5'
							)z ORDER BY kode
					";  */    
					if($kd_skpd=='1.20.05.01'){
							$sql = "SELECT * FROM(
						SELECT a.kd_program AS kode,a.nm_program AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,'' AS SUMBER,
						IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
						WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('4','5','6') 
						AND LEFT(p.kd_kegiatan,18)=a.kd_program),0)+
						IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
						WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2','3','7')
						AND LEFT(l.kd_kegiatan,18)=a.kd_program),0) -
						(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program)+
						(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program)AS reali
						FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' OR LEFT(b.kd_rek5,2)='62'
						GROUP BY a.kd_program
						UNION ALL	
						SELECT a.kd_kegiatan AS kode,a.nm_kegiatan AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,B.SUMBER_UBAH AS SUMBER,
						IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
						WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('4','5','6') 
						AND LEFT(p.kd_kegiatan,18)=a.kd_program AND p.kd_kegiatan=b.kd_kegiatan),0)+
						IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
						WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2','3','7') 
						AND LEFT(l.kd_kegiatan,18)=a.kd_program AND l.kd_kegiatan=b.kd_kegiatan),0) -
						(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program AND kd_kegiatan=b.kd_kegiatan)+
						(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program AND kd_kegiatan=b.kd_kegiatan) AS reali
						FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' OR LEFT(b.kd_rek5,2)='62'
						GROUP BY a.kd_kegiatan
						UNION ALL
						SELECT CONCAT(kd_kegiatan,'.',kd_rek5) AS kode,nm_rek5 AS nama,nilai AS angg_m, nilai_ubah AS angg,'' AS SUMBER,
						IFNULL((SELECT SUM(a.nilai) FROM trdspp a INNER JOIN trhsp2d b ON a.no_spp=b.no_spp 
						WHERE b.kd_skpd='$kd_skpd' AND a.kd_skpd='$kd_skpd' AND b.jns_spp IN('4','5','6') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5
						GROUP BY kd_rek5,kd_kegiatan),0)+
						IFNULL((SELECT SUM(a.nilai) FROM trdtransout a INNER JOIN trhtransout b ON a.no_bukti=b.no_bukti 
						WHERE b.kd_skpd='$kd_skpd' AND SUBSTR(a.kd_kegiatan,6,10)='$kd_skpd' AND b.jns_spp IN('1','2','3','7') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5
						GROUP BY kd_rek5,kd_kegiatan),0)   - 
						(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd'  AND kd_kegiatan=q.kd_kegiatan AND kk.kd_rek5=q.kd_rek5)+
						(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND kd_kegiatan=q.kd_kegiatan AND kk.kd_rek5=q.kd_rek5)
						AS reali
						FROM trdrka q WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek5,1)='5' OR LEFT(kd_rek5,2)='62'
						)z ORDER BY kode";          
    				}else{
    					$sql = "SELECT * FROM(
						SELECT a.kd_program AS kode,a.nm_program AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,'' AS SUMBER,
						IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
						WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('4','5','6') 
						AND LEFT(p.kd_kegiatan,18)=a.kd_program),0)+
						IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
						WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2','3','7')
						AND LEFT(l.kd_kegiatan,18)=a.kd_program),0) -
						(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program)+
						(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program)AS reali
						FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' 
						GROUP BY a.kd_program
						UNION ALL	
						SELECT a.kd_kegiatan AS kode,a.nm_kegiatan AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,B.SUMBER_UBAH AS SUMBER,
						IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
						WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('4','5','6') 
						AND LEFT(p.kd_kegiatan,18)=a.kd_program AND p.kd_kegiatan=b.kd_kegiatan),0)+
						IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
						WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2','3','7') 
						AND LEFT(l.kd_kegiatan,18)=a.kd_program AND l.kd_kegiatan=b.kd_kegiatan),0) -
						(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program AND kd_kegiatan=b.kd_kegiatan)+
						(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND LEFT(kk.kd_kegiatan,18)=a.kd_program AND kd_kegiatan=b.kd_kegiatan) AS reali
						FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' 
						GROUP BY a.kd_kegiatan
						UNION ALL
						SELECT CONCAT(kd_kegiatan,'.',kd_rek5) AS kode,nm_rek5 AS nama,nilai AS angg_m, nilai_ubah AS angg,'' AS SUMBER,
						IFNULL((SELECT SUM(a.nilai) FROM trdspp a INNER JOIN trhsp2d b ON a.no_spp=b.no_spp 
						WHERE b.kd_skpd='$kd_skpd' AND a.kd_skpd='$kd_skpd' AND b.jns_spp IN('4','5','6') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5
						GROUP BY kd_rek5,kd_kegiatan),0)+
						IFNULL((SELECT SUM(a.nilai) FROM trdtransout a INNER JOIN trhtransout b ON a.no_bukti=b.no_bukti 
						WHERE b.kd_skpd='$kd_skpd' AND SUBSTR(a.kd_kegiatan,6,10)='$kd_skpd' AND b.jns_spp IN('1','2','3','7') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5
						GROUP BY kd_rek5,kd_kegiatan),0)   - 
						(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd'  AND kd_kegiatan=q.kd_kegiatan AND kk.kd_rek5=q.kd_rek5)+
						(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
						INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND kd_kegiatan=q.kd_kegiatan AND kk.kd_rek5=q.kd_rek5)
						AS reali
						FROM trdrka q WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek5,1)='5'
						)z ORDER BY kode"; 
    				}

					$hasil = $this->db->query($sql);       
					$saldo=0;
					foreach ($hasil->result() as $row){
					   $kode  = $row->kode ;
					   $nama  = $row->nama;
					   $angg    = $row->angg; 
					   $reali   = $row->reali;
					   $angg_m    = $row->angg_m;
					   $SUMBER    = $row->SUMBER;
					   
					if($angg<0){
						$xy="("; 
						$angg=$angg*-1; 
						$yx=")";						   
					}else{
						$xy=""; 
						$angg=$angg*1; 
						$yx="";					   
					}
					$angg1 = number_format($angg,2,',','.');
					
					if($reali<0){
						$as="("; 
						$reali=$reali*-1; 
						$sa=")";						   
					}else{
						$as=""; 
						$reali=$reali*1; 
						$sa="";					   
					}
					$reali1 = number_format($reali,2,',','.');
					
					$sisa = $row->angg_m-$row->reali;
					if($sisa<0){
						$df="("; 
						$sisa=$sisa*-1; 
						$fd=")";						   
					}else{
						$df=""; 
						$sisa=$sisa*1; 
						$fd="";					   
					}
					$sisa1 = number_format($sisa,2,',','.');
					
					$reapers = $angg_m-$reali ;
					


					if($reapers == 0){
						if($angg_m == 0 and $reali == 0){
						$per5x=0;
						}else{
						$per5x   = 0;
						}					
					}else if($reapers < 0){
					
						if($angg_m == 0 and $reali != 0){
						$per5x=100;
						}else{
					$per5x= ($reali!=0)?($reapers/$angg_m) * 100:0; 
						}					

					
					


					}else if($reapers > 0){
					$per5x=($reapers/$angg_m) * 100;
					}else{
					$per5x=0;
					}

					if($per5x < 0){
						$xx="("; 
						$per5x=$per5x*-1; 
						$yy=")";						   
					}else{
						$xx=""; 
						$per5x=$per5x*1; 
						$yy="";					   
					}
					$persenrea = number_format($per5x,"2",",",".");
					
					if((strlen($kode)<=21)){
						$cRet .="<tr>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$kode</b></td>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$nama</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>".number_format($angg_m,2,',','.')."</b></td>
								  
								  <td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$SUMBER</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$as$reali1$sa</b></td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$df$sisa1$fd</b></td>
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$xx$persenrea$yy</b></td>								  
								</tr>";
					}else{
						$cRet .="<tr>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$kode</td>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$nama</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">".number_format($angg_m,2,',','.')."</td>
								  
								  <td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none\">$SUMBER</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$as$reali1$sa</td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$df$sisa1$fd</td> 
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$xx$persenrea$yy</td> 								  
								</tr>";   
					}					
					}
					if($kd_skpd=='1.20.05.01'){
					$sqltot="SELECT sum(angg_m)as tm,SUM(angg) AS tot, SUM(realix) AS treali FROM(
								SELECT a.kd_program AS kode,a.nm_program AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,
								IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
								WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('4','5','6') 
								AND LEFT(p.kd_kegiatan,18)=a.kd_program),0)+
								IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
								WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2','3','7')
								AND LEFT(l.kd_kegiatan,18)=a.kd_program),0) AS realix
								FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
								WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' OR LEFT(b.kd_rek5,2)='62'
								GROUP BY a.kd_program)cc";
						}else{
							$sqltot="SELECT sum(angg_m)as tm,SUM(angg) AS tot, SUM(realix) AS treali FROM(
								SELECT a.kd_program AS kode,a.nm_program AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,
								IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
								WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('4','5','6') 
								AND LEFT(p.kd_kegiatan,18)=a.kd_program),0)+
								IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
								WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2','3','7')
								AND LEFT(l.kd_kegiatan,18)=a.kd_program),0) AS realix
								FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
								WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5'
								GROUP BY a.kd_program)cc";
						}
							$hsl = $this->db->query($sqltot); 
							
							foreach ($hsl->result() as $row1){
					   			$totm=$row1->tm;
					   			$totangg    = $row1->tot; 
					   			$totreali   = $row1->treali;

					   			$rumus=$totm-$totreali;

					   			if($totreali <> 0){
									$per5   = ($rumus!=0)?($rumus /$row1->tm) * 100:0; 
									}else if($totm <> 0 and $totreali ==0){
										$per5=100;
									}else{
										$per5=0;
									}

                    			$persen5= number_format($per5,"2",".",",");
					   			
							}

							$cRet .="<tr>
								  <td valign=\"top\" colspan=\"2\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>TOTAL</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totm,2,',','.')."</b></td>
								  
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totreali,2,',','.')."</b></td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($rumus,2,',','.')."</b></td> 
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($persen5,2,',','.')."</b></td> 								  
								</tr>";
					}else{
	$sql = "SELECT * FROM(
							SELECT a.kd_kegiatan AS kode,a.nm_kegiatan AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,B.SUMBER_UBAH AS SUMBER,
							IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
							WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('4','5','6') 
							AND LEFT(p.kd_kegiatan,18)=a.kd_program AND p.kd_kegiatan=b.kd_kegiatan),0)+
							IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
							WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2','3','7') 
							AND LEFT(l.kd_kegiatan,18)=a.kd_program AND l.kd_kegiatan=b.kd_kegiatan),0) AS reali
							FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
							WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' AND a.kd_kegiatan='$keg'
							GROUP BY a.kd_kegiatan
							UNION ALL
							SELECT CONCAT(kd_kegiatan,'.',kd_rek5) AS kode,nm_rek5 AS nama,nilai AS angg_m,nilai_ubah AS angg,''SUMBER,
							IFNULL((SELECT SUM(a.nilai) FROM trdspp a INNER JOIN trhsp2d b ON a.no_spp=b.no_spp 
							WHERE b.kd_skpd='$kd_skpd' AND a.kd_skpd='$kd_skpd' AND b.jns_spp IN('4','5','6') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5
							GROUP BY kd_rek5,kd_kegiatan),0)+
							IFNULL((SELECT SUM(a.nilai) FROM trdtransout a INNER JOIN trhtransout b ON a.no_bukti=b.no_bukti 
							WHERE b.kd_skpd='$kd_skpd' AND SUBSTR(a.kd_kegiatan,6,10)='$kd_skpd' AND b.jns_spp IN('1','2','3','7') AND q.kd_kegiatan=a.kd_kegiatan AND q.kd_rek5=a.kd_rek5
							GROUP BY kd_rek5,kd_kegiatan),0) - 
(SELECT IFNULL(SUM(kk.nilaid),0) FROM dkoreksi kk 
INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd'  AND kd_kegiatan=q.kd_kegiatan AND kk.kd_rek5=q.kd_rek5)+
(SELECT IFNULL(SUM(kk.nilaik),0) FROM dkoreksi kk 
INNER JOIN hkoreksi ll ON kk.no_bukti=ll.no_bukti WHERE kk.kd_skpd='$kd_skpd' AND kd_kegiatan=q.kd_kegiatan AND kk.kd_rek5=q.kd_rek5)AS reali
FROM trdrka q WHERE kd_skpd='$kd_skpd' AND LEFT(kd_rek5,1)='5' AND kd_kegiatan='$keg'
							)z ORDER BY kode";          



					$hasil = $this->db->query($sql);       
					$saldo=0;
					foreach ($hasil->result() as $row){
					   $kode  = $row->kode ;
					   $nama  = $row->nama;
					   $angg    = $row->angg; 
					   $reali   = $row->reali;
					   $angg_m    = $row->angg_m;
					     $SUMBER    = $row->SUMBER;
					   
					if($angg<0){
						$xy="("; 
						$angg=$angg*-1; 
						$yx=")";						   
					}else{
						$xy=""; 
						$angg=$angg*1; 
						$yx="";					   
					}
					$angg1 = number_format($angg,2,',','.');
					
					if($reali<0){
						$as="("; 
						$reali=$reali*-1; 
						$sa=")";						   
					}else{
						$as=""; 
						$reali=$reali*1; 
						$sa="";					   
					}
					$reali1 = number_format($reali,2,',','.');
					
					$sisa = $row->angg_m-$row->reali;
					if($sisa<0){
						$df="("; 
						$sisa=$sisa*-1; 
						$fd=")";						   
					}else{
						$df=""; 
						$sisa=$sisa*1; 
						$fd="";					   
					}
					$sisa1 = number_format($sisa,2,',','.');
					
					$reapers = $angg_m-$reali ;
					if($reapers == 0){
						if($angg_m == 0 and $reali == 0){
						$per5x=0;
						}else{
						$per5x   = 0;
						}					
					}else if($reapers < 0){
					$per5x= ($reali!=0)?($reapers/$angg_m) * 100:0; 
					}else if($reapers > 0){
					$per5x=($reapers/$angg_m) * 100;
					}else{
					$per5x=0;
					}

					if($per5x < 0){
						$xx="("; 
						$per5x=$per5x*-1; 
						$yy=")";						   
					}else{
						$xx=""; 
						$per5x=$per5x*1; 
						$yy="";					   
					}
					$persenrea = number_format($per5x,"2",",",".");
					
					if((strlen($kode)<=21)){
						$cRet .="<tr>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$kode</b></td>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$nama</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>".number_format($angg_m,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$xy$angg1$yx</b></td>
								  <td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$SUMBER</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$as$reali1$sa</b></td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$df$sisa1$fd</b></td>
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"><b>$xx$persenrea$yy</b></td>								  
								</tr>";
					}else{
						$cRet .="<tr>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$kode</td>
								  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$nama</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">".number_format($angg_m,2,',','.')."</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$xy$angg1$yx</td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\"></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$as$reali1$sa</td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$df$sisa1$fd</td> 
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$xx$persenrea$yy</td> 								  
								</tr>";   
					}					
					}

					$sqltot="SELECT sum(angg_m)as tm,SUM(angg) AS tot, SUM(realix) AS treali,SUMBER FROM(
								SELECT a.kd_kegiatan AS kode,a.nm_kegiatan AS nama,SUM(b.nilai) AS angg_m,SUM(b.nilai_ubah) AS angg,B.SUMBER_UBAH AS SUMBER,
							IFNULL((SELECT SUM(p.nilai) FROM trdspp p INNER JOIN trhsp2d o ON p.no_spp=o.no_spp 
							WHERE o.kd_skpd='$kd_skpd' AND p.kd_skpd='$kd_skpd' AND o.jns_spp IN('4','5','6') 
							AND LEFT(p.kd_kegiatan,18)=a.kd_program AND p.kd_kegiatan=b.kd_kegiatan),0)+
							IFNULL((SELECT SUM(l.nilai) FROM trdtransout l INNER JOIN trhtransout k ON l.no_bukti=k.no_bukti 
							WHERE k.kd_skpd='$kd_skpd' AND SUBSTR(l.kd_kegiatan,6,10)='$kd_skpd' AND k.jns_spp IN('1','2','3','7') 
							AND LEFT(l.kd_kegiatan,18)=a.kd_program AND l.kd_kegiatan=b.kd_kegiatan),0) AS realix
							FROM trskpd a INNER JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
							WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND LEFT(b.kd_rek5,1)='5' AND a.kd_kegiatan='$keg'
							GROUP BY a.kd_kegiatan)cc";
							$hsl = $this->db->query($sqltot); 
							
							foreach ($hsl->result() as $row1){
					   			$totm=$row1->tm;
					   			$totangg    = $row1->tot; 
					   			$totreali   = $row1->treali;
					   			$SUMBER   = $row1->SUMBER;

					   			$rumus=$totm-$totreali;

					   			if($totreali <> 0){
									$per5   = ($rumus!=0)?($rumus /$row1->tm) * 100:0; 
									}else if($totm <> 0 and $totreali ==0){
										$per5=100;
									}else{
										$per5=0;
									}

                    			$persen5= number_format($per5,"2",".",",");
					   			
							}

							$cRet .="<tr>
								  <td valign=\"top\" colspan=\"2\" align=\"center\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>TOTAL</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totm,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totangg,2,',','.')."</b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b></b></td>
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($totreali,2,',','.')."</b></td>    
								  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($rumus,2,',','.')."</b></td> 
									<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:1px solid black\"><b>".number_format($persen5,2,',','.')."</b></td> 								  
								</tr>";
					}
				

        $cRet .='</table>';
        $data['prev']= $cRet;    
        //$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
        switch($cetak) {        
        case 1;
              $this->_mpdf1_tes('', $cRet, 10, 5, 10, '0');
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename=realisasi_belanja_skpd.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        }		
    }	

	

}