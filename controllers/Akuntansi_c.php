<?php

if (!defined('BASEPATH'))
	exit('No direct script access allowed');

/**
 * Controller master data kegiatan
 */

class Akuntansi_c extends CI_Controller
{

	function __contruct(){
		parent::__construct();

	}
	
	//Firman Tambah
	function index($offset=0,$lctabel,$field,$field1,$judul,$list,$lccari)
	{
		$data['page_title'] = "CETAK $judul";
		
		//$total_rows = $this->master_model->get_count($lctabel);
        if(empty($lccari)){
            $total_rows = $this->master_model->get_count($lctabel);
            $lc = "/.$lccari";
        }else{
            $total_rows = $this->master_model->get_count_teang($lctabel,$field,$field1,$lccari);
            $lc = "";
        }
		// pagination        
 
		$config['base_url']		= site_url("rka/".$list);
		$config['total_rows'] 	= $total_rows;
		$config['per_page'] 	= '10';
		$config['uri_segment'] 	= 3;
		$config['num_links'] 	= 5;
		$config['full_tag_open'] = '<ul class="page-navi">';
		$config['full_tag_close'] = '</ul>';
		$config['num_tag_open'] = '<li>';
		$config['num_tag_close'] = '</li>';
		$config['cur_tag_open'] = '<li class="current">';
		$config['cur_tag_close'] = '</li>';
		$config['prev_link'] = '&lt;';
		$config['prev_tag_open'] = '<li>';
		$config['prev_tag_close'] = '</li>';
		$config['next_link'] = '&gt;';
		$config['next_tag_open'] = '<li>';
		$config['next_tag_close'] = '</li>';
		$config['last_link'] = 'Last';
		$config['last_tag_open'] = '<li>';
		$config['last_tag_close'] = '</li>';
		$config['first_link'] = 'First';
		$config['first_tag_open'] = '<li>';
		$config['first_tag_close'] = '</li>';
		$limit            		= $config['per_page'];  
		$offset         		= $this->uri->segment(3);  
		$offset         		= ( ! is_numeric($offset) || $offset < 1) ? 0 : $offset;  
		  
		if(empty($offset))  
		{  
			$offset=0;  
		}
	           
		//$data['list'] 		= $this->master_model->getAll($lctabel,$field,$limit, $offset);
         if(empty($lccari)){     
		$data['list'] 		= $this->master_model->getAll($lctabel,$field,$limit, $offset);
        }else {
            $data['list'] 		= $this->master_model->getCari($lctabel,$field,$field1,$limit, $offset,$lccari);
        }
		$data['num']		= $offset;
		$data['total_rows'] = $total_rows;
		
				$this->pagination->initialize($config);
		$a=$judul;
		$data['sikap'] = 'list';
		$this->template->set('title', 'CETAK RKA');
		$this->template->load('template', "anggaran/rka/".$list, $data);
	}
	function _mpdf1($judul='',$isi='',$lMargin=10,$rMargin=10,$font=10,$orientasi='',$skpd='',$hal='') {
        
        ini_set("memory_limit","-1");
        $this->load->library('mpdf');

        $this->mpdf->defaultheaderfontsize = 6;	/* in pts */
        $this->mpdf->defaultheaderfontstyle = BI;	/* blank, B, I, or BI */
        $this->mpdf->defaultheaderline = 1; 	/* 1 to include line below header/above footer */
		
        $this->mpdf->defaultfooterfontsize = 7;	/* in pts */
        $this->mpdf->defaultfooterfontstyle = B;	/* blank, B, I, or BI */
        $this->mpdf->defaultfooterline = 1; 

		$this->mpdf->SetBottomMargin('12');
		$initial='';
        $this->mpdf->SetFooter(''.$initial.' ||'.$skpd.' Halaman  : {PAGENO}| ');
        $this->mpdf->AddPage($orientasi,'',$hal,'1','off',$lMargin,$rMargin);

        if (!empty($judul)) $this->mpdf->writeHTML($judul);
        $this->mpdf->writeHTML($isi);         
        $this->mpdf->Output();
               
    }
	function rekal()
	{
		$data['page_title'] = 'REKAL TRANSAKSI';
		$this->template->set('title', 'REKAL TRANSAKSI');
		$this->template->load('template', 'akuntansi/rekal', $data);
	}
	
	function neraca_saldo()
	{
		$data['page_title']= 'Neraca Saldo';
		$this->template->set('title', 'Neraca Saldo');   
		$this->template->load('template','akuntansi/neraca_saldo',$data) ; 
	}

	function proses_rekal()
	{

		$this->db->query(" delete from trhrekal ");
		$this->db->query(" delete from trdrekal ");
		//sp2d
		$sql = " SELECT a.kd_skpd,b.nm_skpd,a.kd_kegiatan,a.nm_kegiatan,a.kd_rek5,a.nm_rek5,a.nilai,b.keperluan,d.status,d.tgl_kas,d.no_kas,b.jns_spp,d.no_sp2d FROM trdspp a
				LEFT JOIN trhspp b ON a.no_spp=b.no_spp
				LEFT JOIN trhspm c ON c.no_spp=b.no_spp
				LEFT JOIN trhsp2d d ON d.no_spm=c.no_spm
				WHERE d.status='1' ";
		$query1 = $this->db->query($sql);
		$tnosp2d = '';
		foreach ($query1->result_array() as $res)
		{
			$nosp2d = trim($res['no_sp2d']);
			$nokas = $res['no_kas'];
			$tglkas = $res['tgl_kas'];
			$uraian = $res['keperluan'];
			$kdskpd = $res['kd_skpd'];
			$nmskpd = $res['nm_skpd'];
			$jns = $res['jns_spp'];
			$kdgiat = $res['kd_kegiatan'];
			$nmgiat = $res['nm_kegiatan'];
			$nilai = $res['nilai'];
			$kdrek5 = $res['kd_rek5'];
			$nmrek5 = $res['nm_rek5'];

			if ($tnosp2d != $nosp2d)
			{
				$this->db->query(" insert into trhrekal(no_kas,tgl_kas,uraian,kd_skpd,nm_skpd,jns_trans) 
				values('$nokas','$tglkas','$uraian','$kdskpd','$nmskpd','1') ");
			}

			$this->db->query(" insert into trdrekal(no_kas,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,terima,keluar,jns_trans) 
			values('$nokas','$kdgiat','$nmgiat','$kdrek5','$nmrek5',$nilai,0,'1') ");

			$tnosp2d = $nosp2d;
		}

		//transout
		$sql = " SELECT a.no_bukti,b.kd_skpd,b.nm_skpd,b.ket,a.kd_kegiatan,a.nm_kegiatan,a.kd_rek5,a.nm_rek5,a.nilai,b.tgl_bukti  
				FROM trdtransout a LEFT JOIN trhtransout b ON a.no_bukti=b.no_bukti; ";
		$query1 = $this->db->query($sql);
		$tnokas = '';
		foreach ($query1->result_array() as $res)
		{
			$nokas = trim($res['no_bukti']);
			$tglkas = trim($res['tgl_bukti']);
			$uraian = trim($res['ket']);
			$kdskpd = trim($res['kd_skpd']);
			$nmskpd = trim($res['nm_skpd']);

			$kdgiat = trim($res['kd_kegiatan']);
			$nmgiat = trim($res['nm_kegiatan']);
			$kdrek5 = trim($res['kd_rek5']);
			$nmrek5 = trim($res['nm_rek5']);
			$nilai = trim($res['nilai']);

			if ($tnokas != $nokas)
			{
				$this->db->query(" insert into trhrekal(no_kas,tgl_kas,uraian,kd_skpd,nm_skpd,jns_trans) 
									values('$nokas','$tglkas','$uraian','$kdskpd','$nmskpd','2') ");
			}

			$this->db->query(" insert into trdrekal(no_kas,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,terima,keluar,jns_trans) 
								values('$nokas','$kdgiat','$nmgiat','$kdrek5','$nmrek5',0,$nilai,'2') ");
			$tnokas = $nokas;
		}


		//potongan trm pot
		$sql = " SELECT a.no_bukti,a.kd_rek5,a.nm_rek5,a.nilai,b.kd_skpd,b.nm_skpd,b.ket,b.tgl_bukti FROM trdtrmpot a 
				LEFT JOIN trhtrmpot b ON a.no_bukti=b.no_bukti ";
		$query1 = $this->db->query($sql);
		$tnosp2d = '';
		foreach ($query1->result_array() as $res)
		{
			$nosp2d = trim($res['no_bukti']);
			$nokas = $res['no_bukti'];
			$tglkas = $res['tgl_bukti'];
			$uraian = $res['ket'];
			$kdskpd = $res['kd_skpd'];
			$nmskpd = $res['nm_skpd'];
			$kdgiat = '';
			$nmgiat = '';
			$nilai = $res['nilai'];
			$kdrek5 = $res['kd_rek5'];
			$nmrek5 = $res['nm_rek5'];

			if ($tnosp2d != $nosp2d)
			{
				$this->db->query(" insert into trhrekal(no_kas,tgl_kas,uraian,kd_skpd,nm_skpd,jns_trans) 
				values('$nokas','$tglkas','$uraian','$kdskpd','$nmskpd','3') ");
			}

			$this->db->query(" insert into trdrekal(no_kas,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,terima,keluar,jns_trans) 
			values('$nokas','$kdgiat','$nmgiat','$kdrek5','$nmrek5',$nilai,0,'3') ");

			$tnosp2d = $nosp2d;
		}

		//potongan out pot
		$sql = " SELECT a.no_bukti,a.kd_rek5,a.nm_rek5,a.nilai,b.kd_skpd,b.nm_skpd,b.ket,b.tgl_bukti FROM trdstrpot a 
				LEFT JOIN trhstrpot b ON a.no_bukti=b.no_bukti ";
		$query1 = $this->db->query($sql);
		$tnosp2d = '';
		foreach ($query1->result_array() as $res)
		{
			$nosp2d = trim($res['no_bukti']);
			$nokas = $res['no_bukti'];
			$tglkas = $res['tgl_bukti'];
			$uraian = $res['ket'];
			$kdskpd = $res['kd_skpd'];
			$nmskpd = $res['nm_skpd'];
			$kdgiat = '';
			$nmgiat = '';
			$nilai = $res['nilai'];
			$kdrek5 = $res['kd_rek5'];
			$nmrek5 = $res['nm_rek5'];

			if ($tnosp2d != $nosp2d)
			{
				$this->db->query(" insert into trhrekal(no_kas,tgl_kas,uraian,kd_skpd,nm_skpd,jns_trans) 
				values('$nokas','$tglkas','$uraian','$kdskpd','$nmskpd','4') ");
			}

			$this->db->query(" insert into trdrekal(no_kas,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,terima,keluar,jns_trans) 
			values('$nokas','$kdgiat','$nmgiat','$kdrek5','$nmrek5',0,$nilai,'4') ");

			$tnosp2d = $nosp2d;
		}

		echo '1';
	}

	function mapping()
	{
		$data['page_title'] = 'MAPPING REALISASI';
		$this->template->set('title', 'MAPPING REALISASI');
		$this->template->load('template', 'akuntansi/mapping', $data);
	}

	function mapping_ju()
	{
		$data['page_title'] = 'MAPPING TRANSAKSI';
		$this->template->set('title', 'MAPPING TRANSAKSI');
		$this->template->load('template', 'akuntansi/proses_mapping', $data);
	}
	
   //===DN   
	function proses_mapping(){
		$this->load->model("Akuntansi_model");
		$exec	= $this->Akuntansi_model->jurnal_akt();
		if($exec){
			echo '1';
		}else{
			echo '0';
		}
	}

	function proses_rekal_sp2d(){
		$this->load->model("Akuntansi_model");
		$exec	= $this->Akuntansi_model->jurnal_sp2d_bud();
		if($exec){
			echo '1';
		}else{
			echo '0';
		}
	}

	function proses_rekal_sp2d_skpd(){
		$this->load->model("Akuntansi_model");
		$exec	= $this->Akuntansi_model->jurnal_sp2d_skpd();
		if($exec){
			echo '1';
		}else{
			echo '0';
		}
	}

	function proses_rekal_spj_skpd(){
		$this->load->model("Akuntansi_model");
		$exec	= $this->Akuntansi_model->jurnal_spj_skpd();
		if($exec){
			echo '1';
		}else{
			echo '0';
		}
	}

	function proses_rekal_trmpjk_skpd(){
		$this->load->model("Akuntansi_model");
		$exec	= $this->Akuntansi_model->jurnal_trmpjk_skpd();
		if($exec){
			echo '1';
		}else{
			echo '0';
		}
	}

	function proses_rekal_strpjk_skpd(){
		$this->load->model("Akuntansi_model");
		$exec	= $this->Akuntansi_model->jurnal_strpjk_skpd();
		if($exec){
			echo '1';
		}else{
			echo '0';
		}
	}

	function proses_rekal_pend_skpd(){
		$this->load->model("Akuntansi_model");
		$exec	= $this->Akuntansi_model->jurnal_pend_skpd();
		if($exec){
			echo '1';
		}else{
			echo '0';
		}
	}

	function proses_rekal_pend_bud(){
		$this->load->model("Akuntansi_model");
		$exec	= $this->Akuntansi_model->jurnal_pend_bud();
		if($exec){
			echo '1';
		}else{
			echo '0';
		}
	}
	
	function bukubesar(){
		$data['page_title'] = 'CETAK BUKU BESAR';
		$this->template->set('title', 'BUKU BESAR');
		$this->template->load('template', 'akuntansi/bukubesar', $data);

	}

	function skpd(){
		$lccr	= $this->input->post('q');
		//$sql	= " SELECT kd_skpd,nm_skpd FROM ms_skpd UNION
		//			select 'PPKD','Satuan Kerja Pengeloala Keuangan Daerah' ";
		$sql	= " SELECT kd_skpd,nm_skpd FROM ms_skpd where upper(nm_skpd) like upper('%$lccr%') or upper(kd_skpd) like upper('%$lccr%')";
		$query1	= $this->db->query($sql);
		$result	= array();
		$ii = 0;
		foreach ($query1->result_array() as $resulte){
			$result[] = array(
				'id' => $ii,
				'kd_skpd' => $resulte['kd_skpd'],
				'nm_skpd' => $resulte['nm_skpd'],
			);
			$ii++;
		}

		echo json_encode($result);
	}
//Firman Tambah SDANA
    function sumber() {
        $lccr = $this->input->post('q');
        $sql = "SELECT kd_sdana,nm_sdana FROM ms_dana where upper(nm_sdana) like upper('%$lccr%') or upper(nm_sdana) like upper('%$lccr%') ";
        $query1 = $this->db->query($sql);  
        $result = array();
        $ii = 0;
        foreach($query1->result_array() as $resulte)
        { 
           
            $result[] = array(
                        'id' => $ii,        
                        'kd_sdana' => $resulte['kd_sdana'],  
                        'nm_sdana' => $resulte['nm_sdana'],  
                       
                        );
                        $ii++;
        }
           
        echo json_encode($result);
	}      

//BATAS	
	
	function rekening(){
		$lccr = $this->input->post('q');
		$sql = " SELECT kd_rek64,nm_rek64 FROM ms_rek5 where concat(kd_rek64,nm_rek64) like '%$lccr%' order by kd_rek64 limit 20 ";
		$query1 = $this->db->query($sql);
		$result = array();
		$ii = 0;
		foreach ($query1->result_array() as $resulte){
			$result[] = array(
				'id' => $ii,
				'kd_rek5' => $resulte['kd_rek64'],
				'nm_rek5' => $resulte['nm_rek64'], );
			$ii++;
		}

		echo json_encode($result);
	}

		
	function rekening_21_11_2014(){
		$lccr = $this->input->post('q');
		$sql = " SELECT kd_rek5,nm_rek5 FROM ms_rek5 where kd_rek5 like '$lccr%' limit 20";
		$query1 = $this->db->query($sql);
		$result = array();
		$ii = 0;
		foreach ($query1->result_array() as $resulte)
		{

			$result[] = array('id' => $ii, 'kd_rek5' => $resulte['kd_rek5'], 'nm_rek5' => $resulte['nm_rek5'], );
			$ii++;
		}

		echo json_encode($result);
	}
	
	function panjang_karakter(){
		$text	= strlen("contoh");
		print($text);
	}

	function angka($nilai){

	if($nilai<0){
		$lc = '('.number_format(abs($nilai),2,'.',',').')';
	}else{
		if($nilai==0){
			$lc =0;
		}else{
			$lc = number_format($nilai,2,'.',',');
		}
	}

	return $lc;
   }

	function cetakbb($dcetak='',$rek5='',$dcetak2='',$ctk){
		$panjang	= strlen($rek5);
		$id_ppk		= $_REQUEST['id_ppk'];
		$nm_ppk		= $_REQUEST['nm_ppk'];
		$tgl_cetak	= $_REQUEST['tgl_ttd'];
		if(!$tgl_cetak){
			$tgl_cetak	= $this->tukd_model->tanggal_format_indonesia(date('Y-m-d'));
		}else{
			$tgl_cetak =$this->tukd_model->tanggal_format_indonesia($tgl_cetak);
		}

		$kab_kota	= $this->akuntansi_model->get_sclient('kab_kota');
		
			$cRet ='<TABLE width="100%">
					<tr>
						<td align="center" > '.$kab_kota.'</TD>
					</tr>
					<tr>
						<td align="center" >BUKU BESAR PPKD</TD>
					</tr>
					<tr>
						<td align="center" >Periode '.$this->tukd_model->tanggal_format_indonesia($dcetak).' S/D '.$this->tukd_model->tanggal_format_indonesia($dcetak2).'</TD>
					</tr>
					<tr>
						<td align="center" >&nbsp;</TD>
					</tr>
					</TABLE>';

			$cRet .='<TABLE border="0" cellspacing="0" cellpadding="0" align="center" width="80%">
					<tr>
						<td align="left" style="width:150px">Kode Rekening</TD>
						<td align="center">:</TD>
						<td align="left" width="800px">&nbsp;'.$rek5.'</TD>
					</tr>
					<tr>
						<td align="left" style="width:150px">Nama Rekening</TD>
						<td align="center">:</TD>
						<td align="left">&nbsp;'.$this->akuntansi_model->get_rek64($rek5,'nm_rek').'</TD>
					</tr>
					</TABLE>';

			$cRet .='<TABLE border="1" cellspacing="0" cellpadding="0" align="center" width="80%">
					<thead>
					<tr>
						<td width="90" align="center" bgcolor="#cccccc">TANGGAL</TD>
						<td width="350" align="center" bgcolor="#cccccc" >URAIAN</TD>
						<td width="80" align="center" bgcolor="#cccccc" >REF</TD>
						<td width="100" align="center" bgcolor="#cccccc" >DEBET</TD>
						<td width="100" align="center" bgcolor="#cccccc" >KREDIT</TD>
						<td width="120" align="center" bgcolor="#cccccc" >SALDO</TD>
					</tr>
					</thead>';
			
		$csql3 = "	SELECT sum(a.debet) as debet,sum(a.kredit) as kredit FROM trdju_ppkd a JOIN trhju_ppkd b ON a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_skpd 
					WHERE left(a.kd_rek5,$panjang)='$rek5' and b.tgl_voucher < '$dcetak'  and a.pos='1'";

					$hasil = $this->db->query($csql3);
					$trh4 = $hasil->row(); 
					$awaldebet		= $trh4->debet;
					$awalkredit	= $trh4->kredit;
					if ((substr($rek5,0,1)=='9') or (substr($rek5,0,1)=='5') or (substr($rek5,0,2)=='62') or (substr($rek5,0,2)=='72') or (substr($rek5,0,1)=='1')){
						$saldo=$awaldebet-$awalkredit;
					}else{
						$saldo=$awalkredit-$awaldebet;
					}
					
					$cRet .='<tr>
								<td width="90" align="left" ></TD>
								<td width="350" align="left" >Saldo Lalu</TD>
								<td width="80" align="left" ></TD>
								<td width="100" align="right" ></TD>
								<td width="100" align="right" ></TD>
								<td width="120" align="right" >'.number_format($saldo).'</TD>
							</tr>';		
			
				$qry	= " SELECT a.kd_rek5,a.debet,a.kredit,b.tgl_voucher,b.ket,b.no_voucher FROM trdju_ppkd a 
							JOIN trhju_ppkd b ON a.kd_skpd=b.kd_skpd and a.no_voucher=b.no_voucher 
							WHERE left(a.kd_rek5,$panjang)='$rek5' and b.tgl_voucher>='$dcetak' and b.tgl_voucher<='$dcetak2' and a.pos='1' 
							order by tgl_voucher,a.no_voucher";
							
				$query	= $this->db->query($qry);
				$saldo=$saldo;
				$jdebet=0;
				$jkredit=0;
				foreach($query->result() as $res){
						$tgl_voucher	= $res->tgl_voucher;
						$ket			= $res->ket;
						$no_voucher		= $res->no_voucher;
						$debet			= $res->debet;
						$kredit			= $res->kredit;

					if ((substr($rek5,0,1)=='9') or (substr($rek5,0,1)=='5') or (substr($rek5,0,2)=='62') or (substr($rek5,0,2)=='72') or (substr($rek5,0,1)=='1')){					
						$saldo=$saldo+$debet-$kredit;
					}else{
						$saldo=$saldo+$kredit-$debet;
					}

					$cRet .='<tr>
								<td width="90" align="left" >'.$this->tukd_model->tanggal_ind($tgl_voucher).'</TD>
								<td width="350" align="left" >'.$ket.'</TD>
								<td width="80" align="left" >'.$no_voucher.'</TD>
								<td width="100" align="right" >'.number_format($debet).'</TD>
								<td width="100" align="right" >'.number_format($kredit).'</TD>
								<td width="120" align="right" >'.number_format($saldo).'</TD>
							';					
					$jdebet=$jdebet+$debet;
					$jkredit=$jkredit+$kredit;
				}

				$cRet .='</tr><tr>
					<td width="90" align="left" ></TD>
					<td width="350" align="center" >JUMLAH</TD>
					<td width="80" align="left" ></TD>
					<td width="100" align="right" >'.number_format($jdebet).'</TD>
					<td width="100" align="right" >'.number_format($jkredit).'</TD>
					<td width="120" align="right" >'.number_format($saldo).'</TD>
				</tr>';					

						$cRet .='</TABLE>';
						$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
									<tr>
										<td style=\"border: solid 1px white;width:100px\">&ensp;</td>
										<td style=\"border: solid 1px white;width:100px\">&ensp;</td>
										<td style=\"border: solid 1px white;width:100px\">&ensp;</td>
									</tr>
									<tr>
										<td colspan=\"2\" align=\"center\" style=\"border: solid 1px white;\">&ensp;</td>
										<td align=\"center\" style=\"border: solid 1px white;\">".$this->akuntansi_model->get_sclient('daerah').", ".$tgl_cetak."</td>
									</tr>
									<tr>
										<td colspan=\"2\" align=\"center\" style=\"border: solid 1px white;\">&ensp;</td>
										<td align=\"center\" style=\"border: solid 1px white;\">&ensp;</td>
									</tr>
									<tr>
										<td colspan=\"2\" align=\"center\" style=\"border: solid 1px white;\">&ensp;</td>
										<td align=\"center\" style=\"border: solid 1px white;\">&ensp;</td>
									</tr>
									<tr>
										<td colspan=\"2\" align=\"center\" style=\"border: solid 1px white;\">&ensp;</td>
										<td align=\"center\" style=\"border: solid 1px white;\"><u>".$nm_ppk."</u></td>
									</tr>
									<tr>
										<td colspan=\"2\" align=\"center\" style=\"border: solid 1px white;\">&ensp;</td>
										<td align=\"center\" style=\"border: solid 1px white;\">".$id_ppk."</td>
									</tr>
								</table>";

			$data['prev']= 'BUKU BESAR';
			switch ($ctk){
				case 0:
					echo $cRet;
					echo "<title>Buku Besar</title>";
					break;
				case '1':
					$this->tukd_model->_mpdf('',$cRet,10,5,10,'0');
					break;
				default:
				print('samijo, similikite, kutu kupret');
				break;
			}
	}

	function jukeluar()
	{
		$data['page_title'] = 'JURNAL PENGELUARAN';
		$this->template->set('title', 'JURNAL PENGELUARAN');
		$this->template->load('template', 'akuntansi/jukeluar', $data);
	}

	function jumasuk()
	{
		$data['page_title'] = 'JURNAL PENERIMAAN';
		$this->template->set('title', 'JURNAL PENERIMAAN');
		$this->template->load('template', 'akuntansi/jumasuk', $data);
	}


	function ctk_jukeluar($dcetak = '', $ttd = '', $skpd = '', $dcetak2 = '')
	{

		$cRet = '<table width="100%">
					<tr>
						<td align="center" >JURNAL PENGELUARAN</TD>
					</tr>
					<table>';

		$cRet .= '<table width="100%">
					<tr>
						<td align="left" width="100" >SKPD</TD>
						<td align="left" width="100" >: ' . $skpd . ' ' . $this->tukd_model->
			get_nama($skpd, 'nm_skpd', 'ms_skpd', 'kd_skpd') . '</TD>
					</tr>
					<tr>
						<td  align="left" width="100" >PERIODE</TD>
						<td align="left" width="100" >: ' . $this->tukd_model->
			tanggal_format_indonesia($dcetak) . ' s/d ' . $this->tukd_model->
			tanggal_format_indonesia($dcetak2) . '</TD>
					</tr>
					<table>';

		$cRet .= '<table border="1" cellspacing="0" cellpadding="0" >
					<tr>
						<td width="90" align="center" rowspan="2" >TANGGAL</TD>
						<td width="200" align="center" colspan="2" >NOMOR</TD>
						<td width="100" align="center" rowspan="2" >KODE REKENING</TD>
						<td width="200" align="center" rowspan="2" >URAIAN</TD>
						<td width="80" align="center"  rowspan="2" >REF</TD>
						<td width="100" align="center" rowspan="2" >JUMLAH</TD>
						<td width="100" align="center" rowspan="2" >AKUMULASI</TD>
					</tr>';

		$cRet .= '<tr>
						<td width="100" align="center" >No.Bukti</TD>
						<td width="100" align="center" >Bukti Lain</TD>
					</tr>';

		$idx = 1;
		$saldo = 0;
		$tbukti = '';
		$tgl = '';
		$query = $this->db->query(" SELECT a.kd_rek5,a.nilai,a.nm_rek5,b.tgl_kas,b.ket,b.no_kas FROM trdkasout_pkd a LEFT JOIN trhkasout_pkd b ON a.no_kas=b.no_kas WHERE b.kd_skpd='$skpd' and b.tgl_kas>='$dcetak' and b.tgl_kas<='$dcetak2' order by b.tgl_kas ");
		foreach ($query->result_array() as $res)
		{
			if ($tbukti != $res['no_kas'])
			{
				$nokas = $res['no_kas'];
			} else
			{
				$nokas = '';
			}
			if ($tgl != $res['tgl_kas'])
			{
				$tanggal = $res['tgl_kas'];
			} else
			{
				$tanggal = '';
			}
			$saldo = $saldo + $res['nilai'];
			$cRet .= '<tr>
								<td  align="left" >' . $this->tukd_model->rev_date($res['tgl_kas']) .
				'</TD>
								<td  align="left" >' . $nokas . '</TD>
								<td  align="left" ></TD>
								<td  align="center" >' . $res['kd_rek5'] . '</TD>
								<td  align="left" >' . $res['nm_rek5'] . '</TD>
								<td  align="left" ></TD>
								<td  align="right" >' . number_format($res['nilai']) . '</TD>
								<td  align="right" >' . number_format($saldo) . '</TD>
							</tr>';
			$idx++;
			$tbukti = $res['no_kas'];
			$tgl = $res['tgl_kas'];
		}


		$cRet .= '<table>';

		$data['prev'] = 'JURNAL PENGELUARAN';
		$this->tukd_model->_mpdf('', $cRet, 5, 5, 10, '0');

	}


	function ctk_jumasuk($dcetak = '', $ttd = '', $skpd = '', $dcetak2 = '')
	{

		$cRet = '<table width="100%">
					<tr>
						<td align="center" >JURNAL PENERIMAAN</TD>
					</tr>
					<table>';

		$cRet .= '<table width="100%">
					<tr>
						<td align="left" width="100" >SKPD</TD>
						<td align="left" width="100" >: ' . $skpd . ' ' . $this->tukd_model->
			get_nama($skpd, 'nm_skpd', 'ms_skpd', 'kd_skpd') . '</TD>
					</tr>
					<tr>
						<td  align="left" width="100" >PERIODE</TD>
						<td align="left" width="100" >: ' . $this->tukd_model->
			tanggal_format_indonesia($dcetak) . ' s/d ' . $this->tukd_model->
			tanggal_format_indonesia($dcetak2) . '</TD>
					</tr>
					<table>';

		$cRet .= '<table border="1" cellspacing="0" cellpadding="0" >
					<tr>
						<td width="90" align="center" rowspan="2" >TANGGAL</TD>
						<td width="200" align="center" colspan="2" >NOMOR</TD>
						<td width="100" align="center" rowspan="2" >KODE REKENING</TD>
						<td width="200" align="center" rowspan="2" >URAIAN</TD>
						<td width="80" align="center"  rowspan="2" >REF</TD>
						<td width="100" align="center" rowspan="2" >JUMLAH</TD>
						<td width="100" align="center" rowspan="2" >AKUMULASI</TD>
					</tr>';

		$cRet .= '<tr>
						<td width="100" align="center" >No.Bukti</TD>
						<td width="100" align="center" >Bukti Lain</TD>
					</tr>';

		$idx = 1;
		$saldo = 0;
		$tbukti = '';
		$query = $this->db->query(" SELECT a.kd_rek5,a.rupiah AS nilai,c.nm_rek5,b.tgl_sts,b.no_sts as no_kas FROM trdkasin_pkd a LEFT JOIN trhkasin_pkd b ON a.no_sts=b.no_sts LEFT JOIN ms_rek5 c ON a.kd_rek5=c.kd_rek5 WHERE  b.kd_skpd='$skpd' and b.tgl_sts>='$dcetak' and b.tgl_sts<='$dcetak2' ");
		foreach ($query->result_array() as $res)
		{
			if ($tbukti != $res['no_kas'])
			{
				$nokas = $res['no_kas'];
			} else
			{
				$nokas = '';
			}
			$saldo = $saldo + $res['nilai'];
			$cRet .= '<tr>
								<td  align="left" >' . $this->tukd_model->rev_date($res['tgl_sts']) .
				'</TD>
								<td  align="left" >' . $nokas . '</TD>
								<td  align="left" ></TD>
								<td  align="center" >' . $res['kd_rek5'] . '</TD>
								<td  align="left" >' . $res['nm_rek5'] . '</TD>
								<td  align="left" ></TD>
								<td  align="right" >' . number_format($res['nilai']) . '</TD>
								<td  align="right" >' . number_format($saldo) . '</TD>
							</tr>';
			$idx++;
			$tbukti = $res['no_kas'];
		}


		$cRet .= '<table>';

		$data['prev'] = 'JURNAL PENERIMAAN';
		$this->tukd_model->_mpdf('', $cRet, 5, 5, 10, '0');

	}

	function jumum(){
		$data['page_title'] = 'INPUT JURNAL UMUM';
		$this->template->set('title', 'INPUT JURNAL UMUM');
		$this->template->load('template', 'akuntansi/jumum', $data);
	}

	function jumum_ppkd(){
		$data['page_title'] = 'INPUT JURNAL UMUM';
		$this->template->set('title', 'INPUT JURNAL UMUM');
		$this->template->load('template', 'akuntansi/jumum_ppkd', $data);
	}

	function load_ju(){
		$result = array();
		$row = array();
		$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
		$rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
		$offset = ($page - 1) * $rows;
		$kriteria = $this->input->post('cari');
		$where = "where tabel='1'";
		if ($kriteria <> ''){
			$where = " where tabel='1' and (upper(no_voucher) like upper('%$kriteria%') 
			or tgl_voucher like '%$kriteria%' or upper(ket) like upper('%$kriteria%')) ";
		}

		$sql = "SELECT count(*) as total from trhju_pkd $where";
		$query1 = $this->db->query($sql);
		$total = $query1->row();
		$result["total"] = $total->total;
		$query1->free_result();

		$sql = " select * from trhju_pkd $where order by tgl_voucher,no_voucher,kd_skpd limit $offset,$rows";
		$query1 = $this->db->query($sql);
		$ii = 0;
		foreach ($query1->result_array() as $resulte)
		{
			$row[] = array('no_voucher' => $resulte['no_voucher'], 'tgl_voucher' => $resulte['tgl_voucher'],
				'kd_skpd' => $resulte['kd_skpd'], 'nm_skpd' => $resulte['nm_skpd'], 'ket' =>
				trim($resulte['ket']), 'total_d' => $resulte['total_d'], 'total_k' => $resulte['total_k']);
			$ii++;
		}
		$result["rows"] = $row;
		echo json_encode($result);
		$query1->free_result();
	}

	function load_ju_ppkd(){
		$result = array();
		$row = array();
		$page = isset($_POST['page']) ? intval($_POST['page']) : 1;
		$rows = isset($_POST['rows']) ? intval($_POST['rows']) : 10;
		$offset = ($page - 1) * $rows;
		$kriteria = $this->input->post('cari');
		$where = "where tabel='1'";
		if ($kriteria){
			$where = "	where tabel='1' and (upper(no_voucher) like upper('%$kriteria%') 
						or tgl_voucher like '%$kriteria%' or upper(ket) like upper('%$kriteria%')) ";
		}

		$sql = "SELECT count(*) as total from trhju_ppkd $where ";
		$query1 = $this->db->query($sql);
		$total = $query1->row();
		$result["total"] = $total->total;
		$query1->free_result();

		$sql = " select * from trhju_ppkd $where order by tgl_voucher desc,no_voucher desc,kd_skpd limit $offset,$rows";
		$query1 = $this->db->query($sql);
		$ii = 0;
		foreach ($query1->result_array() as $resulte){
			$row[] = array(
				'no_voucher'	=> $resulte['no_voucher'],
				'tgl_voucher'	=> $resulte['tgl_voucher'],
				'kd_skpd'		=> $resulte['kd_skpd'],
				'nm_skpd'		=> $resulte['nm_skpd'], 
				'ket'			=> trim($resulte['ket']),
				'total_d'		=> $resulte['total_d'],
				'total_k'		=> $resulte['total_k']
			);
			$ii++;
		}
		$result["rows"] = $row;
		echo json_encode($result);
		$query1->free_result();
	}

	function load_dju(){
		$nomor	= $this->input->post('no');
		$sql	= " SELECT a.no_voucher,b.kd_kegiatan,b.nm_kegiatan,b.kd_rek5,IF(rk='D',b.nm_rek5,CONCAT(SPACE(4),b.nm_rek5)) 
					AS nm_rek5,b.debet,b.kredit,b.rk,b.jns,b.pos FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher WHERE a.no_voucher='$nomor'";
		$query1 = $this->db->query($sql);
		$result = array();
		$ii = 0;
		foreach ($query1->result_array() as $resulte)
		{
			$result[] = array('no_voucher' => $resulte['no_voucher'], 'kd_kegiatan' => $resulte['kd_kegiatan'],
				'nm_kegiatan' => $resulte['nm_kegiatan'], 'kd_rek5' => $resulte['kd_rek5'],
				'nm_rek5' => $resulte['nm_rek5'], 'debet' => $resulte['debet'], 'kredit' => $resulte['kredit'],
				'rk' => $resulte['rk'], 'jns' => $resulte['jns'], 'post' => $resulte['pos']);
			$ii++;
		}
		echo json_encode($result);
		$query1->free_result();
	}

	function load_dju_ppkd(){
		$nomor	= $this->input->post('no');
		$skpd	= $this->input->post('skpd');
		$sql = " SELECT a.no_voucher,b.kd_kegiatan,b.nm_kegiatan,b.kd_rek5,IF(rk='D',b.nm_rek5,CONCAT(SPACE(4),b.nm_rek5)) 
				AS nm_rek5,b.debet,b.kredit,b.rk,b.jns,b.pos FROM trhju_ppkd a INNER JOIN trdju_ppkd b ON a.kd_skpd='$skpd' and b.kd_skpd='$skpd'
				and a.no_voucher='$nomor' and b.no_voucher='$nomor' ";
		$query1 = $this->db->query($sql);
		$result = array();
		$ii = 0;
		foreach ($query1->result_array() as $resulte)
		{
			$result[] = array('no_voucher' => $resulte['no_voucher'], 'kd_kegiatan' => $resulte['kd_kegiatan'],
				'nm_kegiatan' => $resulte['nm_kegiatan'], 'kd_rek5' => $resulte['kd_rek5'],
				'nm_rek5' => $resulte['nm_rek5'], 'debet' => $resulte['debet'], 'kredit' => $resulte['kredit'],
				'rk' => $resulte['rk'], 'jns' => $resulte['jns'], 'post' => $resulte['pos']);
			$ii++;
		}
		echo json_encode($result);
		$query1->free_result();
	}

	function load_ju_trskpd()
	{
		$jenis = $this->input->post('jenis');
		$len = strlen($jenis);
		$giat = $this->input->post('giat');
		$cskpd = $this->input->post('kd');

		$jns_beban = '';
		$cgiat = '';
		if ($jenis != '')
		{
			$jns_beban = "and left(a.jns_kegiatan,$len)='$jenis'";
		}
		if ($giat != '')
		{
			$cgiat = " and a.kd_kegiatan not in ($giat) ";
		}
		$lccr = $this->input->post('q');
 
//		$sql = "SELECT a.kd_kegiatan,b.nm_kegiatan,a.kd_program,(select nm_program from m_prog where kd_program=a.kd_program) as nm_program,a.total FROM trskpd a INNER JOIN m_giat b ON a.kd_kegiatan1=b.kd_kegiatan
//				WHERE LEFT(a.kd_kegiatan,4)= LEFT('$cskpd',4) $jns_beban $cgiat AND (UPPER(a.kd_kegiatan) LIKE UPPER('%$lccr%') OR UPPER(b.nm_kegiatan) LIKE UPPER('%$lccr%'))";
 
 //===DN

		$sql = "SELECT a.kd_kegiatan,a.nm_kegiatan,a.kd_program,a.nm_program,a.total FROM trskpd a 
				WHERE LEFT(a.kd_kegiatan,4)= LEFT('$cskpd',4) $jns_beban $cgiat AND (UPPER(a.kd_kegiatan) LIKE UPPER('%$lccr%') OR UPPER(a.nm_kegiatan) LIKE UPPER('%$lccr%'))";


//==DNA 

 
		$query1 = $this->db->query($sql);
		$result = array();
		$ii = 0;
		foreach ($query1->result_array() as $resulte)
		{

			$result[] = array('id' => $ii, 'kd_kegiatan' => $resulte['kd_kegiatan'],
				'nm_kegiatan' => $resulte['nm_kegiatan'], 'kd_program' => $resulte['kd_program'],
				'nm_program' => $resulte['nm_program'], 'total' => $resulte['total']);
			$ii++;
		}

		echo json_encode($result);
		$query1->free_result();
	}

	function load_ju_rek()
	{
		//$jenis = $this->uri->segment(3);
		$jenis = $this->input->post('jenis');
		$len = strlen($jenis);
		$giat = $this->input->post('giat');
		$kode = $this->input->post('kd');
		$rek = $this->input->post('rek');
		$lccr = $this->input->post('q');


		if ($rek != '')
		{
			//if($jenis == '7' || $jenis == '8'  ||  $jenis == '9'){
			//$notIn = " and kd_rek4 not in ($rek) " ;
			//}else{
			$notIn = " and kd_rek5 not in ($rek) ";
			//}
		} else
		{
			$notIn = "";
		}
		//echo $jenis;

		//if ($jenis == '4' || $jenis == '5' || $jenis == '6')
		if (!$jenis){
			$sql = "SELECT kd_rek5,nm_rek5 FROM trdrka  WHERE kd_kegiatan= '$giat' AND kd_skpd = '$kode' $notIn ";
		} elseif($jenis=='10'){
			$sql = "select '0000000' kd_rek5,'Perubahan SAL' nm_rek5 ";
		}else{
			$sql = "SELECT kd_rek64 kd_rek5,nm_rek64 nm_rek5 FROM ms_rek5 where (left(kd_rek64,$len)='$jenis' and concat(kd_rek64,nm_rek64) like '%$lccr%' )$notIn";
		}
		$query1 = $this->db->query($sql);
		$result = array();
		$ii = 0;
		foreach ($query1->result_array() as $resulte)
		{
			$result[] = array('kd_rek5' => $resulte['kd_rek5'], 'nm_rek5' => $resulte['nm_rek5']);
			$ii++;
		}
		echo json_encode($result);
		$query1->free_result();
	}

	function simpan_ju()
	{
		$tabel = $this->input->post('tabel');
		$nomor = $this->input->post('no');
		$tgl = $this->input->post('tgl');
		$skpd = $this->input->post('skpd');
		$nmskpd = $this->input->post('nmskpd');
		$ket = $this->input->post('ket');
		$total_d = $this->input->post('total_d');
		$total_k = $this->input->post('total_k');
		$csql = $this->input->post('sql');

		$usernm = $this->session->userdata('pcNama');
		$update = date('y-m-d H:i:s');
		$msg = array();

		if ($tabel == 'trhju_pkd')
		{
			$sql = "delete from trhju_pkd where kd_skpd='$skpd' and no_voucher='$nomor'";
			$asg = $this->db->query($sql);
			if ($asg)
			{
				$sql = "insert into trhju_pkd(no_voucher,tgl_voucher,ket,username,tgl_update,kd_skpd,nm_skpd,total_d,total_k,tabel) 
						values('$nomor','$tgl','$ket','$usernm','$update','$skpd','$nmskpd','$total_d','$total_k','1')";
				$asg = $this->db->query($sql);
				if (!($asg))
				{
					$msg = array('pesan' => '0');
					echo json_encode($msg);
					exit();
				} else
				{
					$msg = array('pesan' => '1');
					echo json_encode($msg);
				}
			} else
			{
				$msg = array('pesan' => '0');
				echo json_encode($msg);
				exit();
			}

		} else
			if ($tabel == 'trdju_pkd')
			{

				// Simpan Detail //
				$sql = "delete from trdju_pkd where no_voucher='$nomor'";
				$asg = $this->db->query($sql);
				if (!($asg))
				{
					$msg = array('pesan' => '0');
					echo json_encode($msg);
					exit();
				} else
				{
					$sql = "insert into trdju_pkd(no_voucher,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,debet,kredit,rk,jns,pos,urut)";

					$asg = $this->db->query($sql . $csql);
					if (!($asg))
					{
						$msg = array('pesan' => '0');
						echo json_encode($msg);
						exit();
					} else
					{
						$msg = array('pesan' => '1');
						echo json_encode($msg);
					}
				}
			}
	}

	function simpan_ju_ppkd()
	{
		$tabel = $this->input->post('tabel');
		$nomor = $this->input->post('no');
		$tgl = $this->input->post('tgl');
		$skpd = $this->input->post('skpd');
		$nmskpd = $this->input->post('nmskpd');
		$ket = $this->input->post('ket');
		$total_d = $this->input->post('total_d');
		$total_k = $this->input->post('total_k');
		$csql = $this->input->post('sql');

		$usernm = $this->session->userdata('pcNama');
		$update = date('y-m-d H:i:s');
		$msg = array();

		if ($tabel == 'trhju_ppkd')
		{
			$sql = "delete from trhju_ppkd where kd_skpd='$skpd' and no_voucher='$nomor'";
			$asg = $this->db->query($sql);
			if ($asg)
			{
				$sql = "insert into trhju_ppkd(no_voucher,tgl_voucher,ket,username,tgl_update,kd_skpd,nm_skpd,total_d,total_k,tabel) 
						values('$nomor','$tgl','$ket','$usernm','$update','$skpd','$nmskpd','$total_d','$total_k','1')";
				$asg = $this->db->query($sql);
				if (!($asg))
				{
					$msg = array('pesan' => '0');
					echo json_encode($msg);
					exit();
				} else
				{
					$msg = array('pesan' => '1');
					echo json_encode($msg);
				}
			} else
			{
				$msg = array('pesan' => '0');
				echo json_encode($msg);
				exit();
			}

		} else
			if ($tabel == 'trdju_ppkd')
			{

				// Simpan Detail //
				$sql = "delete from trdju_ppkd where no_voucher='$nomor'";
				$asg = $this->db->query($sql);
				if (!($asg))
				{
					$msg = array('pesan' => '0');
					echo json_encode($msg);
					exit();
				} else
				{
					$sql = "insert into trdju_ppkd(no_voucher,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,debet,kredit,rk,jns,pos,urut,kd_skpd,tabel)";

					$asg = $this->db->query($sql . $csql);
					if (!($asg))
					{
						$msg = array('pesan' => '0');
						echo json_encode($msg);
						exit();
					} else
					{
						$msg = array('pesan' => '1');
						echo json_encode($msg);
					}
				}
			}
	}

	function hapus_ju()
	{
		$nomor = $this->input->post('no');
		$msg = array();
		$sql = "delete from trdju_pkd where no_voucher='$nomor'";
		$asg = $this->db->query($sql);
		if ($asg)
		{
			$sql = "delete from trhju_pkd where no_voucher='$nomor'";
			$asg = $this->db->query($sql);
			if (!($asg))
			{
				$msg = array('pesan' => '0');
				echo json_encode($msg);
				exit();
			}
		} else
		{
			$msg = array('pesan' => '0');
			echo json_encode($msg);
			exit();
		}
		$msg = array('pesan' => '1');
		echo json_encode($msg);
	}

	function hapus_ju_ppkd()
	{
		$nomor = $this->input->post('no');
		$msg = array();
		$sql = "delete from trdju_ppkd where no_voucher='$nomor'";
		$asg = $this->db->query($sql);
		if ($asg)
		{
			$sql = "delete from trhju_ppkd where no_voucher='$nomor'";
			$asg = $this->db->query($sql);
			if (!($asg))
			{
				$msg = array('pesan' => '0');
				echo json_encode($msg);
				exit();
			}
		} else
		{
			$msg = array('pesan' => '0');
			echo json_encode($msg);
			exit();
		}
		$msg = array('pesan' => '1');
		echo json_encode($msg);
	}


	function penjabaran()
	{
		$data['page_title'] = 'REALISASI';
		$this->template->set('title', 'REALISASI');
		$this->template->load('template', 'akuntansi/penjabaran', $data);
	}
	function cetak_perkada_real($ctk = '', $skpd = '', $awal = '', $akhir = '')
	{

		$cetak = $ctk;
		$id = $skpd;
		$date_awal = $awal;
		$date_akhir = $akhir;
		if ($cetak == 2)
		{
			$tgl_awal = $this->tukd_model->tanggal_format_indonesia($date_awal);
			$tgl_akhir = $this->tukd_model->tanggal_format_indonesia($date_akhir);
		}
		$sqldns = "SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
		$sqlskpd = $this->db->query($sqldns);
		foreach ($sqlskpd->result() as $rowdns)
		{

			$kd_urusan = $rowdns->kd_u;
			$nm_urusan = $rowdns->nm_u;
			$kd_skpd = $rowdns->kd_sk;
			$nm_skpd = $rowdns->nm_sk;
		}

		$sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
		$sqlsclient = $this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc)
		{

			$tgl = $rowsc->tgl_rka;
			$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
			$kab = $rowsc->kab_kota;
			$daerah = $rowsc->daerah;
			$thn = $rowsc->thn_ang;
		}


		$cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td align=\"center\"><strong>$kab</strong></td>
						
					</tr>
					<tr>
						<td align=\"center\"><strong>RINCIAN LAPORAN REALISASI ANGGARAN MENURUT URUSAN PEMERINTAHAN DAERAH,ORGANISASI<br/>PENDAPATAN,BELANJA DAN PEMBIAYAAN </strong></td>
					</tr>
					
					<tr>
						<td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
					</tr>

				<table>";
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
					<tr>
						<td width=\"20%\">Urusan Organisasi </td>
						<td width=\"80%\">:$kd_urusan - $nm_urusan</td>
					</tr>
					<tr>
						<td>Organisasi</td>
						<td>:$kd_skpd - $nm_skpd</td>
					</tr>";
		if ($cetak == 2)
		{
			$cRet .= "<tr>						
						<td  align=\"left\" width=\"20%\" >PERIODE</TD>
						<td align=\"left\" width=\"80%\" >:$tgl_awal s/d $tgl_akhir </TD>					
					</tr>";
		}
		$cRet .= "<table>";

		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
					<thead>					
						<tr><td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Kode Rekening</b></td>							
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"26%\" align=\"center\"><b>Uraian</b></td>							
							<td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"28%\" align=\"center\"><b>Jumlah (Rp.)</b></td>
							<td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"16%\" align=\"center\"><b>Bertambah/ (berkurang)</b></td>
							<td  rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"13%\" align=\"center\"><b>Dasar Hukum</b></td>							
							</tr>
						<tr>
 							<td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Anggaran </td>
							<td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Realisasi</td>
							<td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Jumlah</td>
							<td width=\"3%\" bgcolor=\"#CCCCCC\" align=\"center\">%</td>
							
						</tr>	
					</thead>
					<tfoot>
						<tr>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>  
							<td style=\"border-top: none;\"></td>
																				
						</tr>
					</tfoot>
					
					
						<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"center\">&nbsp;</td>							
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"26%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>							
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"14%\">&nbsp;</td>
							</tr>
						";
		if ($cetak == 1)
		{
			$sqltp = "SELECT SUM(a.nilai) AS totp,SUM(a.nilai_ubah) AS totp_u, 
						(SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,1)='4' AND a.kd_skpd='$id') AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,1)='4' AND d.kd_skpd='$id') AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,1)='4' AND f.kd_skpd='$id') AS kredit FROM trdrka a
						WHERE LEFT(kd_rek5,1)='4' AND kd_skpd='$id'";
		}
		if ($cetak == 2)
		{
			$sqltp = "SELECT SUM(a.nilai) AS totp,SUM(a.nilai_ubah) AS totp_u, 
						(SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,1)='4' AND a.kd_skpd='$id' AND b.tgl_sts>='$date_awal' AND b.tgl_sts<='$date_akhir') AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,1)='4' AND d.kd_skpd='$id' AND  d.tgl_voucher>='$date_awal' AND d.tgl_voucher<='$date_akhir') AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,1)='4' AND f.kd_skpd='$id' AND  f.tgl_voucher>='$date_awal' AND f.tgl_voucher<='$date_akhir') AS kredit FROM trdrka a
						WHERE LEFT(kd_rek5,1)='4' AND kd_skpd='$id'";
		}

		$sqlp = $this->db->query($sqltp);
		foreach ($sqlp->result() as $rowp)
		{
			$angp = number_format($rowp->totp_u, "2", ".", ",");
			$angaranp = $rowp->totp_u;
			$penp = $rowp->cp;
			$debetp = $rowp->debet;
			$kreditp = $rowp->kredit;
			$realp = ($penp + $kreditp) - $debetp;
			$nrealp = number_format($realp, "2", ".", ",");
			$real_sp = $realp - $angaranp;
			if ($real_sp < 0)
			{
				$x1 = "(";
				$real_sp = $real_sp * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisihp = number_format($real_sp, "2", ".", ",");
			$per1p = ($real_sp != 0) ? ($real_sp / $rowp->totp_u) * 100 : 0;
			$persen1p = number_format($per1p);

			$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Pendapatan Daerah</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$angp</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nrealp</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisihp$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1p</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";

			$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";
		}
		if ($cetak == 1)
		{
			$sql_p = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE  h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'3' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
						ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,25)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
						ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,26)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,28) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
						ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,28)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,30) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan)AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'6' AS nu FROM trdrka a					
						WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,30),a.nm_rek5 ) a ORDER BY kd_rek,nu ";
		}
		if ($cetak == 2)
		{
			$sql_p = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE  h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'3' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
						ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,25)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
						ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,26)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,28) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir')AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
						ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,28)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,30) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir')AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir')AS kredit,'6' AS nu FROM trdrka a					
						WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,30),a.nm_rek5 ) a ORDER BY kd_rek,nu ";
		}
		$pend = $this->db->query($sql_p);
		//$query = $this->skpd_model->getAllc();

		foreach ($pend->result() as $row)
		{
			$kode = $row->kd_rek;
			$nama = $row->nm_rek;
			$ang = number_format($row->nilai_u, "2", ".", ",");
			$angaran = $row->nilai_u;
			$pen = $row->cp;
			$debet = $row->debet;
			$kredit = $row->kredit;
			$real = ($pen + $kredit) - $debet;
			$nreal = number_format($real, "2", ".", ",");
			$real_s = $real - $angaran;
			if ($real_s < 0)
			{
				$x1 = "(";
				$real_s = $real_s * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisih = number_format($real_s, "2", ".", ",");
			$per1 = ($real_s != 0) ? ($real_s / $row->nilai_u) * 100 : 0;
			$persen1 = number_format($per1);

			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$kode</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisih$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
									</tr>
									";


		}

		$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";


		if ($cetak == 1)
		{
			$sqltb = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u, 
			(SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,1)='5' AND a.kd_skpd='$id' ) AS cp,
			(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,1)='5' AND d.kd_skpd='$id' ) AS debet,
			(SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,1)='5' AND f.kd_skpd='$id' ) AS kredit FROM trdrka a
			WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='$id'";
		}
		if ($cetak == 2)
		{
			$sqltb = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u, 
			(SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,1)='5' AND a.kd_skpd='$id' AND b.tgl_sts>='$date_awal' AND b.tgl_sts<='$date_akhir') AS cp,
			(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,1)='5' AND d.kd_skpd='$id' AND  d.tgl_voucher>='$date_awal' AND d.tgl_voucher<='$date_akhir') AS debet,
			(SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,1)='5' AND f.kd_skpd='$id' AND  f.tgl_voucher>='$date_awal' AND f.tgl_voucher<='$date_akhir') AS kredit FROM trdrka a
			WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='$id'";
		}
		$sqlb = $this->db->query($sqltb);
		foreach ($sqlb->result() as $rowb_5)
		{
			$ang_5 = number_format($rowb_5->totb_u, "2", ".", ",");
			$angaran_5 = $rowb_5->totb_u;
			$in_5 = $rowb_5->cp;
			$debet_5 = $rowb_5->debet;
			$kredit_5 = $rowb_5->kredit;
			$real_5 = $debet_5 - ($in_5 + $kredit_5);
			$nreal_5 = number_format($real_5, "2", ".", ",");
			$real_s_5 = $real_5 - $angaran_5;
			if ($real_s_5 < 0)
			{
				$x1 = "(";
				$real_s_5 = $real_s_5 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_5 = number_format($real_s_5, "2", ".", ",");
			$per_5 = ($real_s_5 != 0) ? ($real_s_5 / $rowb_5->totb_u) * 100 : 0;
			$persen_5 = number_format($per_5);

			$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Belanja Daerah</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_5</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_5</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_5$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_5</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";


		}
		if ($cetak == 1)
		{
			$sqltbtl = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u, 
							(SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='51' AND a.kd_skpd='$id' ) AS cp,
							(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='51' AND d.kd_skpd='$id' ) AS debet,
							(SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='51' AND f.kd_skpd='$id' ) AS kredit FROM trdrka a
							WHERE LEFT(kd_rek5,2)='51' AND kd_skpd='$id'";
		}
		if ($cetak == 2)
		{
			$sqltbtl = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u, 
							(SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='51' AND a.kd_skpd='$id' AND b.tgl_sts>='$date_awal' AND b.tgl_sts<='$date_akhir') AS cp,
							(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='51' AND d.kd_skpd='$id' AND  d.tgl_voucher>='$date_awal' AND d.tgl_voucher<='$date_akhir') AS debet,
							(SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='51' AND f.kd_skpd='$id' AND  f.tgl_voucher>='$date_awal' AND f.tgl_voucher<='$date_akhir') AS kredit FROM trdrka a
							WHERE LEFT(kd_rek5,2)='51' AND kd_skpd='$id'";
		}
		$sqlbtl = $this->db->query($sqltbtl);
		foreach ($sqlbtl->result() as $rowbtl)
		{
			$ang_51 = number_format($rowbtl->totb_u, "2", ".", ",");
			$angaran_51 = $rowbtl->totb_u;
			$in_51 = $rowbtl->cp;
			$debet_51 = $rowbtl->debet;
			$kredit_51 = $rowbtl->kredit;
			$real_51 = $debet_51 - ($in_51 + $kredit_51);
			$nreal_51 = number_format($real_51, "2", ".", ",");
			$real_s_51 = $real_51 - $angaran_51;
			if ($real_s_51 < 0)
			{
				$x1 = "(";
				$real_s_51 = $real_s_51 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_51 = number_format($real_s_51, "2", ".", ",");
			$per_51 = ($real_s_51 != 0) ? ($real_s_51 / $rowbtl->totb_u) * 100 : 0;
			$persen_51 = number_format($per_51);

			$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Belanja Tidak Langsung</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_51</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_51</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_51$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_51</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";

			$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";
		}


		if ($cetak == 1)
		{
			$sql_btl = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
						ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,26)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,28) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
						ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,28)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,30) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'6' AS nu FROM trdrka a					
						WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,30),a.nm_rek5 ) a ORDER BY kd_rek,nu";
		}
		if ($cetak == 2)
		{
			$sql_btl = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
						ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,26)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,28) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir')AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
						ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,28)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,30) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir')AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir')AS kredit,'6' AS nu FROM trdrka a					
						WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,30),a.nm_rek5 ) a ORDER BY kd_rek,nu";
		}
		$btl = $this->db->query($sql_btl);

		foreach ($btl->result() as $row_btl)
		{
			$kode = $row_btl->kd_rek;
			$nama = $row_btl->nm_rek;
			$ang_511 = number_format($row_btl->nilai_u, "2", ".", ",");
			$angaran_511 = $row_btl->nilai_u;
			$in_511 = $row_btl->cp;
			$debet_511 = $row_btl->debet;
			$kredit_511 = $row_btl->kredit;
			$real_511 = $debet_511 - ($in_511 + $kredit_511);
			$nreal_511 = number_format($real_511, "2", ".", ",");
			$real_s_511 = $real_511 - $angaran_511;
			if ($real_s_511 < 0)
			{
				$x1 = "(";
				$real_s_511 = $real_s_511 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_511 = number_format($real_s_511, "2", ".", ",");
			$per_511 = ($real_s_5 != 0) ? ($real_s_511 / $row_btl->nilai_u) * 100 : 0;
			$persen_511 = number_format($per_511);

			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$kode</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_511</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_511</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_511$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_511</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
									</tr>
									";


		}
		$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";

		if ($cetak == 1)
		{
			$sqltbl = "SELECT SUM(a.nilai) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
						(SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='52' AND a.kd_skpd='$id') AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='52' AND d.kd_skpd='$id') AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='52' AND f.kd_skpd='$id') AS kredit FROM trdrka a
						WHERE LEFT(kd_rek5,2)='52' AND kd_skpd='$id'";
		}
		if ($cetak == 2)
		{
			$sqltbl = "SELECT SUM(a.nilai) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
						(SELECT SUM(rupiah) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='52' AND a.kd_skpd='$id' AND b.tgl_sts>='$date_awal' AND b.tgl_sts<='$date_akhir') AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='52' AND d.kd_skpd='$id' AND  d.tgl_voucher>='$date_awal' AND d.tgl_voucher<='$date_akhir') AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='52' AND f.kd_skpd='$id' AND  f.tgl_voucher>='$date_awal' AND f.tgl_voucher<='$date_akhir') AS kredit FROM trdrka a
						WHERE LEFT(kd_rek5,2)='52' AND kd_skpd='$id'";
		}
		$sqlbl = $this->db->query($sqltbl);
		foreach ($sqlbl->result() as $rowbl)
		{
			$ang_52 = number_format($rowbl->totbl_u, "2", ".", ",");
			$angaran_52 = $rowbl->totbl_u;
			$in_52 = $rowbl->cp;
			$debet_52 = $rowbl->debet;
			$kredit_52 = $rowbl->kredit;
			$real_52 = $debet_52 - ($in_52 + $kredit_52);
			$nreal_52 = number_format($real_52, "2", ".", ",");
			$real_s_52 = $real_52 - $angaran_52;
			if ($real_s_52 < 0)
			{
				$x1 = "(";
				$real_s_52 = $real_s_52 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_52 = number_format($real_s_51, "2", ".", ",");
			$per_52 = ($real_s_5 != 0) ? ($real_s_51 / $rowbl->totbl_u) * 100 : 0;
			$persen_52 = number_format($per_52);

			$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Belanja Langsung</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_52</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_52</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_52$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_52</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";
		}
		$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";



		


// ====DN
 
if ($cetak == 1) 

		{
			$sql_bl = "SELECT * FROM (SELECT a.kd_program AS kd_rek, a.nm_program AS nm_rek,(SELECT SUM(nilai) FROM trdrka WHERE LEFT(kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program) AS nilai,
						(SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program) AS nilai_u,
						(SELECT SUM(rupiah) FROM trdkasin_pkd g INNER JOIN trhkasin_pkd h ON g.no_sts = h.no_sts WHERE h.kd_skpd='$id' AND LEFT(h.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program ) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd i  INNER JOIN trhju_pkd j ON i.no_voucher = j.no_voucher  WHERE j.kd_skpd='$id' AND LEFT(i.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program ) AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd k  INNER JOIN trhju_pkd l ON k.no_voucher = l.no_voucher WHERE l.kd_skpd='$id' AND LEFT(k.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program ) AS kredit,'1' AS nu FROM trskpd a 
						LEFT JOIN trdrka b ON a.kd_program=LEFT(b.kd_kegiatan,(LENGTH(a.kd_program))) WHERE a.kd_skpd='$id' AND RIGHT(a.kd_program,2) <>'00' GROUP BY a.kd_program,a.nm_program 
						UNION ALL
						SELECT a.kd_kegiatan AS kd_rek,a.nm_kegiatan AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
						(SELECT SUM(rupiah) FROM trdkasin_pkd g INNER JOIN trhkasin_pkd h ON g.no_sts = h.no_sts WHERE h.kd_skpd='$id' AND h.kd_kegiatan = a.kd_kegiatan ) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd i  INNER JOIN trhju_pkd j ON i.no_voucher = j.no_voucher  WHERE j.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan ) AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd k  INNER JOIN trhju_pkd l ON k.no_voucher = l.no_voucher WHERE l.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan ) AS kredit,'2' AS nu FROM trskpd a 
						LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan WHERE a.kd_skpd='$id' AND RIGHT(a.kd_program,2) <>'00' GROUP BY a.kd_kegiatan,a.nm_kegiatan
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'3' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
						ON LEFT(a.kd_rek5,3)=b.kd_rek3   
						WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,25)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
						ON LEFT(a.kd_rek5,3)=b.kd_rek3				
						WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,26)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,28) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
						ON LEFT(a.kd_rek5,5)=b.kd_rek4					
						WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,28)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,30) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'6' AS nu FROM trdrka a					
						WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,30),a.nm_rek5 ) a ORDER BY kd_rek,nu";
		}
		if ($cetak == 2)
		{
			$sql_bl = "SELECT * FROM (SELECT a.kd_program AS kd_rek,a.nm_program AS nm_rek,(SELECT SUM(nilai) FROM trdrka WHERE LEFT(kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program) AS nilai,
						(SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program) AS nilai_u,
						(SELECT SUM(rupiah) FROM trdkasin_pkd g INNER JOIN trhkasin_pkd h ON g.no_sts = h.no_sts WHERE h.kd_skpd='$id' AND LEFT(h.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program AND h.tgl_sts>='$date_awal' AND h.tgl_sts<='$date_akhir') AS cp,
						(SELECT SUM(debet) FROM trdju_pkd i  INNER JOIN trhju_pkd j ON i.no_voucher = j.no_voucher  WHERE j.kd_skpd='$id' AND LEFT(i.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program AND j.tgl_voucher>='$date_awal' AND j.tgl_voucher<='$date_akhir') AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd k  INNER JOIN trhju_pkd l ON k.no_voucher = l.no_voucher WHERE l.kd_skpd='$id' AND LEFT(k.kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program AND l.tgl_voucher>='$date_awal' AND l.tgl_voucher<='2$date_akhir') AS kredit,'1' AS nu FROM trskpd a 
						LEFT JOIN trdrka b ON a.kd_program=LEFT(b.kd_kegiatan,(LENGTH(a.kd_program))) WHERE a.kd_skpd='$id' AND RIGHT(a.kd_program,2) <>'00' GROUP BY a.kd_program,a.nm_program 
						UNION ALL
						SELECT a.kd_kegiatan AS kd_rek,a.nm_kegiatan AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
						(SELECT SUM(rupiah) FROM trdkasin_pkd g INNER JOIN trhkasin_pkd h ON g.no_sts = h.no_sts WHERE h.kd_skpd='$id' AND h.kd_kegiatan = a.kd_kegiatan AND h.tgl_sts>='2012-11-01' AND h.tgl_sts <='$date_akhir') AS cp,
						(SELECT SUM(debet) FROM trdju_pkd i  INNER JOIN trhju_pkd j ON i.no_voucher = j.no_voucher  WHERE j.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan AND j.tgl_voucher>='$date_awal' AND j.tgl_voucher<='$date_akhir') AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd k  INNER JOIN trhju_pkd l ON k.no_voucher = l.no_voucher WHERE l.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan AND l.tgl_voucher>='$date_awal' AND l.tgl_voucher<='$date_akhir') AS kredit,'2' AS nu FROM trskpd a 
						LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan WHERE a.kd_skpd='$id' AND RIGHT(a.kd_program,2) <>'00' GROUP BY a.kd_kegiatan,a.nm_kegiatan
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'3' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
						ON LEFT(a.kd_rek5,3)=b.kd_rek3   
						WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,25)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='2012-11-01' AND d.tgl_sts<='$date_akhir' )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
						ON LEFT(a.kd_rek5,3)=b.kd_rek3				
						WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,26)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,28) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir')AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
						ON LEFT(a.kd_rek5,5)=b.kd_rek4					
						WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,28)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,30) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE d.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir')AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir')AS kredit,'6' AS nu FROM trdrka a					
						WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,30),a.nm_rek5 ) a ORDER BY kd_rek,nu";
		}
 
 
 //===DNA 



		
		
		$bl = $this->db->query($sql_bl);
		foreach ($bl->result() as $row_bl)
		{
			$kode = $row_bl->kd_rek;
			$nama = $row_bl->nm_rek;
			$ang_522 = number_format($row_bl->nilai_u, "2", ".", ",");
			$angaran_522 = $row_bl->nilai_u;
			$in_522 = $row_bl->cp;
			$debet_522 = $row_bl->debet;
			$kredit_522 = $row_bl->kredit;
			$real_522 = $debet_522 - ($in_522 + $kredit_522);
			$nreal_522 = number_format($real_522, "2", ".", ",");
			$real_s_522 = $real_522 - $angaran_522;
			if ($real_s_522 < 0)
			{
				$x1 = "(";
				$real_s_522 = $real_s_522 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_522 = number_format($real_s_522, "2", ".", ",");
			$per_522 = ($real_s_522 != 0) ? ($real_s_522 / $row_bl->nilai_u) * 100 : 0;
			$persen_522 = number_format($per_522);

			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$kode</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_522</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_522</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_522$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_522</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
									</tr>
									";


		}
		$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";


		$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Belanja Daerah</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_5</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_5</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_5$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_5</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";
		$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";
		if($id=='1.20.06.00')
		{
				if ($cetak == 1)
				{
					$sqltpm = "SELECT SUM(IFNULL(a.nilai,0)) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
								(SELECT SUM(IFNULL(rupiah,0)) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='61' AND a.kd_skpd='$id' ) AS cp,
								(SELECT SUM(IFNULL(debet,0)) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='61' AND d.kd_skpd='$id' ) AS debet,
								(SELECT SUM(IFNULL(kredit,0)) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='61' AND f.kd_skpd='$id' ) AS kredit FROM trdrka a
								WHERE LEFT(kd_rek5,2)='61' AND kd_skpd='$id'";
				}
				if ($cetak == 2)
				{
					$sqltpm = "SELECT SUM(IFNULL(a.nilai,0)) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
								(SELECT SUM(IFNULL(rupiah,0)) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='61' AND a.kd_skpd='$id' AND b.tgl_sts>='$date_awal' AND b.tgl_sts<='$date_akhir') AS cp,
								(SELECT SUM(IFNULL(debet,0)) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='61' AND d.kd_skpd='$id' AND  d.tgl_voucher>='$date_awal' AND d.tgl_voucher<='$date_akhir') AS debet,
								(SELECT SUM(IFNULL(kredit,0)) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='61' AND f.kd_skpd='$id' AND  f.tgl_voucher>='$date_awal' AND f.tgl_voucher<='$date_akhir') AS kredit FROM trdrka a
								WHERE LEFT(kd_rek5,2)='61' AND kd_skpd='$id'";
				}
				$sqlpm = $this->db->query($sqltpm);
				foreach ($sqlpm->result() as $rowpm)
				{
					$ang_61 = number_format($rowpm->totbl_u, "2", ".", ",");
					$angaran_61 = $rowpm->totbl_u;
					$in_61 = $rowpm->cp;
					$debet_61 = $rowpm->debet;
					$kredit_61 = $rowpm->kredit;
					$real_61 = $debet_61 - ($in_61 + $kredit_61);
					$nreal_61 = number_format($real_61, "2", ".", ",");
					$real_s_61 = $real_61 - $angaran_61;
					if ($real_s_61 < 0)
					{
						$x1 = "(";
						$real_s_61 = $real_s_61 * -1;
						$y1 = ")";
					} else
					{
						$x1 = "";
						$y1 = "";
					}
					$selisih_61 = number_format($real_s_61, "2", ".", ",");
					$per_61 = ($real_s_61 != 0) ? ($real_s_61 / $rowpm->totbl_u) * 100 : 0;
					$persen_61 = number_format($per_61);
					//
					//					$cRet	.= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
					//									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Pembiayaan Masuk</td>
					//									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_61</td>
					//									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_61</td>
					//									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_61$y1</td>
					//									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_61</td>
					//									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
					//									</tr>";
				}
		
		
				if ($cetak == 1)
				{
					$sqlpm = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
								(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
								(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
								(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
								ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,25)
								UNION ALL
								SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
								(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
								(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
								(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
								ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,26)
								UNION ALL
								SELECT SUBSTR(a.no_trdrka,12,28) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
								(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
								(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
								(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
								ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,28)
								UNION ALL
								SELECT SUBSTR(a.no_trdrka,12,30) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
								(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
								(SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
								(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'6' AS nu FROM trdrka a					
								WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,30),a.nm_rek5 ) a ORDER BY kd_rek,nu";
				}
				if ($cetak == 2)
				{
					$sqlpm = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
								(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
								(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='<strong>$date_awal</strong>' AND g.tgl_voucher<='$date_akhir' )AS debet,
								(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
								ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,25)
								UNION ALL
								SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
								(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='2012-10-01' AND d.tgl_sts<='$date_akhir' )AS cp,
								(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
								(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
								ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,26)
								UNION ALL
								SELECT SUBSTR(a.no_trdrka,12,28) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
								(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
								(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir')AS debet,
								(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
								ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,28)
								UNION ALL
								SELECT SUBSTR(a.no_trdrka,12,30) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
								(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir')AS cp,
								(SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
								(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir')AS kredit,'6' AS nu FROM trdrka a					
								WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,30),a.nm_rek5 ) a ORDER BY kd_rek,nu";
				}
				$sql611 = $this->db->query($sqlpm);
				foreach ($sql611->result() as $row_61)
				{
					$kd = $row_61->kd_rek;
					$nm = $row_61->nm_rek;
					$ang_611 = number_format($row_61->nilai_u, "2", ".", ",");
					$angaran_611 = $row_61->nilai_u;
					$in_611 = $row_61->cp;
					$debet_611 = $row_61->debet;
					$kredit_611 = $row_61->kredit;
					$real_611 = $debet_611 - ($in_611 + $kredit_611);
					$nreal_611 = number_format($real_611, "2", ".", ",");
					$real_s_611 = $real_611 - $angaran_611;
					if ($real_s_611 < 0)
					{
						$x1 = "(";
						$real_s_611 = $real_s_611 * -1;
						$y1 = ")";
					} else
					{
						$x1 = "";
						$y1 = "";
					}
					$selisih_611 = number_format($real_s_611, "2", ".", ",");
					$per_611 = ($real_s_611 != 0) ? ($real_s_611 / $row_61->nilai_u) * 100 : 0;
					$persen_611 = number_format($per_611);
		
					$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"15%\" align=\"left\">$kd</td>									
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"26%\">$nm</td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$ang_611</td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$nreal_611</td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$x1$selisih_611$y1</td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"3%\" align=\"right\">$persen_611</td>
											<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
											</tr>";
				}
				$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
											<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
											</tr>";
				if ($cetak == 1)
				{
					$sqltpk = "SELECT SUM(IFNULL(a.nilai,0)) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
								(SELECT SUM(IFNULL(rupiah,0)) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='62' AND a.kd_skpd='$id' ) AS cp,
								(SELECT SUM(IFNULL(debet,0)) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='62' AND d.kd_skpd='$id' ) AS debet,
								(SELECT SUM(IFNULL(kredit,0)) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='62' AND f.kd_skpd='$id' ) AS kredit FROM trdrka a
								WHERE LEFT(kd_rek5,2)='62' AND kd_skpd='$id' ";
				}
				if ($cetak == 2)
				{
					$sqltpk = "SELECT SUM(IFNULL(a.nilai,0)) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
								(SELECT SUM(IFNULL(rupiah,0)) FROM trdkasin_pkd a INNER JOIN trhkasin_pkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='62' AND a.kd_skpd='$id' AND b.tgl_sts>='$date_awal' AND b.tgl_sts<='$date_akhir') AS cp,
								(SELECT SUM(IFNULL(debet,0)) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5,2)='62' AND d.kd_skpd='$id' AND  d.tgl_voucher>='$date_awal' AND d.tgl_voucher<='$date_akhir') AS debet,
								(SELECT SUM(IFNULL(kredit,0)) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5,2)='62' AND f.kd_skpd='$id' AND  f.tgl_voucher>='$date_awal' AND f.tgl_voucher<='$date_akhir') AS kredit FROM trdrka a
								WHERE LEFT(kd_rek5,2)='62' AND kd_skpd='$id' ";
				}
				$sqlpk = $this->db->query($sqltpk);
				foreach ($sqlpk->result() as $rowpk)
				{
					$ang_62 = number_format($rowpk->totbl_u, "2", ".", ",");
					$angaran_62 = $rowpk->totbl_u;
					//echo($angaran_62);
					$in_62 = $rowpk->cp;
					$debet_62 = $rowpk->debet;
					$kredit_62 = $rowpk->kredit;
					$real_62 = $debet_62 - ($in_62 + $kredit_62);
					$nreal_62 = number_format($real_62, "2", ".", ",");
					$real_s_62 = $real_62 - $angaran_62;
					if ($real_s_62 < 0)
					{
						$x1 = "(";
						$real_s_62 = $real_s_62 * -1;
						$y1 = ")";
					} else
					{
						$x1 = "";
						$y1 = "";
					}
					$selisih_62 = number_format($real_s_62, "2", ".", ",");
					$per_62 = ($real_s_62 != 0) ? ($real_s_62 / $rowpk->totbl_u) * 100 : 0;
					$persen_62 = number_format($per_62);
		
					//					$cRet	.= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
					//									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Pembiayaan Keluar</td>
					//									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_62</td>
					//									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_62</td>
					//									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_62$y1</td>
					//									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_62</td>
					//									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
					//									</tr>";
				}
				if ($cetak == 1)
				{
					$sqlpk = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
								(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
								(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
								(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
								ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,25)
								UNION ALL
								SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
								(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
								(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
								(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
								ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,26)
								UNION ALL
								SELECT SUBSTR(a.no_trdrka,12,28) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
								(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
								(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
								(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
								ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,28)
								UNION ALL
								SELECT SUBSTR(a.no_trdrka,12,30) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
								(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
								(SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
								(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'6' AS nu FROM trdrka a					
								WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,30),a.nm_rek5 ) a ORDER BY kd_rek,nu";
				}
				if ($cetak == 2)
				{
					$sqlpk = "SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
								(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
								(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='<strong>$date_awal</strong>' AND g.tgl_voucher<='$date_akhir' )AS debet,
								(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
								ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,25)
								UNION ALL
								SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
								(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='2012-10-01' AND d.tgl_sts<='$date_akhir' )AS cp,
								(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
								(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
								ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,26)
								UNION ALL
								SELECT SUBSTR(a.no_trdrka,12,28) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
								(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir' )AS cp,
								(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,5)= LEFT(a.kd_rek5,5) AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir')AS debet,
								(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,5)= LEFT(a.kd_rek5,5) AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir' )AS kredit,'5' AS nu FROM trdrka a INNER JOIN ms_rek4 b 
								ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,28)
								UNION ALL
								SELECT SUBSTR(a.no_trdrka,12,30) AS kd_rek,a.nm_rek5 ,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
								(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND c.kd_rek5= a.kd_rek5 AND d.kd_kegiatan = a.kd_kegiatan AND d.tgl_sts>='$date_awal' AND d.tgl_sts<='$date_akhir')AS cp,
								(SELECT SUM(e.debet) FROM trdju_pkd e INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND e.kd_rek5= a.kd_rek5 AND e.kd_kegiatan = a.kd_kegiatan AND g.tgl_voucher>='$date_awal' AND g.tgl_voucher<='$date_akhir' )AS debet,
								(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND f.kd_rek5= a.kd_rek5 AND f.kd_kegiatan = a.kd_kegiatan AND h.tgl_voucher>='$date_awal' AND h.tgl_voucher<='$date_akhir')AS kredit,'6' AS nu FROM trdrka a					
								WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,30),a.nm_rek5 ) a ORDER BY kd_rek,nu";
				}
				$sql62 = $this->db->query($sqlpk);
				foreach ($sql62->result() as $row_62)
				{
					$kd = $row_62->kd_rek;
					$nm = $row_62->nm_rek;
					$ang_622 = number_format($row_62->nilai_u, "2", ".", ",");
					$angaran_622 = $row_62->nilai_u;
					$in_622 = $row_62->cp;
					$debet_622 = $row_62->debet;
					$kredit_622 = $row_62->kredit;
					$real_622 = $debet_622 - ($in_622 + $kredit_622);
					$nreal_622 = number_format($real_622, "2", ".", ",");
					$real_s_622 = $real_622 - $angaran_622;
					if ($real_s_622 < 0)
					{
						$x1 = "(";
						$real_s_622 = $real_s_622 * -1;
						$y1 = ")";
					} else
					{
						$x1 = "";
						$y1 = "";
					}
					$selisih_622 = number_format($real_s_622, "2", ".", ",");
					$per_622 = ($real_s_611 != 0) ? ($real_s_622 / $row_62->nilai_u) * 100 : 0;
					$persen_622 = number_format($per_622);
		
					$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"15%\" align=\"left\">$kd</td>									
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"26%\">$nm</td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$ang_622</td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$nreal_622</td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$x1$selisih_622$y1</td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"3%\" align=\"right\">$persen_622</td>
											<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
											</tr>";
				}
				$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
											<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
											</tr>";
		
				$netto = $angaran_61 - $angaran_62;
				$net = number_format($netto, "2", ",", ".");
				$netto_r = $real_61 - $real_62;
				$net_r = number_format($netto_r, "2", ",", ".");
				$netto_s = $netto_r - $netto;
				if ($netto_s < 0)
				{
					$x1 = "(";
					$netto_s = $netto_s * -1;
					$y1 = ")";
				} else
				{
					$x1 = "";
					$y1 = "";
				}
				$netto_selisih = number_format($netto_s, "2", ",", ".");
				$perpnet = ($netto_s != 0) ? ($netto_s / $netto) * 100 : 0;
				$persennet = number_format($perpnet);
		
		
				$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Pembiayaan Netto</td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$net</td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$net_r</td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$netto_selisih$y1</td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persennet</td>
											<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
											</tr>";
		
				$silpa = ($angaranp + $angaran_61) - ($angaran_5 + $angaran_62);
				if ($silpa < 0)
				{
					$a = "(";
					$silpa = $silpa * -1;
					$b = ")";
				} else
				{
					$a = "";
					$b = "";
				}
				$silp = number_format($silpa, "2", ",", ".");
				$silpa_real = ($realp + $real_61) - ($real_5 + $real_62);
				if ($silpa_real < 0)
				{
					$c = "(";
					$silpa_real = $silpa_real * -1;
					$d = ")";
				} else
				{
					$c = "";
					$d = "";
				}
				$silp_real = number_format($silpa_real, "2", ",", ".");
				$silpa_s = $silpa_real - $silpa;
				if ($silpa_s < 0)
				{
					$x = "(";
					$silpa_s = $silpa_s * -1;
					$y = ")";
				} else
				{
					$x = "";
					$y = "";
				}
				$silpa_selisih = number_format($silpa_s, "2", ",", ".");
				$persil = ($silpa_s != 0) ? ($silpa_s / $silpa) * 100 : 0;
				$persensilpa = number_format($persil);
			
				$cRet	.= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
													<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">SILPA</td>
													<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$a$silp$b</td>
													<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$c$silp_real$d</td>
													<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x$silpa_selisih$y</td>
													<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persensilpa</td>
													<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
				
												</tr>";
		}else{
			$silpa = $angaranp  - $angaran_5 ;
		if ($silpa < 0)
		{
			$a = "(";
			$silpa = $silpa * -1;
			$b = ")";
		} else
		{
			$a = "";
			$b = "";
		}
		$silp = number_format($silpa, "2", ",", ".");
		$silpa_real = $realp  - $real_5;
		if ($silpa_real < 0)
		{
			$c = "(";
			$silpa_real = $silpa_real * -1;
			$d = ")";
		} else
		{
			$c = "";
			$d = "";
		}
		$silp_real = number_format($silpa_real, "2", ",", ".");
		$silpa_s = $silpa_real - $silpa;
		if ($silpa_s < 0)
		{
			$x = "(";
			$silpa_s = $silpa_s * -1;
			$y = ")";
		} else
		{
			$x = "";
			$y = "";
		}
		$silpa_selisih = number_format($silpa_s, "2", ",", ".");
		$persil = ($silpa_s != 0) ? ($silpa_s / $silpa) * 100 : 0;
		$persensilpa = number_format($persil);
	
		$cRet	.= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">SILPA</td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$a$silp$b</td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$c$silp_real$d</td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x$silpa_selisih$y</td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persensilpa</td>
											<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
		
										</tr>";
			
		}								
		$cRet .= " <table>";
		$data['prev'] = $cRet;
		echo ("$cRet");
		// $this->template->set('title', 'CETAK RINCIAN REALISASI');
		//		$this->tukd_model->_mpdf('',$cRet,10,10,10,1);


	}

	function lampiran_I()
	{
		$data['page_title'] = 'REALISASI';
		$this->template->set('title', 'REALISASI');
		$this->template->load('template', 'akuntansi/perda_real_1', $data);
	}
	function lampiran_I_smstr()
	{
		$data['page_title'] = 'REALISASI SEMESTER I';
		$this->template->set('title', 'SEMESTER I');
		$this->template->load('template', 'akuntansi/perda_real_smstr', $data);
	}

	function rpt_lra_pemda(){
		$periode	= $_REQUEST['periode'];
		$Periode	= $this->tukd_model->tanggal_format_indonesia($periode);
		$cetak		= $_REQUEST['cetak'];
		$ppkd		= 'PPKD';
		$kdskpd		= $_REQUEST['skpd'];
		$cek_sisa	= $_REQUEST['cek_sisa'];
		if($kdskpd){
			$nmskpd		= $this->tukd_model->get_nama($kdskpd,'nm_skpd','ms_skpd','kd_skpd');
			$entitas	= " and kd_skpd='$kdskpd' ";
		}else{
			$nmskpd		= " ";
			$entitas	= " ";
		}
		$thi		= $this->session->userdata('pcThang');
		$thl		= $thi-1;
		$kab_kota	= $this->akuntansi_model->get_sclient('kab_kota');

		/*$qry	= "	select '$periode' periode,'PPKD' kd_skpd,a.nm_skpd,kd_rek5,nm_rek5,
					sum(if(year(tgl_voucher)='$thi',(if(left(kd_rek5,1)in(1,5,6,9) or left(kd_rek5,2)in(72),debet-kredit,kredit-debet)),0))Nilai,
					sum(if(year(tgl_voucher)='$thl',(if(left(kd_rek5,1)in(1,5,6,9) or left(kd_rek5,2)in(72),debet-kredit,kredit-debet)),0))Lalu
					from trhju_ppkd a join trdju_ppkd b on a.kd_skpd=b.kd_skpd and left(kd_rek5,1) in(4,5,6,7)
					and a.no_voucher=b.no_voucher and a.tgl_voucher<='$periode'
					GROUP BY kd_rek5 
					union all
					select '$periode' periode,a.kd_skpd,a.nm_skpd,kd_rek5,nm_rek5,
					sum(if(year(tgl_voucher)='$thi',(if(left(kd_rek5,1)in(1,5,6,9) or left(kd_rek5,2)in(72),debet-kredit,kredit-debet)),0))Nilai,
					sum(if(year(tgl_voucher)='$thl',(if(left(kd_rek5,1)in(1,5,6,9) or left(kd_rek5,2)in(72),debet-kredit,kredit-debet)),0))Lalu
					from trhju_pkd a join trdju_pkd b on a.kd_skpd=b.kd_skpd and left(kd_rek5,1) in(4,5,6,7)
					and a.no_voucher=b.no_voucher and a.tgl_voucher<='$periode'
					GROUP BY kd_rek5 ";*/
		$qry	= "	select '$periode' periode,a.kd_skpd,a.nm_skpd,kd_rek5,nm_rek5,
					sum(if(year(tgl_voucher)='$thi',(if(left(kd_rek5,1)in(1,5,6,9) or left(kd_rek5,2)in(72),debet-kredit,kredit-debet)),0))Nilai,
					sum(if(year(tgl_voucher)='$thl',(if(left(kd_rek5,1)in(1,5,6,9) or left(kd_rek5,2)in(72),debet-kredit,kredit-debet)),0))Lalu
					from trhju_pkd a join trdju_pkd b on a.kd_skpd=b.kd_skpd and left(kd_rek5,1) in(4,5,6,7)
					and a.no_voucher=b.no_voucher and a.tgl_voucher<='$periode'
					GROUP BY kd_rek5 ";

			$this->db->query("DROP TABLE IF EXISTS realisasi_akt");
			$this->db->query("DROP TABLE IF EXISTS the_real_akt");
			$this->db->query("DROP TABLE IF EXISTS the_real_ang");
			
			$sql	= "	CREATE TEMPORARY TABLE realisasi_akt (
						`periode`  varchar(255) ,
						`kd_skpd`  varchar(255) ,
						`nm_skpd`  varchar(255) ,
						`kd_rek5`  varchar(255) ,
						`nm_rek5`  varchar(255) ,
						`nilai`  decimal(20,2) NULL DEFAULT NULL ,
						`lalu`  decimal(20,2) NULL DEFAULT NULL ,
						INDEX `id_akt` (`periode`, `kd_skpd`, `kd_rek5`) USING BTREE 
						) ENGINE=InnoDB DEFAULT CHARACTER SET=latin1 COLLATE=latin1_swedish_ci ROW_FORMAT=COMPACT";
			$del_exec	= $this->db->query($sql);
			if($del_exec){
				$ins_exec	= $this->db->query("insert into realisasi_akt (periode,kd_skpd,nm_skpd,kd_rek5,nm_rek5,nilai,lalu) ".$qry);
				
				$a0	= $this->db->query("CREATE TEMPORARY TABLE the_real_akt (kode varchar(10),Rupiah decimal(20,2),Lalu decimal(20,2) )");
				if($a0){
					$a1	= $this->db->query("insert into the_real_akt select left(kd_rek5,1),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt GROUP BY left(kd_rek5,1)");
				}
				if($a1){
					$a2	= $this->db->query("insert into the_real_akt select left(kd_rek5,2),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt GROUP BY left(kd_rek5,2)");
				}
				if($a2){
					$a3	= $this->db->query("insert into the_real_akt select left(kd_rek5,3),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt GROUP BY left(kd_rek5,3)");
				}
				if($a3){
					$a4	= $this->db->query("insert into the_real_akt select left(kd_rek5,5),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt GROUP BY left(kd_rek5,5)");
				}
				if($a4){
					$a5	= $this->db->query("insert into the_real_akt select left(kd_rek5,8),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt GROUP BY left(kd_rek5,8)");
				}

				$Q_ang	= $this->db->query("CREATE TEMPORARY TABLE the_real_ang (kode varchar(10),anggaran decimal(20,2))");
				if($Q_ang){
					$the_SKPD	= $kdskpd	? "kd_skpd='$kdskpd'"	: true;
					$sql = " insert into the_real_ang
								select left(kd_rek64,8)kode,sum(nilai_ubah)anggaran from trdrka a join ms_rek5 b on $the_SKPD and a.kd_rek5=b.kd_rek5 group by left(kd_rek64,8) union 
								select left(kd_rek64,5)kode,sum(nilai_ubah)anggaran from trdrka a join ms_rek5 b on $the_SKPD and a.kd_rek5=b.kd_rek5 group by left(kd_rek64,5) union 
								select left(kd_rek64,3)kode,sum(nilai_ubah)anggaran from trdrka a join ms_rek5 b on $the_SKPD and a.kd_rek5=b.kd_rek5 group by left(kd_rek64,3) union 
								select left(kd_rek64,2)kode,sum(nilai_ubah)anggaran from trdrka a join ms_rek5 b on $the_SKPD and a.kd_rek5=b.kd_rek5 group by left(kd_rek64,2) union 
								select left(kd_rek64,1)kode,sum(nilai_ubah)anggaran from trdrka a join ms_rek5 b on $the_SKPD and a.kd_rek5=b.kd_rek5 group by left(kd_rek64,1)
							";
					$this->db->query($sql);
				}
			}

		$cRet ='<TABLE width="100%">
				<tr>
					<td colspan="3" align="center" style="font-size:12px"><b>'.$kab_kota.'</b></TD>
				</tr>
				<tr>
					<td colspan="3" align="center" style="font-size:15px"><b>LAPORAN REALISASI ANGGARAN</b></TD>
				</tr>
				<tr>
					<td colspan="3" align="center" style="font-size:12px"><b>Untuk Tahun Yang Berakhir Sampai Dengan '.$Periode.' dan '.$thl.'<b></TD>
				</tr>
				<br><br>';
				
		if($kdskpd){
			$cRet .= "	<tr>
							<td width='50px'><b>SKPD</b></TD>
							<td width='5px'><b>:</b></TD>
							<td><b>".strtoupper($nmskpd)."</b></TD>
						</tr>";
		}
		
		$cRet	.=	"</TABLE>";

		$cRet .= '<table style="border-collapse:collapse;font-size:12px" width="100%" align="center" border="1" cellspacing="1" cellpadding="0">
					<thead>
					<tr>
						<td align="center" width="5%" bgcolor="#cccccc" ><b>No.</b></TD>
						<td align="center" width="50%" bgcolor="#cccccc"><b>URAIAN</b></TD>
						<td align="center" width="15%" bgcolor="#cccccc"><b>Anggaran<br>'.$thi.'</b></TD>
						<td align="center" width="12%" bgcolor="#cccccc"><b>Realisasi<br>'.$thi.'</b></TD>
						<td align="center" width="5%" bgcolor="#cccccc"><b>%</b></TD>';
							if($cek_sisa=='1'){
								$cRet .= '<td align="center" width="15%" bgcolor="#cccccc"><b>Sisa<br>Anggaran</b></TD>';
							}
						$cRet	.= '<td align="center" width="15%" bgcolor="#cccccc"><b>Realisasi<br>'.$thl.'</b></TD>
					</tr>
					</thead>';

		$pmb_qry	= $this->db->query("select 
						sum(if(left(kd_rek5,2)=71,nilai,0))tp_ini,
						sum(if(left(kd_rek5,2)=71,lalu,0))tp_lalu,
						sum(if(left(kd_rek5,2)=72,nilai,0))kp_ini,
						sum(if(left(kd_rek5,2)=72,lalu,0))kp_lalu
						from realisasi_akt where periode='$periode' $entitas ");
		// Total Penerimaan Pembiayaan Tahun Ini
		$tot_tp_ini		= $pmb_qry->row('tp_ini');
		// Total Penerimaan Pembiayaan Tahun Lalu
		$tot_tp_lalu	= $pmb_qry->row('tp_lalu');
		// Total Pengeluaran Pembiayaan Tahun Ini
		$tot_kp_ini		= $pmb_qry->row('kp_ini');
		// Total Pengeluaran Pembiayaan Tahun Lalu
		$tot_kp_lalu	= $pmb_qry->row('kp_lalu');
		//Pembiayaan Netto Tahun Ini
		$tot_pmb_ini	= $tot_tp_ini-$tot_kp_ini;
		//Pembiayaan Netto Tahun Lalu
		$tot_pmb_lalu	= $tot_tp_lalu-$tot_kp_lalu;

		$csql	= " select nor,kode_1,uraian,bold,thn_m1 from map_lra_kab ";
		$query = $this->db->query($csql);  
		
		$anggaran	= 0;
		$rupiah		= 0;
		$lalu		= 0;
		$persen		= 0;
		$join_rek	= " if(left(a.kd_rek5,1)in (4,5),a.kd_rek5,concat(a.kd_rek5,'p'))=b.kd_rek5 ";
		foreach ( $query->result() as $res){
			$nor		= $res->nor;
			$kodenya	= $res->kode_1;
			$uraian		= $res->uraian;
			$bold		= $res->bold;
			$lalu		= $res->thn_m1;

			if($kodenya){
				$csqlr	= " select kode,sum(Rupiah)Rupiah,sum(Lalu)Lalu from the_real_akt where kode in ($kodenya) ";

				$queryr = $this->db->query($csqlr);
				foreach ($queryr->result() as $resr){
					$rupiah		= $resr->Rupiah;
					//$lalu		= $resr->Lalu;
				}
				
				$qryang	= $this->db->query("select sum(anggaran)anggaran from the_real_ang a where kode in ($kodenya) ");
				$anggaran	= $qryang->row('anggaran');
			}else{
				$anggaran	= 0;
				$rupiah		= 0;
				//$lalu		= 0;
			}

			/*	Menghitung Persen	0 tidak dapat dibagi*/

			
			
			/* Menghitung Nilai real Surplus Defisit dan Pembiayaan (b_n_t = Beban dan Transfer )*/
			if($nor=='33'){
				$pend_ang	= $anggaran;
				$pend_ini	= $rupiah;
				$pend_lalu	= $lalu;
				$anggaran	= $pend_ang;
				$rupiah		= $pend_ini;
				$lalu		= $pend_lalu;
			}elseif($nor=='71'){
				$b_n_t_ang	= $anggaran;
				$b_n_t_ini	= $rupiah;
				$b_n_t_lalu	= $lalu;
				$anggaran	= $b_n_t_ang;
				$rupiah		= $b_n_t_ini;
				$lalu		= $b_n_t_lalu;
			}elseif($nor=='73'){
				$sd_ang		= $pend_ang-$b_n_t_ang;
				$sd_ini		= $pend_ini-$b_n_t_ini;
				$sd_lalu	= $pend_lalu-$b_n_t_lalu;
				$anggaran	= $sd_ang;
				$rupiah		= $sd_ini;
				$lalu		= $sd_lalu;
			}elseif($nor=='90'){
				$tpmb_ang	= $anggaran;	// Total Anggaran Penerimaan Pembiayaan 
				$anggaran	= $tpmb_ang;
				$rupiah		= $tot_tp_ini;
				//$lalu		= $tot_tp_lalu;
				$lalu		= $lalu;
			}elseif($nor=='104'){
				$kpmb_ang	= $anggaran;	// Total Anggaran Pengeluaran Pembiayaan
				$anggaran	= $kpmb_ang;
				$rupiah		= $tot_kp_ini;
				//$lalu		= $tot_kp_lalu;
				$lalu		= $lalu;
			}elseif($nor=='105'){
				$net_pmb_ang= $tpmb_ang-$kpmb_ang;
				$anggaran	= $net_pmb_ang;
				$rupiah		= $tot_pmb_ini;
				//$lalu		= $tot_pmb_lalu;
				$lalu		= $lalu;
			}elseif($nor=='107'){
				$anggaran	= $sd_ang+$net_pmb_ang;
				$rupiah		= $sd_ini+$tot_pmb_ini;
				//$lalu		= $sd_lalu+$tot_pmb_lalu;
				$lalu		= $lalu;
			}else{
				$anggaran	= $anggaran;
				$rupiah		= $rupiah;
				$lalu		= $lalu;
			}

			/*if($anggaran!=0){
				$persen	= number_format(($rupiah*100/$anggaran), "2", ".", ",");
			}else{
				$persen	= '';
			}*/

			if($anggaran!=0){
				$persen	= number_format(($rupiah*100/$anggaran), "2", ".", ",");
			}else{
				$persen	= '';
			}

			$sisa_ang	= number_format(($anggaran-$rupiah),"2",".",",");
			$anggaran	= number_format($anggaran,"2",".",",");
			$rupiah		= number_format($rupiah,"2",".",",");
			$lalu		= number_format($lalu,"2",".",",");

			switch ($bold){
				case 6:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\"><b>$anggaran&nbsp;</b></TD>
							<td align=\"right\"><b>$rupiah&nbsp;</b></TD>
							<td align=\"right\"><b>&nbsp;$persen</b></TD>
								";
								if($cek_sisa=='1'){
									$cRet	.= "<td align=\"right\"><b>$sisa_ang&nbsp;</b></TD>";
								}
				$cRet .="	<td align=\"right\"><b>$lalu&nbsp;</b></TD>
						</tr>";
				break;
				case 5:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;$uraian</b></TD>
							<td align=\"right\"><b>&nbsp;</b></TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\"><b>&nbsp;</b></TD>
								";
								if($cek_sisa=='1'){
									$cRet	.= "<td align=\"right\">&nbsp;</TD>";
								}
								$cRet .="
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
				case 4:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\"><b>&nbsp;</b></TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\"><b>&nbsp;</b></TD>
								";
								if($cek_sisa=='1'){
									$cRet	.= "<td align=\"right\">&nbsp;</TD>";
								}
								$cRet .="
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
				case 3:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\"><b>$anggaran&nbsp;</b></TD>
							<td align=\"right\"><b>$rupiah&nbsp;</b></TD>
							<td align=\"right\"><b>&nbsp;$persen</b></TD>
								";
								if($cek_sisa=='1'){
									$cRet	.= "<td align=\"right\"><b>$sisa_ang&nbsp;</b></TD>";
								}
								$cRet .="
							<td align=\"right\"><b>$lalu&nbsp;</b></TD>
						</tr>";
				break;
				case 2:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</TD>
							<td align=\"right\">$anggaran&nbsp;</TD>
							<td align=\"right\">$rupiah&nbsp;</TD>
							<td align=\"right\">&nbsp;$persen</TD>
								";
								if($cek_sisa=='1'){
									$cRet	.= "<td align=\"right\">$sisa_ang&nbsp;</TD>";
								}
								$cRet .="
							<td align=\"right\">$lalu&nbsp;</TD>
						</tr>";
				break;
				case 1:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</TD>
							<td align=\"right\">$anggaran&nbsp;</TD>
							<td align=\"right\">$rupiah&nbsp;</TD>
							<td align=\"right\">&nbsp;$persen</TD>
								";
								if($cek_sisa=='1'){
									$cRet	.= "<td align=\"right\">$sisa_ang&nbsp;</TD>";
								}
								$cRet .="
							<td align=\"right\">$lalu&nbsp;</TD>
						</tr>";
				break;
				default:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
								";
								if($cek_sisa=='1'){
									$cRet	.= "<td align=\"right\">&nbsp;</TD>";
								}
								$cRet .="
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
			}
		}
		
		$cRet .= '</table>';
		$data['prev'] = $cRet;
		$judul	= " L R A ";
		switch ($cetak){
			case 0;
				echo $cRet;
				echo "<title>$judul</title>";
				break;
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");

				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}
	}

	function rpt_lo_pemda(){
		$periode	= $_REQUEST['periode'];
		$Periode	= $this->tukd_model->tanggal_format_indonesia($periode);
		$cetak		= $_REQUEST['cetak'];
		$ppkd		= 'PPKD';
		$kdskpd		= $_REQUEST['skpd'];
		if($kdskpd){
			$nmskpd		= $this->tukd_model->get_nama($kdskpd,'nm_skpd','ms_skpd','kd_skpd');
			$entitas	= " and kd_skpd='$kdskpd' ";
		}else{
			$nmskpd		= " ";
			$entitas	= " ";
		}
		$thi		= $this->session->userdata('pcThang');
		$thl		= $thi-1;
		$kab_kota	= $this->akuntansi_model->get_sclient('kab_kota');

		$this->db->query("DROP TABLE IF EXISTS realisasi_akt");
		$this->db->query("DROP TABLE IF EXISTS the_real_akt");
			$sql	= "	CREATE TEMPORARY TABLE realisasi_akt (
						`periode`  varchar(255) ,
						`kd_skpd`  varchar(255) ,
						`nm_skpd`  varchar(255) ,
						`kd_rek5`  varchar(255) ,
						`nm_rek5`  varchar(255) ,
						`nilai`  decimal(20,2) NULL DEFAULT NULL ,
						`lalu`  decimal(20,2) NULL DEFAULT NULL ,
						INDEX `id_akt` (`periode`, `kd_skpd`, `kd_rek5`) USING BTREE 
						) ENGINE=InnoDB DEFAULT CHARACTER SET=latin1 COLLATE=latin1_swedish_ci ROW_FORMAT=COMPACT";
			$del_exec	= $this->db->query($sql);
			if($del_exec){
				$qry	= "	select '$periode','PPKD',a.nm_skpd,kd_rek5,nm_rek5,
							sum(if(year(tgl_voucher)='$thi',(if(left(kd_rek5,1)in(1,5,6,9) or left(kd_rek5,2)in(72),debet-kredit,kredit-debet)),0))Nilai,
							sum(if(year(tgl_voucher)='$thl',(if(left(kd_rek5,1)in(1,5,6,9) or left(kd_rek5,2)in(72),debet-kredit,kredit-debet)),0))Lalu
							from trhju_ppkd a join trdju_ppkd b on a.kd_skpd=b.kd_skpd and left(kd_rek5,1) in(8,9)
							and a.no_voucher=b.no_voucher and a.tgl_voucher<='$periode'
							GROUP BY kd_rek5
							union all
							select '$periode',a.kd_skpd,a.nm_skpd,kd_rek5,nm_rek5,
							sum(if(year(tgl_voucher)='$thi',(if(left(kd_rek5,1)in(1,5,6,9) or left(kd_rek5,2)in(72),debet-kredit,kredit-debet)),0))Nilai,
							sum(if(year(tgl_voucher)='$thl',(if(left(kd_rek5,1)in(1,5,6,9) or left(kd_rek5,2)in(72),debet-kredit,kredit-debet)),0))Lalu
							from trhju_pkd a join trdju_pkd b on a.kd_skpd=b.kd_skpd and left(kd_rek5,1) in(8,9)
							and a.no_voucher=b.no_voucher and a.tgl_voucher<='$periode'
							GROUP BY kd_rek5 ";
				$ins_exec	= $this->db->query("insert into realisasi_akt (periode,kd_skpd,nm_skpd,kd_rek5,nm_rek5,nilai,lalu) ".$qry);
				
				$a0	= $this->db->query("CREATE TEMPORARY TABLE the_real_akt (kode varchar(10),Rupiah decimal(20,2),Lalu decimal(20,2) )");
				if($a0){
					$a1	= $this->db->query("insert into the_real_akt select left(kd_rek5,1),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
				if($a1){
					$a2	= $this->db->query("insert into the_real_akt select left(kd_rek5,2),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
				if($a2){
					$a3	= $this->db->query("insert into the_real_akt select left(kd_rek5,3),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
				if($a3){
					$a4	= $this->db->query("insert into the_real_akt select left(kd_rek5,5),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
				if($a4){
					$a5	= $this->db->query("insert into the_real_akt select left(kd_rek5,8),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
			}

		$cRet ='<TABLE width="100%">
				<tr>
					<td colspan="3" align="center" style="font-size:12px"><b>'.$kab_kota.'</b></TD>
				</tr>
				<tr>
					<td colspan="3" align="center" style="font-size:15px"><b>LAPORAN OPERASIONAL</b></TD>
				</tr>
				<tr>
					<td colspan="3" align="center" style="font-size:12px"><b>Untuk Tahun Yang Berakhir Sampai Dengan '.$Periode.' dan '.$thl.'<b></TD>
				</tr>
				<br><br>';
				
		if($kdskpd){
			$cRet .= "	<tr>
							<td width='50px'><b>SKPD</b></TD>
							<td width='5px'><b>:</b></TD>
							<td><b>$nmskpd</b></TD>
						</tr>";
		}
		
		$cRet	.=	"</TABLE>";

		$cRet .= '<table style="border-collapse:collapse;font-size:12px" width="100%" align="center" border="1" cellspacing="1" cellpadding="0">
					<thead>
					<tr>
						<td align="center" width="5%" bgcolor="#cccccc" ><b>No.</b></TD>
						<td align="center" width="50%" bgcolor="#cccccc"><b>URAIAN</b></TD>
						<td align="center" width="15%" bgcolor="#cccccc"><b>Realisasi<br>'.$thi.'</b></TD>
						<td align="center" width="5%" bgcolor="#cccccc"><b>%</b></TD>
						<td align="center" width="15%" bgcolor="#cccccc"><b>Realisasi<br>'.$thl.'</b></TD>
					</tr>
					</thead>';

		$pmb_qry	= $this->db->query("select 
						sum(if(left(kd_rek5,2)=71,nilai,0))tp_ini,
						sum(if(left(kd_rek5,2)=71,nilai,0))tp_lalu,
						sum(if(left(kd_rek5,2)=72,nilai,0))kp_ini,
						sum(if(left(kd_rek5,2)=72,nilai,0))kp_lalu
						from realisasi_akt where periode='$periode' $entitas ");
		// Total Penerimaan Pembiayaan Tahun Ini
		$tot_tp_ini		= $pmb_qry->row('tp_ini');
		// Total Penerimaan Pembiayaan Tahun Lalu
		$tot_tp_lalu	= $pmb_qry->row('tp_lalu');
		// Total Pengeluaran Pembiayaan Tahun Ini
		$tot_kp_ini		= $pmb_qry->row('kp_ini');
		// Total Pengeluaran Pembiayaan Tahun Lalu
		$tot_kp_lalu	= $pmb_qry->row('kp_lalu');
		//Pembiayaan Netto Tahun Ini
		$tot_pmb_ini	= $tot_tp_ini-$tot_kp_ini;
		//Pembiayaan Netto Tahun Lalu
		$tot_pmb_lalu	= $tot_tp_lalu-$tot_kp_lalu;

		$csql	= " select nor,kode_1,uraian,bold from map_lo_kab ";
		$query = $this->db->query($csql);  
		
		$anggaran	= 0;
		$rupiah		= 0;
		$lalu		= 0;
		$persen		= 0;
		foreach ( $query->result() as $res){
			$nor		= $res->nor;
			$kodenya	= $res->kode_1;
			$uraian		= $res->uraian;
			$bold		= $res->bold;

			if($kodenya){
				$csqlr	= " select kode,sum(Rupiah)Rupiah,sum(Lalu)Lalu from the_real_akt where kode in ($kodenya)  ";

				$queryr = $this->db->query($csqlr);
				foreach ($queryr->result() as $resr){
					$rupiah		= $resr->Rupiah;
					$lalu		= $resr->Lalu;
				}
			}else{
				$rupiah		= 0;
				$lalu		= 0;
			}

			/* Menghitung Nilai Surplus Defisit	(nsd) a=anggaran, s=sekarang, l=lalu */
			if($nor=='32'){
				$tot_pnd_ini			= $rupiah;
				$tot_pnd_lalu			= $lalu;
				$rupiah					= number_format(($tot_pnd_ini),"2",".",",");
				$lalu					= number_format(($tot_pnd_lalu),"2",".",",");
			}elseif($nor=='53'){
				$jumlah_beban_ini		= $rupiah;
				$jumlah_beban_lalu		= $lalu;
				$rupiah					= number_format(($jumlah_beban_ini),"2",".",",");
				$lalu					= number_format(($jumlah_beban_lalu),"2",".",",");				
				// Surplus Defisit Operasi
			}elseif($nor=='55'){
				$sd_operasi_ini			= $tot_pnd_ini-$jumlah_beban_ini;
				$sd_operasi_lalu		= $tot_pnd_lalu-$jumlah_beban_lalu;
				$rupiah					= number_format(($sd_operasi_ini),"2",".",",");
				$lalu					= number_format(($sd_operasi_lalu),"2",".",",");
			}elseif($nor=='62'){
				$surplus_non_op_ini		= $rupiah;
				$surplus_non_op_lalu	= $lalu;
				$rupiah					= number_format(($surplus_non_op_ini),"2",".",",");
				$lalu					= number_format(($surplus_non_op_lalu),"2",".",",");
			}elseif($nor=='68'){
				$defisit_non_op_ini		= $rupiah;
				$defisit_non_op_lalu	= $lalu;
				$rupiah					= number_format(($defisit_non_op_ini),"2",".",",");
				$lalu					= number_format(($defisit_non_op_lalu),"2",".",",");
			}elseif($nor=='69'){
				$sd_non_operasi_ini		= $surplus_non_op_ini-$defisit_non_op_ini;
				$sd_non_operasi_lalu	= $surplus_non_op_lalu-$defisit_non_op_lalu;
				$rupiah					= number_format(($sd_non_operasi_ini),"2",".",",");
				$lalu					= number_format(($sd_non_operasi_lalu),"2",".",",");
			}elseif($nor=='71'){
				$sd_sblm_pos_lb_ini		= $sd_operasi_ini+$sd_non_operasi_ini;
				$sd_sblm_pos_lb_lalu	= $sd_operasi_lalu+$sd_non_operasi_lalu;
				$rupiah					= number_format(($sd_sblm_pos_lb_ini),"2",".",",");
				$lalu					= number_format(($sd_sblm_pos_lb_lalu),"2",".",",");

				//PENDAPATAN LUAR BIASA
			}elseif($nor=='76'){
				$pend_lb_ini			= $rupiah;
				$pend_lb_lalu			= $lalu;
				$rupiah					= number_format(($pend_lb_ini),"2",".",",");
				$lalu					= number_format(($pend_lb_lalu),"2",".",",");
				//BEBAN LUAR BIASA
			}elseif($nor=='80'){
				$beban_lb_ini			= $rupiah;
				$beban_lb_lalu			= $lalu;
				$rupiah					= number_format(($beban_lb_ini),"2",".",",");
				$lalu					= number_format(($beban_lb_lalu),"2",".",",");
			}elseif($nor=='81'){
				$sd_pos_lb_ini			= $pend_lb_ini-$beban_lb_ini;
				$sd_pos_lb_lalu			= $pend_lb_lalu-$beban_lb_lalu;
				$rupiah					= number_format(($sd_pos_lb_ini),"2",".",",");
				$lalu					= number_format(($sd_pos_lb_lalu),"2",".",",");
			}elseif($nor=='83'){
				$tot_sd_ini				= $sd_sblm_pos_lb_ini+$sd_pos_lb_ini;
				$tot_sd_lalu			= $sd_sblm_pos_lb_lalu+$sd_pos_lb_lalu;
				$rupiah					= number_format(($tot_sd_ini),"2",".",",");
				$lalu					= number_format(($tot_sd_lalu),"2",".",",");
			}else{
				$rupiah					= number_format(($rupiah),"2",".",",");
				$lalu					= number_format(($lalu),"2",".",",");
			}

			
			switch ($bold){
				case 6:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\"><b>$rupiah&nbsp;</b></TD>
							<td align=\"right\"><b>&nbsp;$persen</b></TD>
							<td align=\"right\"><b>$lalu&nbsp;</b></TD>
						</tr>";
				break;
				case 5:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;$uraian</b></TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\"><b>&nbsp;</b></TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
				case 4:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\"><b>&nbsp;</b></TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
				case 3:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\"><b>$rupiah&nbsp;</b></TD>
							<td align=\"right\"><b>&nbsp;$persen</b></TD>
							<td align=\"right\"><b>$lalu&nbsp;</b></TD>
						</tr>";
				break;
				case 2:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</TD>
							<td align=\"right\">$rupiah&nbsp;</TD>
							<td align=\"right\">&nbsp;$persen</TD>
							<td align=\"right\">$lalu&nbsp;</TD>
						</tr>";
				break;
				case 1:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</TD>
							<td align=\"right\">$rupiah&nbsp;</TD>
							<td align=\"right\">&nbsp;$persen</TD>
							<td align=\"right\">$lalu&nbsp;</TD>
						</tr>";
				break;
				default:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
			}
		}

		$cRet .= '</table>';
		$data['prev'] = $cRet;
		$judul	= " LAPORAN OPERASIONAL ";
		switch ($cetak){
			case 0;
				echo $cRet;
				echo "<title>$judul</title>";
				break;
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");

				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}
	}
	
 

//firman tambah keseluruhan

function cetak_perda_real1(){
        $thn_ang	   = $this->session->userdata('pcThang');
        //$skpd = $lcskpd;
        //$nama=  $this->tukd_model->get_nama($lcskpd,'nm_skpd','ms_skpd','kd_skpd');
        //$bulan= $this->tukd_model->getBulan($nbulan); 
        $cRet = '';
        $cRet = "
		<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">
					<tr>
						<td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
						<td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"15%\"><h6>LAMPIRAN I  :</h6></td>
						<td colspan=\"2\" align=\"left\" width=\"40%\"><h6>PERATURAN DAERAH</h6></td>
					</tr>
					<tr> 
						<td align=\"left\" width=\"10%\"><h6>NOMOR</h6></td><td width=\"20%\" align=\"left\" ><h5>:</h5></td>
					</tr>
					<tr>
						<td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h6>TANGGAL</h6></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>:</h5></td>
					</tr>	
        </table>'
		<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"1\" cellpadding=\"1\">
				<tr>
                    <td align=\"center\" style=\"font-size:14px;\" colspan=\"3\"><b>
                      <strong>PEMERINTAH KABUPATEN MAMBERAMO TENGAH</strong><BR>
                      <strong>LAPORAN REALISASI ANGGARAN</strong><br>
					  <strong>TAHUN ANGGARAN $thn_ang</b></strong><br>&nbsp;
                    </td>
                </tr>";
				
        $cRet .='</table>';          
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"3\">
                <thead>
                <tr>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" rowspan=\"2\" style=\"font-size:14px\"><strong>NO<br>URUT</strong></td>
                    <td bgcolor=\"#CCCCCC\"  width=\"15%\" align=\"center\" rowspan=\"2\" style=\"font-size:14px\"><strong>URAIAN</strong></td>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" colspan=\"2\" style=\"font-size:14px\"><strong>JUMLAH (Rp)</strong></td>
					<td bgcolor=\"#CCCCCC\"  align=\"center\" rowspan=\"2\" style=\"font-size:14px\"><strong>LEBIH<br>(KURANG)</strong></td> 
                    <td bgcolor=\"#CCCCCC\"  width=\"5%\" align=\"center\" rowspan=\"2\" style=\"font-size:14px\"><strong>%</strong></td>
                </tr> 
				<tr>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><strong>ANGGARAN<BR>PERUBAHAN</strong></td>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><strong>REALISASI</strong></td>
				</tr>
				<tr>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><b>1</b></td>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><b>2</b></td>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><b>3</b></td>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><b>4</b></td>
				    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><b>5 = 3-4</b></td>
                    <td bgcolor=\"#CCCCCC\"  width=\"5%\" align=\"center\" style=\"font-size:14px\"><b>6</b></td>
				</tr>
                </thead>"; 
				
        $sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                 {
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                 }
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kode='KD' and kd_skpd='1.20.02.00'";
                 $sqlttd=$this->db->query($sqlttd1);
				 $kos=0;
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip=$rowttd->nip;                    
                    $nama= $rowttd->nm;
                    $jabatan  = $rowttd->jab;
					$kos++;
                }
				if($kos==0){
					$nip='Belum ada nip';
					$nama='Belum ada nama';
					$jabatan='Belum ada jabatan';
				}
				
//REK PENDAPATAN  
        /*                 
			$sql1="	
			        SELECT LEFT(a.kd_rek5,1) AS Kode,b.`lra` AS Rekening,b.nm_rek1 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd WHERE  LEFT(kd_rek5,1)=4 AND no_sts IN (SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0)AS Realisasi,
				    IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd  WHERE LEFT(kd_rek5,1)=4 AND no_sts IN(SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0) AS cp,
					IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,1)=4 AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,1)=4 AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)
					AS debet,
				    IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,1)=4 AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
				    IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,1)=4 AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=4
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS Kode,b.`lra` AS Rekening,b.nm_rek2 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd WHERE  LEFT(kd_rek5,2)=b.kd_rek2 AND no_sts IN (SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0)AS Realisasi,
				    IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd  WHERE LEFT(kd_rek5,2)=b.kd_rek2  AND no_sts IN(SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0) AS cp,
					IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS debet,
					IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=4
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS Kode,b.`lra` AS Rekening,b.nm_rek3 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd WHERE  LEFT(kd_rek5,3)=b.kd_rek3  AND no_sts IN (SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0)AS Realisasi,
				    IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd  WHERE LEFT(kd_rek5,3)=b.kd_rek3  AND no_sts IN(SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0) AS cp,
					IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,3)=b.`kd_rek3`  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,3)=b.`kd_rek3`  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS debet,
					IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,3)=b.kd_rek3  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,3)=b.kd_rek3  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=4
					GROUP BY b.`lra`					
					ORDER BY Kode,nu
					";
	*/
			$sql1=		
			      "
			        SELECT LEFT(a.kd_rek5,1) AS Kode,b.`lra` AS Rekening,b.nm_rek1 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=4),0)
					AS debet,'0' AS kredit,'' as cp,'0' AS Realisasi,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=4
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS Kode,b.`lra` AS Rekening,b.nm_rek2 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=4 AND LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS debet,'0' AS kredit,'' as cp,
					'0' AS Realisasi
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=4
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS Kode,b.`lra` AS Rekening,b.nm_rek3 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=4 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'0' AS kredit,'' as cp
					,'0' AS Realisasi,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=4
					GROUP BY b.`lra`					
					ORDER BY Kode,nu
				  ";
					
			    $query = $this->db->query($sql1);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query->result() as $row)
                {
                    $coba1=$row->Rekening;
                    $coba2=$row->Belanja;
                    $coba3= number_format($row->Anggaran,"2",".",",");
					$anggaran =$row->Anggaran;
                    $coba4= number_format($row->Realisasi,"2",".",",");
					$pen = number_format($row->cp,"2",".",",");
					$pen4 =$row->cp;
					$debet = number_format($row->debet,"2",".",",");
					$debetp = $row->debet;
					$kredit = number_format($row->kredit,"2",".",",");
					$kreditp = $row->kredit;
                    $coba5= $row->Anggaran - $row->Realisasi;
					$penp = $row->cp;
					$realp = $debetp;
					//$realp = $anggaran - $pen4;
					$nrealp = number_format($realp,"2", ".", ",");
					$real_sp = $realp - $anggaran;
/*					
                    if ($coba5 < 0){
                    	$x1="(";
                    	$coba5=$coba5*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba5,"2",".",",");  
                    $per1   = ($coba5!=0)?($coba5 / $row->Anggaran ) * 100:0; 
                    $persen1= number_format($per1,"2",".",","); 
*/					
					if ($real_sp < 0)
					{
						$x1 = "(";
						$real_sp = $real_sp * -1;
						$y1 = ")";
					} else
					{
						$x1 = "";
						$y1 = "";
					}
					$pend_selisihp = number_format($real_sp, "2", ".", ",");
					$per1p = ($real_sp != 0) ? ($real_sp / $row->Anggaran) * 100 : 0;
					$persen1p = number_format($per1p, "2", ".", ",");
							
                    if(strlen($coba1)<=3){
                        $coba1= strtoupper($coba1);
                        $coba2= strtoupper($coba2);
                        $cRet .= "<tr>
						            <td width=\"10%\" align=\"center\">&nbsp;</td>                            
                                    <td width=\"40%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"5%\">&nbsp;</td>
								  </tr>";
									
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\"><b>$coba1</b></td>                                     
                                 <td width=\"40%\"><b>$coba2</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$coba3</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$nrealp</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$x1$pend_selisihp$y1</b></td>
                                 <td width=\"5%\" align=\"right\"><b>$persen1p</b></td></tr>";
                    }else{
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\">$coba1</td>                                     
                                 <td width=\"40%\">$coba2</td>
                                 <td width=\"15%\" align=\"right\">$coba3</td>
                                 <td width=\"15%\" align=\"right\">$nrealp</td>
                                 <td width=\"15%\" align=\"right\">$pend_selisihp</td>
                                 <td width=\"5%\" align=\"right\">$persen1p</td></tr>";
                    }
                    
                }
		/*		
                $sqltp="
				       SELECT SUM(nilai_ubah) AS totp,
				        IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd  WHERE LEFT(kd_rek5,1)=4 AND no_sts IN(SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0) AS cp,
						IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,1)=4 AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
						IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,1)=4 AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0) as kredit,
						IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,1)=4 AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
						IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,1)=4 AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0) as debet
						FROM trdrka WHERE LEFT(kd_rek5,1)='4'";
				*/
		$sqltp=		
                 "
			        SELECT IFNULL(SUM(a.nilai_ubah),0) AS totp,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=4),0)
					AS debet,'0' AS kredit,'' as cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=4
					";				
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                   $coba6=number_format($rowp->totp,"2",".",",");
				   $cob6 = $rowp->totp;
                   $coba7=number_format($rowp->debet,"2",".",",");
				   $cob7 = $rowp->debet;
                   $kredit=number_format($rowp->kredit,"2",".",",");
				   $kredit2 = $rowp->kredit;
				   $pend = $rowp->cp;
                   $realp=$cob7 ;
                   $realisasi=number_format($realp,"2",".",",");
				   $coba8 =$realp-$cob6;
                    if ($coba8 < 0){
                    	$x1="(";
                    	$coba8=$coba8*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba8,"2",".",",");  
                    $per1   = ($coba8!=0)?($coba8 / $rowp->totp ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");   
                   //$cob1=$rowp->totp;
                   
                    $cRet    .= " <tr><td idth=\"10%\" align=\"left\"></td>                                     
                                     <td width=\"40%\" align=\"right\"><b>JUMLAH PENDAPATAN&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba6</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$realisasi</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$x1$total1$y1</b></td>
                                     <td width=\"5%\" align=\"right\"><b>$persen1</b></td></tr>";
                 }     

//REK BELANJA
/*				 
			$sql2="
					SELECT LEFT(a.kd_rek5,1) AS Kode,b.`lra` AS Rekening,b.nm_rek1 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd WHERE  LEFT(kd_rek5,1)=5 AND no_sts IN (SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0)AS Realisasi,
				    IFNULL((SELECT SUM(rupiah) FROM trdkasin_pkd  WHERE LEFT(kd_rek5,1)=5 AND no_sts IN(SELECT no_sts FROM trhkasin_pkd WHERE MONTH(tgl_sts)<='12' )),0) AS cp,
					IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,1)=5 AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,1)=5 AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS debet,
					IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,1)=5 AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,1)=5 AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=5
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS Kode,b.`lra` AS Rekening,b.nm_rek2 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd WHERE  LEFT(kd_rek5,2)=b.kd_rek2 AND no_sts IN (SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0)AS Realisasi,
				    IFNULL((SELECT SUM(rupiah) FROM trdkasin_pkd  WHERE LEFT(kd_rek5,2)=b.kd_rek2  AND no_sts IN(SELECT no_sts FROM trhkasin_pkd WHERE MONTH(tgl_sts)<='12' )),0) AS cp,
					IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS debet,
					IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=5
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS Kode,b.`lra` AS Rekening,b.nm_rek3 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd WHERE  LEFT(kd_rek5,3)=b.kd_rek3  AND no_sts IN (SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0)AS Realisasi,
				    IFNULL((SELECT SUM(rupiah) FROM trdkasin_pkd  WHERE LEFT(kd_rek5,3)=b.kd_rek3  AND no_sts IN(SELECT no_sts FROM trhkasin_pkd WHERE MONTH(tgl_sts)<='12' )),0) AS cp,
					IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,3)=b.`kd_rek3`  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,3)=b.`kd_rek3`  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS debet,
					IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,3)=b.kd_rek3  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,3)=b.kd_rek3  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=5
					GROUP BY b.`lra`					
					ORDER BY Kode,nu ";
			*/
		$sql2=
				"
			        SELECT LEFT(a.kd_rek5,1) AS Kode,b.`lra` AS Rekening,b.nm_rek1 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=5),0)
					AS debet,'0' AS kredit,'0' AS Realisasi,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=5
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS Kode,b.`lra` AS Rekening,b.nm_rek2 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=5 AND LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=5
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS Kode,b.`lra` AS Rekening,b.nm_rek3 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=5 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=5
					GROUP BY b.`lra`					
					ORDER BY Kode,nu
				";	
			    $query = $this->db->query($sql2);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query->result() as $row)
                {
                    $coba9=$row->Rekening;
                    $coba10=$row->Belanja;
                    $coba11= number_format($row->Anggaran,"2",".",",");
					$anggaran = $row->Anggaran;
                    $coba12= number_format($row->Realisasi,"2",".",",");
					$realisasi =$row->Realisasi;
                    $coba13= $row->Anggaran - $row->Realisasi;
					$pen5 = $row->cp;
					$debet5 = $row->debet;
					$kredit5 = $row->kredit;
					$real5 = $debet5 - $kredit5;
					$nreal5 = number_format($real5, "2", ".", ",");
					$real_s5 = $real5 - $anggaran;
					
/*					
                    if ($coba13 < 0){
                    	$x1="(";
                    	$coba13=$coba13*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba13,"2",".",",");  
                    $per1   = ($coba13!=0)?($coba13 / $row->Anggaran ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");  
*/

					
					if ($real_s5 < 0)
					{
						$x1 = "(";
						$real_s5 = $real_s5 * -1;
						$y1 = ")";
					} else
					{
						$x1 = "";
						$y1 = "";
					}
					$pend_selisih5 = number_format($real_s5, "2", ".", ",");
					$per15 = ($anggaran != 0) ? ($real_s5 / $row->Anggaran) * 100 : 0;
					$persen15 = number_format($per15, "2", ".", ",");

					
                    if(strlen($coba9)<=3){
                        $coba9= strtoupper($coba9);
                        $coba10= strtoupper($coba10);
                        $cRet .= "<tr><td width=\"10%\" align=\"center\">&nbsp;</td>                            
                                    <td width=\"40%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"5%\">&nbsp;</td>
								</tr>";
									
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\"><b>$coba9</b></td>                                     
                                 <td width=\"40%\"><b>$coba10</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$coba11</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$nreal5</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$x1$pend_selisih5$y1</b></td>
                                 <td width=\"5%\" align=\"right\"><b>$persen15</b></td></tr>";
                    }else{
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\">$coba9</td>                                     
                                 <td width=\"40%\">$coba10</td>
                                 <td width=\"15%\" align=\"right\">$coba11</td>
                                 <td width=\"15%\" align=\"right\">$nreal5</td>
                                 <td width=\"15%\" align=\"right\">$x1$pend_selisih5$y1</td>
                                 <td width=\"5%\" align=\"right\">$persen15</td></tr>";
                    }
                    
                }
		/*		
                $sqltp="
				       SELECT SUM(nilai_ubah) AS totb,
					    IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE left(kd_rek5_ang,1)='5'  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					    IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE left(kd_rek5_ang,1)='5'  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS debet,
						IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE left(kd_rek5_ang,1)='5'  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
						IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE left(kd_rek5_ang,1)='5'  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit
						FROM trdrka  WHERE LEFT(kd_rek5,1)='5'";
			*/
		$sqltp=		
				"
			        SELECT IFNULL(SUM(a.nilai_ubah),0) AS totb,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=5),0)
					AS debet,'0' AS kredit
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=5
					";		
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                   $coba14=number_format($rowp->totb,"2",".",",");
				   $cob14 = $rowp->totb;
				   $debet = number_format($rowp->debet,"2",".",",");
				   $debet5 = $rowp->debet;
				   $kredit =number_format($rowp->kredit,"2",".",",");
				   $kredit5 = $rowp->kredit;
				   $real5  =$debet5-$kredit5;
				   $nreal5 = number_format($real5, "2", ".", ",");
                   $coba16= $cob14 - $real5;
                    if ($coba16 < 0){
                    	$x1="(";
                    	$coba16=$coba16*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba16,"2",".",",");  
                    $per1   = ($coba16!=0)?($coba16 / $rowp->totb ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");
					
                  $suplus=$cob6-$cob14; 
                  if ($suplus < 0){
                	$x1="(";
                	$suplus=$suplus*-1;
                	$y1=")";}
                  else {
                	$x1="";
	                $y1="";}
                 $surp1=number_format($suplus,2,',','.'); 
				 
                 $suplus1=$cob7-$real5; 
                  if ($suplus1 < 0){
                	$x1="(";
                	$suplus1=$suplus1*-1;
                	$y1=")";}
                  else {
                	$x1="";
	                $y1="";}
                 $surp2=number_format($suplus1,"2",".",","); 				 
                  
                    $cRet    .= " <tr>
					              <td idth=\"10%\" align=\"left\"></td>                                     
                                     <td width=\"40%\" align=\"right\"><b>JUMLAH BELANJA&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba14</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$nreal5</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$total1</b></td>
                                     <td width=\"5%\" align=\"right\"><b>$persen1</b></td></tr>
								<tr>
								<td idth=\"10%\" align=\"left\"></td>                                     
                                     <td width=\"40%\" align=\"right\"><b>SURPLUS/DEFISIT&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$x1$surp1$y1</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$x1$surp2$y1</b></td>
                                     <td width=\"15%\" align=\"right\"><b></b></td>
                                     <td width=\"5%\" align=\"right\"><b></b></td>
								</tr>";
									 
                 }    

//REK PEMBIAYAAN
		/*
				$sql3="
				SELECT LEFT(a.kd_rek5,1) AS Kode,b.`lra` AS Rekening,b.nm_rek1 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd WHERE  LEFT(kd_rek5,1)=6 AND no_sts IN (SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0)AS Realisasi,
				    IFNULL((SELECT SUM(rupiah) FROM trdkasin_pkd  WHERE LEFT(kd_rek5,1)=6 AND no_sts IN(SELECT no_sts FROM trhkasin_pkd WHERE MONTH(tgl_sts)<='12' )),0) AS cp,
					IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,1)=6 AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,1)=6 AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS debet,
					IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,1)=6 AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,1)=6 AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=6
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS Kode,b.`lra` AS Rekening,b.nm_rek2 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd WHERE  LEFT(kd_rek5,2)=b.kd_rek2 AND no_sts IN (SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0)AS Realisasi,
				    IFNULL((SELECT SUM(rupiah) FROM trdkasin_pkd  WHERE LEFT(kd_rek5,2)=b.kd_rek2  AND no_sts IN(SELECT no_sts FROM trhkasin_pkd WHERE MONTH(tgl_sts)<='12' )),0) AS cp,
					IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS debet,
					IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=6
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS Kode,b.`lra` AS Rekening,b.nm_rek3 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd WHERE  LEFT(kd_rek5,3)=b.kd_rek3  AND no_sts IN (SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0)AS Realisasi,
				    IFNULL((SELECT SUM(rupiah) FROM trdkasin_pkd  WHERE LEFT(kd_rek5,3)=b.kd_rek3  AND no_sts IN(SELECT no_sts FROM trhkasin_pkd WHERE MONTH(tgl_sts)<='12' )),0) AS cp,
					IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,3)=b.`kd_rek3`  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,3)=b.`kd_rek3`  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS debet,
					IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,3)=b.kd_rek3  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,3)=b.kd_rek3  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=6
					GROUP BY b.`lra`					
					ORDER BY Kode,nu  ";
			*/
		$sql3=	
				"
			        SELECT LEFT(a.kd_rek5,1) AS Kode,b.`lra` AS Rekening,b.nm_rek1 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=6),0)
					AS Realisasi,'0' AS kredit,'0' AS debet,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=6
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS Kode,b.`lra` AS Rekening,b.nm_rek2 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=6 AND LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS Realisasi,'0' AS kredit,
					'0' AS debet,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=6
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS Kode,b.`lra` AS Rekening,b.nm_rek3 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=6 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS Realisasi,'0' AS kredit,
					'0' AS debet,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=6
					GROUP BY b.`lra`					
					ORDER BY Kode,nu
					";				
			    $query = $this->db->query($sql3);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query->result() as $row)
                {
                    $coba17=$row->Rekening;
                    $coba18=$row->Belanja;
                    $coba19= number_format($row->Anggaran,"2",".",",");
                    $coba20= number_format($row->Realisasi,"2",".",",");
                    $coba21= $row->Anggaran - $row->Realisasi;
					$realisasi =$row->Realisasi;
					$ang61 = number_format($row->Anggaran, "2", ".", ",");
					$angaran61 = $row->Anggaran;
					//echo($angaran61);
					$pen61 = $row->cp;
					$debet61 = $row->debet;
					$kredit61 = $row->kredit;
					$real61 = $kredit61 - $debet61;
					$nreal61 = number_format($real61, "2", ".", ",");
					$real_s61 = $realisasi-$angaran61;
					if ($real_s61 < 0)
					{
						$x1 = "(";
						$real_s61 = $real_s61 * -1;
						$y1 = ")";
					} else
					{
						$x1 = "";
						$y1 = "";
					}
					$pend_selisih61 = number_format($real_s61, "2", ".", ",");
					$per161 = ($real_s61 != 0) ? ($real_s61 / $row->Anggaran) * 100 : 0;
					$persen161 = number_format($per161, "2", ".", ",");
/*
			if ($coba21 < 0){
                    	$x1="(";
                    	$coba21=$coba21*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba21,"2",".",",");  
                    $per1   = ($coba21!=0)?($coba21 / $row->Anggaran ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");
*/					
                    if(strlen($coba17)<=3){
                        //$coba17= strtoupper($coba9);
                        //$coba18= strtoupper($coba10);
                        
                        $cRet .= "<tr><td width=\"10%\" align=\"center\">&nbsp;</td>                            
                                    <td width=\"40%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"5%\">&nbsp;</td></tr>";
									
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\"><b>$coba17</b></td>                                     
                                 <td width=\"40%\"><b>$coba18</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$coba19</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$coba20</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$x1$pend_selisih61$y1</b></td>
                                 <td width=\"5%\" align=\"right\"><b>$persen161</b></td></tr>";
                       }else{
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\">$coba17</td>                                     
                                 <td width=\"40%\">$coba18</td>
                                 <td width=\"15%\" align=\"right\">$coba19</td>
                                 <td width=\"15%\" align=\"right\">$coba20</td>
                                 <td width=\"15%\" align=\"right\">$x1$pend_selisih61$y1</td>
                                 <td width=\"5%\" align=\"right\">$persen161</td></tr>";
                    }
                    
                }
			/*	
                $sqltp="
				       SELECT SUM(a.nilai_ubah) AS totp,
					    IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd WHERE  LEFT(kd_rek5,1)='6'  AND no_sts IN (SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0)AS Realisasi,
					    IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE left(kd_rek5_ang,1)='6'  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					    IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE left(kd_rek5_ang,1)='6'  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS debet,
						IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE left(kd_rek5_ang,1)='6'  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
						IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE left(kd_rek5_ang,1)='6'  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit
						FROM trdrka a WHERE LEFT(a.kd_rek5,1)='6'";
				*/		
				$sqltp="
			        SELECT IFNULL(SUM(a.nilai_ubah),0) AS totp,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=6),0)
					AS Realisasi,'0' AS kredit,'0' AS debet
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=6
					";				
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                   $coba22=number_format($rowp->totp,"2",".",",");
				   $coba2a= $rowp->totp;
				   $realisasi =number_format($rowp->Realisasi,"2",".",",");
				   $realis6 =$rowp->Realisasi;
                   $debet=number_format($rowp->debet,"2",".",",");
                   $kredit=number_format($rowp->kredit,"2",".",",");
				   $real6 = $kredit - $debet;
				   $sisa =$coba22 - $realis6;
                   $coba24= $coba2a - $realis6;
				   
                    if ($coba24 < 0){
                    	$x1="(";
                    	$coba24=$coba24*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba24,"2",".",",");  
                    $per1   = ($coba24!=0)?($coba24 / $rowp->totp ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");   
                   
                    $cRet    .= " <tr><td idth=\"10%\" align=\"left\"></td>                                     
                                     <td width=\"40%\" align=\"right\"><b>PEMBIAYAAN/NETTO&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba22</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$realisasi</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$x1$total1$y1</b></td>
                                     <td width=\"5%\" align=\"right\"><b>$persen1</b></td></tr>";
									 
                 }
    $cRet .='</table>';
//Aktifkan Jika Penandatangan Perlu
 
		 $cRet .="<table>;
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
					</tr>
		 </table>";
 		 $cRet .=" <table width='100%' border=\"0\" cellspacing=\"1\" cellpadding=\"1\">
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>$daerah, ".$this->tukd_model->tanggal_format_indonesia(date("Y-m-d"))."</td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'><b>$jabatan</b></td>
					</tr>
					<tr>
						<td align='center' width='40%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>&nbsp;</td>
					</tr>
					<tr>
						<td align='center' width='40%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>&nbsp;</td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'><b>$nama</b></td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'><b>$nip</b></td>
					</tr>
				  </table>
				";		

         $data['prev']= $cRet;    
         $this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0'); 
    }	
	
//Cetak Laporan Realisasi Ringkasan Anggaran Semua SKPD
function cetak_perda_real12(){
        $thn_ang	   = $this->session->userdata('pcThang');
        $total_segment= $this->uri->total_segments();
        $halaman_awal = $this->uri->segment($total_segment);
        $ttd          = $this->uri->segment($total_segment - 1);
        //$skpd = $lcskpd;
        //$nama=  $this->tukd_model->get_nama($lcskpd,'nm_skpd','ms_skpd','kd_skpd');
        //$bulan= $this->tukd_model->getBulan($nbulan); 
        $cRet = '';
        $cRet = "
		<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">
					<tr>
						<td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
						<td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"15%\"><h6>LAMPIRAN I  :</h6></td>
						<td colspan=\"2\" align=\"left\" width=\"40%\"><h6>RANCANGAN PERATURAN DAERAH</h6></td>
					</tr>
					<tr> 
						<td align=\"left\" width=\"10%\"><h6>NOMOR</h6></td><td width=\"20%\" align=\"left\" ><h5>:</h5></td>
					</tr>
					<tr>
						<td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h6>TANGGAL</h6></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>:</h5></td>
					</tr>	
        </table>'
		<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"1\" cellpadding=\"1\">
				<tr>
                    <td align=\"center\" style=\"font-size:14px;\" colspan=\"3\"><b>
                      <strong>PEMERINTAH KABUPATEN MAMBERAMO TENGAH</strong><BR>
                      <strong>LAPORAN REALISASI ANGGARAN</strong><br>
					  <strong>TAHUN ANGGARAN $thn_ang</b></strong><br>&nbsp;
                    </td>
                </tr>";
				
        $cRet .='</table>';          
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"3\">
                <thead>
                <tr>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" rowspan=\"2\" style=\"font-size:14px\"><strong>NO<br>URUT</strong></td>
                    <td bgcolor=\"#CCCCCC\"  width=\"15%\" align=\"center\" rowspan=\"2\" style=\"font-size:14px\"><strong>URAIAN</strong></td>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" colspan=\"2\" style=\"font-size:14px\"><strong>JUMLAH (Rp)</strong></td>
					<td bgcolor=\"#CCCCCC\"  align=\"center\" rowspan=\"2\" style=\"font-size:14px\"><strong>LEBIH<br>(KURANG)</strong></td> 
                    <td bgcolor=\"#CCCCCC\"  width=\"5%\" align=\"center\" rowspan=\"2\" style=\"font-size:14px\"><strong>%</strong></td>
                </tr> 
				<tr>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><strong>ANGGARAN<BR>PERUBAHAN</strong></td>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><strong>REALISASI</strong></td>
				</tr>
				<tr>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><b>1</b></td>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><b>2</b></td>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><b>3</b></td>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><b>4</b></td>
				    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><b>5 = 3-4</b></td>
                    <td bgcolor=\"#CCCCCC\"  width=\"5%\" align=\"center\" style=\"font-size:14px\"><b>6</b></td>
				</tr>
                </thead>"; 
				
        $sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                 {
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                 }
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kode='KD' and kd_skpd='1.20.02.00'";
                 $sqlttd=$this->db->query($sqlttd1);
				 $kos=0;
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip=$rowttd->nip;                    
                    $nama= $rowttd->nm;
                    $jabatan  = $rowttd->jab;
					$kos++;
                }
				if($kos==0){
					$nip='Belum ada nip';
					$nama='Belum ada nama';
					$jabatan='Belum ada jabatan';
				}
				
//REK PENDAPATAN  
        /*                 
			$sql1="	
			        SELECT LEFT(a.kd_rek5,1) AS Kode,b.`lra` AS Rekening,b.nm_rek1 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd WHERE  LEFT(kd_rek5,1)=4 AND no_sts IN (SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0)AS Realisasi,
				    IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd  WHERE LEFT(kd_rek5,1)=4 AND no_sts IN(SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0) AS cp,
					IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,1)=4 AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,1)=4 AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)
					AS debet,
				    IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,1)=4 AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
				    IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,1)=4 AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=4
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS Kode,b.`lra` AS Rekening,b.nm_rek2 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd WHERE  LEFT(kd_rek5,2)=b.kd_rek2 AND no_sts IN (SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0)AS Realisasi,
				    IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd  WHERE LEFT(kd_rek5,2)=b.kd_rek2  AND no_sts IN(SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0) AS cp,
					IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS debet,
					IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=4
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS Kode,b.`lra` AS Rekening,b.nm_rek3 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd WHERE  LEFT(kd_rek5,3)=b.kd_rek3  AND no_sts IN (SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0)AS Realisasi,
				    IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd  WHERE LEFT(kd_rek5,3)=b.kd_rek3  AND no_sts IN(SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0) AS cp,
					IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,3)=b.`kd_rek3`  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,3)=b.`kd_rek3`  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS debet,
					IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,3)=b.kd_rek3  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,3)=b.kd_rek3  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=4
					GROUP BY b.`lra`					
					ORDER BY Kode,nu
					";
	*/
			$sql1=		
			      "
			        SELECT LEFT(a.kd_rek5,1) AS Kode,b.`lra` AS Rekening,b.nm_rek1 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=4),0)
					AS debet,'0' AS kredit,'' as cp,'0' AS Realisasi,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=4
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS Kode,b.`lra` AS Rekening,b.nm_rek2 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=4 AND LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS debet,'0' AS kredit,'' as cp,
					'0' AS Realisasi
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=4
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS Kode,b.`lra` AS Rekening,b.nm_rek3 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=4 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'0' AS kredit,'' as cp
					,'0' AS Realisasi,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=4
					GROUP BY b.`lra`					
					ORDER BY Kode,nu
				  ";
					
			    $query = $this->db->query($sql1);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query->result() as $row)
                {
                    $coba1=$row->Rekening;
                    $coba2=$row->Belanja;
                    $coba3= number_format($row->Anggaran,"2",".",",");
					$anggaran =$row->Anggaran;
                    $coba4= number_format($row->Realisasi,"2",".",",");
					$pen = number_format($row->cp,"2",".",",");
					$pen4 =$row->cp;
					$debet = number_format($row->debet,"2",".",",");
					$debetp = $row->debet;
					$kredit = number_format($row->kredit,"2",".",",");
					$kreditp = $row->kredit;
                    $coba5= $row->Anggaran - $row->Realisasi;
					$penp = $row->cp;
					$realp = $debetp;
					//$realp = $anggaran - $pen4;
					$nrealp = number_format($realp,"2", ".", ",");
					$real_sp = $realp - $anggaran;
/*					
                    if ($coba5 < 0){
                    	$x1="(";
                    	$coba5=$coba5*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba5,"2",".",",");  
                    $per1   = ($coba5!=0)?($coba5 / $row->Anggaran ) * 100:0; 
                    $persen1= number_format($per1,"2",".",","); 
*/					
					if ($real_sp < 0)
					{
						$x1 = "(";
						$real_sp = $real_sp * -1;
						$y1 = ")";
					} else
					{
						$x1 = "";
						$y1 = "";
					}
					$pend_selisihp = number_format($real_sp, "2", ".", ",");
					$per1p = ($real_sp != 0) ? ($real_sp / $row->Anggaran) * 100 : 0;
					$persen1p = number_format($per1p, "2", ".", ",");
							
                    if(strlen($coba1)<=3){
                        $coba1= strtoupper($coba1);
                        $coba2= strtoupper($coba2);
                        $cRet .= "<tr>
						            <td width=\"10%\" align=\"center\">&nbsp;</td>                            
                                    <td width=\"40%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"5%\">&nbsp;</td>
								  </tr>";
									
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\"><b>$coba1</b></td>                                     
                                 <td width=\"40%\"><b>$coba2</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$coba3</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$nrealp</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$x1$pend_selisihp$y1</b></td>
                                 <td width=\"5%\" align=\"right\"><b>$persen1p</b></td></tr>";
                    }else{
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\">$coba1</td>                                     
                                 <td width=\"40%\">$coba2</td>
                                 <td width=\"15%\" align=\"right\">$coba3</td>
                                 <td width=\"15%\" align=\"right\">$nrealp</td>
                                 <td width=\"15%\" align=\"right\">$pend_selisihp</td>
                                 <td width=\"5%\" align=\"right\">$persen1p</td></tr>";
                    }
                    
                }
		/*		
                $sqltp="
				       SELECT SUM(nilai_ubah) AS totp,
				        IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd  WHERE LEFT(kd_rek5,1)=4 AND no_sts IN(SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0) AS cp,
						IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,1)=4 AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
						IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,1)=4 AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0) as kredit,
						IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,1)=4 AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
						IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,1)=4 AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0) as debet
						FROM trdrka WHERE LEFT(kd_rek5,1)='4'";
				*/
		$sqltp=		
                 "
			        SELECT IFNULL(SUM(a.nilai_ubah),0) AS totp,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=4),0)
					AS debet,'0' AS kredit,'' as cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=4
					";				
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                   $coba6=number_format($rowp->totp,"2",".",",");
				   $cob6 = $rowp->totp;
                   $coba7=number_format($rowp->debet,"2",".",",");
				   $cob7 = $rowp->debet;
                   $kredit=number_format($rowp->kredit,"2",".",",");
				   $kredit2 = $rowp->kredit;
				   $pend = $rowp->cp;
                   $realp=$cob7 ;
                   $realisasi=number_format($realp,"2",".",",");
				   $coba8 =$realp-$cob6;
                    if ($coba8 < 0){
                    	$x1="(";
                    	$coba8=$coba8*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba8,"2",".",",");  
                    $per1   = ($coba8!=0)?($coba8 / $rowp->totp ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");   
                   //$cob1=$rowp->totp;
                   
                    $cRet    .= " <tr><td idth=\"10%\" align=\"left\"></td>                                     
                                     <td width=\"40%\" align=\"right\"><b>JUMLAH PENDAPATAN&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba6</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$realisasi</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$x1$total1$y1</b></td>
                                     <td width=\"5%\" align=\"right\"><b>$persen1</b></td></tr>";
                 }     

//REK BELANJA
/*				 
			$sql2="
					SELECT LEFT(a.kd_rek5,1) AS Kode,b.`lra` AS Rekening,b.nm_rek1 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd WHERE  LEFT(kd_rek5,1)=5 AND no_sts IN (SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0)AS Realisasi,
				    IFNULL((SELECT SUM(rupiah) FROM trdkasin_pkd  WHERE LEFT(kd_rek5,1)=5 AND no_sts IN(SELECT no_sts FROM trhkasin_pkd WHERE MONTH(tgl_sts)<='12' )),0) AS cp,
					IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,1)=5 AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,1)=5 AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS debet,
					IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,1)=5 AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,1)=5 AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=5
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS Kode,b.`lra` AS Rekening,b.nm_rek2 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd WHERE  LEFT(kd_rek5,2)=b.kd_rek2 AND no_sts IN (SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0)AS Realisasi,
				    IFNULL((SELECT SUM(rupiah) FROM trdkasin_pkd  WHERE LEFT(kd_rek5,2)=b.kd_rek2  AND no_sts IN(SELECT no_sts FROM trhkasin_pkd WHERE MONTH(tgl_sts)<='12' )),0) AS cp,
					IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS debet,
					IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=5
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS Kode,b.`lra` AS Rekening,b.nm_rek3 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd WHERE  LEFT(kd_rek5,3)=b.kd_rek3  AND no_sts IN (SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0)AS Realisasi,
				    IFNULL((SELECT SUM(rupiah) FROM trdkasin_pkd  WHERE LEFT(kd_rek5,3)=b.kd_rek3  AND no_sts IN(SELECT no_sts FROM trhkasin_pkd WHERE MONTH(tgl_sts)<='12' )),0) AS cp,
					IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,3)=b.`kd_rek3`  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,3)=b.`kd_rek3`  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS debet,
					IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,3)=b.kd_rek3  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,3)=b.kd_rek3  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=5
					GROUP BY b.`lra`					
					ORDER BY Kode,nu ";
			*/
		$sql2=
				"
			        SELECT LEFT(a.kd_rek5,1) AS Kode,b.`lra` AS Rekening,b.nm_rek1 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=5),0)
					AS debet,'0' AS kredit,'0' AS Realisasi,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=5
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS Kode,b.`lra` AS Rekening,b.nm_rek2 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=5 AND LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=5
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS Kode,b.`lra` AS Rekening,b.nm_rek3 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=5 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=5
					GROUP BY b.`lra`					
					ORDER BY Kode,nu
				";	
			    $query = $this->db->query($sql2);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query->result() as $row)
                {
                    $coba9=$row->Rekening;
                    $coba10=$row->Belanja;
                    $coba11= number_format($row->Anggaran,"2",".",",");
					$anggaran = $row->Anggaran;
                    $coba12= number_format($row->Realisasi,"2",".",",");
					$realisasi =$row->Realisasi;
                    $coba13= $row->Anggaran - $row->Realisasi;
					$pen5 = $row->cp;
					$debet5 = $row->debet;
					$kredit5 = $row->kredit;
					$real5 = $debet5 - $kredit5;
					$nreal5 = number_format($real5, "2", ".", ",");
					$real_s5 = $real5 - $anggaran;
					
/*					
                    if ($coba13 < 0){
                    	$x1="(";
                    	$coba13=$coba13*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba13,"2",".",",");  
                    $per1   = ($coba13!=0)?($coba13 / $row->Anggaran ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");  
*/

					
					if ($real_s5 < 0)
					{
						$x1 = "(";
						$real_s5 = $real_s5 * -1;
						$y1 = ")";
					} else
					{
						$x1 = "";
						$y1 = "";
					}
					$pend_selisih5 = number_format($real_s5, "2", ".", ",");
					$per15 = ($anggaran != 0) ? ($real_s5 / $row->Anggaran) * 100 : 0;
					$persen15 = number_format($per15, "2", ".", ",");

					
                    if(strlen($coba9)<=3){
                        $coba9= strtoupper($coba9);
                        $coba10= strtoupper($coba10);
                        $cRet .= "<tr><td width=\"10%\" align=\"center\">&nbsp;</td>                            
                                    <td width=\"40%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"5%\">&nbsp;</td>
								</tr>";
									
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\"><b>$coba9</b></td>                                     
                                 <td width=\"40%\"><b>$coba10</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$coba11</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$nreal5</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$x1$pend_selisih5$y1</b></td>
                                 <td width=\"5%\" align=\"right\"><b>$persen15</b></td></tr>";
                    }else{
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\">$coba9</td>                                     
                                 <td width=\"40%\">$coba10</td>
                                 <td width=\"15%\" align=\"right\">$coba11</td>
                                 <td width=\"15%\" align=\"right\">$nreal5</td>
                                 <td width=\"15%\" align=\"right\">$x1$pend_selisih5$y1</td>
                                 <td width=\"5%\" align=\"right\">$persen15</td></tr>";
                    }
                    
                }
		/*		
                $sqltp="
				       SELECT SUM(nilai_ubah) AS totb,
					    IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE left(kd_rek5_ang,1)='5'  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					    IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE left(kd_rek5_ang,1)='5'  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS debet,
						IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE left(kd_rek5_ang,1)='5'  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
						IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE left(kd_rek5_ang,1)='5'  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit
						FROM trdrka  WHERE LEFT(kd_rek5,1)='5'";
			*/
		$sqltp=		
				"
			        SELECT IFNULL(SUM(a.nilai_ubah),0) AS totb,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=5),0)
					AS debet,'0' AS kredit
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=5
					";		
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                   $coba14=number_format($rowp->totb,"2",".",",");
				   $cob14 = $rowp->totb;
				   $debet = number_format($rowp->debet,"2",".",",");
				   $debet5 = $rowp->debet;
				   $kredit =number_format($rowp->kredit,"2",".",",");
				   $kredit5 = $rowp->kredit;
				   $real5  =$debet5-$kredit5;
				   $nreal5 = number_format($real5, "2", ".", ",");
                   $coba16= $cob14 - $real5;
                    if ($coba16 < 0){
                    	$x1="(";
                    	$coba16=$coba16*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba16,"2",".",",");  
                    $per1   = ($coba16!=0)?($coba16 / $rowp->totb ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");
					
                  $suplus=$cob6-$cob14; 
                  if ($suplus < 0){
                	$x1="(";
                	$suplus=$suplus*-1;
                	$y1=")";}
                  else {
                	$x1="";
	                $y1="";}
                 $surp1=number_format($suplus,2,',','.'); 
				 
                 $suplus1=$cob7-$real5; 
                  if ($suplus1 < 0){
                	$x1="(";
                	$suplus1=$suplus1*-1;
                	$y1=")";}
                  else {
                	$x1="";
	                $y1="";}
                 $surp2=number_format($suplus1,"2",".",","); 				 
                  
                    $cRet    .= " <tr>
					              <td idth=\"10%\" align=\"left\"></td>                                     
                                     <td width=\"40%\" align=\"right\"><b>JUMLAH BELANJA&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba14</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$nreal5</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$total1</b></td>
                                     <td width=\"5%\" align=\"right\"><b>$persen1</b></td></tr>
								<tr>
								<td idth=\"10%\" align=\"left\"></td>                                     
                                     <td width=\"40%\" align=\"right\"><b>SURPLUS/DEFISIT&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$x1$surp1$y1</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$x1$surp2$y1</b></td>
                                     <td width=\"15%\" align=\"right\"><b></b></td>
                                     <td width=\"5%\" align=\"right\"><b></b></td>
								</tr>";
									 
                 }    

//REK PEMBIAYAAN
		/*
				$sql3="
				SELECT LEFT(a.kd_rek5,1) AS Kode,b.`lra` AS Rekening,b.nm_rek1 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd WHERE  LEFT(kd_rek5,1)=6 AND no_sts IN (SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0)AS Realisasi,
				    IFNULL((SELECT SUM(rupiah) FROM trdkasin_pkd  WHERE LEFT(kd_rek5,1)=6 AND no_sts IN(SELECT no_sts FROM trhkasin_pkd WHERE MONTH(tgl_sts)<='12' )),0) AS cp,
					IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,1)=6 AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,1)=6 AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS debet,
					IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,1)=6 AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,1)=6 AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=6
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS Kode,b.`lra` AS Rekening,b.nm_rek2 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd WHERE  LEFT(kd_rek5,2)=b.kd_rek2 AND no_sts IN (SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0)AS Realisasi,
				    IFNULL((SELECT SUM(rupiah) FROM trdkasin_pkd  WHERE LEFT(kd_rek5,2)=b.kd_rek2  AND no_sts IN(SELECT no_sts FROM trhkasin_pkd WHERE MONTH(tgl_sts)<='12' )),0) AS cp,
					IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS debet,
					IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=6
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS Kode,b.`lra` AS Rekening,b.nm_rek3 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd WHERE  LEFT(kd_rek5,3)=b.kd_rek3  AND no_sts IN (SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0)AS Realisasi,
				    IFNULL((SELECT SUM(rupiah) FROM trdkasin_pkd  WHERE LEFT(kd_rek5,3)=b.kd_rek3  AND no_sts IN(SELECT no_sts FROM trhkasin_pkd WHERE MONTH(tgl_sts)<='12' )),0) AS cp,
					IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,3)=b.`kd_rek3`  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,3)=b.`kd_rek3`  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS debet,
					IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE LEFT(kd_rek5_ang,3)=b.kd_rek3  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE LEFT(kd_rek5_ang,3)=b.kd_rek3  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=6
					GROUP BY b.`lra`					
					ORDER BY Kode,nu  ";
			*/
		$sql3=	
				"
			        SELECT LEFT(a.kd_rek5,1) AS Kode,b.`lra` AS Rekening,b.nm_rek1 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=6),0)
					AS Realisasi,'0' AS kredit,'0' AS debet,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=6
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS Kode,b.`lra` AS Rekening,b.nm_rek2 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=6 AND LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS Realisasi,'0' AS kredit,
					'0' AS debet,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=6
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS Kode,b.`lra` AS Rekening,b.nm_rek3 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=6 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS Realisasi,'0' AS kredit,
					'0' AS debet,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=6
					GROUP BY b.`lra`					
					ORDER BY Kode,nu
					";				
			    $query = $this->db->query($sql3);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query->result() as $row)
                {
                    $coba17=$row->Rekening;
                    $coba18=$row->Belanja;
                    $coba19= number_format($row->Anggaran,"2",".",",");
                    $coba20= number_format($row->Realisasi,"2",".",",");
                    $coba21= $row->Anggaran - $row->Realisasi;
					$realisasi =$row->Realisasi;
					$ang61 = number_format($row->Anggaran, "2", ".", ",");
					$angaran61 = $row->Anggaran;
					//echo($angaran61);
					$pen61 = $row->cp;
					$debet61 = $row->debet;
					$kredit61 = $row->kredit;
					$real61 = $kredit61 - $debet61;
					$nreal61 = number_format($real61, "2", ".", ",");
					$real_s61 = $realisasi-$angaran61;
					if ($real_s61 < 0)
					{
						$x1 = "(";
						$real_s61 = $real_s61 * -1;
						$y1 = ")";
					} else
					{
						$x1 = "";
						$y1 = "";
					}
					$pend_selisih61 = number_format($real_s61, "2", ".", ",");
					$per161 = ($real_s61 != 0) ? ($real_s61 / $row->Anggaran) * 100 : 0;
					$persen161 = number_format($per161, "2", ".", ",");
/*
			if ($coba21 < 0){
                    	$x1="(";
                    	$coba21=$coba21*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba21,"2",".",",");  
                    $per1   = ($coba21!=0)?($coba21 / $row->Anggaran ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");
*/					
                    if(strlen($coba17)<=3){
                        //$coba17= strtoupper($coba9);
                        //$coba18= strtoupper($coba10);
                        
                        $cRet .= "<tr><td width=\"10%\" align=\"center\">&nbsp;</td>                            
                                    <td width=\"40%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"5%\">&nbsp;</td></tr>";
									
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\"><b>$coba17</b></td>                                     
                                 <td width=\"40%\"><b>$coba18</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$coba19</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$coba20</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$x1$pend_selisih61$y1</b></td>
                                 <td width=\"5%\" align=\"right\"><b>$persen161</b></td></tr>";
                       }else{
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\">$coba17</td>                                     
                                 <td width=\"40%\">$coba18</td>
                                 <td width=\"15%\" align=\"right\">$coba19</td>
                                 <td width=\"15%\" align=\"right\">$coba20</td>
                                 <td width=\"15%\" align=\"right\">$x1$pend_selisih61$y1</td>
                                 <td width=\"5%\" align=\"right\">$persen161</td></tr>";
                    }
                    
                }
			/*	
                $sqltp="
				       SELECT SUM(a.nilai_ubah) AS totp,
					    IFNULL((SELECT SUM(rupiah) FROM trdkasin_ppkd WHERE  LEFT(kd_rek5,1)='6'  AND no_sts IN (SELECT no_sts FROM trhkasin_ppkd WHERE MONTH(tgl_sts)<='12' )),0)AS Realisasi,
					    IFNULL((SELECT SUM(debet) FROM trdju_pkd  WHERE left(kd_rek5_ang,1)='6'  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
					    IFNULL((SELECT SUM(debet) FROM trdju_ppkd  WHERE left(kd_rek5_ang,1)='6'  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS debet,
						IFNULL((SELECT SUM(kredit) FROM trdju_pkd  WHERE left(kd_rek5_ang,1)='6'  AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12')),0)+
						IFNULL((SELECT SUM(kredit) FROM trdju_ppkd  WHERE left(kd_rek5_ang,1)='6'  AND no_voucher IN(SELECT no_voucher FROM trhju_ppkd WHERE MONTH(tgl_voucher)<='12')),0)AS kredit
						FROM trdrka a WHERE LEFT(a.kd_rek5,1)='6'";
				*/		
				$sqltp="
			        SELECT IFNULL(SUM(a.nilai_ubah),0) AS totp,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=6),0)
					AS Realisasi,'0' AS kredit,'0' AS debet
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=6
					";				
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                   $coba22=number_format($rowp->totp,"2",".",",");
				   $coba2a = $rowp->totp;
				   $realisasi =number_format($rowp->Realisasi,"2",".",",");
				   $realis6 =$rowp->Realisasi;
                   $debet=number_format($rowp->debet,"2",".",",");
                   $kredit=number_format($rowp->kredit,"2",".",",");
				   $real6 = $kredit - $debet;
				   $sisa =$coba22 - $realis6;
                   $coba24= $coba2a - $realis6;
				   
                    if ($coba24 < 0){
                    	$x1="(";
                    	$coba24=$coba24*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba24,"2",".",",");  
                    $per1   = ($coba24!=0)?($coba24 / $rowp->totp ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");   
                   
                    $cRet    .= " <tr><td idth=\"10%\" align=\"left\"></td>                                     
                                     <td width=\"40%\" align=\"right\"><b>PEMBIAYAAN/NETTO&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba22</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$realisasi</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$x1$total1$y1</b></td>
                                     <td width=\"5%\" align=\"right\"><b>$persen1</b></td></tr>";
									 
                 }
    $cRet .='</table>';
	

         $data['prev']= $cRet;  
         $this->template->set('title', 'CETAK PERDA');
         $this->rka_model->_mpdf('',$cRet,10,10,10,1,'',$halaman_awal);
         //$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '1',$halaman_awal); 
    }
	
//Cetak Laporan Realisasi Ringkasan Anggaran Semua SKPD
	
	function cetak_perda1_real($lap = '', $ctk = '', $skpd = ''){
		$id = $skpd;
		$cetak = $ctk;
		$laporan = $lap;

		if ($laporan <> '2')
		{
			$sts = "AND MONTH(d.tgl_sts)<='12'";
			$jurnal = "AND MONTH(d.tgl_voucher)<='12'";
		} else
		{
			$sts = "AND MONTH(d.tgl_sts)<='12'";
			$jurnal = "AND MONTH(d.tgl_voucher)<='12'";

		}
		$sqldns = "SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
		$sqlskpd = $this->db->query($sqldns);
		foreach ($sqlskpd->result() as $rowdns)
		{
			$kd_urusan = $rowdns->kd_u;
			$nm_urusan = $rowdns->nm_u;
			$kd_skpd = $rowdns->kd_sk;
			$nm_skpd = $rowdns->nm_sk;
		}

		$sqlttd1 = "SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$id' and kode='PA'";
		$sqlttd = $this->db->query($sqlttd1);
		foreach ($sqlttd->result() as $rowttd)
		{
			$nip = $rowttd->nip;
			$nama = $rowttd->nm;
			$jabatan = $rowttd->jab;
		}

		$sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
		$sqlsclient = $this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc)
		{

			$tgl = $rowsc->tgl_rka;
			$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
			$kab = $rowsc->kab_kota;
			$daerah = $rowsc->daerah;
			$thn = $rowsc->thn_ang;
		}

		$jk = $this->rka_model->combo_skpd();

		$cRet = '';

		if ($cetak == '1' || $cetak == '2' )
		{
			$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td rowspan=\"3\" align=\"left\" width=\"55%\"><strong></strong></td>
						<td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"15%\"><strong><h5>LAMPIRAN I  :</h6></strong></td>
						<td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>PERATURAN DAERAH</strong></h5></td>
					</tr>
					<tr> 
						<td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>:</h5></td>
					</tr>
					<tr>
						<td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>:</h5></td>
					</tr>									
				
				</table>";
		}

		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td align=\"center\"><strong>$kab</strong></td>						
					</tr>
					<tr>
						<td align=\"center\"><strong>RINGKASAN LAPORAN REALISASI ANGGARAN MENURUT JENIS BELANJA </strong></td>
					</tr>					
					<tr>
						<td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
					</tr>
					<tr>
						<td align=\"center\">&nbsp;</td>
					</tr>
				</table>";
		if ($cetak == '2')
		{
			$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
						<tr>
							<td width=\"20%\">Urusan Organisasi </td>
							<td width=\"80%\">: $kd_urusan - $nm_urusan</td>
						</tr>
						<tr>
							<td>Organisasi</td>
							<td>: $kd_skpd - $nm_skpd </td>
						</tr>
					
					</table>";
		}

		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
					<thead>					
						<tr><td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NOMOR URUT</b></td>							
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\" colspan=\"2\" ><b>JUMLAH (Rp.)</b></td>
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>LEBIH</br>(KURANG)</b></td>
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>   
						</tr>
						<tr >
							<td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Anggaran<br>Perubahan</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Realisasi</b></td>							
						</tr>  
					</thead>
					<tfoot>
						<tr>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>						
						</tr>
					</tfoot>
				
					<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>							
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
						</tr>";


		if ($cetak == '1')
		{
			$sql4 = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,1)= a.kd_rek1 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
						ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='4'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
						UNION ALL 
						SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,2)= a.kd_rek2 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='4'  GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,3)= a.kd_rek3 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='4'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
		}
		
		if ($cetak == '2')
		{ 
		    $sql4 ="
			        SELECT LEFT(a.kd_rek5,1) AS kd_rek,b.`lra` AS rek,b.nm_rek1 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=4),0)
					AS kredit,'0' AS debet,'0' AS Realisasi,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=4 AND kd_skpd='$id' 
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS kd_rek,b.`lra` AS rek,b.nm_rek2 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=4 AND LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS kredit,'0' AS debet,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=4 AND kd_skpd='$id' 
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS kd_rek,b.`lra` AS rek,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=4 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS kredit,'0' AS debet,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=4 AND a.kd_skpd='$id'
					GROUP BY b.`lra`					
					ORDER BY kd_rek,nu ";
		}
		if( $cetak == '2' and $id=='1.20.06.00')
		{ 
		    $sql4 ="
			        SELECT LEFT(a.kd_rek5,1) AS kd_rek,b.`lra` AS rek,b.nm_rek1 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=4),0)
					AS kredit,'0' AS debet,'0' AS Realisasi,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=4 AND kd_skpd='1.20.06.00' 
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS kd_rek,b.`lra` AS rek,b.nm_rek2 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=4 AND LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS kredit,'0' AS debet,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=4 AND kd_skpd='1.20.06.00' 
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS kd_rek,b.`lra` AS rek,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=4 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS kredit,'0' AS debet,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=4 AND a.kd_skpd='1.20.06.00'
					GROUP BY b.`lra`					
					ORDER BY kd_rek,nu ";
			}
		
		$query4 = $this->db->query($sql4);
		//$query = $this->skpd_model->getAllc();

		foreach ($query4->result() as $row4)
		{
			$kode = $row4->rek;
			$nama = $row4->nm_rek;
			$ang = number_format($row4->nilai, "2", ".", ",");
			$angaran = $row4->nilai;
			$pen = $row4->cp;
			$debet = $row4->debet;
			$kredit = $row4->kredit;
			$real = ($pen+$kredit) - $debet;
			$nreal = number_format($real, "2", ".", ",");
			$real_s = $real - $angaran;
			if ($real_s < 0)
			{
				$x1 = "(";
				$real_s = $real_s * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisih = number_format($real_s, "2", ".", ",");
			$per1 = ($real != 0) ? ($real / $row4->nilai) * 100 : 0;
			$persen1 = number_format($per1, "2", ".", ",");
			
        if(strlen($kode) <='3')
		{
			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode</b></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\"><b>$nama</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$ang</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nreal</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$x1$pend_selisih$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1</b></td>
								</tr>";
		} else {
			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kode</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$ang</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nreal</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$pend_selisih$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
								</tr>";
		}
	}
		if ($cetak == '1')
		{
			$sqltp = "SSELECT SUM(nilai_ubah) AS totp,
						(SELECT SUM(rupiah)FROM trdkasin_ppkd c WHERE  LEFT(c.kd_rek5,1)='4')AS realisasi,
						(SELECT SUM(rupiah)FROM trdkasin_pkd c WHERE  LEFT(c.kd_rek5,1)='4')AS cp,
						(SELECT SUM(debet)FROM trdju_pkd c WHERE  LEFT(c.kd_rek5_ang,1)='4' )AS debet,
						(SELECT SUM(kredit)FROM trdju_pkd c  WHERE  LEFT(c.kd_rek5_ang,1)='4' )AS kredit  
						FROM trdrka WHERE LEFT(kd_rek5,1)='4'";
		}
		if ($cetak == '2')
		{
			$sqltp = "
					SELECT SUM(nilai_ubah) AS totp,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=4),0)
					AS kredit,'0' AS debet,'0' AS Realisasi,'' AS cp
					FROM trdrka WHERE LEFT(kd_rek5,1)='4' AND kd_skpd='$id'	
					";					
		}
		if($cetak == '2' and $id=='1.20.06.00')
		{
			$sqltp = "
					SELECT SUM(nilai_ubah) AS totp,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=4),0)
					AS kredit,'0' AS debet,'0' AS Realisasi,'' AS cp
					FROM trdrka WHERE LEFT(kd_rek5,1)='4' AND kd_skpd='1.20.06.00'	
					";					
		}

		
		$sqlp = $this->db->query($sqltp);
		foreach ($sqlp->result() as $rowp)
		{
			$angp = number_format($rowp->totp, "2", ".", ",");
			$angaranp = $rowp->totp;
			$penp = $rowp->cp;
			$debetp = $rowp->debet;
			$kreditp = $rowp->kredit;
			$realp = ($penp+$kreditp) - $debetp;
			$nrealp = number_format($realp, "2", ".", ",");
			$real_sp = $realp - $angaranp;
			if ($real_sp < 0)
			{
				$x1 = "(";
				$real_sp = $real_sp * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisihp = number_format($real_sp, "2", ".", ",");
			$per1p = ($realp != 0) ? ($realp / $rowp->totp) * 100 : 0;
			$persen1p = number_format($per1p, "2", ".", ",");

			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\" align=\"right\"><b>Jumlah Pendapatan</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$angp</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nrealp</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$x1$pend_selisihp$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1p</b></td>
								</tr>";
		}

		if ($cetak == '1')
		{
			$sql5 = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,1)= a.kd_rek1 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,1)=a.kd_rek1 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
						ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='5'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
						UNION ALL 
						SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,2)= a.kd_rek2 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='5'  GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,3)= a.kd_rek3 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='5'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
		}
		if ($cetak == '2')
		{ 
		    $sql5 ="
			        SELECT LEFT(a.kd_rek5,1) AS kd_rek,b.`lra` AS rek,b.nm_rek1 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=5),0)
					AS debet,'0' AS kredit,'0' AS Realisasi,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=5 AND kd_skpd='$id' 
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS kd_rek,b.`lra` AS rek,b.nm_rek2 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=5 AND LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=5 AND kd_skpd='$id' 
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS kd_rek,b.`lra` AS rek,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=5 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=5 AND a.kd_skpd='$id'
					GROUP BY b.`lra`					
					ORDER BY kd_rek,nu ";
		}

			if ($cetak == '2' and $id=='1.20.06.00')
		{ 
		    $sql5 ="
			        SELECT LEFT(a.kd_rek5,1) AS kd_rek,b.`lra` AS rek,b.nm_rek1 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=5),0)
					AS debet,'0' AS kredit,'0' AS Realisasi,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=5 AND kd_skpd='1.20.06.00' 
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS kd_rek,b.`lra` AS rek,b.nm_rek2 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=5 AND LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=5 AND kd_skpd='1.20.06.00' 
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS kd_rek,b.`lra` AS rek,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=5 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=5 AND a.kd_skpd='1.20.06.00'
					GROUP BY b.`lra`					
					ORDER BY kd_rek,nu ";
		}



		$query5 = $this->db->query($sql5);
		//$query = $this->skpd_model->getAllc();

		foreach ($query5->result() as $row5)
		{
			$kode5 = $row5->rek;
			$nama5 = $row5->nm_rek;
			$ang5 = number_format($row5->nilai, "2", ".", ",");
			$angaran5 = $row5->nilai;
			$pen5 = $row5->cp;
			$debet5 = $row5->debet;
			$kredit5 = $row5->kredit;
			$real5 = $debet5 - $kredit5;
			$nreal5 = number_format($real5, "2", ".", ",");
			$real_s5 = $real5 - $angaran5;
			if ($real_s5 < 0)
			{
				$x1 = "(";
				$real_s5 = $real_s5 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisih5 = number_format($real_s5, "2", ".", ",");
			$per15 = ($real5 != 0) ? ($real5 / $row5->nilai) * 100 : 0;
			$persen15 = number_format($per15, "2", ".", ",");

        if(strlen($kode5) <='3')
		{
			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode5</b></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\"><b>$nama5</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$ang5</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nreal5</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$x1$pend_selisih5$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen15</b></td>
									
								</tr>";
		}else{
			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kode5</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama5</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$ang5</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nreal5</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$pend_selisih5$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen15</td>
									
								</tr>";
		}
	}	

		if ($cetak == '1')
		{
			$sqltb = "SELECT SUM(nilai) AS totb,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE LEFT(c.kd_rek5,1)='5' $sts)AS cp,
						(SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5_ang,1)='5' $jurnal)AS debet,
						(SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5_ang,1)='5' $jurnal)AS kredit  
						FROM trdrka WHERE LEFT(kd_rek5,1)='5' ";
		}
		if ($cetak == '2')
		{
			$sqltb = "
					SELECT SUM(nilai_ubah) AS totb,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=5),0)
					AS debet,'0' AS kredit,'0' AS Realisasi,'' AS cp
					FROM trdrka WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='$id'	
					";					
		}
		if ($cetak == '2' and $id=='1.20.06.00')
		{
			$sqltb = "
					SELECT SUM(nilai_ubah) AS totb,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=5),0)
					AS debet,'0' AS kredit,'0' AS Realisasi,'' AS cp
					FROM trdrka WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='1.20.06.00'	
					";					
		}
		$sqlb = $this->db->query($sqltb);
		foreach ($sqlb->result() as $rowb)
		{
			$angb = number_format($rowb->totb, "2", ".", ",");
			$angaranb = $rowb->totb;
			$penb = $rowb->cp;
			$debetb = $rowb->debet;
			$kreditb = $rowb->kredit;
			$realb = $debetb - $kreditb;
			$nrealb = number_format($realb, "2", ".", ",");
			$real_sb = $realb - $angaranb;
			if ($real_sb < 0)
			{
				$x1 = "(";
				$real_sb = $real_sb * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisihb = number_format($real_sb, "2", ".", ",");
			$per1b = ($realb != 0) ? ($realb / $rowb->totb) * 100 : 0;
			$persen1b = number_format($per1b, "2", ".", ",");

			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\" align=\"right\"><b>Jumlah Belanja</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$angb</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nrealb</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$x1$pend_selisihb$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1b</b></td>
								</tr>";
		}

		$suplus = $angaranp - $angaranb;

		if ($suplus < 0)
		{
			$s = "(";
			$suplus = $suplus * -1;
			$d = ")";
		} else
		{
			$s = "";
			$d = "";
		}
		$surp = number_format($suplus, 2, ',', '.');
		$suplusr = $realp - $realb;

		if ($suplusr < 0)
		{
			$j = "(";
			$suplusr = $suplusr * -1;
			$k = ")";
		} else
		{
			$j = "";
			$k = "";
		}
		$surpr = number_format($suplusr, 2, ',', '.');

		$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\" align=\"right\"><b>Surplus/Defisit</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$s$surp$d</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$j$surpr$k</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
								</tr>";
		if ($cetak == '1')
		{
			$sqlpm = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,1)= a.kd_rek1 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,1)=a.kd_rek1 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
						ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='6'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
						UNION ALL 
						SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,2)= a.kd_rek2 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='61'  GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,3)= a.kd_rek3 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='61'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
		}
		if ($cetak == '2')
		{
		    $sqlpm ="
			        SELECT LEFT(a.kd_rek5,1) AS kd_rek,b.`lra` AS rek,b.nm_rek1 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=6),0)
					AS kredit,'0' AS debet,'0' AS Realisasi,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=6 AND kd_skpd='$id' 
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS kd_rek,b.`lra` AS rek,b.nm_rek2 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,2)=61 AND LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS kredit,'0' AS debet,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,2)=61 AND kd_skpd='$id' 
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS kd_rek,b.`lra` AS rek,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,2)=61 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS kredit,'0' AS debet,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,2)=61 AND a.kd_skpd='$id'
					GROUP BY b.`lra`					
					ORDER BY kd_rek,nu ";
		}
		if ($cetak == '2' and $id=='1.20.06.00')
		{
		    $sqlpm ="
			        SELECT LEFT(a.kd_rek5,1) AS kd_rek,b.`lra` AS rek,b.nm_rek1 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=6),0)
					AS kredit,'0' AS debet,'0' AS Realisasi,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=6 AND kd_skpd='1.20.06.00' 
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS kd_rek,b.`lra` AS rek,b.nm_rek2 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,2)=61 AND LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS kredit,'0' AS debet,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,2)=61 AND kd_skpd='1.20.06.00' 
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS kd_rek,b.`lra` AS rek,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,2)=6 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS kredit,'0' AS debet,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,2)=61 AND a.kd_skpd='1.20.06.00'
					GROUP BY b.`lra`					
					ORDER BY kd_rek,nu ";
		}
		
		$query61 = $this->db->query($sqlpm);

		foreach ($query61->result() as $row61)
		{
			$kode61 = $row61->rek;
			$nama61 = $row61->nm_rek;
			$ang61 = number_format($row61->nilai, "2", ".", ",");
			$angaran61 = $row61->nilai;
			//echo($angaran61);
			$pen61 = $row61->cp;
			$debet61 = $row61->debet;
			$kredit61 = $row61->kredit;
			$real61 = $kredit61 - $debet61;
			$nreal61 = number_format($real61, "2", ".", ",");
			$real_s61 = $real61 - $angaran61;
			if ($real_s61 < 0)
			{
				$x1 = "(";
				$real_s61 = $real_s61 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisih61 = number_format($real_s61, "2", ".", ",");
			$per161 = ($real61 != 0) ? ($real61 / $row61->nilai) * 100 : 0;
			$persen161 = number_format($per161, "2", ".", ",");

        if(strlen($kode61) <='3')
		{
			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode61</b></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\"><b>$nama61</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$ang61</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nreal61</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$x1$pend_selisih61$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen161</b></td>
								</tr>";
		} else {
			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kode61</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama61</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$ang61</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nreal61</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$pend_selisih61$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen161</td>
								</tr>";
		
		}
	}

		if ($cetak == '1')
		{
			$sqltpm = "SELECT SUM(nilai) AS totpm,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE LEFT(c.kd_rek5,2)='61' $sts)AS cp,
						(SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5_ang,2)='61' $jurnal)AS debet,
						(SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5_ang,2)='61' $jurnal)AS kredit  
						FROM trdrka WHERE LEFT(kd_rek5,2)='61' ";
		}
		if ($cetak == '2')
		{

			$sqltpm  = "
					SELECT SUM(nilai_ubah) AS totpm,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,2)=61),0)
					AS kredit,'0' AS debet,'0' AS Realisasi,'' AS cp
					FROM trdrka WHERE LEFT(kd_rek5,2)='61' AND kd_skpd='$id'	
					";
		}
		$sqlpmasuk = $this->db->query($sqltpm);
		foreach ($sqlpmasuk->result() as $rowpm)
		{
			$angpm = number_format($rowpm->totpm, "2", ".", ",");
			$angaranpm = $rowpm->totpm;
			$penpm = $rowpm->cp;
			$debetpm = $rowpm->debet;
			$kreditpm = $rowpm->kredit;
			$realpm = $kreditpm - $debetpm;
			$nrealpm = number_format($realpm, "2", ".", ",");
			$real_spm = $realpm - $angaranpm;
			if ($real_spm < 0)
			{
				$x1 = "(";
				$real_spm = $real_spm * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisihpm = number_format($real_spm, "2", ".", ",");
			$per1pm = ($realpm != 0) ? ($realpm / $rowpm->totpm) * 100 : 0;
			$persen1pm = number_format($per1pm, "2", ".", ",");

			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\" align=\"right\"><b>Jumlah Pembiayaan masuk</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$angpm</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nrealpm</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$x1$pend_selisihpm$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1pm</b></td>
								</tr>";
		}
		if ($cetak == '1')
		{
			$sqlpk = "SELECT * FROM(SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,2)= a.kd_rek2 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='62'  GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,3)= a.kd_rek3 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='62'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3) a ORDER BY kd_rek";
		}
		if ($cetak == '2')
		{
			$sqlpk = "
					SELECT LEFT(a.kd_rek5,2) AS kd_rek,b.`lra` AS rek,b.nm_rek2 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,2)=62 AND LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS kredit,'0' AS debet,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,2)=62 AND kd_skpd='$id' 
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS kd_rek,b.`lra` AS rek,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,2)=62 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS kredit,'0' AS debet,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,2)=62 AND a.kd_skpd='$id'
					GROUP BY b.`lra`					
					ORDER BY kd_rek,nu ";
		}
		$query62 = $this->db->query($sqlpk);

		foreach ($query62->result() as $row62)
		{
			$kode62 = $row62->rek;
			$nama62 = $row62->nm_rek;
			$ang62 = number_format($row62->nilai, "2", ".", ",");
			$angaran62 = $row62->nilai;
			$pen62 = $row62->cp;
			$debet62 = $row62->debet;
			$kredit62 = $row62->kredit;
			$real62 = $kredit62 -$debet62;
			$nreal62 = number_format($real62, "2", ".", ",");
			$real_s62 = $real62 - $angaran62;
			if ($real_s62 < 0)
			{
				$x1 = "(";
				$real_s62 = $real_s62 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisih62 = number_format($real_s62, "2", ".", ",");
			$per162 = ($real62 != 0) ? ($real62 / $row62->nilai) * 100 : 0;
			$persen162 = number_format($per162, "2", ".", ",");

			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kode62</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama62</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$ang62</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nreal62</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$pend_selisih62$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen162</td>
								</tr>";
		}

		if ($cetak == '1')
		{
			$sqltpk = "SELECT SUM(nilai) AS totpk,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE LEFT(c.kd_rek5,2)='62' $sts)AS cp,
						(SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5_ang,2)='62' $jurnal)AS debet,
						(SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5_ang,2)='62' $jurnal)AS kredit  
						FROM trdrka WHERE LEFT(kd_rek5,2)='62' ";
		}
		if ($cetak == '2')
		{
			$sqltpk  = "
					SELECT SUM(nilai_ubah) AS totpk,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,2)=62),0)
					AS kredit,'0' AS debet,'0' AS Realisasi,'' AS cp
					FROM trdrka WHERE LEFT(kd_rek5,2)='62' AND kd_skpd='$id'	
					";
		}
		$sqlpkeluar = $this->db->query($sqltpk);
		foreach ($sqlpkeluar->result() as $rowpk)
		{
			$angpk = number_format($rowpk->totpk, "2", ".", ",");
			$angaranpk = $rowpk->totpk;
			$penpk = $rowpk->cp;
			$debetpk = $rowpk->debet;
			$kreditpk = $rowpk->kredit;
			$realpk =  $kreditpk - $debetpk;
			$nrealpk = number_format($realpm, "2", ".", ",");
			$real_spk = $realpk - $angaranpk;
			if ($real_spk < 0)
			{
				$x1 = "(";
				$real_spk = $real_spk * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisihpk = number_format($real_spk, "2", ".", ",");
			$per1pk = ($realpk != 0) ? ($realpk / $rowpk->totpk) * 100 : 0;
			$persen1pk = number_format($per1pk, "2", ".", ",");

			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\" align=\"right\"><b>Jumlah Pembiayaan Keluar</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$angpk</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nrealpk</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$x1$pend_selisihpk$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1pk</b></td>
								</tr>";
		}
		//echo($angaran62);
		$netto = $angaranpm - $angaranpk;
		$net = number_format($netto, 2, ',', '.');
		if ($netto < 0)
		{
			$x4 = "(";
			$netto = $netto * -1;
			$y4 = ")";
		} else
		{
			$x4 = "";
			$y4 = "";
		}

		$nettor = $realpm - $realpk;
		$netr = number_format($nettor, 2, ',', '.');
		if ($nettor < 0)
		{
			$x5 = "(";
			$nettor = $nettor * -1;
			$y5 = ")";
		} else
		{
			$x5 = "";
			$y5 = "";
		}

		$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\" align=\"right\"><b>Pembiayaan Netto</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$x4$net$y4</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$x5$netr$y5</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
								</tr>";
								
		$silpa = ($angaranp + $angaranpm) - ($angaranpk + $angaranb);
		if ($silpa < 0)
		{
			$c = "(";
			$silpa = $silpa * -1;
			$d = ")";
		} else
		{
			$c = "";
			$d = "";
		}
		$silp = number_format($silpa, 2, ',', '.');
		$silpar = ($realp + $realpm) - ($realb + $realpk);
		if ($silpar < 0)
		{
			$c1 = "(";
			$silpar = $silpar * -1;
			$d1 = ")";
		} else
		{
			$c1 = "";
			$d1 = "";
		}
		$silpr = number_format($silpar, 2, ',', '.');

		$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\" align=\"right\"><b>SILPA</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$c$silp$d</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$c1$silpr$d1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
								</tr>";

		$cRet .= "</table>";
		
//Aktifkan Jika Penandatangan Perlu
 
		 $cRet .="<table>;
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
					</tr>
		 </table>";
 		 $cRet .=" <table width='100%' border=\"0\" cellspacing=\"1\" cellpadding=\"1\">
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>$daerah, ".$this->tukd_model->tanggal_format_indonesia(date("Y-m-d"))."</td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'><b>$jabatan</b></td>
					</tr>
					<tr>
						<td align='center' width='40%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>&nbsp;</td>
					</tr>
					<tr>
						<td align='center' width='40%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>&nbsp;</td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'><b>$nama</b></td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'><b>NIP:$nip</b></td>
					</tr>
				  </table>
				";		
		$data['prev'] = $cRet;
		$data['sikap'] = 'preview';
		$this->template->set('title', 'CETAK PERDA REALISASI SEMESTER LAMPIRAN I');
		$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
	}
	
//RANCANGAN PERDA I TANDPA TANDA TANGAN	
	function cetak_perda12_real($lap = '', $ctk = '', $skpd = '')
	{
		$id = $skpd;
		$cetak = $ctk;
		$laporan = $lap;

		if ($laporan <> '2')
		{
			$sts = "AND MONTH(d.tgl_sts)<='12'";
			$jurnal = "AND MONTH(d.tgl_voucher)<='12'";
		} else
		{
			$sts = "AND MONTH(d.tgl_sts)<='12'";
			$jurnal = "AND MONTH(d.tgl_voucher)<='12'";

		}
		$sqldns = "SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
		$sqlskpd = $this->db->query($sqldns);
		foreach ($sqlskpd->result() as $rowdns)
		{
			$kd_urusan = $rowdns->kd_u;
			$nm_urusan = $rowdns->nm_u;
			$kd_skpd = $rowdns->kd_sk;
			$nm_skpd = $rowdns->nm_sk;
		}

		$sqlttd1 = "SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$id' and kode='PA'";
		$sqlttd = $this->db->query($sqlttd1);
		foreach ($sqlttd->result() as $rowttd)
		{
			$nip = $rowttd->nip;
			$nama = $rowttd->nm;
			$jabatan = $rowttd->jab;
		}

		$sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
		$sqlsclient = $this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc)
		{

			$tgl = $rowsc->tgl_rka;
			$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
			$kab = $rowsc->kab_kota;
			$daerah = $rowsc->daerah;
			$thn = $rowsc->thn_ang;
		}

		$jk = $this->rka_model->combo_skpd();

		$cRet = '';

		if ($cetak == '1' || $cetak == '2' )
		{
			$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td rowspan=\"3\" align=\"left\" width=\"55%\"><strong></strong></td>
						<td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"15%\"><strong><h5>LAMPIRAN I  :</h6></strong></td>
						<td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>RANCANGAN PERATURAN DAERAH</strong></h5></td>
					</tr>
					<tr> 
						<td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>:</h5></td>
					</tr>
					<tr>
						<td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>:</h5></td>
					</tr>									
				
				</table>";
		}

		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td align=\"center\"><strong>$kab</strong></td>						
					</tr>
					<tr>
						<td align=\"center\"><strong>RINGKASAN LAPORAN REALISASI ANGGARAN MENURUT JENIS BELANJA </strong></td>
					</tr>					
					<tr>
						<td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
					</tr>
					<tr>
						<td align=\"center\">&nbsp;</td>
					</tr>
				</table>";
		if ($cetak == '2')
		{
			$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
						<tr>
							<td width=\"20%\">Urusan Organisasi </td>
							<td width=\"80%\">: $kd_urusan - $nm_urusan</td>
						</tr>
						<tr>
							<td>Organisasi</td>
							<td>: $kd_skpd - $nm_skpd </td>
						</tr>
					
					</table>";
		}

		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
					<thead>					
						<tr><td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NOMOR URUT</b></td>							
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\" colspan=\"2\" ><b>JUMLAH (Rp.)</b></td>
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>LEBIH</br>(KURANG)</b></td>
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>   
						</tr>
						<tr >
							<td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Anggaran<br>Perubahan</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Realisasi</b></td>							
						</tr>  
					</thead>
					<tfoot>
						<tr>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>						
						</tr>
					</tfoot>
				
					<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>							
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
						</tr>";


		if ($cetak == '1')
		{
			$sql4 = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,1)= a.kd_rek1 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,1)=a.kd_rek1 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
						ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='4'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
						UNION ALL 
						SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,2)= a.kd_rek2 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='4'  GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,3)= a.kd_rek3 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='4'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
		}
		
		if ($cetak == '2')
		{ 
		    $sql4 ="
			        SELECT LEFT(a.kd_rek5,1) AS kd_rek,b.`lra` AS rek,b.nm_rek1 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=4),0)
					AS kredit,'0' AS debet,'0' AS Realisasi,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=4 AND kd_skpd='$id' 
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS kd_rek,b.`lra` AS rek,b.nm_rek2 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=4 AND LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS kredit,'0' AS debet,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=4 AND kd_skpd='$id' 
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS kd_rek,b.`lra` AS rek,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=4 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS kredit,'0' AS debet,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=4 AND a.kd_skpd='$id'
					GROUP BY b.`lra`					
					ORDER BY kd_rek,nu ";
		}
		if( $cetak == '2' and $id=='1.20.06.00')
		{ 
		    $sql4 ="
			        SELECT LEFT(a.kd_rek5,1) AS kd_rek,b.`lra` AS rek,b.nm_rek1 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=4),0)
					AS kredit,'0' AS debet,'0' AS Realisasi,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=4 AND kd_skpd='1.20.06.00' 
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS kd_rek,b.`lra` AS rek,b.nm_rek2 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=4 AND LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS kredit,'0' AS debet,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=4 AND kd_skpd='1.20.06.00' 
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS kd_rek,b.`lra` AS rek,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=4 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS kredit,'0' AS debet,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=4 AND a.kd_skpd='1.20.06.00'
					GROUP BY b.`lra`					
					ORDER BY kd_rek,nu ";
			}
		
		$query4 = $this->db->query($sql4);
		//$query = $this->skpd_model->getAllc();

		foreach ($query4->result() as $row4)
		{
			$kode = $row4->rek;
			$nama = $row4->nm_rek;
			$ang = number_format($row4->nilai, "2", ".", ",");
			$angaran = $row4->nilai;
			$pen = $row4->cp;
			$debet = $row4->debet;
			$kredit = $row4->kredit;
			$real = ($pen+$kredit) - $debet;
			$nreal = number_format($real, "2", ".", ",");
			$real_s = $real - $angaran;
			if ($real_s < 0)
			{
				$x1 = "(";
				$real_s = $real_s * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisih = number_format($real_s, "2", ".", ",");
			$per1 = ($real != 0) ? ($real / $row4->nilai) * 100 : 0;
			$persen1 = number_format($per1, "2", ".", ",");
			
        if(strlen($kode) <='3')
		{
			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode</b></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\"><b>$nama</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$ang</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nreal</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$x1$pend_selisih$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1</b></td>
								</tr>";
		} else {
			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kode</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$ang</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nreal</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$pend_selisih$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
								</tr>";
		}
	}
		if ($cetak == '1')
		{
			$sqltp = "SSELECT SUM(nilai_ubah) AS totp,
						(SELECT SUM(rupiah)FROM trdkasin_ppkd c WHERE  LEFT(c.kd_rek5,1)='4')AS realisasi,
						(SELECT SUM(rupiah)FROM trdkasin_pkd c WHERE  LEFT(c.kd_rek5,1)='4')AS cp,
						(SELECT SUM(debet)FROM trdju_pkd c WHERE  LEFT(c.kd_rek5_ang,1)='4' )AS debet,
						(SELECT SUM(kredit)FROM trdju_pkd c  WHERE  LEFT(c.kd_rek5_ang,1)='4' )AS kredit  
						FROM trdrka WHERE LEFT(kd_rek5,1)='4'";
		}
		if ($cetak == '2')
		{
			$sqltp = "
					SELECT SUM(nilai_ubah) AS totp,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=4),0)
					AS kredit,'0' AS debet,'0' AS Realisasi,'' AS cp
					FROM trdrka WHERE LEFT(kd_rek5,1)='4' AND kd_skpd='$id'	
					";					
		}
		if($cetak == '2' and $id=='1.20.06.00')
		{
			$sqltp = "
					SELECT SUM(nilai_ubah) AS totp,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=4),0)
					AS kredit,'0' AS debet,'0' AS Realisasi,'' AS cp
					FROM trdrka WHERE LEFT(kd_rek5,1)='4' AND kd_skpd='1.20.06.00'	
					";					
		}

		
		$sqlp = $this->db->query($sqltp);
		foreach ($sqlp->result() as $rowp)
		{
			$angp = number_format($rowp->totp, "2", ".", ",");
			$angaranp = $rowp->totp;
			$penp = $rowp->cp;
			$debetp = $rowp->debet;
			$kreditp = $rowp->kredit;
			$realp = ($penp+$kreditp) - $debetp;
			$nrealp = number_format($realp, "2", ".", ",");
			$real_sp = $realp - $angaranp;
			if ($real_sp < 0)
			{
				$x1 = "(";
				$real_sp = $real_sp * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisihp = number_format($real_sp, "2", ".", ",");
			$per1p = ($realp != 0) ? ($realp / $rowp->totp) * 100 : 0;
			$persen1p = number_format($per1p, "2", ".", ",");

			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\" align=\"right\"><b>Jumlah Pendapatan</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$angp</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nrealp</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$x1$pend_selisihp$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1p</b></td>
								</tr>";
		}

		if ($cetak == '1')
		{
			$sql5 = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,1)= a.kd_rek1 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,1)=a.kd_rek1 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
						ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='5'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
						UNION ALL 
						SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,2)= a.kd_rek2 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='5'  GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,3)= a.kd_rek3 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='5'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
		}
		if ($cetak == '2')
		{ 
		    $sql5 ="
			        SELECT LEFT(a.kd_rek5,1) AS kd_rek,b.`lra` AS rek,b.nm_rek1 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=5),0)
					AS debet,'0' AS kredit,'0' AS Realisasi,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=5 AND kd_skpd='$id' 
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS kd_rek,b.`lra` AS rek,b.nm_rek2 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=5 AND LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=5 AND kd_skpd='$id' 
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS kd_rek,b.`lra` AS rek,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=5 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=5 AND a.kd_skpd='$id'
					GROUP BY b.`lra`					
					ORDER BY kd_rek,nu ";
		}

			if ($cetak == '2' and $id=='1.20.06.00')
		{ 
		    $sql5 ="
			        SELECT LEFT(a.kd_rek5,1) AS kd_rek,b.`lra` AS rek,b.nm_rek1 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=5),0)
					AS debet,'0' AS kredit,'0' AS Realisasi,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=5 AND kd_skpd='1.20.06.00' 
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS kd_rek,b.`lra` AS rek,b.nm_rek2 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=5 AND LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=5 AND kd_skpd='1.20.06.00' 
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS kd_rek,b.`lra` AS rek,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=5 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=5 AND a.kd_skpd='1.20.06.00'
					GROUP BY b.`lra`					
					ORDER BY kd_rek,nu ";
		}



		$query5 = $this->db->query($sql5);
		//$query = $this->skpd_model->getAllc();

		foreach ($query5->result() as $row5)
		{
			$kode5 = $row5->rek;
			$nama5 = $row5->nm_rek;
			$ang5 = number_format($row5->nilai, "2", ".", ",");
			$angaran5 = $row5->nilai;
			$pen5 = $row5->cp;
			$debet5 = $row5->debet;
			$kredit5 = $row5->kredit;
			$real5 = $debet5 - $kredit5;
			$nreal5 = number_format($real5, "2", ".", ",");
			$real_s5 = $real5 - $angaran5;
			if ($real_s5 < 0)
			{
				$x1 = "(";
				$real_s5 = $real_s5 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisih5 = number_format($real_s5, "2", ".", ",");
			$per15 = ($real5 != 0) ? ($real5 / $row5->nilai) * 100 : 0;
			$persen15 = number_format($per15, "2", ".", ",");

        if(strlen($kode5) <='3')
		{
			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode5</b></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\"><b>$nama5</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$ang5</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nreal5</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$x1$pend_selisih5$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen15</b></td>
									
								</tr>";
		}else{
			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kode5</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama5</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$ang5</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nreal5</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$pend_selisih5$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen15</td>
									
								</tr>";
		}
	}	

		if ($cetak == '1')
		{
			$sqltb = "SELECT SUM(nilai) AS totb,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE LEFT(c.kd_rek5,1)='5' $sts)AS cp,
						(SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5_ang,1)='5' $jurnal)AS debet,
						(SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5_ang,1)='5' $jurnal)AS kredit  
						FROM trdrka WHERE LEFT(kd_rek5,1)='5' ";
		}
		if ($cetak == '2')
		{
			$sqltb = "
					SELECT SUM(nilai_ubah) AS totb,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=5),0)
					AS debet,'0' AS kredit,'0' AS Realisasi,'' AS cp
					FROM trdrka WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='$id'	
					";					
		}
		if ($cetak == '2' and $id=='1.20.06.00')
		{
			$sqltb = "
					SELECT SUM(nilai_ubah) AS totb,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=5),0)
					AS debet,'0' AS kredit,'0' AS Realisasi,'' AS cp
					FROM trdrka WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='1.20.06.00'	
					";					
		}
		$sqlb = $this->db->query($sqltb);
		foreach ($sqlb->result() as $rowb)
		{
			$angb = number_format($rowb->totb, "2", ".", ",");
			$angaranb = $rowb->totb;
			$penb = $rowb->cp;
			$debetb = $rowb->debet;
			$kreditb = $rowb->kredit;
			$realb = $debetb - $kreditb;
			$nrealb = number_format($realb, "2", ".", ",");
			$real_sb = $realb - $angaranb;
			if ($real_sb < 0)
			{
				$x1 = "(";
				$real_sb = $real_sb * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisihb = number_format($real_sb, "2", ".", ",");
			$per1b = ($realb != 0) ? ($realb / $rowb->totb) * 100 : 0;
			$persen1b = number_format($per1b, "2", ".", ",");

			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\" align=\"right\"><b>Jumlah Belanja</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$angb</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nrealb</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$x1$pend_selisihb$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1b</b></td>
								</tr>";
		}

		$suplus = $angaranp - $angaranb;

		if ($suplus < 0)
		{
			$s = "(";
			$suplus = $suplus * -1;
			$d = ")";
		} else
		{
			$s = "";
			$d = "";
		}
		$surp = number_format($suplus, 2, ',', '.');
		$suplusr = $realp - $realb;

		if ($suplusr < 0)
		{
			$j = "(";
			$suplusr = $suplusr * -1;
			$k = ")";
		} else
		{
			$j = "";
			$k = "";
		}
		$surpr = number_format($suplusr, 2, ',', '.');

		$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\" align=\"right\"><b>Surplus/Defisit</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$s$surp$d</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$j$surpr$k</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
								</tr>";
		if ($cetak == '1')
		{
			$sqlpm = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,1)= a.kd_rek1 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,1)=a.kd_rek1 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
						ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='6'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
						UNION ALL 
						SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,2)= a.kd_rek2 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='61'  GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,3)= a.kd_rek3 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='61'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
		}
		if ($cetak == '2')
		{
		    $sqlpm ="
			        SELECT LEFT(a.kd_rek5,1) AS kd_rek,b.`lra` AS rek,b.nm_rek1 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=6),0)
					AS kredit,'0' AS debet,'0' AS Realisasi,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=6 AND kd_skpd='$id' 
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS kd_rek,b.`lra` AS rek,b.nm_rek2 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,2)=61 AND LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS kredit,'0' AS debet,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,2)=61 AND kd_skpd='$id' 
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS kd_rek,b.`lra` AS rek,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,2)=61 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS kredit,'0' AS debet,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,2)=61 AND a.kd_skpd='$id'
					GROUP BY b.`lra`					
					ORDER BY kd_rek,nu ";
		}
		if ($cetak == '2' and $id=='1.20.06.00')
		{
		    $sqlpm ="
			        SELECT LEFT(a.kd_rek5,1) AS kd_rek,b.`lra` AS rek,b.nm_rek1 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=6),0)
					AS kredit,'0' AS debet,'0' AS Realisasi,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=6 AND kd_skpd='1.20.06.00' 
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS kd_rek,b.`lra` AS rek,b.nm_rek2 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,2)=61 AND LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS kredit,'0' AS debet,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,2)=61 AND kd_skpd='1.20.06.00' 
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS kd_rek,b.`lra` AS rek,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,2)=6 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS kredit,'0' AS debet,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,2)=61 AND a.kd_skpd='1.20.06.00'
					GROUP BY b.`lra`					
					ORDER BY kd_rek,nu ";
		}
		
		$query61 = $this->db->query($sqlpm);

		foreach ($query61->result() as $row61)
		{
			$kode61 = $row61->rek;
			$nama61 = $row61->nm_rek;
			$ang61 = number_format($row61->nilai, "2", ".", ",");
			$angaran61 = $row61->nilai;
			//echo($angaran61);
			$pen61 = $row61->cp;
			$debet61 = $row61->debet;
			$kredit61 = $row61->kredit;
			$real61 = $kredit61 - $debet61;
			$nreal61 = number_format($real61, "2", ".", ",");
			$real_s61 = $real61 - $angaran61;
			if ($real_s61 < 0)
			{
				$x1 = "(";
				$real_s61 = $real_s61 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisih61 = number_format($real_s61, "2", ".", ",");
			$per161 = ($real61 != 0) ? ($real61 / $row61->nilai) * 100 : 0;
			$persen161 = number_format($per161, "2", ".", ",");

        if(strlen($kode61) <='3')
		{
			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode61</b></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\"><b>$nama61</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$ang61</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nreal61</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$x1$pend_selisih61$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen161</b></td>
								</tr>";
		} else {
			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kode61</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama61</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$ang61</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nreal61</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$pend_selisih61$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen161</td>
								</tr>";
		
		}
	}

		if ($cetak == '1')
		{
			$sqltpm = "SELECT SUM(nilai) AS totpm,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE LEFT(c.kd_rek5,2)='61' $sts)AS cp,
						(SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5_ang,2)='61' $jurnal)AS debet,
						(SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5_ang,2)='61' $jurnal)AS kredit  
						FROM trdrka WHERE LEFT(kd_rek5,2)='61' ";
		}
		if ($cetak == '2')
		{

			$sqltpm  = "
					SELECT SUM(nilai_ubah) AS totpm,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,2)=61),0)
					AS kredit,'0' AS debet,'0' AS Realisasi,'' AS cp
					FROM trdrka WHERE LEFT(kd_rek5,2)='61' AND kd_skpd='$id'	
					";
		}
		$sqlpmasuk = $this->db->query($sqltpm);
		foreach ($sqlpmasuk->result() as $rowpm)
		{
			$angpm = number_format($rowpm->totpm, "2", ".", ",");
			$angaranpm = $rowpm->totpm;
			$penpm = $rowpm->cp;
			$debetpm = $rowpm->debet;
			$kreditpm = $rowpm->kredit;
			$realpm = $kreditpm - $debetpm;
			$nrealpm = number_format($realpm, "2", ".", ",");
			$real_spm = $realpm - $angaranpm;
			if ($real_spm < 0)
			{
				$x1 = "(";
				$real_spm = $real_spm * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisihpm = number_format($real_spm, "2", ".", ",");
			$per1pm = ($realpm != 0) ? ($realpm / $rowpm->totpm) * 100 : 0;
			$persen1pm = number_format($per1pm, "2", ".", ",");

			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\" align=\"right\"><b>Jumlah Pembiayaan masuk</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$angpm</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nrealpm</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$x1$pend_selisihpm$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1pm</b></td>
								</tr>";
		}
		if ($cetak == '1')
		{
			$sqlpk = "SELECT * FROM(SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,2)= a.kd_rek2 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='62'  GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,3)= a.kd_rek3 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='62'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3) a ORDER BY kd_rek";
		}
		if ($cetak == '2')
		{
			$sqlpk = "
					SELECT LEFT(a.kd_rek5,2) AS kd_rek,b.`lra` AS rek,b.nm_rek2 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,2)=62 AND LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS kredit,'0' AS debet,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,2)=62 AND kd_skpd='$id' 
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS kd_rek,b.`lra` AS rek,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,2)=62 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS kredit,'0' AS debet,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,2)=62 AND a.kd_skpd='$id'
					GROUP BY b.`lra`					
					ORDER BY kd_rek,nu ";
		}
		$query62 = $this->db->query($sqlpk);

		foreach ($query62->result() as $row62)
		{
			$kode62 = $row62->rek;
			$nama62 = $row62->nm_rek;
			$ang62 = number_format($row62->nilai, "2", ".", ",");
			$angaran62 = $row62->nilai;
			$pen62 = $row62->cp;
			$debet62 = $row62->debet;
			$kredit62 = $row62->kredit;
			$real62 = $kredit62 -$debet62;
			$nreal62 = number_format($real62, "2", ".", ",");
			$real_s62 = $real62 - $angaran62;
			if ($real_s62 < 0)
			{
				$x1 = "(";
				$real_s62 = $real_s62 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisih62 = number_format($real_s62, "2", ".", ",");
			$per162 = ($real62 != 0) ? ($real62 / $row62->nilai) * 100 : 0;
			$persen162 = number_format($per162, "2", ".", ",");

			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kode62</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama62</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$ang62</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nreal62</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$pend_selisih62$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen162</td>
								</tr>";
		}

		if ($cetak == '1')
		{
			$sqltpk = "SELECT SUM(nilai) AS totpk,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE LEFT(c.kd_rek5,2)='62' $sts)AS cp,
						(SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5_ang,2)='62' $jurnal)AS debet,
						(SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5_ang,2)='62' $jurnal)AS kredit  
						FROM trdrka WHERE LEFT(kd_rek5,2)='62' ";
		}
		if ($cetak == '2')
		{
			$sqltpk  = "
					SELECT SUM(nilai_ubah) AS totpk,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,2)=62),0)
					AS kredit,'0' AS debet,'0' AS Realisasi,'' AS cp
					FROM trdrka WHERE LEFT(kd_rek5,2)='62' AND kd_skpd='$id'	
					";
		}
		$sqlpkeluar = $this->db->query($sqltpk);
		foreach ($sqlpkeluar->result() as $rowpk)
		{
			$angpk = number_format($rowpk->totpk, "2", ".", ",");
			$angaranpk = $rowpk->totpk;
			$penpk = $rowpk->cp;
			$debetpk = $rowpk->debet;
			$kreditpk = $rowpk->kredit;
			$realpk =  $kreditpk - $debetpk;
			$nrealpk = number_format($realpm, "2", ".", ",");
			$real_spk = $realpk - $angaranpk;
			if ($real_spk < 0)
			{
				$x1 = "(";
				$real_spk = $real_spk * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisihpk = number_format($real_spk, "2", ".", ",");
			$per1pk = ($realpk != 0) ? ($realpk / $rowpk->totpk) * 100 : 0;
			$persen1pk = number_format($per1pk, "2", ".", ",");

			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\" align=\"right\"><b>Jumlah Pembiayaan Keluar</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$angpk</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nrealpk</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$x1$pend_selisihpk$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1pk</b></td>
								</tr>";
		}
		//echo($angaran62);
		$netto = $angaranpm - $angaranpk;
		$net = number_format($netto, 2, ',', '.');
		if ($netto < 0)
		{
			$x4 = "(";
			$netto = $netto * -1;
			$y4 = ")";
		} else
		{
			$x4 = "";
			$y4 = "";
		}

		$nettor = $realpm - $realpk;
		$netr = number_format($nettor, 2, ',', '.');
		if ($nettor < 0)
		{
			$x5 = "(";
			$nettor = $nettor * -1;
			$y5 = ")";
		} else
		{
			$x5 = "";
			$y5 = "";
		}

		$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\" align=\"right\"><b>Pembiayaan Netto</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$x4$net$y4</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$x5$netr$y5</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
								</tr>";
								
		$silpa = ($angaranp + $angaranpm) - ($angaranpk + $angaranb);
		if ($silpa < 0)
		{
			$c = "(";
			$silpa = $silpa * -1;
			$d = ")";
		} else
		{
			$c = "";
			$d = "";
		}
		$silp = number_format($silpa, 2, ',', '.');
		$silpar = ($realp + $realpm) - ($realb + $realpk);
		if ($silpar < 0)
		{
			$c1 = "(";
			$silpar = $silpar * -1;
			$d1 = ")";
		} else
		{
			$c1 = "";
			$d1 = "";
		}
		$silpr = number_format($silpar, 2, ',', '.');

		$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\" align=\"right\"><b>SILPA</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$c$silp$d</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$c1$silpr$d1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
								</tr>";

		$cRet .= "</table>";
		
		$data['prev'] = $cRet;
		$data['sikap'] = 'preview';
		$this->template->set('title', 'CETAK PERDA REALISASI SEMESTER LAMPIRAN I');
		$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
	}
	

	function cetak_perda1_semester($lap = '', $ctk = '', $skpd = '')
	{
		$id = $skpd;
		$cetak = $ctk;
		$laporan = $lap;

		if ($laporan <> '2')
		{
			$sts = '';
			$jurnal = '';
		} else
		{
			$sts = "AND MONTH(d.tgl_sts)<='6'";
			$jurnal = "AND MONTH(d.tgl_voucher)<='6'";

		}
		$sqldns = "SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
		$sqlskpd = $this->db->query($sqldns);
		foreach ($sqlskpd->result() as $rowdns)
		{
			$kd_urusan = $rowdns->kd_u;
			$nm_urusan = $rowdns->nm_u;
			$kd_skpd = $rowdns->kd_sk;
			$nm_skpd = $rowdns->nm_sk;
		}

		$sqlttd1 = "SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$id' and kode='PA'";
		$sqlttd = $this->db->query($sqlttd1);
		foreach ($sqlttd->result() as $rowttd)
		{
			$nip = $rowttd->nip;
			$nama = $rowttd->nm;
			$jabatan = $rowttd->jab;
		}

		$sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
		$sqlsclient = $this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc)
		{

			$tgl = $rowsc->tgl_rka;
			$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
			$kab = $rowsc->kab_kota;
			$daerah = $rowsc->daerah;
			$thn = $rowsc->thn_ang;
		}

		$jk = $this->rka_model->combo_skpd();

		$cRet = '';

		if ($cetak == '2')
		{
			$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td rowspan=\"3\" align=\"left\" width=\"55%\"><strong></strong></td>
						<td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"15%\"><strong><h5>LAMPIRAN I  :</h6></strong></td>
						<td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>PERATURAN DAERAH</strong></h5></td>
					</tr>
					<tr> 
						<td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>:</h5></td>
					</tr>
					<tr>
						<td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>:</h5></td>
					</tr>									
				
				</table>";
		}

		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td align=\"center\"><strong>$kab</strong></td>						
					</tr>
					<tr>
						<td align=\"center\"><strong>RINGKASAN REALISASI APBD SEMESTER I </strong></td>
					</tr>					
					<tr>
						<td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
					</tr>
					<tr>
						<td align=\"center\">&nbsp;</td>
					</tr>
				</table>";
		if ($cetak == '2')
		{
			$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
						<tr>
							<td width=\"20%\">Urusan Organisasi </td>
							<td width=\"80%\">: $kd_urusan - $nm_urusan</td>
						</tr>
						<tr>
							<td>Organisasi</td>
							<td>: $kd_skpd - $nm_skpd </td>
						</tr>
					
					</table>";
		}

		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
					<thead>					
						<tr><td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NOMOR URUT</b></td>							
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\" colspan=\"2\" ><b>JUMLAH (Rp.)</b></td>
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>PROGNOSIS</b></td>
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>   
						</tr>
						<tr >
							<td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Anggaran</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Realisasi</b></td>							
						</tr>  
					</thead>
					<tfoot>
						<tr>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>						
						</tr>
					</tfoot>
				
					<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>							
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
						</tr>";


		if ($cetak == '1')
		{
			$sql4 = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,1)= a.kd_rek1 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,1)=a.kd_rek1 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
						ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='4'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
						UNION ALL 
						SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,2)= a.kd_rek2 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='4'  GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,3)= a.kd_rek3 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='4'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
		}
		if ($cetak == '2')
		{
			$sql4 = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_ppkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5`,1)=a.kd_rek1 AND c.no_sts  IN(SELECT no_sts FROM trhkasin_ppkd  WHERE kd_skpd='$id'))AS realisasi,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5`,1)=a.kd_rek1 AND c.no_sts  IN(SELECT no_sts FROM trhkasin_pkd  WHERE kd_skpd='$id'))AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5_ang`,1)=a.kd_rek1 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c WHERE c.kd_skpd='$id' AND LEFT(c.`kd_rek5_ang`,1)=a.kd_rek1 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS kredit FROM ms_rek1 a INNER JOIN trdrka b
						ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='4' AND b.kd_skpd='$id' GROUP BY a.kd_rek1,a.lra, a.nm_rek1
						UNION ALL 
						SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_ppkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5`,2)=a.kd_rek2 AND c.no_sts  IN(SELECT no_sts FROM trhkasin_ppkd  WHERE kd_skpd='$id'))AS realisasi,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5`,2)=a.kd_rek2 AND c.no_sts  IN(SELECT no_sts FROM trhkasin_pkd  WHERE kd_skpd='$id'))AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5_ang`,2)=a.kd_rek2 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c WHERE c.kd_skpd='$id' AND LEFT(c.`kd_rek5_ang`,2)=a.kd_rek2 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS kredit FROM ms_rek2 a INNER JOIN trdrka b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='4' AND b.kd_skpd='$id' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_ppkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5`,3)=a.kd_rek3 AND c.no_sts  IN(SELECT no_sts FROM trhkasin_ppkd  WHERE kd_skpd='$id'))AS realisasi,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5`,3)=a.kd_rek3 AND c.no_sts  IN(SELECT no_sts FROM trhkasin_pkd  WHERE kd_skpd='$id'))AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5_ang`,3)=a.kd_rek3 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c WHERE c.kd_skpd='$id' AND LEFT(c.`kd_rek5_ang`,3)=a.kd_rek3 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS kredit FROM ms_rek3 a INNER JOIN trdrka b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='4' AND b.kd_skpd='$id' GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek ";
		}

		$query4 = $this->db->query($sql4);
		//$query = $this->skpd_model->getAllc();

		foreach ($query4->result() as $row4)
		{
			$kode = $row4->rek;
			$nama = $row4->nm_rek;
			$ang = number_format($row4->nilai, "2", ".", ",");
			$angaran = $row4->nilai;
			$realisasi = $row4->realisasi;
			$pen = $row4->cp;
			$debet = $row4->debet;
			$kredit = $row4->kredit;
			$real = ($realisasi+$pen + $kredit) - $debet;
			$nreal = number_format($real, "2", ".", ",");
			$real_s = $real - $angaran;
			if ($real_s < 0)
			{
				$x1 = "(";
				$real_s = $real_s * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisih = number_format($real_s, "2", ".", ",");
			$per1 = ($real != 0) ? ($real / $row4->nilai) * 100 : 0;
			$persen1 = number_format($per1, "2", ".", ",");
		if(strlen($kode)<=3)
		{
			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode</b></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\"><b>$nama</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$ang</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nreal</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$pend_selisih</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1</b></td>
								</tr>";
		}else{
			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kode</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$ang</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nreal</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$pend_selisih</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
								</tr>";
		}
	}
		if ($cetak == '1')
		{
			$sqltp = "SELECT SUM(nilai) AS totp,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE LEFT(c.kd_rek5,1)='4' $sts)AS cp,
						(SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5_ang,1)='4' $jurnal)AS debet,
						(SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5_ang,1)='4' $jurnal)AS kredit  
						FROM trdrka WHERE LEFT(kd_rek5,1)='4' ";
		}
		if ($cetak == '2')
		{
			$sqltp = "SELECT SUM(nilai_ubah) AS totp,
						(SELECT SUM(rupiah)FROM trdkasin_ppkd c WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,1)='4')AS realisasi,
						(SELECT SUM(rupiah)FROM trdkasin_pkd c WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,1)='4')AS cp,
						(SELECT SUM(debet)FROM trdju_pkd c WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5_ang,1)='4' )AS debet,
						(SELECT SUM(kredit)FROM trdju_pkd c  WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5_ang,1)='4' )AS kredit  
						FROM trdrka WHERE LEFT(kd_rek5,1)='4' AND kd_skpd='$id'";
		}
		$sqlp = $this->db->query($sqltp);
		foreach ($sqlp->result() as $rowp)
		{
			$angp = number_format($rowp->totp, "2", ".", ",");
			$angaranp = $rowp->totp;
			$penp = $rowp->cp;
			$realisasi =$rowp->realisasi;
			$debetp = $rowp->debet;
			$kreditp = $rowp->kredit;
			$realp = ($realisasi+$penp + $kreditp) - $debetp;
			$nrealp = number_format($realp, "2", ".", ",");
			$real_sp = $realp - $angaranp;
			if ($real_sp < 0)
			{
				$x1 = "(";
				$real_sp = $real_sp * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisihp = number_format($real_sp, "2", ".", ",");
			$per1p = ($realp != 0) ? ($realp / $rowp->totp) * 100 : 0;
			$persen1p = number_format($per1p, "2", ".", ",");

			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">Jumlah Pendapatan</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angp</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nrealp</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$pend_selisihp</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1p</td>
								</tr>";
		}

		if ($cetak == '1')
		{
			$sql5 = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,1)= a.kd_rek1 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,1)=a.kd_rek1 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
						ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='5'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
						UNION ALL 
						SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,2)= a.kd_rek2 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='5'  GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,3)= a.kd_rek3 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='5'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
		}
		if ($cetak == '2')
		{
			$sql5 = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_ppkd c INNER JOIN trhkasin_ppkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(kd_rek5,1)= a.kd_rek1)AS realisasi,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(kd_rek5,1)= a.kd_rek1)AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5_ang`,1)=a.kd_rek1 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c WHERE c.kd_skpd='$id' AND LEFT(c.`kd_rek5_ang`,1)=a.kd_rek1 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS kredit FROM ms_rek1 a INNER JOIN trdrka b
						ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='5' AND b.kd_skpd='$id' GROUP BY a.kd_rek1,a.lra, a.nm_rek1
						UNION ALL 
						SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_ppkd c INNER JOIN trhkasin_ppkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(kd_rek5,1)= a.kd_rek2)AS realisasi,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(kd_rek5,1)= a.kd_rek2)AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5_ang`,2)=a.kd_rek2 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c WHERE c.kd_skpd='$id' AND LEFT(c.`kd_rek5_ang`,2)=a.kd_rek2 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS kredit FROM ms_rek2 a INNER JOIN trdrka b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='5' AND b.kd_skpd='$id' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_ppkd c INNER JOIN trhkasin_ppkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(kd_rek5,1)= a.kd_rek3)AS realisasi,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE d.kd_skpd='$id' AND LEFT(kd_rek5,1)= a.kd_rek3)AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5_ang`,3)=a.kd_rek3 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c WHERE c.kd_skpd='$id' AND LEFT(c.`kd_rek5_ang`,3)=a.kd_rek3 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS kredit FROM ms_rek3 a INNER JOIN trdrka b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='5' AND b.kd_skpd='$id' GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek ";
		}


		$query5 = $this->db->query($sql5);
		//$query = $this->skpd_model->getAllc();

		foreach ($query5->result() as $row5)
		{
			$kode5 = $row5->rek;
			$nama5 = $row5->nm_rek;
			$ang5 = number_format($row5->nilai, "2", ".", ",");
			$angaran5 = $row5->nilai;
			$pen5 = $row5->cp;
			$debet5 = $row5->debet;
			$kredit5 = $row5->kredit;
			$real5 = $debet5 - ($pen5 + $kredit5);
			$nreal5 = number_format($real5, "2", ".", ",");
			$real_s5 = $real5 - $angaran5;
			if ($real_s5 < 0)
			{
				$x1 = "(";
				$real_s5 = $real_s5 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisih5 = number_format($real_s5, "2", ".", ",");
			$per15 = ($real5 != 0) ? ($real5 / $row5->nilai) * 100 : 0;
			$persen15 = number_format($per15, "2", ".", ",");
		if(strlen($kode5)<=3)
		{
			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode5</b></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\"><b>$nama5</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$ang5</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$nreal5</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"><b>$pend_selisih5</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen15</b></td>
									
								</tr>";
		}else{
			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kode5</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama5</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$ang5</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nreal5</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$pend_selisih5</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen15</td>
									
								</tr>";
		}
	 }

		if ($cetak == '1')
		{
			$sqltb = "SELECT SUM(nilai) AS totb,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE LEFT(c.kd_rek5,1)='5' $sts)AS cp,
						(SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5_ang,1)='5' $jurnal)AS debet,
						(SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5_ang,1)='5' $jurnal)AS kredit  
						FROM trdrka WHERE LEFT(kd_rek5,1)='5' ";
		}
		if ($cetak == '2')
		{
			$sqltb = "SELECT SUM(nilai_ubah) AS totb,
						(SELECT SUM(rupiah)FROM trdkasin_ppkd c WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,1)='5')AS realisasi,
						(SELECT SUM(rupiah)FROM trdkasin_pkd c WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,1)='5')AS cp,
						(SELECT SUM(debet)FROM trdju_pkd c WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5_ang,1)='5' )AS debet,
						(SELECT SUM(kredit)FROM trdju_pkd c  WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5_ang,1)='5' )AS kredit  
						FROM trdrka WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='$id'";
		}
		$sqlb = $this->db->query($sqltb);
		foreach ($sqlb->result() as $rowb)
		{
			$angb = number_format($rowb->totb, "2", ".", ",");
			$angaranb = $rowb->totb;
			$penb = $rowb->cp;
			$debetb = $rowb->debet;
			$kreditb = $rowb->kredit;
			$realb = $debetb - ($penb + $kreditb);
			$nrealb = number_format($realb, "2", ".", ",");
			$real_sb = $realb - $angaranb;
			if ($real_sb < 0)
			{
				$x1 = "(";
				$real_sb = $real_sb * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisihb = number_format($real_sb, "2", ".", ",");
			$per1b = ($realb != 0) ? ($realb / $rowb->totb) * 100 : 0;
			$persen1b = number_format($per1b, "2", ".", ",");

			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">Jumlah Belanja</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angb</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nrealb</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$pend_selisihb</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1b</td>
								</tr>";
		}

		$suplus = $angaranp - $angaranb;

		if ($suplus < 0)
		{
			$s = "(";
			$suplus = $suplus * -1;
			$d = ")";
		} else
		{
			$s = "";
			$d = "";
		}
		$surp = number_format($suplus, 2, ',', '.');
		$suplusr = $realp - $realb;

		if ($suplusr < 0)
		{
			$j = "(";
			$suplusr = $suplusr * -1;
			$k = ")";
		} else
		{
			$j = "";
			$k = "";
		}
		$surpr = number_format($suplusr, 2, ',', '.');

		$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">Surplus/Defisit</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$s$surp$d</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$j$surpr$k</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
								</tr>";
		if ($cetak == '1')
		{
			$sqlpm = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,1)= a.kd_rek1 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,1)=a.kd_rek1 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,1)=a.kd_rek1 $jurnal)AS kredit FROM ms_rek1 a INNER JOIN trdrka b
						ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='6'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
						UNION ALL 
						SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,2)= a.kd_rek2 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='61'  GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,3)= a.kd_rek3 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='61'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek";
		}
		if ($cetak == '2')
		{
			$sqlpm = "SELECT * FROM(SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_ppkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5`,1)=a.kd_rek1 AND c.no_sts  IN(SELECT no_sts FROM trhkasin_ppkd  WHERE kd_skpd='$id'))AS realisasi,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5`,1)=a.kd_rek1 AND c.no_sts  IN(SELECT no_sts FROM trhkasin_pkd  WHERE kd_skpd='$id'))AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5_ang`,1)=a.kd_rek1 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c WHERE c.kd_skpd='$id' AND LEFT(c.`kd_rek5_ang`,1)=a.kd_rek1 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS kredit FROM ms_rek1 a INNER JOIN trdrka b
						ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='6' AND b.kd_skpd='$id' GROUP BY a.kd_rek1,a.lra, a.nm_rek1
						UNION ALL 
						SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_ppkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5`,2)=a.kd_rek2 AND c.no_sts  IN(SELECT no_sts FROM trhkasin_ppkd  WHERE kd_skpd='$id'))AS realisasi,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5`,2)=a.kd_rek2 AND c.no_sts  IN(SELECT no_sts FROM trhkasin_pkd  WHERE kd_skpd='$id'))AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5_ang`,2)=a.kd_rek2 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c WHERE c.kd_skpd='$id' AND LEFT(c.`kd_rek5_ang`,2)=a.kd_rek2 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS kredit FROM ms_rek2 a INNER JOIN trdrka b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='61' AND b.kd_skpd='$id' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_ppkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5`,3)=a.kd_rek3 AND c.no_sts  IN(SELECT no_sts FROM trhkasin_ppkd  WHERE kd_skpd='$id'))AS realisasi,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5`,3)=a.kd_rek3 AND c.no_sts  IN(SELECT no_sts FROM trhkasin_pkd  WHERE kd_skpd='$id'))AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5_ang`,3)=a.kd_rek3 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c WHERE c.kd_skpd='$id' AND LEFT(c.`kd_rek5_ang`,3)=a.kd_rek3 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS kredit FROM ms_rek3 a INNER JOIN trdrka b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='61' AND b.kd_skpd='$id' GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek ";
		}
		$query61 = $this->db->query($sqlpm);

		foreach ($query61->result() as $row61)
		{
			$kode61 = $row61->rek;
			$nama61 = $row61->nm_rek;
			$ang61 = number_format($row61->nilai, "2", ".", ",");
			$angaran61 = $row61->nilai;
			//echo($angaran61);
			$pen61 = $row61->cp;
			$debet61 = $row61->debet;
			$kredit61 = $row61->kredit;
			$real61 = ($realisasi+$pen61 + $kredit61) - $debet61;
			$nreal61 = number_format($real61, "2", ".", ",");
			$real_s61 = $real61 - $angaran61;
			if ($real_s61 < 0)
			{
				$x1 = "(";
				$real_s61 = $real_s61 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisih61 = number_format($real_s61, "2", ".", ",");
			$per161 = ($real61 != 0) ? ($real61 / $row61->nilai) * 100 : 0;
			$persen161 = number_format($per161, "2", ".", ",");

			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kode61</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama61</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$ang61</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nreal61</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$pend_selisih61</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen161</td>
								</tr>";
		}

		if ($cetak == '1')
		{
			$sqltpm = "SELECT SUM(nilai) AS totpm,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE LEFT(c.kd_rek5,2)='61' $sts)AS cp,
						(SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5_ang,2)='61' $jurnal)AS debet,
						(SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5_ang,2)='61' $jurnal)AS kredit  
						FROM trdrka WHERE LEFT(kd_rek5,2)='61' ";
		}
		if ($cetak == '2')
		{
			$sqltpm = "SELECT SUM(nilai_ubah) AS totpm,
						(SELECT SUM(rupiah)FROM trdkasin_ppkd c WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,2)='61')AS realisasi,
						(SELECT SUM(rupiah)FROM trdkasin_pkd c WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,2)='61')AS cp,
						(SELECT SUM(debet)FROM trdju_pkd c WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5_ang,2)='61' )AS debet,
						(SELECT SUM(kredit)FROM trdju_pkd c  WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5_ang,2)='61' )AS kredit  
						FROM trdrka WHERE LEFT(kd_rek5,2)='61' AND kd_skpd='$id'";
		}
		$sqlpmasuk = $this->db->query($sqltpm);
		foreach ($sqlpmasuk->result() as $rowpm)
		{
			$angpm = number_format($rowpm->totpm, "2", ".", ",");
			$angaranpm = $rowpm->totpm;
			$penpm = $rowpm->cp;
			$debetpm = $rowpm->debet;
			$kreditpm = $rowpm->kredit;
			$realpm = ($penpm + $kreditpm) - $debetpm;
			$nrealpm = number_format($realpm, "2", ".", ",");
			$real_spm = $realpm - $angaranpm;
			if ($real_spm < 0)
			{
				$x1 = "(";
				$real_spm = $real_spm * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisihpm = number_format($real_spm, "2", ".", ",");
			$per1pm = ($realpm != 0) ? ($realpm / $rowpm->totpm) * 100 : 0;
			$persen1pm = number_format($per1pm, "2", ".", ",");

			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">Jumlah Pembiayaan masuk</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angpm</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nrealpm</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$pend_selisihpm</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1pm</td>
								</tr>";
		}
		if ($cetak == '1')
		{
			$sqlpk = "SELECT * FROM(SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,2)= a.kd_rek2 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,2)=a.kd_rek2 $jurnal)AS kredit FROM ms_rek2 a INNER JOIN trdrka b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='62'  GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts  WHERE  LEFT(c.kd_rek5,3)= a.kd_rek3 $sts) AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher  WHERE  LEFT(c.kd_rek5_ang,3)=a.kd_rek3 $jurnal)AS kredit FROM ms_rek3 a INNER JOIN trdrka b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='62'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3) a ORDER BY kd_rek";
		}
		if ($cetak == '2')
		{
			$sqlpk = "SELECT * FROM(
						SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_ppkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5`,2)=a.kd_rek2 AND c.no_sts  IN(SELECT no_sts FROM trhkasin_ppkd  WHERE kd_skpd='$id'))AS realisasi,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5`,2)=a.kd_rek2 AND c.no_sts  IN(SELECT no_sts FROM trhkasin_pkd  WHERE kd_skpd='$id'))AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5_ang`,2)=a.kd_rek2 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c WHERE c.kd_skpd='$id' AND LEFT(c.`kd_rek5_ang`,2)=a.kd_rek2 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS kredit FROM ms_rek2 a INNER JOIN trdrka b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='62' AND b.kd_skpd='$id' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,
						(SELECT SUM(rupiah) FROM trdkasin_ppkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5`,3)=a.kd_rek3 AND c.no_sts  IN(SELECT no_sts FROM trhkasin_ppkd  WHERE kd_skpd='$id'))AS realisasi,
						(SELECT SUM(rupiah) FROM trdkasin_pkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5`,3)=a.kd_rek3 AND c.no_sts  IN(SELECT no_sts FROM trhkasin_pkd  WHERE kd_skpd='$id'))AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c WHERE c.kd_skpd='$id'  AND LEFT(c.`kd_rek5_ang`,3)=a.kd_rek3 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd c WHERE c.kd_skpd='$id' AND LEFT(c.`kd_rek5_ang`,3)=a.kd_rek3 AND c.no_voucher  IN(SELECT no_voucher FROM trhju_pkd  WHERE kd_skpd='$id'))AS kredit FROM ms_rek3 a INNER JOIN trdrka b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='62' AND b.kd_skpd='$id' GROUP BY a.kd_rek3,a.lra, a.nm_rek3)a ORDER BY kd_rek ";
		}
		$query62 = $this->db->query($sqlpk);

		foreach ($query62->result() as $row62)
		{
			$kode62 = $row62->rek;
			$nama62 = $row62->nm_rek;
			$ang62 = number_format($row62->nilai, "2", ".", ",");
			$angaran62 = $row62->nilai;
			$pen62 = $row62->cp;
			$reali	= $row62->realisasi;
			$debet62 = $row62->debet;
			$kredit62 = $row62->kredit;
			$real62 = $debet62 - ($reali+$pen62+$kredit62);
			$nreal62 = number_format($real62, "2", ".", ",");
			$real_s62 = $real62 - $angaran62;
			if ($real_s62 < 0)
			{
				$x1 = "(";
				$real_s62 = $real_s62 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisih62 = number_format($real_s62, "2", ".", ",");
			$per162 = ($real62 != 0) ? ($real62 / $row62->nilai) * 100 : 0;
			$persen162 = number_format($per162, "2", ".", ",");

			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kode62</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama62</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$ang62</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nreal62</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$pend_selisih62</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen162</td>
								</tr>";
		}

		if ($cetak == '1')
		{
			$sqltpk = "SELECT SUM(nilai) AS totpk,(SELECT SUM(rupiah)FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts=d.no_sts WHERE LEFT(c.kd_rek5,2)='62' $sts)AS cp,
						(SELECT SUM(debet)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5_ang,2)='62' $jurnal)AS debet,
						(SELECT SUM(kredit)FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher=d.no_voucher WHERE  LEFT(c.kd_rek5_ang,2)='62' $jurnal)AS kredit  
						FROM trdrka WHERE LEFT(kd_rek5,2)='62' ";
		}
		if ($cetak == '2')
		{
			$sqltpk = "SELECT SUM(nilai_ubah) AS totpk,
						(SELECT SUM(rupiah)FROM trdkasin_ppkd c WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,2)='62')AS realisasi,
						(SELECT SUM(rupiah)FROM trdkasin_pkd c WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,2)='62')AS cp,
						(SELECT SUM(debet)FROM trdju_pkd c WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5_ang,2)='62' )AS debet,
						(SELECT SUM(kredit)FROM trdju_pkd c  WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5_ang,2)='62' )AS kredit  
						FROM trdrka WHERE LEFT(kd_rek5,2)='62' AND kd_skpd='$id'";
		}
		$sqlpkeluar = $this->db->query($sqltpk);
		foreach ($sqlpkeluar->result() as $rowpk)
		{
			$angpk = number_format($rowpk->totpk, "2", ".", ",");
			$angaranpk = $rowpk->totpk;
			$penpk = $rowpk->cp;
			$realisasi= $rowpk->realisasi;
			$debetpk = $rowpk->debet;
			$kreditpk = $rowpk->kredit;
			$realpk = ($penpk + $kreditpk) - $debetpk;
			$nrealpk = number_format($realpm, "2", ".", ",");
			$real_spk = $realpk - $angaranpk;
			if ($real_spk < 0)
			{
				$x1 = "(";
				$real_spk = $real_spk * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisihpk = number_format($real_spk, "2", ".", ",");
			$per1pk = ($realpk != 0) ? ($realpk / $rowpk->totpk) * 100 : 0;
			$persen1pk = number_format($per1pk, "2", ".", ",");

			$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">Jumlah Pembiayaan Keluar</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angpk</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nrealpk</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$pend_selisihpk</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1pk</td>
								</tr>";
		}
		//echo($angaran62);
		$netto = $angaranpm - $angaranpk;
		$net = number_format($netto, 2, ',', '.');
		if ($netto < 0)
		{
			$x4 = "(";
			$netto = $netto * -1;
			$y4 = ")";
		} else
		{
			$x4 = "";
			$y4 = "";
		}

		$nettor = $realpm - $realpk;
		$netr = number_format($nettor, 2, ',', '.');
		if ($nettor < 0)
		{
			$x5 = "(";
			$nettor = $nettor * -1;
			$y5 = ")";
		} else
		{
			$x5 = "";
			$y5 = "";
		}

		$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">Pembiayaan Netto</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$x4$net$y4</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$x5$netr$y5</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
								</tr>";
		$silpa = ($angaranp + $angaranpm) - ($angaranpk + $angaranb);
		if ($silpa < 0)
		{
			$c = "(";
			$silpa = $silpa * -1;
			$d = ")";
		} else
		{
			$c = "";
			$d = "";
		}
		$silp = number_format($silpa, 2, ',', '.');
		$silpar = ($realp + $realpm) - ($realb + $realpk);
		if ($silpar < 0)
		{
			$c1 = "(";
			$silpar = $silpar * -1;
			$d1 = ")";
		} else
		{
			$c1 = "";
			$d1 = "";
		}
		$silpr = number_format($silpar, 2, ',', '.');

		$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\"><b>SILPA</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$c$silp$d</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"><b>$c1$silpr$d1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
								</tr>";

		$cRet .= "</table>";
		$data['prev'] = $cRet;
		$data['sikap'] = 'preview';


		$this->template->set('title', 'CETAK PERDA REALISASI SEMESTER LAMPIRAN I');
		$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
		//$this->template->load('template','anggaran/rka/perkadaII',$data);
	}

	function rpt_lra_ppkd(){
		$cetak		= $_REQUEST['cetak'];
		$mapping	= $_REQUEST['mapping'];
		$periode	= $_REQUEST['periode'];
		if(!$periode){
			$periode	= date('Y-m-d');
		}else{
			$periode	= $periode;
		}
		$ppkd		= 'PPKD';
		$kdskpd		= '1.20.06.00';
		$nmskpd		= $this->tukd_model->get_nama($kdskpd,'nm_skpd','ms_skpd','kd_skpd');
		$thi		= $this->session->userdata('pcThang');
		$thl		= $thi-1;
		$kab_kota	= $this->akuntansi_model->get_sclient('kab_kota');

		$this->db->query("DROP TABLE IF EXISTS realisasi_akt");
		$this->db->query("DROP TABLE IF EXISTS the_real_akt");
		$this->db->query("DROP TABLE IF EXISTS the_real_ang");
		$qry	= "	select '$periode' periode,'PPKD'kd_skpd,a.nm_skpd,kd_rek5,nm_rek5,
					sum(if(year(tgl_voucher)='$thi',(if(left(kd_rek5,1)in(1,5,6,9) or left(kd_rek5,2)in(72),debet-kredit,kredit-debet)),0))Nilai,
					sum(if(year(tgl_voucher)='$thl',(if(left(kd_rek5,1)in(1,5,6,9) or left(kd_rek5,2)in(72),debet-kredit,kredit-debet)),0))Lalu
					from trhju_ppkd a join trdju_ppkd b on a.kd_skpd=b.kd_skpd and left(kd_rek5,1) in(4,5,6,7)
					and a.no_voucher=b.no_voucher and a.tgl_voucher<='$periode'
					GROUP BY kd_rek5 ";

		if($mapping=='true'){
			$sql	= "	CREATE TEMPORARY TABLE realisasi_akt (
						`periode`  varchar(255) ,
						`kd_skpd`  varchar(255) ,
						`nm_skpd`  varchar(255) ,
						`kd_rek5`  varchar(255) ,
						`nm_rek5`  varchar(255) ,
						`nilai`  decimal(20,2) NULL DEFAULT NULL ,
						`lalu`  decimal(20,2) NULL DEFAULT NULL ,
						INDEX `id_akt` (`periode`, `kd_skpd`, `kd_rek5`) USING BTREE 
						) ENGINE=InnoDB DEFAULT CHARACTER SET=latin1 COLLATE=latin1_swedish_ci ROW_FORMAT=COMPACT";
			$del_exec	= $this->db->query($sql);
			if($del_exec){
				$ins_exec	= $this->db->query("insert into realisasi_akt (periode,kd_skpd,nm_skpd,kd_rek5,nm_rek5,nilai,lalu) ".$qry);
				
				$a0	= $this->db->query("CREATE TEMPORARY TABLE the_real_akt (kode varchar(10),Rupiah decimal(20,2),Lalu decimal(20,2) )");
				if($a0){
					$a1	= $this->db->query("insert into the_real_akt select left(kd_rek5,1),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
				if($a1){
					$a2	= $this->db->query("insert into the_real_akt select left(kd_rek5,2),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
				if($a2){
					$a3	= $this->db->query("insert into the_real_akt select left(kd_rek5,3),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
				if($a3){
					$a4	= $this->db->query("insert into the_real_akt select left(kd_rek5,5),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
				if($a4){
					$a5	= $this->db->query("insert into the_real_akt select left(kd_rek5,8),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}

				$Q_ang	= $this->db->query("CREATE TEMPORARY TABLE the_real_ang (kode varchar(10),anggaran decimal(20,2))");
				if($Q_ang){
					$sql	= " insert into the_real_ang
								select left(kd_rek64,8)kode,sum(nilai_ubah)anggaran from trdrka a join ms_rek5 b on kd_skpd='$kdskpd' and a.kd_rek5=b.kd_rek5 group by left(kd_rek64,8) union 
								select left(kd_rek64,5)kode,sum(nilai_ubah)anggaran from trdrka a join ms_rek5 b on kd_skpd='$kdskpd' and a.kd_rek5=b.kd_rek5 group by left(kd_rek64,5) union 
								select left(kd_rek64,3)kode,sum(nilai_ubah)anggaran from trdrka a join ms_rek5 b on kd_skpd='$kdskpd' and a.kd_rek5=b.kd_rek5 group by left(kd_rek64,3) union 
								select left(kd_rek64,2)kode,sum(nilai_ubah)anggaran from trdrka a join ms_rek5 b on kd_skpd='$kdskpd' and a.kd_rek5=b.kd_rek5 group by left(kd_rek64,2) union 
								select left(kd_rek64,1)kode,sum(nilai_ubah)anggaran from trdrka a join ms_rek5 b on kd_skpd='$kdskpd' and a.kd_rek5=b.kd_rek5 group by left(kd_rek64,1)
							";
					$this->db->query($sql);
				}
			}
		}

		$cRet ='<TABLE width="100%">
					<tr>
						<td align="center" style="font-size:12px"><b> '.$kab_kota.'</b></TD>
					</tr>
					<tr>
						<td align="center" style="font-size:15px"><b>LAPORAN REALISASI ANGGARAN</b></TD>
					</tr>
					<tr>
						<td align="center" style="font-size:15px"><b>PPKD</b></TD>
					</tr>
					<tr>
						<td align="center" style="font-size:12px"><b>Untuk Tahun Yang Berakhir Sampai Dengan '.strtoupper($this->tukd_model->tanggal_format_indonesia($periode)).' dan '.$thl.'<b></TD>
					</tr>
					</TABLE><br>';


		$cRet .= '<table style="border-collapse:collapse;font-size:12px" width="100%" align="center" border="1" cellspacing="1" cellpadding="0">
					<thead>
					<tr>
						<td align="center" width="5%" bgcolor="#cccccc" ><b>No.</b></TD>
						<td align="center" width="50%" bgcolor="#cccccc"><b>URAIAN</b></TD>
						<td align="center" width="15%" bgcolor="#cccccc"><b>Anggaran<br>'.$thi.'</b></TD>
						<td align="center" width="15%" bgcolor="#cccccc"><b>Realisasi<br>'.$thi.'</b></TD>
						<td align="center" width="5%" bgcolor="#cccccc"><b>%</b></TD>
						<td align="center" width="15%" bgcolor="#cccccc"><b>Realisasi<br>'.$thl.'</b></TD>
					</tr>
					</thead>';


		$pmb_qry	= $this->db->query("select 
						sum(if(left(kd_rek5,2)=71,nilai,0))tp_ini,
						sum(if(left(kd_rek5,2)=71,lalu,0))tp_lalu,
						sum(if(left(kd_rek5,2)=72,nilai,0))kp_ini,
						sum(if(left(kd_rek5,2)=72,lalu,0))kp_lalu
						from realisasi_akt where periode='$periode' ");
		// Total Penerimaan Pembiayaan Tahun Ini
		$tot_tp_ini		= $pmb_qry->row('tp_ini');
		// Total Penerimaan Pembiayaan Tahun Lalu
		$tot_tp_lalu	= $pmb_qry->row('tp_lalu');
		// Total Pengeluaran Pembiayaan Tahun Ini
		$tot_kp_ini		= $pmb_qry->row('kp_ini');
		// Total Pengeluaran Pembiayaan Tahun Lalu
		$tot_kp_lalu	= $pmb_qry->row('kp_lalu');
		//Pembiayaan Netto Tahun Ini
		$tot_pmb_ini	= $tot_tp_ini-$tot_kp_ini;
		//Pembiayaan Netto Tahun Lalu
		$tot_pmb_lalu	= $tot_tp_lalu-$tot_kp_lalu;

		$csql	= " select nor,kode_1,uraian,bold from map_lra_ppkd_kab ";
		$query = $this->db->query($csql);  
		
		$anggaran	= 0;
		$rupiah		= 0;
		$lalu		= 0;
		$persen		= 0;
		$join_rek	= " if(left(a.kd_rek5,1)in (4,5,6),a.kd_rek5,concat(a.kd_rek5,'p'))=b.kd_rek5 ";
		foreach ( $query->result() as $res){
			$nor		= $res->nor;
			$kodenya	= $res->kode_1;
			$uraian		= $res->uraian;
			$bold		= $res->bold;

			if($kodenya){
				$csqlr	= " select kode,sum(Rupiah)Rupiah,sum(Lalu)Lalu from the_real_akt where kode in ($kodenya) ";

				$queryr = $this->db->query($csqlr);
				foreach ($queryr->result() as $resr){
					$rupiah		= $resr->Rupiah;
					$lalu		= $resr->Lalu;
				}
				$qryang	= $this->db->query("select sum(anggaran)anggaran from the_real_ang where kode in ($kodenya) ");
				$anggaran	= $qryang->row('anggaran');
			}else{
				$anggaran	= 0;
				$rupiah		= 0;
				$lalu		= 0;
			}

			/*	Menghitung Persen	0 tidak dapat dibagi*/
			if($anggaran!=0){
				$persen	= number_format(($rupiah*100/$anggaran), "2", ".", ",");
			}else{
				$persen	= 0;
			}

			
			
			/* Menghitung Nilai real Surplus Defisit dan Pembiayaan (b_n_t = Beban dan Transfer )*/
			if($nor=='31'){					// Total Pendapatan
				$pend_ang	= $anggaran;
				$pend_ini	= $rupiah;
				$pend_lalu	= $lalu;
				$anggaran	= number_format($pend_ang);
				$rupiah		= number_format($pend_ini);
				$lalu		= number_format($pend_lalu);
			}elseif($nor=='59'){			// Total Belanja dan Transfer
				$b_n_t_ang	= $anggaran;
				$b_n_t_ini	= $rupiah;
				$b_n_t_lalu	= $lalu;
				$anggaran	= number_format($b_n_t_ang);
				$rupiah		= number_format($b_n_t_ini);
				$lalu		= number_format($b_n_t_lalu);
			}elseif($nor=='61'){
				$sd_ang		= $pend_ang-$b_n_t_ang;
				$sd_ini		= $pend_ini-$b_n_t_ini;
				$sd_lalu	= $pend_lalu-$b_n_t_lalu;
				$anggaran	= number_format($sd_ang);
				$rupiah		= number_format($sd_ini);
				$lalu		= number_format($sd_lalu);
			}elseif($nor=='79'){
				$tpmb_ang	= $anggaran;	// Total Anggaran Penerimaan Pembiayaan
				$anggaran	= number_format($tpmb_ang);
				$rupiah		= number_format($tot_tp_ini);
				$lalu		= number_format($tot_tp_lalu);
			}elseif($nor=='93'){
				$kpmb_ang	= $anggaran;	// Total Anggaran Pengeluaran Pembiayaan 
				$anggaran	= number_format($kpmb_ang);
				$rupiah		= number_format($rupiah);
				$lalu		= number_format($lalu);
			}elseif($nor=='94'){			// Pembiayaan Netto
				$net_pmb_ang= $tpmb_ang-$kpmb_ang;
				$anggaran	= number_format($net_pmb_ang);
				$rupiah		= number_format($tot_pmb_ini);
				$lalu		= number_format($tot_pmb_lalu);
			}elseif($nor=='96'){			// Silpa
				$anggaran	= number_format($sd_ang+$net_pmb_ang);
				$rupiah		= number_format($sd_ini+$tot_pmb_ini);
				$lalu		= number_format($sd_lalu+$tot_pmb_lalu);
			}else{
				$anggaran	= number_format($anggaran);
				$rupiah		= number_format($rupiah);
				$lalu		= number_format($lalu);
			}

			
			switch ($bold){
				case 6:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\"><b>$anggaran&nbsp;</b></TD>
							<td align=\"right\"><b>$rupiah&nbsp;</b></TD>
							<td align=\"right\"><b>&nbsp;$persen</b></TD>
							<td align=\"right\"><b>$lalu&nbsp;</b></TD>
						</tr>";
				break;
				case 5:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;$uraian</b></TD>
							<td align=\"right\"><b>&nbsp;</b></TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\"><b>&nbsp;</b></TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
				case 4:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\"><b>&nbsp;</b></TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\"><b>&nbsp;</b></TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
				case 3:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\"><b>$anggaran&nbsp;</b></TD>
							<td align=\"right\"><b>$rupiah&nbsp;</b></TD>
							<td align=\"right\"><b>&nbsp;$persen</b></TD>
							<td align=\"right\"><b>$lalu&nbsp;</b></TD>
						</tr>";
				break;
				case 2:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</TD>
							<td align=\"right\">$anggaran&nbsp;</TD>
							<td align=\"right\">$rupiah&nbsp;</TD>
							<td align=\"right\">&nbsp;$persen</TD>
							<td align=\"right\">$lalu&nbsp;</TD>
						</tr>";
				break;
				case 1:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</TD>
							<td align=\"right\">$anggaran&nbsp;</TD>
							<td align=\"right\">$rupiah&nbsp;</TD>
							<td align=\"right\">&nbsp;$persen</TD>
							<td align=\"right\">$lalu&nbsp;</TD>
						</tr>";
				break;
				default:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
			}
		}

		$cRet .= '</table>';
		$judul	= "LRA PPKD";
		$data['prev'] = $cRet;
		switch ($cetak){
			case 0;
				echo $cRet;
				echo "<title>$judul</title>";
				break;
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");

				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}
	}

	function rpt_lpe_ppkd(){
		$cetak		= $_REQUEST['cetak'];
		$mapping	= $_REQUEST['mapping'];
		$periode	= $_REQUEST['periode'];
		if(!$periode){
			$periode	= date('Y-m-d');
		}else{
			$periode	= $periode;
		}
		$kdskpd		= "1.20.06.00";
		$nmskpd		= $this->tukd_model->get_nama($kdskpd,'nm_skpd','ms_skpd','kd_skpd');
		$thi		= $this->session->userdata('pcThang');
		$thl		= $thi-1;
		$kab_kota	= $this->akuntansi_model->get_sclient('kab_kota');
			
		$cRet ='<TABLE width="100%">
					<tr>
						<td align="center" > '.$kab_kota.'</TD>
					</tr>
					<tr>
						<td align="center" ><b>LAPORAN PERUBAHAN EKUITAS</b></TD>
					</tr>
					<tr>
						<td align="center" ><b>PPKD</b></TD>
					</tr>
					<tr>
						<td align="center" >UNTUK PERIODE YANG BERAKHIR SAMPAI DENGAN '.strtoupper($this->tukd_model->tanggal_format_indonesia($periode)).' DAN '.$thl.'</TD>
					</tr>
					</TABLE><br>';


		$cRet .= '<table style="border-collapse:collapse" width="100%" align="center" border="1" cellspacing="1" cellpadding="0">
					<thead>						
					<tr>
						<td align="center" width="10%" bgcolor="#cccccc" ><b>No.</b></TD>
						<td align="center" width="60%" bgcolor="#cccccc"><b>URAIAN</b></TD>
						<td align="center" width="15%" bgcolor="#cccccc"><b>'.$thi.'</b></TD>
						<td align="center" width="15%" bgcolor="#cccccc"><b>'.$thl.'</b></TD>
					</tr>
					</thead>';
			
		$ea	= " SELECT  sum(if(year(tgl_voucher)='$thl',debet-kredit,0))eaw FROM trhju_ppkd a 
						join trdju_ppkd b on a.kd_skpd=b.kd_skpd and a.no_voucher=b.no_voucher 
						where year(tgl_voucher)='$thl' and left(kd_rek5,1) in (1,2) ";

		$eaw	= $this->db->query($ea)->row('eaw');

		$sd	= " SELECT 
				sum(if(year(tgl_voucher)='$thl',kredit-debet,0))sdl,
				sum(if(year(tgl_voucher)='$thi' and tgl_voucher<='$periode',kredit-debet,0))sds
				FROM trhju_ppkd a 
				join trdju_ppkd b on a.kd_skpd=b.kd_skpd and a.no_voucher=b.no_voucher 
				where year(tgl_voucher) in ('$thl','$thi') and left(kd_rek5,1) in (8,9) ";
		$sds	= $this->db->query($sd)->row('sds');
		$sdl	= $this->db->query($sd)->row('sdl');

		$csql	= " select nor,uraian,0 Rupiah,0 Lalu from map_lpe ";
		$query = $this->db->query($csql);
		foreach ( $query->result() as $res){
			$nor	= $res->nor;
			$uraian	= $res->uraian;
			$rupiah	= $res->Rupiah;
			$lalu	= $res->Lalu;

			/* Menghitung Nilai Ekuitas	*/
			/*	___________________
				Keterangan Perhitungan
				$eaw	= Ekuitas Awal
				$sdl	= Surplus Defisit Lalu (Pendapatan LO - Beban Tahun Sebelumnya)
				$sds	= Surplus Defisit Sekarang (Pendapatan LO - Bebabn Tahun ini)
			*/
			if($nor=='1'){
				$rupiah	= number_format($eaw);
				$lalu	= number_format($eaw-$sdl);
			}elseif($nor=='2'){
				$rupiah	= number_format($sds);
				$lalu	= number_format($sdl);
			}elseif($nor=='7'){
				$rupiah	= number_format($eaw+$sds);
				$lalu	= number_format($eaw);
			}else{
				$rupiah	= number_format(0);
				$lalu	= number_format(0);
			}
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;$uraian</TD>
							<td align=\"right\">$rupiah&nbsp;</TD>
							<td align=\"right\">$lalu&nbsp;</TD>
						</tr>";
		}

		$cRet .= '</table>';

		$data['prev']= $cRet;  
		$data['sikap'] = 'preview';
		$judul = 'L P E';
		switch ($cetak){
			case 0;
				echo $cRet;
				echo "<title>$judul</title>";
				break;
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
			break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}
	}

	function rpt_lo_ppkd(){
		$cetak		= $_REQUEST['cetak'];
		$mapping	= $_REQUEST['mapping'];
		$periode	= $_REQUEST['periode'];
		if(!$periode){
			$periode	= date('Y-m-d');
		}else{
			$periode	= $periode;
		}
		$ppkd		= 'PPKD';
		$kdskpd		= '1.20.06.00';
		$nmskpd		= $this->tukd_model->get_nama($kdskpd,'nm_skpd','ms_skpd','kd_skpd');
		$thi		= $this->session->userdata('pcThang');
		$thl		= $thi-1;
		$kab_kota	= $this->akuntansi_model->get_sclient('kab_kota');
		$qry	= "	select '$periode','PPKD',a.nm_skpd,kd_rek5,nm_rek5,
					sum(if(year(tgl_voucher)='$thi',(if(left(kd_rek5,1)in(1,5,6,9) or left(kd_rek5,2)in(72),debet-kredit,kredit-debet)),0))Nilai,
					sum(if(year(tgl_voucher)='$thl',(if(left(kd_rek5,1)in(1,5,6,9) or left(kd_rek5,2)in(72),debet-kredit,kredit-debet)),0))Lalu
					from trhju_ppkd a join trdju_ppkd b on a.kd_skpd=b.kd_skpd and left(kd_rek5,1) in(8,9)
					and a.no_voucher=b.no_voucher and a.tgl_voucher<='$periode'
					GROUP BY kd_rek5 ";

		if($mapping=='true'){
			$this->db->query("DROP TABLE IF EXISTS realisasi_akt");
			$this->db->query("DROP TABLE IF EXISTS the_real_akt");
			$this->db->query("DROP TABLE IF EXISTS the_real_ang");
			$sql	= "	CREATE TEMPORARY TABLE realisasi_akt (
						`periode`  varchar(255) ,
						`kd_skpd`  varchar(255) ,
						`nm_skpd`  varchar(255) ,
						`kd_rek5`  varchar(255) ,
						`nm_rek5`  varchar(255) ,
						`nilai`  decimal(20,2) NULL DEFAULT NULL ,
						`lalu`  decimal(20,2) NULL DEFAULT NULL ,
						INDEX `id_akt` (`periode`, `kd_skpd`, `kd_rek5`) USING BTREE 
						) ENGINE=InnoDB DEFAULT CHARACTER SET=latin1 COLLATE=latin1_swedish_ci ROW_FORMAT=COMPACT";
			$del_exec	= $this->db->query($sql);
			if($del_exec){
				$ins_exec	= $this->db->query("insert into realisasi_akt (periode,kd_skpd,nm_skpd,kd_rek5,nm_rek5,nilai,lalu) ".$qry);
				
				$a0	= $this->db->query("CREATE TEMPORARY TABLE the_real_akt (kode varchar(10),Rupiah decimal(20,2),Lalu decimal(20,2) )");
				if($a0){
					$a1	= $this->db->query("insert into the_real_akt select left(kd_rek5,1),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
				if($a1){
					$a2	= $this->db->query("insert into the_real_akt select left(kd_rek5,2),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
				if($a2){
					$a3	= $this->db->query("insert into the_real_akt select left(kd_rek5,3),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
				if($a3){
					$a4	= $this->db->query("insert into the_real_akt select left(kd_rek5,5),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
				if($a4){
					$a5	= $this->db->query("insert into the_real_akt select left(kd_rek5,8),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
			}
		}

		$cRet ='<TABLE width="100%">
					<tr>
						<td align="center" style="font-size:12px"><b> '.$kab_kota.'</b></TD>
					</tr>
					<tr>
						<td align="center" style="font-size:15px"><b>LAPORAN OPERASIONAL</b></TD>
					</tr>
					<tr>
						<td align="center" style="font-size:15px"><b>PPKD</b></TD>
					</tr>
					<tr>
						<td align="center" style="font-size:12px"><b>Untuk Tahun Yang Berakhir Sampai Dengan '.strtoupper($this->tukd_model->tanggal_format_indonesia($periode)).' dan '.$thl.'<b></TD>
					</tr>
					</TABLE><br>';


		$cRet .= '<table style="border-collapse:collapse;font-size:12px" width="100%" align="center" border="1" cellspacing="1" cellpadding="0">
					<thead>
					<tr>
						<td align="center" width="5%" bgcolor="#cccccc" ><b>No.</b></TD>
						<td align="center" width="65%" bgcolor="#cccccc"><b>URAIAN</b></TD>
						<td align="center" width="20%" bgcolor="#cccccc"><b>'.$thi.'</b></TD>
						<td align="center" width="20%" bgcolor="#cccccc"><b>'.$thl.'</b></TD>
					</tr>
					</thead>';

		$csql	= " select nor,kode_1,uraian,bold from map_lo_ppkd_kab ";
		$query = $this->db->query($csql);  

		$anggaran	= 0;
		$persen		= 0;
		foreach ( $query->result() as $res){
			$nor		= $res->nor;
			$kodenya	= $res->kode_1;
			$uraian		= $res->uraian;
			$bold		= $res->bold;

			if($kodenya){
				$csqlr	= " select kode,sum(Rupiah)Rupiah,sum(Lalu)Lalu from the_real_akt where kode in ($kodenya)  ";

				$queryr = $this->db->query($csqlr);
				foreach ($queryr->result() as $resr){
					$rupiah		= $resr->Rupiah;
					$lalu		= $resr->Lalu;
				}
			}else{
				$rupiah		= 0;
				$lalu		= 0;
			}

			/* Menghitung Nilai Surplus Defisit	(nsd) a=anggaran, s=sekarang, l=lalu */
			if($nor=='31'){
				$tot_pnd_ini			= $rupiah;
				$tot_pnd_lalu			= $lalu;
				$rupiah					= number_format(($tot_pnd_ini),"2",".",",");
				$lalu					= number_format(($tot_pnd_lalu),"2",".",",");
			}elseif($nor=='48'){
				$jumlah_beban_ini		= $rupiah;
				$jumlah_beban_lalu		= $lalu;
				$rupiah					= number_format(($jumlah_beban_ini),"2",".",",");
				$lalu					= number_format(($jumlah_beban_lalu),"2",".",",");				
				// Surplus Defisit Operasi
			}elseif($nor=='50'){
				$sd_operasi_ini			= $tot_pnd_ini-$jumlah_beban_ini;
				$sd_operasi_lalu		= $tot_pnd_lalu-$jumlah_beban_lalu;
				$rupiah					= number_format(($sd_operasi_ini),"2",".",",");
				$lalu					= number_format(($sd_operasi_lalu),"2",".",",");
			}elseif($nor=='57'){
				$surplus_non_op_ini		= $rupiah;
				$surplus_non_op_lalu	= $lalu;
				$rupiah					= number_format(($surplus_non_op_ini),"2",".",",");
				$lalu					= number_format(($surplus_non_op_lalu),"2",".",",");
			}elseif($nor=='63'){
				$defisit_non_op_ini		= $rupiah;
				$defisit_non_op_lalu	= $lalu;
				$rupiah					= number_format(($defisit_non_op_ini),"2",".",",");
				$lalu					= number_format(($defisit_non_op_lalu),"2",".",",");
			}elseif($nor=='64'){
				$sd_non_operasi_ini		= $surplus_non_op_ini-$defisit_non_op_ini;
				$sd_non_operasi_lalu	= $surplus_non_op_lalu-$defisit_non_op_lalu;
				$rupiah					= number_format(($sd_non_operasi_ini),"2",".",",");
				$lalu					= number_format(($sd_non_operasi_lalu),"2",".",",");
			}elseif($nor=='66'){
				$sd_sblm_pos_lb_ini		= $sd_operasi_ini+$sd_non_operasi_ini;
				$sd_sblm_pos_lb_lalu	= $sd_operasi_lalu+$sd_non_operasi_lalu;
				$rupiah					= number_format(($sd_sblm_pos_lb_ini),"2",".",",");
				$lalu					= number_format(($sd_sblm_pos_lb_lalu),"2",".",",");

				//PENDAPATAN LUAR BIASA
			}elseif($nor=='71'){
				$pend_lb_ini			= $rupiah;
				$pend_lb_lalu			= $lalu;
				$rupiah					= number_format(($pend_lb_ini),"2",".",",");
				$lalu					= number_format(($pend_lb_lalu),"2",".",",");
				//BEBAN LUAR BIASA
			}elseif($nor=='75'){
				$beban_lb_ini			= $rupiah;
				$beban_lb_lalu			= $lalu;
				$rupiah					= number_format(($beban_lb_ini),"2",".",",");
				$lalu					= number_format(($beban_lb_lalu),"2",".",",");
			}elseif($nor=='76'){
				$sd_pos_lb_ini			= $pend_lb_ini-$beban_lb_ini;
				$sd_pos_lb_lalu			= $pend_lb_lalu-$beban_lb_lalu;
				$rupiah					= number_format(($sd_pos_lb_ini),"2",".",",");
				$lalu					= number_format(($sd_pos_lb_lalu),"2",".",",");
			}elseif($nor=='78'){
				$tot_sd_ini				= $sd_sblm_pos_lb_ini+$sd_pos_lb_ini;
				$tot_sd_lalu			= $sd_sblm_pos_lb_lalu+$sd_pos_lb_lalu;
				$rupiah					= number_format(($tot_sd_ini),"2",".",",");
				$lalu					= number_format(($tot_sd_lalu),"2",".",",");
			}else{
				$rupiah					= number_format(($rupiah),"2",".",",");
				$lalu					= number_format(($lalu),"2",".",",");
			}

			
			switch ($bold){
				case 6:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\"><b>$rupiah&nbsp;</b></TD>
							<td align=\"right\"><b>$lalu&nbsp;</b></TD>
						</tr>";
				break;
				case 5:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;$uraian</b></TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
				case 4:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
				case 3:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\"><b>$rupiah&nbsp;</b></TD>
							<td align=\"right\"><b>$lalu&nbsp;</b></TD>
						</tr>";
				break;
				case 2:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</TD>
							<td align=\"right\">$rupiah&nbsp;</TD>
							<td align=\"right\">$lalu&nbsp;</TD>
						</tr>";
				break;
				case 1:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</TD>
							<td align=\"right\">$rupiah&nbsp;</TD>
							<td align=\"right\">$lalu&nbsp;</TD>
						</tr>";
				break;
				default:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
			}
		}

		$cRet .= '</table>';
		$data['prev'] = $cRet;
		$judul	= "LO PPKD";
		switch ($cetak){
			case 0;
				echo $cRet;
				echo "<title>$judul</title>";
				break;
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");

				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}
	}

	function cetak_lra($cetak = 1, $lap = 0)
	{
		if ($lap == 1)
		{
			$tabel = 'realisasi_ppkd';
		} else
		{
			$tabel = 'realisasi';
		}
		$sql41 = "SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM $tabel WHERE left(kd_rek5,1)='4' ";
		$query41 = $this->db->query($sql41);
		$jmlp = $query41->row();
		$jmlpendapatan = $jmlp->nilai;
		$jmlangpendapatan = $jmlp->anggaran;
		$jmlangpendapatan1 = number_format($jmlp->anggaran, "2", ".", ",");
		$jmlpendapatan1 = number_format($jmlp->nilai, "2", ".", ",");

		$sql51 = "SELECT SUM(anggaran) as angaran,SUM(real_spj)as nilai FROM $tabel WHERE left(kd_rek5,1)='5' ";
		$query51 = $this->db->query($sql51);
		$jmlb = $query51->row();
		$jmlangbelanja = $jmlb->angaran;
		$jmlbelanja = $jmlb->nilai;
		$jmlbelanja1 = number_format($jmlb->nilai, "2", ".", ",");
		$jmlangbelanja1 = number_format($jmlb->angaran, "2", ".", ",");
		$sql523 = "SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM $tabel WHERE left(kd_rek5,3)='523' ";
		$query523 = $this->db->query($sql523);
		$jmlbm = $query523->row();
		$jmlbmbelanja = $jmlbm->nilai;
		$jmlangbmbelanja = $jmlbm->anggaran;
		$jmlbmbelanja1 = number_format($jmlbmbelanja, "2", ".", ",");
		$jmlangbmbelanja1 = number_format($jmlangbmbelanja, "2", ".", ",");
		$sql61 = "SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM $tabel WHERE left(kd_rek5,2)='61' ";
		$query61 = $this->db->query($sql61);
		$jmlpm = $query61->row();
		$jmlpmasuk = $jmlpm->nilai;
		$jmlangpmasuk = $jmlpm->anggaran;
		$sql62 = "SELECT SUM(anggaran) as anggaran,SUM(real_spj) as nilai FROM $tabel WHERE left(kd_rek5,2)='62' ";
		$query62 = $this->db->query($sql62);
		$jmlpk = $query62->row();
		$jmlpkeluar = $jmlpk->nilai;
		$jmlangpkeluar = $jmlpk->anggaran;
		$surplus = $jmlpendapatan - $jmlbelanja;
		$angsurplus = $jmlangpendapatan - $jmlangbelanja;
		if ($surplus < 0)
		{
			$x = "(";
			$surplus = $surplus * -1;
			$y = ")";
		} else
		{
			$x = "";
			$y = "";
		}
		if ($angsurplus < 0)
		{
			$e = "(";
			$angsurplus = $angsurplus * -1;
			$f = ")";
		} else
		{
			$e = "";
			$f = "";
		}
		$surplus1 = number_format($surplus, "2", ".", ",");
		$angsurplus1 = number_format($angsurplus, "2", ".", ",");
		$biaya_net = $jmlpmasuk - $jmlpkeluar;
		$angbiaya_net = $jmlangpmasuk - $jmlangpkeluar;
		if ($biaya_net < 0)
		{
			$a = "(";
			$biaya_net = $biaya_net * -1;
			$b = ")";
		} else
		{
			$a = "";
			$b = "";
		}
		if ($angbiaya_net < 0)
		{
			$g = "(";
			$angbiaya_net = $angbiaya_net * -1;
			$h = ")";
		} else
		{
			$g = "";
			$h = "";
		}
		$biaya_net1 = number_format($biaya_net, "2", ".", ",");
		$angbiaya_net1 = number_format($angbiaya_net, "2", ".", ",");
		$silpa = ($jmlpendapatan + $jmlpmasuk) - ($jmlbelanja + $jmlpkeluar);
		$angsilpa = ($jmlangpendapatan + $jmlangpmasuk) - ($jmlangbelanja + $jmlangpkeluar);
		if ($silpa < 0)
		{
			$c = "(";
			$silpa = $silpa * -1;
			$d = ")";
		} else
		{
			$c = "";
			$d = "";
		}
		if ($angsilpa < 0)
		{
			$i = "(";
			$angsilpa = $angsilpa * -1;
			$j = ")";
		} else
		{
			$i = "";
			$j = "";
		}
		$silpa1 = number_format($silpa, "2", ".", ",");
		$angsilpa1 = number_format($angsilpa, "2", ".", ",");
		$sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
		$sqlsclient = $this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc)
		{

			$tgl = $rowsc->tgl_rka;
			$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
			$kab = $rowsc->kab_kota;
			$daerah = $rowsc->daerah;
			$thn = $rowsc->thn_ang;
		}

		$jk = $this->rka_model->combo_skpd();

		$cRet = '';


		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td align=\"center\"><strong>$kab</strong></td>						
					</tr>
					<tr>
						<td align=\"center\"><strong>LAPORAN REALISASI ANGGARAN PENDAPATAN DAN BELANJA DAERAH </strong></td>
					</tr>
					<tr>
						<td align=\"center\"><strong>LRA BERDASARKAN SP2D YANG TERBIT</strong></td>
					</tr>					
					<tr>
						<td align=\"center\"><strong>TAHUN ANGGARAN $thn</strong></td>
					</tr>
					<tr>
						<td align=\"center\">&nbsp;</td>
					</tr>
				</table>";


		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
					<thead>					
						<tr><td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NO</b></td>							
							<td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>ANGGARAN</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>REALISASI</b></td>
							<td  bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>LEBIH</br>(KURANG)</b></td>
							<td  bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>   
						</tr>
						
					</thead>
					<tfoot>
						<tr>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>						
						</tr>
					</tfoot>
				
					<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>							
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
						</tr>";


		$sql4 = "SELECT IFNULL(a.kode,\" \") as kode,a.seq,a.nor,a.uraian,ifnull(a.kode_1,\"''\") as kode_1,thn_m1 AS lalu FROM map_lra_ppkd_kab a GROUP BY a.nor,a.uraian,a.kode_1 ORDER BY a.seq";


		$query4 = $this->db->query($sql4);
		//$query = $this->skpd_model->getAllc();
		$no = 0;
		foreach ($query4->result() as $row4)
		{
			//$kode=$row4->rek;
			$nama = $row4->uraian;

			$real_lalu = number_format($row4->lalu, "2", ".", ",");
			$kod = $row4->kode;
			$n = $row4->kode_1;
			//echo $n;
			$sql5 = "SELECT SUM(b.anggaran) as anggaran,SUM(b.real_spj) as nilai FROM $tabel b LEFT JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE c.map_lra1 IN (" .
				$n . ") ";
			//echo $sql5;
			$query5 = $this->db->query($sql5);
			$trh = $query5->row();
			$nil = $trh->nilai;
			$angnil = $trh->anggaran;

			//$nilai=0;
			//$real_s = $trh->nilai - $row4->lalu ;
			$real_s = $trh->nilai - $trh->anggaran;
			if ($real_s < 0)
			{
				$x1 = "(";
				$real_s = $real_s * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih = number_format($real_s, "2", ".", ",");
			if ($trh->nilai == 0)
			{
				$tmp = 1;
			} else
			{
				$tmp = $trh->nilai;
			}
			$nilai = number_format($trh->nilai, "2", ".", ",");
			$angnilai = number_format($trh->anggaran, "2", ".", ",");
			$per1 = ($real_s != 0) ? ($real_s / $tmp) * 100 : 0;
			$persen1 = number_format($per1);
			$no = $no + 1;
			switch ($row4->nor)
			{
				case 1:
					$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kod</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlangpendapatan1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlpendapatan1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
								</tr>";
					break;
				default:
					$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$kod</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$angnilai</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$selisih$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
								</tr>";

			}


		}

		$cRet .= " </table>";
		$data['prev'] = $cRet;
		$data['sikap'] = 'preview';
		$judul = 'LAPORAN REALISASI ANGGARAN';
		$this->template->set('title', 'CETAK LAPORAN REALISASI ANGGARAN');
		switch ($cetak){
			case 0;
				echo $cRet;
				echo "<title>$judul</title>";
				break;
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");

				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}
	}
	
	function ctk_lra_lo_pemda($pilih = 1, $ctk = '', $lap = 0, $skpd = ''){
		$thn_ang = $this->session->userdata('pcThang');
		$thn_ang_1= $thn_ang-1;
		$id = $skpd;
		$cetak = $ctk;
		if ($lap == 1){
			$tabel = 'realisasi_akt';
		} else{
			$tabel = 'realisasi_akt';
		}
		if ($cetak == '1'){
			$skpd = '';
			$skpd1 = '';
		} else{
			$skpd = "AND kd_skpd='$id'";
			$skpd1 = "AND b.kd_skpd='$id'";
		}

		$sqldns = "SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
		$sqlskpd = $this->db->query($sqldns);
		foreach ($sqlskpd->result() as $rowdns)
		{
			$kd_urusan = $rowdns->kd_u;
			$nm_urusan = $rowdns->nm_u;
			$kd_skpd = $rowdns->kd_sk;
			$nm_skpd = $rowdns->nm_sk;
		}

		$sql41 = "SELECT SUM(nilai) as nilai FROM $tabel WHERE left(kd_rek5,1)='8' $skpd";
		$query41 = $this->db->query($sql41);
		$jmlp = $query41->row();
		$jmlpendapatan = $jmlp->nilai;
		$jmlpendapatan1 = number_format($jmlp->nilai, "2", ".", ",");

		$sql51 = "SELECT SUM(nilai) as nilai FROM $tabel WHERE left(kd_rek5,1)='9' $skpd";
		$query51 = $this->db->query($sql51);
		$jmlb = $query51->row();
		$jmlbelanja = $jmlb->nilai;
		$jmlbelanja1 = number_format($jmlb->nilai, "2", ".", ",");
		$sql523 = "SELECT SUM(nilai) as nilai FROM $tabel WHERE left(kd_rek5,3)='923' $skpd";
		$query523 = $this->db->query($sql523);
		$jmlbm = $query523->row();
		$jmlbmbelanja = $jmlbm->nilai;
		$jmlbmbelanja1 = number_format($jmlbmbelanja, "2", ".", ",");
		$sql61 = "SELECT SUM(nilai) as nilai FROM $tabel WHERE left(kd_rek5,2)='71' $skpd";
		$query61 = $this->db->query($sql61);
		$jmlpm = $query61->row();
		$jmlpmasuk = $jmlpm->nilai;
		$sql62 = "SELECT SUM(nilai) as nilai FROM $tabel WHERE left(kd_rek5,2)='72' $skpd";
		$query62 = $this->db->query($sql62);
		$jmlpk = $query62->row();
		$jmlpkeluar = $jmlpk->nilai;
		$surplus = $jmlpendapatan - $jmlbelanja;

		if ($surplus < 0){
			$x = "(";
			$surplus = $surplus * -1;
			$y = ")";
		} else{
			$x = "";
			$y = "";
		}
		$surplus1 = number_format($surplus, "2", ".", ",");
		$biaya_net = $jmlpmasuk - $jmlpkeluar;

		if ($biaya_net < 0){
			$a = "(";
			$biaya_net = $biaya_net * -1;
			$b = ")";
		} else{
			$a = "";
			$b = "";
		}
		$biaya_net1 = number_format($biaya_net, "2", ".", ",");
		$silpa = ($jmlpendapatan + $jmlpmasuk) - ($jmlbelanja + $jmlpkeluar);

		if ($silpa < 0){
			$c = "(";
			$silpa = $silpa * -1;
			$d = ")";
		} else{
			$c = "";
			$d = "";
		}
		$silpa1 = number_format($silpa, "2", ".", ",");
		$sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
		$sqlsclient = $this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc)
		{

			$tgl = $rowsc->tgl_rka;
			$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
			$kab = $rowsc->kab_kota;
			$daerah = $rowsc->daerah;
			$thn = $rowsc->thn_ang;
		}

		$jk = $this->rka_model->combo_skpd();

		$cRet = '';


		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td align=\"center\"><strong> $kab</strong></td>						
					</tr>
					<tr>
						<td align=\"center\"><strong>LAPORAN OPERASIONAL </strong></td>
					</tr>					
					<tr>
						<td align=\"center\"><strong>UNTUK TAHUN YANG BERAKHIR SAMPAI DENGAN $Periode</strong></td>
					</tr>
					<tr>
						<td align=\"center\">&nbsp;</td>
					</tr>
				</table>";
		if ($cetak == '2')
		{
			$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
						<tr>
							<td width=\"20%\">Urusan Organisasi </td>
							<td width=\"80%\">: $kd_urusan - $nm_urusan</td>
						</tr>
						<tr>
							<td>Organisasi</td>
							<td>: $kd_skpd - $nm_skpd </td>
						</tr>
					
					</table>";
		}

		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
					<thead>					
						<tr><td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NO</b></td>							
							<td  bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Saldo $thn_ang</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Saldo $thn_ang_1</b></td>
							<td  bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>Kenaikan</br>(Penurunan)</b></td>
							<td  bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>   
						</tr>
						
					</thead>
					<tfoot>
						<tr>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>						
						</tr>
					</tfoot>
				
					<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>							
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"40%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
						</tr>";


		$sql4 = "SELECT a.seq,a.nor,a.uraian as uraian ,ifnull(a.kode_1,\"''\") as kode_1,thn_m1 AS lalu FROM map_lo_kab a GROUP BY a.nor,a.uraian,a.kode_1 ORDER BY a.nor";
		$query4 = $this->db->query($sql4);
		$no = 0;
		foreach ($query4->result() as $row4){
			$nama = $row4->uraian;
			$real_lalu = number_format($row4->lalu, "2", ".", ",");
			$n = $row4->kode_1;

			if($n){
				$sql5	= " select sum(Rupiah)nilai,sum(lalu)lalu from (
								select left(kd_rek5,7)rek,sum(nilai)Rupiah,sum(lalu)lalu from $tabel b where 1 $skpd1 group by left(kd_rek5,7) union 
								select left(kd_rek5,5)rek,sum(nilai)Rupiah,sum(lalu)lalu from $tabel b where 1 $skpd1 group by left(kd_rek5,5) union 
								select left(kd_rek5,3)rek,sum(nilai)Rupiah,sum(lalu)lalu from $tabel b where 1 $skpd1 group by left(kd_rek5,3) union 
								select left(kd_rek5,2)rek,sum(nilai)Rupiah,sum(lalu)lalu from $tabel b where 1 $skpd1 group by left(kd_rek5,2) union 
								select left(kd_rek5,1)rek,sum(nilai)Rupiah,sum(lalu)lalu from $tabel b where 1 $skpd1 group by left(kd_rek5,1)  
							) a where rek in ($n)  ";
			}
			$query5 = $this->db->query($sql5);
			$trh = $query5->row();
			$nil = $trh->nilai;
			$nilai = number_format($trh->nilai, "2", ".", ",");
			$real_s = $trh->nilai - $nil;
			if ($real_s < 0){
				$x1 = "(";
				$real_s = $real_s * -1;
				$y1 = ")";
			} else{
				$x1 = "";
				$y1 = "";
			}
			$selisih = number_format($real_s, "2", ".", ",");
			if ($trh->nilai == 0){
				$tmp = 1;
			} else{
				$tmp = $trh->nilai;
			}
			$per1 = ($real_s != 0) ? ($real_s / $tmp) * 100 : 0;
			$persen1 = number_format($per1);
			$no = $no + 1;
			switch ($row4->seq){
				case 5:
					$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$no</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$jmlpendapatan1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
								</tr>";
					break;
				default:
					$cRet .= "<tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"left\">$no</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"40%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\">$nilai</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\">$x1$selisih$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
								</tr>";

			}
		}

		$cRet .= " </table>";
		$data['prev'] = $cRet;
		$data['sikap'] = 'preview';
		$judul = 'LAPORAN REALISASI ANGGARAN LAPORAN OPRASIONAL';
		$this->template->set('title',
			'CETAK LAPORAN REALISASI ANGGARAN LAPORAN OPRASIONAL');
		switch ($pilih)
		{
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");

				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}


	}

	function lampiran_II()
	{
		$data['page_title'] = 'REALISASI';
		$this->template->set('title', 'REALISASI');
		$this->template->load('template', 'akuntansi/perda_real_ii', $data);
	}

	function cetak_perdaII_real($cetak ='')
	{
		//$cetak =   $this->uri->segment(3);
		$sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
		$sqlsclient = $this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc)
		{
			$tgl = $rowsc->tgl_rka;
			$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
			$kab = $rowsc->kab_kota;
			$daerah = $rowsc->daerah;
			$thn = $rowsc->thn_ang;
		}

		$cRet = '';

		//if ($cetak = 1)
		
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
						<td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"10%\"><strong><h5>LAMPIRAN I.1  :</h6></strong></td>
						<td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>PERATURAN DAERAH</strong></h5></td>
					</tr>
					<tr> 
						<td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>:</h5></td>
					</tr>
					<tr>
						<td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>:</h5></td>
					</tr>
				</table>";
		
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td align=\"center\" width=\"100%\"><strong>$kab</strong></td>
						
					</tr>
					<tr>
						<td align=\"center\" width=\"100%\"><strong>RINGKASAN LAPORAN REALISASI ANGGARAN MENURUT URUSAN PEMERINTAH DAERAH DAN<br>ORGANISASI</strong></td>
					</tr>
					
					<tr>
						<td align=\"center\" width=\"100%\"><strong>TAHUN ANGARAN $thn</strong></td>
					</tr>

				</table>";

		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
					<thead>					
						<tr><td rowspan=\"3\" bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>KODE</b></td>							
							<td rowspan=\"3\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>URUSAN PEMERINTAH DAERAH</b></td>
							<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" bgcolor=\"#CCCCCC\" width=\"26%\" align=\"center\" colspan=\"4\"><b>PENDAPATAN</b></td>
							<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" bgcolor=\"#CCCCCC\" width=\"54%\" align=\"center\" colspan=\"8\"><b>BELANJA</b></td>
						</tr>
						<tr>
 							<td rowspan=\"2\" width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">SETELAH<br>PERUBAHAN</td>
							<td rowspan=\"2\" width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">REALISASI</td>
							<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" colspan=\"2\" width=\"12%\" bgcolor=\"#CCCCCC\" align=\"center\">LEBIH(KURANG)</td>
							<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\"colspan=\"3\" width=\"21%\" bgcolor=\"#CCCCCC\" align=\"center\">SETELAH PERUBAHAN</td>
							<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\"colspan=\"3\" width=\"21%\" bgcolor=\"#CCCCCC\" align=\"center\">REALISASI</td>
							<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\"colspan=\"2\" width=\"12%\" bgcolor=\"#CCCCCC\" align=\"center\">LEBIH</br>(KURANG)</td>
						</tr>
						<tr>
							<td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >(RP.)</td>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" >%</td>
							<td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >Tidak Langsung</td>
							<td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >Langsung</td>
							<td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >Jumlah</td>
							<td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >Tidak Langsung</td>
							<td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >Langsung</td>
							<td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >Jumlah</td>
							<td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >(RP.)</td>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" >%</td>
						</tr>	
					</thead>
					
					
						<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" >&nbsp;</td>							
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
						</tr>
						";



//Firman Ganti Qwery di ATAS
	
		$sql1 ="
				SELECT
                            a.kd_urusan1 AS kode,
                            a.nm_urusan1 AS nama,
			    a.kd_urusan1 AS urut,
                            SUM(IF(LEFT(x.kd_rek5,1)='4',x.nilai_ubah,0)) AS nilai_4,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=4 AND LEFT(kd_rek5_ang,1)=a.kd_urusan1),0) AS cp_4,'0' AS kredit_4,'0' AS debet_4,
			    SUM(IF(LEFT(x.kd_rek5,2)='51',x.nilai_ubah,0)) AS btl,
                            SUM(IF(LEFT(x.kd_rek5,2)='52',x.nilai_ubah,0)) AS bl,
                            SUM(IF(LEFT(x.kd_rek5,1)='5',x.nilai_ubah,0)) AS jumlah,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=51 AND LEFT(kd_skpd,1)=a.kd_urusan1),0)AS kredit_btl,'0' AS debet_btl,'' AS cp_btl, 
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=52 AND LEFT(kd_skpd,1)=a.kd_urusan1),0)AS kredit_bl,'0' AS debet_bl,'' AS cp_bl 
                          FROM
                            trdrka X
                            LEFT JOIN ms_urusan1 a ON  LEFT(x.kd_skpd,1)=a.kd_urusan1 GROUP BY  a.kd_urusan1 ,a.nm_urusan1
                          UNION
                          SELECT
                            a.kd_urusan AS kode,
                            a.nm_urusan AS nama,
			    a.kd_urusan AS urut,
                            SUM(IF(LEFT(x.kd_rek5,1)='4',x.nilai_ubah,0)) AS nilai_4,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=4 AND LEFT(kd_skpd,4)=a.kd_urusan),0)AS cp_4,'0' AS kredit_4,'0' AS debet_4,
                            SUM(IF(LEFT(x.kd_rek5,2)='51',x.nilai_ubah,0)) AS btl,
                            SUM(IF(LEFT(x.kd_rek5,2)='52',x.nilai_ubah,0)) AS bl,
                            SUM(IF(LEFT(x.kd_rek5,1)='5',x.nilai_ubah,0)) AS jumlah,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=51 AND LEFT(kd_skpd,4)=a.kd_urusan),0)AS kredit_btl,'0' AS debet_btl,'' AS cp_btl, 
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=52 AND LEFT(kd_skpd,4)=a.kd_urusan),0)AS kredit_bl,'0' AS debet_bl,'' AS cp_bl 
                          FROM
                            trdrka X
                            LEFT JOIN ms_urusan a ON LEFT(x.kd_skpd,4)=a.kd_urusan GROUP BY  a.kd_urusan ,a.nm_urusan
                          UNION
                          SELECT
                            a.kd_skpd AS kode,
                            a.nm_skpd AS nama,
			    a.kd_skpd AS urut,
                            SUM(IF(LEFT(x.kd_rek5,1)='4',x.nilai_ubah,0)) AS nilai_4,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=4 AND kd_skpd=a.kd_skpd),0)AS cp_4,'0' AS kredit_4,'0' AS debet_4,
                            SUM(IF(LEFT(x.kd_rek5,2)='51',x.nilai_ubah,0)) AS btl,
                            SUM(IF(LEFT(x.kd_rek5,2)='52',x.nilai_ubah,0)) AS bl,
                            SUM(IF(LEFT(x.kd_rek5,1)='5',x.nilai_ubah,0)) AS jumlah,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=51 AND kd_skpd=a.kd_skpd),0)AS kredit_btl,'0' AS debet_btl,'' AS cp_btl, 
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=52 AND kd_skpd=a.kd_skpd),0)AS kredit_bl,'0' AS debet_bl,'' AS cp_bl 
			    FROM
                            trdrka X
                            LEFT JOIN ms_skpd a ON x.kd_skpd=a.kd_skpd  GROUP BY a.kd_skpd,a.nm_skpd
                          ORDER BY kode
			";
		

		$query = $this->db->query($sql1);
		foreach ($query->result() as $row)
		{
			$kode = $row->kode;
			$nama = $row->nama;
			$ang_4 = $row->nilai_4;
			$in = $row->cp_4;
			$indebet = $row->debet_4;
			$inkredit = $row->kredit_4;
			$real_4 = ($in + $inkredit) - $indebet;
			$pend = number_format($ang_4, "2", ",", ".");
			$pend_real = number_format($real_4, "2", ",", ".");
			$selisih_4 = $real_4 - $ang_4;
			if ($selisih_4 < 0)
			{
				$x = "(";
				$selisih_4 = $selisih_4 * -1;
				$y = ")";
			} else
			{
				$x = "";
				$y = "";
			}
			$sel_4 = number_format($selisih_4, "2", ",", ".");
			$per_4 = ($selisih_4 != 0) ? ($selisih_4 / $ang_4) * 100 : 0;
			$persen_4 = number_format($per_4);

			$ang_51 = $row->btl;
			$btl = number_format($ang_51, "2", ",", ".");
			$btlcp = $row->cp_btl;
			$btlcp2 = number_format($btlcp, "2", ",", ".");
			$debet_btl = $row->debet_btl;
			$kredit_btl = $row->kredit_btl;
			$ang_52 = $row->bl;
			$bl = number_format($ang_52, "2", ",", ".");
			$blcp = $row->cp_bl;
			$debet_bl = $row->debet_bl;
			$kredit_bl = $row->kredit_bl;
			$real_bl = $debet_bl;
			$jum_5 = $ang_51 + $ang_52;
			$jum_5_real = $kredit_btl + $kredit_bl;
			$jum = number_format($jum_5, "2", ",", ".");
			$btl_real = number_format($kredit_btl, "2", ",", ".");
			$bl_real = number_format($kredit_bl, "2", ",", ".");
			$jum_real = number_format($jum_5_real, "2", ",", ".");
			$selisih_5 = $jum_5_real - $jum_5;
			if ($selisih_5 < 0)
			{
				$x1 = "(";
				$selisih_5 = $selisih_5 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$sel_5 = number_format($selisih_5, "2", ",", ".");
			$per_5 = ($selisih_5 != 0) ? ($selisih_5 / $jum_5) * 100 : 0;
			$persen_5 = number_format($per_5);

			$cRet .= "<tr>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\" width=\"5%\">$kode</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\" width=\"15%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$pend</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$pend_real</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$x$sel_4$y</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"5%\">$persen_4</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$btl</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$bl</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$jum</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$btl_real</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$bl_real</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$jum_real</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$x1$sel_5$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"5%\">$persen_5</td>
								</tr>
									";
		}
		$cRet .= " </table>";
		
//Aktifkan Jika Penandatangan Perlu
		$sqlttd1 = "SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='1.20.06.00' and kode='PA'";
		$sqlttd = $this->db->query($sqlttd1);
		foreach ($sqlttd->result() as $rowttd)
		{
			$nip = $rowttd->nip;
			$nama = $rowttd->nm;
			$jabatan = $rowttd->jab;
		}
		 $cRet .="<table>;
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
					</tr>
		 </table>";
 		 $cRet .=" <table width='100%' border=\"0\" cellspacing=\"1\" cellpadding=\"1\">
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>$daerah, ".$this->tukd_model->tanggal_format_indonesia(date("Y-m-d"))."</td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'><b>$jabatan</b></td>
					</tr>
					<tr>
						<td align='center' width='40%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>&nbsp;</td>
					</tr>
					<tr>
						<td align='center' width='40%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>&nbsp;</td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'><b>$nama</b></td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'><b>$nip</b></td>
					</tr>
				  </table>
				";				
		$judul = 'Laporan Realisasi APBD  Lamp II';
		$data['prev'] = $cRet;
		$this->template->set('title', 'CETAK PERDA REALISASI LAMPIRAN II');
		switch ($cetak)
		{
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, 'L');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");

				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}
	}
	
//RANCANGAN PERDA LAMPIRAN II TANPA TTD
	function cetak_perdaII2_real($cetak ='')
	{
		//$cetak =   $this->uri->segment(3);
		$sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
		$sqlsclient = $this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc)
		{
			$tgl = $rowsc->tgl_rka;
			$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
			$kab = $rowsc->kab_kota;
			$daerah = $rowsc->daerah;
			$thn = $rowsc->thn_ang;
		}

		$cRet = '';

		//if ($cetak = 1)
		
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
						<td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"10%\"><strong><h5>LAMPIRAN I.1  :</h6></strong></td>
						<td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>RANCANGAN PERATURAN DAERAH</strong></h5></td>
					</tr>
					<tr> 
						<td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>:</h5></td>
					</tr>
					<tr>
						<td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>:</h5></td>
					</tr>
				</table>";
		
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td align=\"center\" width=\"100%\"><strong>$kab</strong></td>
						
					</tr>
					<tr>
						<td align=\"center\" width=\"100%\"><strong>RINGKASAN LAPORAN REALISASI ANGGARAN MENURUT URUSAN PEMERINTAH DAERAH DAN<br>ORGANISASI</strong></td>
					</tr>
					
					<tr>
						<td align=\"center\" width=\"100%\"><strong>TAHUN ANGARAN $thn</strong></td>
					</tr>

				</table>";

		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
					<thead>					
						<tr><td rowspan=\"3\" bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>KODE</b></td>							
							<td rowspan=\"3\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>URUSAN PEMERINTAH DAERAH</b></td>
							<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" bgcolor=\"#CCCCCC\" width=\"26%\" align=\"center\" colspan=\"4\"><b>PENDAPATAN</b></td>
							<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" bgcolor=\"#CCCCCC\" width=\"54%\" align=\"center\" colspan=\"8\"><b>BELANJA</b></td>
						</tr>
						<tr>
 							<td rowspan=\"2\" width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">SETELAH<br>PERUBAHAN</td>
							<td rowspan=\"2\" width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">REALISASI</td>
							<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" colspan=\"2\" width=\"12%\" bgcolor=\"#CCCCCC\" align=\"center\">LEBIH(KURANG)</td>
							<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\"colspan=\"3\" width=\"21%\" bgcolor=\"#CCCCCC\" align=\"center\">SETELAH PERUBAHAN</td>
							<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\"colspan=\"3\" width=\"21%\" bgcolor=\"#CCCCCC\" align=\"center\">REALISASI</td>
							<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\"colspan=\"2\" width=\"12%\" bgcolor=\"#CCCCCC\" align=\"center\">LEBIH</br>(KURANG)</td>
						</tr>
						<tr>
							<td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >(RP.)</td>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" >%</td>
							<td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >Tidak Langsung</td>
							<td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >Langsung</td>
							<td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >Jumlah</td>
							<td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >Tidak Langsung</td>
							<td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >Langsung</td>
							<td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >Jumlah</td>
							<td bgcolor=\"#CCCCCC\" width=\"7%\" align=\"center\" >(RP.)</td>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" >%</td>
						</tr>	
					</thead>
					
					
						<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" >&nbsp;</td>							
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
						</tr>
						";

//Firman Ganti Qwery di ATAS
	
		$sql1 ="
				SELECT
                            a.kd_urusan1 AS kode,
                            a.nm_urusan1 AS nama,
			    a.kd_urusan1 AS urut,
                            SUM(IF(LEFT(x.kd_rek5,1)='4',x.nilai_ubah,0)) AS nilai_4,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=4 AND LEFT(kd_rek5_ang,1)=a.kd_urusan1),0) AS cp_4,'0' AS kredit_4,'0' AS debet_4,
			    SUM(IF(LEFT(x.kd_rek5,2)='51',x.nilai_ubah,0)) AS btl,
                            SUM(IF(LEFT(x.kd_rek5,2)='52',x.nilai_ubah,0)) AS bl,
                            SUM(IF(LEFT(x.kd_rek5,1)='5',x.nilai_ubah,0)) AS jumlah,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=51 AND LEFT(kd_skpd,1)=a.kd_urusan1),0)AS kredit_btl,'0' AS debet_btl,'' AS cp_btl, 
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=52 AND LEFT(kd_skpd,1)=a.kd_urusan1),0)AS kredit_bl,'0' AS debet_bl,'' AS cp_bl 
                          FROM
                            trdrka X
                            LEFT JOIN ms_urusan1 a ON  LEFT(x.kd_skpd,1)=a.kd_urusan1 GROUP BY  a.kd_urusan1 ,a.nm_urusan1
                          UNION
                          SELECT
                            a.kd_urusan AS kode,
                            a.nm_urusan AS nama,
			    a.kd_urusan AS urut,
                            SUM(IF(LEFT(x.kd_rek5,1)='4',x.nilai_ubah,0)) AS nilai_4,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=4 AND LEFT(kd_skpd,4)=a.kd_urusan),0)AS cp_4,'0' AS kredit_4,'0' AS debet_4,
                            SUM(IF(LEFT(x.kd_rek5,2)='51',x.nilai_ubah,0)) AS btl,
                            SUM(IF(LEFT(x.kd_rek5,2)='52',x.nilai_ubah,0)) AS bl,
                            SUM(IF(LEFT(x.kd_rek5,1)='5',x.nilai_ubah,0)) AS jumlah,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=51 AND LEFT(kd_skpd,4)=a.kd_urusan),0)AS kredit_btl,'0' AS debet_btl,'' AS cp_btl, 
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=52 AND LEFT(kd_skpd,4)=a.kd_urusan),0)AS kredit_bl,'0' AS debet_bl,'' AS cp_bl 
                          FROM
                            trdrka X
                            LEFT JOIN ms_urusan a ON LEFT(x.kd_skpd,4)=a.kd_urusan GROUP BY  a.kd_urusan ,a.nm_urusan
                          UNION
                          SELECT
                            a.kd_skpd AS kode,
                            a.nm_skpd AS nama,
			    a.kd_skpd AS urut,
                            SUM(IF(LEFT(x.kd_rek5,1)='4',x.nilai_ubah,0)) AS nilai_4,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=4 AND kd_skpd=a.kd_skpd),0)AS cp_4,'0' AS kredit_4,'0' AS debet_4,
                            SUM(IF(LEFT(x.kd_rek5,2)='51',x.nilai_ubah,0)) AS btl,
                            SUM(IF(LEFT(x.kd_rek5,2)='52',x.nilai_ubah,0)) AS bl,
                            SUM(IF(LEFT(x.kd_rek5,1)='5',x.nilai_ubah,0)) AS jumlah,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=51 AND kd_skpd=a.kd_skpd),0)AS kredit_btl,'0' AS debet_btl,'' AS cp_btl, 
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=52 AND kd_skpd=a.kd_skpd),0)AS kredit_bl,'0' AS debet_bl,'' AS cp_bl 
			    FROM
                            trdrka X
                            LEFT JOIN ms_skpd a ON x.kd_skpd=a.kd_skpd  GROUP BY a.kd_skpd,a.nm_skpd
                          ORDER BY kode
			";
		

		$query = $this->db->query($sql1);
		foreach ($query->result() as $row)
		{
			$kode = $row->kode;
			$nama = $row->nama;
			$ang_4 = $row->nilai_4;
			$in = $row->cp_4;
			$indebet = $row->debet_4;
			$inkredit = $row->kredit_4;
			$real_4 = ($in + $inkredit) - $indebet;
			$pend = number_format($ang_4, "2", ",", ".");
			$pend_real = number_format($real_4, "2", ",", ".");
			$selisih_4 = $real_4 - $ang_4;
			if ($selisih_4 < 0)
			{
				$x = "(";
				$selisih_4 = $selisih_4 * -1;
				$y = ")";
			} else
			{
				$x = "";
				$y = "";
			}
			$sel_4 = number_format($selisih_4, "2", ",", ".");
			$per_4 = ($selisih_4 != 0) ? ($selisih_4 / $ang_4) * 100 : 0;
			$persen_4 = number_format($per_4);

			$ang_51 = $row->btl;
			$btl = number_format($ang_51, "2", ",", ".");
			$btlcp = $row->cp_btl;
			$btlcp2 = number_format($btlcp, "2", ",", ".");
			$debet_btl = $row->debet_btl;
			$kredit_btl = $row->kredit_btl;
			$ang_52 = $row->bl;
			$bl = number_format($ang_52, "2", ",", ".");
			$blcp = $row->cp_bl;
			$debet_bl = $row->debet_bl;
			$kredit_bl = $row->kredit_bl;
			$real_bl = $debet_bl;
			$jum_5 = $ang_51 + $ang_52;
			$jum_5_real = $kredit_btl + $kredit_bl;
			$jum = number_format($jum_5, "2", ",", ".");
			$btl_real = number_format($kredit_btl, "2", ",", ".");
			$bl_real = number_format($kredit_bl, "2", ",", ".");
			$jum_real = number_format($jum_5_real, "2", ",", ".");
			$selisih_5 = $jum_5_real - $jum_5;
			if ($selisih_5 < 0)
			{
				$x1 = "(";
				$selisih_5 = $selisih_5 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$sel_5 = number_format($selisih_5, "2", ",", ".");
			$per_5 = ($selisih_5 != 0) ? ($selisih_5 / $jum_5) * 100 : 0;
			$persen_5 = number_format($per_5);

			$cRet .= "<tr>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\" width=\"5%\">$kode</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\" width=\"15%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$pend</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$pend_real</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$x$sel_4$y</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"5%\">$persen_4</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$btl</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$bl</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$jum</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$btl_real</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$bl_real</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$jum_real</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"7%\">$x1$sel_5$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\" width=\"5%\">$persen_5</td>
								</tr>
									";
		}
		$cRet .= " </table>";
		
		$judul = 'Laporan Realisasi APBD  Lamp II';
		$data['prev'] = $cRet;
		$this->template->set('title', 'CETAK PERDA REALISASI LAMPIRAN II');
		switch ($cetak)
		{
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, 'L');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");

				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}
	}
	
	

	function lampiran_III()
	{
		$data['page_title'] = 'REALISASI';
		$this->template->set('title', 'REALISASI');
		$this->template->load('template', 'akuntansi/perda_real_iii', $data);
	}

	function cetak_perdaIII_real($skpd = '', $cetak = '')
	{
		$cetak = $cetak;
		$id = $skpd;
		$sqldns = "SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
		$sqlskpd = $this->db->query($sqldns);
		foreach ($sqlskpd->result() as $rowdns)
		{

			$kd_urusan = $rowdns->kd_u;
			$nm_urusan = $rowdns->nm_u;
			$kd_skpd = $rowdns->kd_sk;
			$nm_skpd = $rowdns->nm_sk;
		}

		$sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
		$sqlsclient = $this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc)
		{

			$tgl = $rowsc->tgl_rka;
			$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
			$kab = $rowsc->kab_kota;
			$daerah = $rowsc->daerah;
			$thn = $rowsc->thn_ang;
		}
		$sqlttd1 = "SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$id' and kode='PA'";
		$sqlttd = $this->db->query($sqlttd1);
		foreach ($sqlttd->result() as $rowttd)
		{
			$nip = $rowttd->nip;
			$namap = $rowttd->nm;
			$jabatan = $rowttd->jab;
		}

		$cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
						<td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"15%\"><strong><h5>LAMPIRAN I.2  :</h5></strong></td>
						<td colspan=\"2\" align=\"left\" width=\"25%\"><strong><h5>PERATURAN DAERAH</strong></h5></td>
					</tr>
					<tr> 
						<td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>:</h5></td>
					</tr>
					<tr>
						<td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>:</h5></td>
					</tr>
				</table>";
				
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td align=\"center\"><strong>$kab</strong></td>
					</tr>
					<tr>
						<td align=\"center\"><strong>RINGKASAN LAPORAN REALISASI ANGGARAN MENURUT URUSAN PEMERINTAH DAERAH,<br>ORGANISASI,PENDAPATAN,BELANJA DAN PEMBIAYAAN </strong></td>
					</tr>
					<tr>
						<td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
					</tr>

				</table>";
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
					<tr>
						<td width=\"20%\">Urusan Organisasi </td>
						<td width=\"80%\">:$kd_urusan - $nm_urusan</td>
					</tr>
					<tr>
						<td>Organisasi</td>
						<td>:$kd_skpd - $nm_skpd</td>
					</tr>";

		$cRet .= "</table>";

		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
					<thead>					
						<tr><td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Kode Rekening</b></td>							
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"26%\" align=\"center\"><b>Uraian</b></td>							
							<td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"28%\" align=\"center\"><b>Jumlah (Rp.)</b></td>
							<td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"16%\" align=\"center\"><b>Bertambah/ (berkurang)</b></td>
							<td  rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"13%\" align=\"center\"><b>Dasar Hukum</b></td>							
							</tr>
						<tr>
 							<td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Anggaran<br>Perubahan </td>
							<td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Realisasi</td>
							<td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Jumlah</td>
							<td width=\"3%\" bgcolor=\"#CCCCCC\" align=\"center\">%</td>
							
						</tr>	
					</thead>
					<tfoot>
						<tr>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>  
							<td style=\"border-top: none;\"></td>
																				
						</tr>
					</tfoot>
					
					
						<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"center\">&nbsp;</td>							
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"26%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>							
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"14%\">&nbsp;</td>
							</tr>
						";


//		$sql_p = "SELECT * FROM (SELECT a.kd_kegiatan AS kd_rek,c.nm_kegiatan AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
//						(SELECT SUM(rupiah) FROM trdkasin_pkd g INNER JOIN trhkasin_pkd h ON g.no_sts = h.no_sts WHERE h.kd_skpd='$id' AND h.kd_kegiatan = a.kd_kegiatan ) AS cp,
//						(SELECT SUM(debet) FROM trdju_pkd i  INNER JOIN trhju_pkd j ON i.no_voucher = j.no_voucher  WHERE j.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan ) AS debet,
//						(SELECT SUM(kredit) FROM trdju_pkd k  INNER JOIN trhju_pkd l ON k.no_voucher = l.no_voucher WHERE l.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan ) AS kredit,'2' AS nu FROM trskpd a INNER JOIN m_giat c ON a.kd_kegiatan1=c.kd_kegiatan
//						LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan WHERE a.kd_skpd='$id' AND RIGHT(a.kd_kegiatan,5) ='00.01' GROUP BY a.kd_kegiatan,c.nm_kegiatan
//						UNION ALL 
//						SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
//						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
//						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE  g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
//						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE  h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'3' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
//						ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,24)
//						UNION ALL
//						SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
//						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
//						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
//						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
//						ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,25)) a ORDER BY kd_rek,nu ";

 
 
 
//====DN

	$sql_p = "
	SELECT * FROM (
			    SELECT SUBSTR(b.no_trdrka,12,23)AS kd_rek,c.`nm_rek1` AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND kd_kegiatan=b.`kd_kegiatan` AND LEFT(kd_rek5_ang,1)=4),0) AS cp,'0' AS kredit,'0' AS debet,
			    '1' AS nu FROM trskpd a
			    LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
			    INNER JOIN ms_rek1 c ON LEFT(b.kd_rek5,1)=c.kd_rek1
			    WHERE a.kd_skpd='$id' AND LEFT(b.`kd_rek5`,1)='4'
			    GROUP BY kd_rek
			    UNION
			    SELECT SUBSTR(b.no_trdrka,12,24)  AS kd_rek,c.nm_rek2 AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND kd_kegiatan=b.`kd_kegiatan` AND LEFT(kd_rek5_ang,2)=c.kd_rek2),0) AS cp,'0' AS kredit,'0' AS debet,
			    '2' AS nu FROM trskpd a
			    LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
			    INNER JOIN ms_rek2 c ON LEFT(b.kd_rek5,2)=c.kd_rek2
			    WHERE a.kd_skpd='$id' AND LEFT(b.`kd_rek5`,1)='4'
			    GROUP BY kd_rek
			    UNION 
			    SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND kd_kegiatan=a.`kd_kegiatan` AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS cp,'0' AS kredit,'0' AS debet,
			    '3' AS nu
			    FROM trdrka a 
			    INNER JOIN ms_rek3 b 
			    ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' 
			    GROUP BY SUBSTR(a.no_trdrka,12,25)
			    UNION
			    SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND kd_kegiatan=a.`kd_kegiatan` AND LEFT(kd_rek5_ang,5)=b.kd_rek4),0) AS cp,'0' AS kredit,'0' AS debet,
			    '4' AS nu
			    FROM trdrka a INNER JOIN ms_rek4 b 
			    ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' 
			    GROUP BY SUBSTR(a.no_trdrka,12,27),nm_rek) a ORDER BY kd_rek,nu  
				";
						
		if($id=='1.20.06.00')
		{
	         $sql_p = "
	        SELECT * FROM (
			    SELECT SUBSTR(b.no_trdrka,12,23)AS kd_rek,c.`nm_rek1` AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=4),0) AS cp,'0' AS kredit,'0' AS debet,
			    '1' AS nu FROM trskpd a
			    LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
			    INNER JOIN ms_rek1 c ON LEFT(b.kd_rek5,1)=c.kd_rek1
			    WHERE a.kd_skpd='1.20.06.00' AND LEFT(b.`kd_rek5`,1)='4'
			    GROUP BY kd_rek
			    UNION
			    SELECT SUBSTR(b.no_trdrka,12,24)  AS kd_rek,c.nm_rek2 AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,2)=c.kd_rek2),0) AS cp,'0' AS kredit,'0' AS debet,
			    '2' AS nu FROM trskpd a
			    LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
			    INNER JOIN ms_rek2 c ON LEFT(b.kd_rek5,2)=c.kd_rek2
			    WHERE a.kd_skpd='1.20.06.00' AND LEFT(b.`kd_rek5`,1)='4'
			    GROUP BY kd_rek
			    UNION 
			    SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS cp,'0' AS kredit,'0' AS debet,
			    '3' AS nu
			    FROM trdrka a 
			    INNER JOIN ms_rek3 b 
			    ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='1.20.06.00' AND LEFT(a.kd_rek5,1)='4' 
			    GROUP BY SUBSTR(a.no_trdrka,12,25)
			    UNION
			    SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,5)=b.kd_rek4),0) AS cp,'0' AS kredit,'0' AS debet,
			    '4' AS nu
			    FROM trdrka a INNER JOIN ms_rek4 b 
			    ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='1.20.06.00' AND LEFT(a.kd_rek5,1)='4' 
			    GROUP BY SUBSTR(a.no_trdrka,12,27),nm_rek) a ORDER BY kd_rek,nu  
			";
		}
		if($id=='1.20.06.00')
		{
	         $sql_p = "
	        SELECT * FROM (
			    SELECT SUBSTR(b.no_trdrka,12,23)AS kd_rek,c.`nm_rek1` AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=4),0) AS cp,'0' AS kredit,'0' AS debet,
			    '1' AS nu FROM trskpd a
			    LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
			    INNER JOIN ms_rek1 c ON LEFT(b.kd_rek5,1)=c.kd_rek1
			    WHERE a.kd_skpd='1.20.06.00' AND LEFT(b.`kd_rek5`,1)='4'
			    GROUP BY kd_rek
			    UNION
			    SELECT SUBSTR(b.no_trdrka,12,24)  AS kd_rek,c.nm_rek2 AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,2)=c.kd_rek2),0) AS cp,'0' AS kredit,'0' AS debet,
			    '2' AS nu FROM trskpd a
			    LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
			    INNER JOIN ms_rek2 c ON LEFT(b.kd_rek5,2)=c.kd_rek2
			    WHERE a.kd_skpd='1.20.06.00' AND LEFT(b.`kd_rek5`,1)='4'
			    GROUP BY kd_rek
			    UNION 
			    SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS cp,'0' AS kredit,'0' AS debet,
			    '3' AS nu
			    FROM trdrka a 
			    INNER JOIN ms_rek3 b 
			    ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='1.20.06.00' AND LEFT(a.kd_rek5,1)='4' 
			    GROUP BY SUBSTR(a.no_trdrka,12,25)
			    UNION
			    SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,5)=b.kd_rek4),0) AS cp,'0' AS kredit,'0' AS debet,
			    '4' AS nu
			    FROM trdrka a INNER JOIN ms_rek4 b 
			    ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='1.20.06.00' AND LEFT(a.kd_rek5,1)='4' 
			    GROUP BY SUBSTR(a.no_trdrka,12,27),nm_rek) a ORDER BY kd_rek,nu  
			";
		}

				
				
//DNA 
		$pend = $this->db->query($sql_p);
		
		
		foreach ($pend->result() as $row)
		{
			$kode = $row->kd_rek;
			$nama = $row->nm_rek;
			$ang = number_format($row->nilai_u, "2", ".", ",");
			$angaran = $row->nilai_u;
			$pen = $row->cp;
			$debet = $row->debet;
			$kredit = $row->kredit;
			$real = ($pen + $kredit) - $debet;
			$nreal = number_format($real, "2", ".", ",");
			$real_s = $real - $angaran;
			if ($real_s < 0)
			{
				$x1 = "(";
				$real_s = $real_s * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisih = number_format($real_s, "2", ".", ",");
			$per1 = ($real_s != 0) ? ($real_s / $row->nilai_u) * 100 : 0;
			$persen1 = number_format($per1);

	if(strlen($kode)<=24){
			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\"><b>$kode</b></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"><b>$nama</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$ang</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nreal</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$pend_selisih$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen1</b></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"><b></td>
									</tr>
									";
		} else {
					$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$kode</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisih$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
									</tr>
									";
			}
		}

		$sqltp = "SELECT SUM(a.nilai) AS totp,SUM(a.nilai_ubah) AS totp_u, 
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=4),0) AS cp,'0' AS kredit,'0' AS debet
						FROM trdrka a
						WHERE LEFT(kd_rek5,1)='4' AND kd_skpd='$id'";

		if($id=='1.20.06.00' )
		{
		$sqltp = "SELECT SUM(a.nilai) AS totp,SUM(a.nilai_ubah) AS totp_u, 
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=4),0) AS cp,'0' AS kredit,'0' AS debet
						FROM trdrka a
						WHERE LEFT(kd_rek5,1)='4' AND kd_skpd='1.20.06.00'";
		}
		if($id=='1.20.06.00' )
		{
		$sqltp = "SELECT SUM(a.nilai) AS totp,SUM(a.nilai_ubah) AS totp_u, 
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=4),0) AS cp,'0' AS kredit,'0' AS debet
						FROM trdrka a
						WHERE LEFT(kd_rek5,1)='4' AND kd_skpd='1.20.06.00'";
		}

						
						
		$sqlp = $this->db->query($sqltp);
		foreach ($sqlp->result() as $rowp)
		{
			$angp = number_format($rowp->totp_u, "2", ".", ",");
			$angaranp = $rowp->totp_u;
			$penp = $rowp->cp;
			$debetp = $rowp->debet;
			$kreditp = $rowp->kredit;
			$realp = ($penp + $kreditp) - $debetp;
			$nrealp = number_format($realp, "2", ".", ",");
			$real_sp = $realp - $angaranp;
			if ($real_sp < 0)
			{
				$x1 = "(";
				$real_sp = $real_sp * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisihp = number_format($real_sp, "2", ".", ",");
			$per1p = ($real_sp != 0) ? ($real_sp / $rowp->totp_u) * 100 : 0;
			$persen1p = number_format($per1p);

			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\"><b>Jumlah Pendapatan Daerah</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$angp</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nrealp</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$pend_selisihp$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen1p</b></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";

			$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";
		}

/*
		$sqltb = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u, 
			(SELECT SUM(rupiah) FROM trdkasin_ppkd a INNER JOIN trhkasin_ppkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,1)='5' AND a.kd_skpd='$id' ) AS cp,
			(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5_ang,1)='5' AND d.kd_skpd='$id' ) AS debet,
			(SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5_ang,1)='5' AND f.kd_skpd='$id' ) AS kredit FROM trdrka a
			WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='$id'";
*/			
        $sqltb="
				SELECT SUM(nilai) AS totb,SUM(nilai_ubah) AS totb_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=5),0) AS debet,'0' AS kredit,'' AS cp
				FROM trdrka WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='$id'";
				
		if($id=='1.20.06.00')
		{
        $sqltb="
				SELECT SUM(nilai) AS totb,SUM(nilai_ubah) AS totb_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=5),0) AS debet,'0' AS kredit,'' AS cp
				FROM trdrka WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='1.20.06.00'";
		}
		if($id=='1.20.06.00')
		{
        $sqltb="
				SELECT SUM(nilai) AS totb,SUM(nilai_ubah) AS totb_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=5),0) AS debet,'0' AS kredit,'' AS cp
				FROM trdrka WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='1.20.06.00'";
		}

	
		$sqlb = $this->db->query($sqltb);
		foreach ($sqlb->result() as $rowb_5)
		{
			$ang_5 = number_format($rowb_5->totb_u, "2", ".", ",");
			$angaran_5 = $rowb_5->totb_u;
			$in_5 = $rowb_5->cp;
			$debet_5 = $rowb_5->debet;
			$kredit_5 = $rowb_5->kredit;
			$real_5 = $debet_5 - ($in_5 + $kredit_5);
			$nreal_5 = number_format($real_5, "2", ".", ",");
			$real_s_5 = $real_5 - $angaran_5;
			if ($real_s_5 < 0)
			{
				$x1 = "(";
				$real_s_5 = $real_s_5 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_5 = number_format($real_s_5, "2", ".", ",");
			$per_5 = ($real_s_5 != 0) ? ($real_s_5 / $rowb_5->totb_u) * 100 : 0;
			$persen_5 = number_format($per_5);

			$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\"><b>Belanja Daerah</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$ang_5</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nreal_5</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$selisih_5$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen_5</b></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";


		}

		$sqltbtl = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u, 
			        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,2)=51),0) AS debet,'0' AS kredit,'' AS cp
					FROM trdrka a
					WHERE LEFT(kd_rek5,2)='51' AND kd_skpd='$id'";
		if($id=='1.20.06.00')
		{
		$sqltbtl = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u,
			        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,2)=51),0) AS debet,'0' AS kredit,'' AS cp
							FROM trdrka a
							WHERE LEFT(kd_rek5,2)='51' AND kd_skpd='1.20.06.00'";
		}
		if($id=='1.20.06.00')
		{
		$sqltbtl = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u,
			        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,2)=51),0) AS debet,'0' AS kredit,'' AS cp
							FROM trdrka a
							WHERE LEFT(kd_rek5,2)='51' AND kd_skpd='1.20.06.00'";
		}
					

		$sqlbtl = $this->db->query($sqltbtl);
		foreach ($sqlbtl->result() as $rowbtl)
		{
			$ang_51 = number_format($rowbtl->totb_u, "2", ".", ",");
			$angaran_51 = $rowbtl->totb_u;
			$in_51 = $rowbtl->cp;
			$debet_51 = $rowbtl->debet;
			$kredit_51 = $rowbtl->kredit;
			$real_51 = $debet_51 - ($in_51 + $kredit_51);
			$nreal_51 = number_format($real_51, "2", ".", ",");
			$real_s_51 = $real_51 - $angaran_51;
			if ($real_s_51 < 0)
			{
				$x1 = "(";
				$real_s_51 = $real_s_51 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_51 = number_format($real_s_51, "2", ".", ",");
			$per_51 = ($real_s_51 != 0) ? ($real_s_51 / $rowbtl->totb_u) * 100 : 0;
			$persen_51 = number_format($per_51);


		}


//		$sql_btl = "SELECT * FROM (SELECT a.kd_kegiatan AS kd_rek,c.nm_kegiatan AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
//						(SELECT SUM(rupiah) FROM trdkasin_pkd g INNER JOIN trhkasin_pkd h ON g.no_sts = h.no_sts WHERE h.kd_skpd='$id' AND h.kd_kegiatan = a.kd_kegiatan ) AS cp,
//						(SELECT SUM(debet) FROM trdju_pkd i  INNER JOIN trhju_pkd j ON i.no_voucher = j.no_voucher  WHERE j.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan ) AS debet,
//						(SELECT SUM(kredit) FROM trdju_pkd k  INNER JOIN trhju_pkd l ON k.no_voucher = l.no_voucher WHERE l.kd_skpd='$id' AND kd_kegiatan = a.kd_kegiatan ) AS kredit,'2' AS nu FROM trskpd a INNER JOIN m_giat c ON a.kd_kegiatan1=c.kd_kegiatan
//						LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan WHERE a.kd_skpd='$id' AND RIGHT(a.kd_kegiatan,5) ='00.02' GROUP BY a.kd_kegiatan,c.nm_kegiatan
//						UNION ALL 
//						SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
//						(SELECT SUM(c.rupiah) FROM trdkasin_pkd c INNER JOIN trhkasin_pkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
//						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
//						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
//						ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,25)) a ORDER BY kd_rek,nu";


//=====DN

		$sql_btl = "
		SELECT * FROM (
						SELECT SUBSTR(b.no_trdrka,12,24)  AS kd_rek,c.nm_rek2 AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND kd_kegiatan=a.`kd_kegiatan` AND LEFT(kd_rek5_ang,2)=c.kd_rek2),0) AS debet,'0' AS kredit,'' AS cp,
						'2' AS nu 
						FROM trskpd a 
						LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						INNER JOIN ms_rek2 c ON LEFT(b.kd_rek5,2)=c.kd_rek2
						WHERE a.kd_skpd='$id' AND RIGHT(a.kd_kegiatan,6) ='.00.02' AND LEFT(b.`kd_rek5`,1)='5'
						GROUP BY a.kd_kegiatan
						UNION ALL 
						SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND kd_kegiatan=a.`kd_kegiatan` AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'0' AS kredit,'' AS cp,
						'3' AS nu 
						FROM trdrka a INNER JOIN ms_rek3 b 
						ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND RIGHT(a.kd_kegiatan,6) ='.00.02' AND LEFT(a.kd_rek5,1)='5' GROUP BY SUBSTR(a.no_trdrka,12,25)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND kd_kegiatan=a.`kd_kegiatan` AND LEFT(kd_rek5_ang,5)=b.kd_rek4),0) AS debet,'0' AS kredit,'' AS cp,
						'4' AS nu 
						FROM trdrka a INNER JOIN ms_rek4 b 
						ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND RIGHT(a.kd_kegiatan,6) ='.00.02' AND LEFT(a.kd_rek5,1)='5' GROUP BY SUBSTR(a.no_trdrka,12,27)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,b.nm_rek5 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND kd_kegiatan=a.`kd_kegiatan` AND kd_rek5_ang=b.kd_rek5),0) AS debet,'0' AS kredit,'' AS cp,
						'5' AS nu
						FROM trdrka a INNER JOIN ms_rek5 b 
						ON a.kd_rek5=b.kd_rek5 WHERE a.kd_skpd='$id' AND RIGHT(a.kd_kegiatan,6) ='.00.02' AND LEFT(a.kd_rek5,1)='5' GROUP BY SUBSTR(a.no_trdrka,12,29)
						) a ORDER BY kd_rek,nu ";
						
		if($id=='1.20.06.00')
		{
		$sql_btl = "	
		SELECT * FROM (
						SELECT SUBSTR(b.no_trdrka,12,24)  AS kd_rek,c.nm_rek2 AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,2)=c.kd_rek2),0) AS debet,'0' AS kredit,'' AS cp,
						'2' AS nu 
						FROM trskpd a 
						LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						INNER JOIN ms_rek2 c ON LEFT(b.kd_rek5,2)=c.kd_rek2
						WHERE a.kd_skpd='1.20.06.00' AND RIGHT(a.kd_kegiatan,6) ='.00.02' AND LEFT(b.`kd_rek5`,1)='5'
						GROUP BY a.kd_kegiatan
						UNION ALL 
						SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'0' AS kredit,'' AS cp,
						'3' AS nu 
						FROM trdrka a INNER JOIN ms_rek3 b 
						ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='1.20.06.00' AND RIGHT(a.kd_kegiatan,6) ='.00.02' AND LEFT(a.kd_rek5,1)='5' GROUP BY SUBSTR(a.no_trdrka,12,25)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00'  AND LEFT(kd_rek5_ang,5)=b.kd_rek4),0) AS debet,'0' AS kredit,'' AS cp,
						'4' AS nu 
						FROM trdrka a INNER JOIN ms_rek4 b 
						ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='1.20.06.00' AND RIGHT(a.kd_kegiatan,6) ='.00.02' AND LEFT(a.kd_rek5,1)='5' GROUP BY SUBSTR(a.no_trdrka,12,27)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,b.nm_rek5 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00'  AND kd_rek5_ang=b.kd_rek5),0) AS debet,'0' AS kredit,'' AS cp,
						'5' AS nu
						FROM trdrka a INNER JOIN ms_rek5 b 
						ON a.kd_rek5=b.kd_rek5 WHERE a.kd_skpd='1.20.06.00' AND RIGHT(a.kd_kegiatan,6) ='.00.02' AND LEFT(a.kd_rek5,1)='5' GROUP BY SUBSTR(a.no_trdrka,12,29)
						) a ORDER BY kd_rek,nu ";
		}
		$btl = $this->db->query($sql_btl);

//====DNA


		foreach ($btl->result() as $row_btl)
		{
			$kode = $row_btl->kd_rek;
			$nama = $row_btl->nm_rek;
			$ang_511 = number_format($row_btl->nilai_u, "2", ".", ",");
			$angaran_511 = $row_btl->nilai_u;
			$in_511 = $row_btl->cp;
			$debet_511 = $row_btl->debet;
			$kredit_511 = $row_btl->kredit;
			$real_511 = $debet_511 - ($in_511 + $kredit_511);
			$nreal_511 = number_format($real_511, "2", ".", ",");
			$real_s_511 = $real_511 - $angaran_511;
			if ($real_s_511 < 0)
			{
				$x1 = "(";
				$real_s_511 = $real_s_511 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_511 = number_format($real_s_511, "2", ".", ",");
			$per_511 = ($real_s_511 != 0) ? ($real_s_511 / $row_btl->nilai_u) * 100 : 0;
			$persen_511 = number_format($per_511);

	if(strlen($kode)<=24)
	{			
	$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\"><b>$kode</b></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"><b>$nama</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$ang_511</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nreal_511</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$selisih_511$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen_511</b></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"><b></b></td>
									</tr>
									";


	}else{
	$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$kode</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_511</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_511</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_511$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_511</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
									</tr>
									";
	}
}
		$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";

/*
		$sqltbl = "SELECT SUM(a.nilai) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
						(SELECT SUM(rupiah) FROM trdkasin_ppkd a INNER JOIN trhkasin_ppkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='52' AND a.kd_skpd='$id') AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5_ang,2)='52' AND d.kd_skpd='$id') AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5_ang,2)='52' AND f.kd_skpd='$id') AS kredit FROM trdrka a
						WHERE LEFT(kd_rek5,2)='52' AND kd_skpd='$id'";
*/						
		$sqltbl = "SELECT SUM(a.nilai) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
			        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,2)=51),0) AS debet,'0' AS kredit,'' AS cp
					FROM trdrka a
					WHERE LEFT(kd_rek5,2)='52' AND kd_skpd='$id'";
		if($id=='1.20.06.00')
		{
		$sqltbl = "SELECT SUM(a.nilai) AS totbl,SUM(a.nilai_ubah) AS totbl_u,
			        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,2)=52),0) AS debet,'0' AS kredit,'' AS cp
							FROM trdrka a
							WHERE LEFT(kd_rek5,2)='52' AND kd_skpd='1.20.06.00'";
		}
		if($id=='1.20.06.00')
		{
		$sqltbl = "SELECT SUM(a.nilai) AS totbl,SUM(a.nilai_ubah) AS totbl_u,
			        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,2)=51),0) AS debet,'0' AS kredit,'' AS cp
							FROM trdrka a
							WHERE LEFT(kd_rek5,2)='52' AND kd_skpd='1.20.06.00'";
		}

		$sqlbl = $this->db->query($sqltbl);
		foreach ($sqlbl->result() as $rowbl)
		{
			$ang_52 = number_format($rowbl->totbl_u, "2", ".", ",");
			$angaran_52 = $rowbl->totbl_u;
			$in_52 = $rowbl->cp;
			$debet_52 = $rowbl->debet;
			$kredit_52 = $rowbl->kredit;
			$real_52 = $debet_52 - ($in_52 + $kredit_52);
			$nreal_52 = number_format($real_52, "2", ".", ",");
			$real_s_52 = $real_52 - $angaran_52;
			if ($real_s_52 < 0)
			{
				$x1 = "(";
				$real_s_52 = $real_s_52 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_52 = number_format($real_s_52, "2", ".", ",");
			$per_52 = ($real_s_52 != 0) ? ($real_s_52 / $rowbl->totbl_u) * 100 : 0;
			$persen_52 = number_format($per_52);


			$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\"><b>Belanja Langsung</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$ang_52</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nreal_52</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$selisih_52$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen_52</b></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";
	}
		$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";


		$sql_bl = "		
					SELECT * FROM (
						SELECT a.`kd_program` AS kd_rek,a.`nm_program` AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id'  AND SUBSTR(kd_kegiatan,1,18)=a.`kd_program` AND LEFT(kd_rek5_ang,1)=c.kd_rek1),0) AS debet,'0' AS kredit,'' AS cp,
						'1' AS nu FROM trskpd a 
						LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						INNER JOIN ms_rek1 c ON LEFT(b.kd_rek5,1)=c.kd_rek1
						WHERE a.kd_skpd='$id' AND RIGHT(a.kd_kegiatan,6) <>'.00.02' AND LEFT(b.`kd_rek5`,2)='52'
						GROUP BY a.`kd_program`
						UNION
						SELECT a.`kd_kegiatan` AS kd_rek,a.`nm_kegiatan` AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND kd_kegiatan=a.`kd_kegiatan` AND LEFT(kd_rek5_ang,2)=c.kd_rek2),0) AS debet,'0' AS kredit,'' AS cp,
						'2' AS nu FROM trskpd a 
						LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						INNER JOIN ms_rek2 c ON LEFT(b.kd_rek5,2)=c.kd_rek2
						WHERE a.kd_skpd='$id' AND RIGHT(a.kd_kegiatan,6) <>'.00.02' AND RIGHT(a.kd_kegiatan,6) <>'.00.01'
						GROUP BY a.`kd_kegiatan`
						UNION
						SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,b.nm_rek5 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND kd_kegiatan=a.`kd_kegiatan` AND kd_rek5_ang=b.kd_rek5),0) AS debet,'0' AS kredit,'' AS cp,
						'5' AS nu FROM trdrka a INNER JOIN ms_rek5 b 
						ON a.kd_rek5=b.kd_rek5 WHERE a.kd_skpd='$id'  AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,29)
						) a ORDER BY kd_rek,nu 
						";
		if($id=='1.20.06.00')
		{
		$sql_bl = "		
					SELECT * FROM (
						SELECT a.`kd_program` AS kd_rek,a.`nm_program` AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=c.kd_rek1),0) AS debet,'0' AS kredit,'' AS cp,
						'1' AS nu FROM trskpd a 
						LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						INNER JOIN ms_rek1 c ON LEFT(b.kd_rek5,1)=c.kd_rek1
						WHERE a.kd_skpd='1.20.06.00' AND LEFT(b.`kd_rek5`,2)='52' AND RIGHT(a.kd_kegiatan,6) <>'.00.02'
						GROUP BY a.`kd_program`
						UNION
						SELECT a.`kd_kegiatan` AS kd_rek,a.`nm_kegiatan` AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00'  AND LEFT(kd_rek5_ang,2)=c.kd_rek2),0) AS debet,'0' AS kredit,'' AS cp,
						'2' AS nu FROM trskpd a 
						LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						INNER JOIN ms_rek2 c ON LEFT(b.kd_rek5,2)=c.kd_rek2
						WHERE a.kd_skpd='1.20.06.00' AND LEFT(b.kd_rek5,2)='52' AND RIGHT(a.kd_kegiatan,6) <>'.00.02'
						GROUP BY a.`kd_kegiatan`
						UNION
						SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,b.nm_rek5 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND kd_rek5_ang=b.kd_rek5),0) AS debet,'0' AS kredit,'' AS cp,
						'5' AS nu FROM trdrka a INNER JOIN ms_rek5 b 
						ON a.kd_rek5=b.kd_rek5 WHERE a.kd_skpd='1.20.06.00' AND RIGHT(a.kd_kegiatan,6) <>'.00.02' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,29)
						) a ORDER BY kd_rek,nu 
						";
		}
//====DNA


		$bl = $this->db->query($sql_bl);
		foreach ($bl->result() as $row_bl)
		{
			$kode = $row_bl->kd_rek;
			$nama = $row_bl->nm_rek;
			$ang_522 = number_format($row_bl->nilai_u, "2", ".", ",");
			$angaran_522 = $row_bl->nilai_u;
			$in_522 = $row_bl->cp;
			$debet_522 = $row_bl->debet;
			$kredit_522 = $row_bl->kredit;
			$real_522 = $debet_522 - ($in_522 + $kredit_522);
			$nreal_522 = number_format($real_522, "2", ".", ",");
			$real_s_522 = $real_522 - $angaran_522;
			if ($real_s_522 < 0)
			{
				$x1 = "(";
				$real_s_522 = $real_s_522 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_522 = number_format($real_s_522, "2", ".", ",");
			$per_522 = ($real_s_522 != 0) ? ($real_s_522 / $row_bl->nilai_u) * 100 : 0;
			$persen_522 = number_format($per_522);

			if(strlen($kode)<=21){
				$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\"><b>$kode</b></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"><b>$nama</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$ang_522</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nreal_522</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$selisih_522$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen_522</b></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
									</tr>
									";
			}ELSE{
				$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$kode</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_522</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_522</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_522$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_522</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
									</tr>
									";
			}

		}
		$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";


		$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\"><b>Belanja Daerah</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$ang_5</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nreal_5</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$selisih_5$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen_5</b></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";
		$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";

						
		$sqltpm = "				
				    SELECT IFNULL(SUM(a.nilai_ubah),0) AS totbl_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=61 AND kd_skpd='$id'),0)
					AS debet,'0' AS kredit,'' as cp
					FROM trdrka a 
					WHERE LEFT (a.kd_rek5,2)=61 AND kd_skpd='$id' ";
					
		if($id=='1.20.06.00')
		{
		$sqltpm = "				
				    SELECT IFNULL(SUM(a.nilai_ubah),0) AS totbl_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=61 AND kd_skpd='1.20.06.00'),0)
					AS debet,'0' AS kredit,'' as cp
					FROM trdrka a 
					WHERE LEFT (a.kd_rek5,2)=61 AND kd_skpd='1.20.06.00' ";
		}
		
		$sqlpm = $this->db->query($sqltpm);
		foreach ($sqlpm->result() as $rowpm)
		{
			$ang_61 = number_format($rowpm->totbl_u, "2", ".", ",");
			$angaran_61 = $rowpm->totbl_u;
			$in_61 = $rowpm->cp;
			$debet_61 = $rowpm->debet;
			$kredit_61 = $rowpm->kredit;
			$real_61 = $debet_61 - ($in_61 + $kredit_61);
			$nreal_61 = number_format($real_61, "2", ".", ",");
			$real_s_61 = $real_61 - $angaran_61;
			if ($real_s_61 < 0)
			{
				$x1 = "(";
				$real_s_61 = $real_s_61 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_61 = number_format($real_s_61, "2", ".", ",");
			$per_61 = ($real_s_61 != 0) ? ($real_s_61 / $rowpm->totbl_u) * 100 : 0;
			$persen_61 = number_format($per_61);
			
								$cRet	.= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
												<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\"><b>Pembiayaan Masuk</b></td>
												<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$ang_61</b></td>
												<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nreal_61</b></td>
												<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$selisih_61$y1</b></td>
												<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen_61</b></td>
												<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
												</tr>";
		}


		$sqlpm = "
			        SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.`lra` AS Rekening,b.nm_rek2 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=b.`kd_rek2` and kd_skpd='$id' ),0)
					AS debet,'0' AS kredit,'0' AS Realisasi,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.`kd_rek5`,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=6 and a.kd_skpd='$id'
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.`lra` AS Rekening,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=6 AND LEFT(kd_rek5_ang,3)=b.kd_rek3 and kd_skpd='$id'),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3
					WHERE LEFT (a.kd_rek5,1)=6 and a.kd_skpd='$id'
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.`lra` AS Rekening,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=6 AND LEFT(kd_rek5_ang,3)=b.kd_rek3 and kd_skpd='$id'),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=6 and a.kd_skpd='$id'
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.`lra` AS Rekening,b.nm_rek4 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=6 AND LEFT(kd_rek5_ang,5)=b.kd_rek4 and kd_skpd='$id'),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'4' AS nu
					FROM trdrka a JOIN ms_rek4 b ON LEFT(a.kd_rek5,3)=b.kd_rek4
					WHERE LEFT(a.kd_rek5,1)=6 and a.kd_skpd='$id'
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,b.`lra` AS Rekening,b.nm_rek5 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=6 AND kd_rek5_ang=b.kd_rek5 and kd_skpd='$id'),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'5' AS nu
					FROM trdrka a JOIN ms_rek5 b ON LEFT(a.kd_rek5,3)=b.kd_rek5
					WHERE LEFT(a.kd_rek5,1)=6 and a.kd_skpd='$id'
					GROUP BY b.`lra`					
					ORDER BY kd_rek,Rekening,nu ";
					
		if($id=='1.20.06.00')
		{
		$sqlpm = "
			        SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.`lra` AS Rekening,b.nm_rek2 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=61 AND LEFT(kd_rek5_ang,2)=b.`kd_rek2`),0)
					AS debet,'0' AS kredit,'0' AS Realisasi,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.`kd_rek5`,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,2)=61
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.`lra` AS Rekening,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,2)=61 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3
					WHERE LEFT (a.kd_rek5,2)=61
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.`lra` AS Rekening,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,2)=61 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,2)=61
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.`lra` AS Rekening,b.nm_rek4 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,2)=61 AND LEFT(kd_rek5_ang,5)=b.kd_rek4),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'4' AS nu
					FROM trdrka a JOIN ms_rek4 b ON LEFT(a.kd_rek5,3)=b.kd_rek4
					WHERE LEFT(a.kd_rek5,2)=61
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,b.`lra` AS Rekening,b.nm_rek5 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,2)=61 AND kd_rek5_ang=b.kd_rek5),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'5' AS nu
					FROM trdrka a JOIN ms_rek5 b ON LEFT(a.kd_rek5,3)=b.kd_rek5
					WHERE LEFT(a.kd_rek5,2)=61
					GROUP BY b.`lra`					
					ORDER BY kd_rek,Rekening,nu ";
		}
		
		$sql611 = $this->db->query($sqlpm);
		foreach ($sql611->result() as $row_61)
		{
			$kd = $row_61->kd_rek;
			$nm = $row_61->nm_rek;
			$ang_611 = number_format($row_61->nilai_u, "2", ".", ",");
			$angaran_611 = $row_61->nilai_u;
			$in_611 = $row_61->cp;
			$debet_611 = $row_61->debet;
			$kredit_611 = $row_61->kredit;
			$real_611 = $debet_611 - ($in_611 + $kredit_611);
			$nreal_611 = number_format($real_611, "2", ".", ",");
			$real_s_611 = $real_611 - $angaran_611;
			if ($real_s_611 < 0)
			{
				$x1 = "(";
				$real_s_611 = $real_s_611 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_611 = number_format($real_s_611, "2", ".", ",");
			$per_611 = ($real_s_611 != 0) ? ($real_s_611 / $row_61->nilai_u) * 100 : 0;
			$persen_611 = number_format($per_611);

	if(strlen($kd)<=24)
	{
			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"15%\" align=\"left\"><b>$kd</b></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"26%\"><b>$nm</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\"><b>$ang_611</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\"><b>$nreal_611</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\"><b>$x1$selisih_611$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"3%\" align=\"right\"><b>$persen_611</b></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";
	}else{
			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"15%\" align=\"left\">$kd</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"26%\">$nm</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$ang_611</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$nreal_611</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$x1$selisih_611$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"3%\" align=\"right\">$persen_611</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";
	}
}
		$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";

		$sqltpk = "
				    SELECT IFNULL(SUM(a.nilai_ubah),0) AS totbl_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=62 AND kd_skpd='$id'),0)
					AS debet,'0' AS kredit,'' as cp
					FROM trdrka a 
					WHERE LEFT (a.kd_rek5,2)=62 AND kd_skpd='$id' ";
		
		if($id=='1.20.06.00')
	  {
		$sqltpk = "
				    SELECT IFNULL(SUM(a.nilai_ubah),0) AS totbl_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=62 AND kd_skpd='1.20.06.00'),0)
					AS debet,'0' AS kredit,'' as cp
					FROM trdrka a 
					WHERE LEFT (a.kd_rek5,2)=62 AND kd_skpd='1.20.06.00' ";
	  }
	  

		$sqlpk = $this->db->query($sqltpk);
		foreach ($sqlpk->result() as $rowpk)
		{
			$ang_62 = number_format($rowpk->totbl_u, "2", ".", ",");
			$angaran_62 = $rowpk->totbl_u;
			//echo($angaran_62);
			$in_62 = $rowpk->cp;
			$debet_62 = $rowpk->debet;
			$kredit_62 = $rowpk->kredit;
			$real_62 = $debet_62 - ($in_62 + $kredit_62);
			$nreal_62 = number_format($real_62, "2", ".", ",");
			$real_s_62 = $real_62 - $angaran_62;
			if ($real_s_62 < 0)
			{
				$x1 = "(";
				$real_s_62 = $real_s_62 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_62 = number_format($real_s_62, "2", ".", ",");
			$per_62 = ($real_s_62 != 0) ? ($real_s_62 / $rowpk->totbl_u) * 100 : 0;
			$persen_62 = number_format($per_62);

								$cRet	.= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
												<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\"><b>Pembiayaan Keluar</b></td>
												<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$ang_62</b></td>
												<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nreal_62</b></td>
												<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$selisih_62$y1</b></td>
												<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen_62</b></td>
												<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
												</tr>";
		}
/*
		$sqlpk = "
		SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_ppkd c INNER JOIN trhkasin_ppkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5_ang,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5_ang,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
						ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,25)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_ppkd c INNER JOIN trhkasin_ppkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5_ang,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5_ang,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
						ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,26) ) a ORDER BY kd_rek,nu";
*/						
		$sqlpk = "
					SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,3)=LEFT(a.kd_rek5,3) AND kd_kegiatan=a.kd_kegiatan AND kd_skpd='$id'),0) AS debet,'0' AS kredit,'' AS cp,
					'4' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
					ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,25)
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,3)=LEFT(a.kd_rek5,3) AND kd_kegiatan=a.kd_kegiatan AND kd_skpd='$id'),0) AS debet,'0' AS kredit,'' AS cp,
					'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
					ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,26) ) a ORDER BY kd_rek,nu ";
		
		IF($id=='1.20.06.00')
		{
		$sqlpk = "
		        SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.`lra` AS Rekening,b.nm_rek2 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=62 AND LEFT(kd_rek5_ang,2)=b.`kd_rek2`),0)
					AS debet,'0' AS kredit,'0' AS Realisasi,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.`kd_rek5`,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,2)=62
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.`lra` AS Rekening,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,2)=62 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3
					WHERE LEFT (a.kd_rek5,2)=62
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.`lra` AS Rekening,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,2)=62 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,2)=62
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.`lra` AS Rekening,b.nm_rek4 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,2)=62 AND LEFT(kd_rek5_ang,5)=b.kd_rek4),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'4' AS nu
					FROM trdrka a JOIN ms_rek4 b ON LEFT(a.kd_rek5,3)=b.kd_rek4
					WHERE LEFT(a.kd_rek5,2)=62
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,b.`lra` AS Rekening,b.nm_rek5 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,2)=62 AND kd_rek5_ang=b.kd_rek5),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'5' AS nu
					FROM trdrka a JOIN ms_rek5 b ON LEFT(a.kd_rek5,3)=b.kd_rek5
					WHERE LEFT(a.kd_rek5,2)=62
					GROUP BY b.`lra`					
					ORDER BY kd_rek,Rekening,nu ";
			}
		
		$sql62 = $this->db->query($sqlpk);
		foreach ($sql62->result() as $row_62)
		{
			$kd = $row_62->kd_rek;
			$nm = $row_62->nm_rek;
			$ang_622 = number_format($row_62->nilai_u, "2", ".", ",");
			$angaran_622 = $row_62->nilai_u;
			$in_622 = $row_62->cp;
			$debet_622 = $row_62->debet;
			$kredit_622 = $row_62->kredit;
			$real_622 = $debet_622 - ($in_622 + $kredit_622);
			$nreal_622 = number_format($real_622, "2", ".", ",");
			$real_s_622 = $real_622 - $angaran_622;
			if ($real_s_622 < 0)
			{
				$x1 = "(";
				$real_s_622 = $real_s_622 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_622 = number_format($real_s_622, "2", ".", ",");
			$per_622 = ($real_s_611 != 0) ? ($real_s_622 / $row_62->nilai_u) * 100 : 0;
			$persen_622 = number_format($per_622);

	if(strlen($kd)<=24)
	{
			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"15%\" align=\"left\"><b>$kd</b></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"26%\"><b>$nm</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\"><b>$ang_622</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\"><b>$nreal_622</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\"><b>$x1$selisih_622$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"3%\" align=\"right\"><b>$persen_622</b></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";
	}else{
			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"15%\" align=\"left\">$kd</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"26%\">$nm</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$ang_622</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$nreal_622</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$x1$selisih_622$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"3%\" align=\"right\">$persen_622</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";
	}
}
		$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";


		$netto = $angaran_61 - $angaran_62;
		$net = number_format($netto, "2", ",", ".");
		$netto_r = $real_61 - $real_62;
		$net_r = number_format($netto_r, "2", ",", ".");
		$netto_s = $netto_r - $netto;
		if ($netto_s < 0)
		{
			$x1 = "(";
			$netto_s = $netto_s * -1;
			$y1 = ")";
		} else
		{
			$x1 = "";
			$y1 = "";
		}
		$netto_selisih = number_format($netto_s, "2", ",", ".");
		$perpnet = ($netto_s != 0) ? ($netto_s / $netto) * 100 : 0;
		$persennet = number_format($perpnet);


		$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\"><b>Pembiayaan Netto</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$net</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$net_r</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$netto_selisih$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persennet</b></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";

		$silpa = ($angaranp + $angaran_61) - ($angaran_5 + $angaran_62);
		if ($silpa < 0)
		{
			$a = "(";
			$silpa = $silpa * -1;
			$b = ")";
		} else
		{
			$a = "";
			$b = "";
		}
		$silp = number_format($silpa, "2", ",", ".");
		$silpa_real = ($realp + $real_61) - ($real_5 + $real_62);
		if ($silpa_real < 0)
		{
			$c = "(";
			$silpa_real = $silpa_real * -1;
			$d = ")";
		} else
		{
			$c = "";
			$d = "";
		}
		$silp_real = number_format($silpa_real, "2", ",", ".");
		$silpa_s = $silpa_real - $silpa;
		if ($silpa_s < 0)
		{
			$x = "(";
			$silpa_s = $silpa_s * -1;
			$y = ")";
		} else
		{
			$x = "";
			$y = "";
		}
		$silpa_selisih = number_format($silpa_s, "2", ",", ".");
		$persil = ($silpa_s != 0) ? ($silpa_s / $silpa) * 100 : 0;
		$persensilpa = number_format($persil);

		//$cRet	.= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
		//									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">SILPA</td>
		//									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$a$silp$b</td>
		//									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$c$silp_real$d</td>
		//									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x$silpa_selisih$y</td>
		//									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persensilpa</td>
		//									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
		//									</tr>";
		$cRet .= " </table>";
		
//Aktifkan Jika Penandatangan Perlu
 
		 $cRet .="<table>;
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
					</tr>
		 </table>";
 		 $cRet .=" <table width='100%' border=\"0\" cellspacing=\"1\" cellpadding=\"1\">
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>$daerah, ".$this->tukd_model->tanggal_format_indonesia(date("Y-m-d"))."</td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'><b>$jabatan</b></td>
					</tr>
					<tr>
						<td align='center' width='40%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>&nbsp;</td>
					</tr>
					<tr>
						<td align='center' width='40%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>&nbsp;</td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'><b>$namap</b></td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'><b>$nip</b></td>
					</tr>
				  </table>
				";		
		
		
		$data['prev'] = $cRet;
		$this->template->set('title', 'CETAK REALISASI LAMPIRAN III');


		switch ($cetak)
		{
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}

	}
	
//RANCANGAN PERDA LAMPI III2 
	function cetak_perdaIII2_real($skpd = '', $cetak = '')
	{
		$kdskpd	= $skpd;
		$thi	= $this->session->userdata("tahun");
		$thl	= $thi-1;
		$periode= $thi."-12-31";
		
		$qry	= "	select '$periode' periode,'PPKD' kd_skpd,a.nm_skpd,kd_rek5,nm_rek5,
					sum(if(year(tgl_voucher)='$thi',(if(left(kd_rek5,1)in(1,5,6,9) or left(kd_rek5,2)in(72),debet-kredit,kredit-debet)),0))Nilai,
					sum(if(year(tgl_voucher)='$thl',(if(left(kd_rek5,1)in(1,5,6,9) or left(kd_rek5,2)in(72),debet-kredit,kredit-debet)),0))Lalu
					from trhju_ppkd a join trdju_ppkd b on a.kd_skpd=b.kd_skpd and left(kd_rek5,1) in(4,5,6,7)
					and a.no_voucher=b.no_voucher and a.tgl_voucher<='$periode'
					GROUP BY kd_rek5 
					union all
					select '$periode' periode,a.kd_skpd,a.nm_skpd,kd_rek5,nm_rek5,
					sum(if(year(tgl_voucher)='$thi',(if(left(kd_rek5,1)in(1,5,6,9) or left(kd_rek5,2)in(72),debet-kredit,kredit-debet)),0))Nilai,
					sum(if(year(tgl_voucher)='$thl',(if(left(kd_rek5,1)in(1,5,6,9) or left(kd_rek5,2)in(72),debet-kredit,kredit-debet)),0))Lalu
					from trhju_pkd a join trdju_pkd b on a.kd_skpd=b.kd_skpd and left(kd_rek5,1) in(4,5,6,7)
					and a.no_voucher=b.no_voucher and a.tgl_voucher<='$periode'
					GROUP BY kd_rek5 ";

			$sql	= "	CREATE TEMPORARY TABLE realisasi_akt (
						`periode`  varchar(255) ,
						`kd_skpd`  varchar(255) ,
						`nm_skpd`  varchar(255) ,
						`kd_rek5`  varchar(255) ,
						`nm_rek5`  varchar(255) ,
						`nilai`  decimal(20,2) NULL DEFAULT NULL ,
						`lalu`  decimal(20,2) NULL DEFAULT NULL ,
						INDEX `id_akt` (`periode`, `kd_skpd`, `kd_rek5`) USING BTREE 
						) ENGINE=InnoDB DEFAULT CHARACTER SET=latin1 COLLATE=latin1_swedish_ci ROW_FORMAT=COMPACT";
			$del_exec	= $this->db->query($sql);
			if($del_exec){
				$ins_exec	= $this->db->query("insert into realisasi_akt (periode,kd_skpd,nm_skpd,kd_rek5,nm_rek5,nilai,lalu) ".$qry);
				
				$a0	= $this->db->query("CREATE TEMPORARY TABLE the_real_akt (kode varchar(10),Rupiah decimal(20,2),Lalu decimal(20,2) )");
				if($a0){
					$a1	= $this->db->query("insert into the_real_akt select left(kd_rek5,1),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
				if($a1){
					$a2	= $this->db->query("insert into the_real_akt select left(kd_rek5,2),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
				if($a2){
					$a3	= $this->db->query("insert into the_real_akt select left(kd_rek5,3),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
				if($a3){
					$a4	= $this->db->query("insert into the_real_akt select left(kd_rek5,5),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
				if($a4){
					$a5	= $this->db->query("insert into the_real_akt select left(kd_rek5,8),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}

				$Q_ang	= $this->db->query("CREATE TEMPORARY TABLE the_real_ang (kode varchar(10),anggaran decimal(20,2))");
				if($Q_ang){
					$sql	= " insert into the_real_ang
							select left(kd_rek64,7)rek,sum(nilai_ubah)anggaran from trdrka a join ms_rek5 b on kd_skpd='$kdskpd' and a.kd_rek5=b.kd_rek5 group by left(kd_rek64,7) union 
							select left(kd_rek64,5)rek,sum(nilai_ubah)anggaran from trdrka a join ms_rek5 b on kd_skpd='$kdskpd' and a.kd_rek5=b.kd_rek5 group by left(kd_rek64,5) union 
							select left(kd_rek64,3)rek,sum(nilai_ubah)anggaran from trdrka a join ms_rek5 b on kd_skpd='$kdskpd' and a.kd_rek5=b.kd_rek5 group by left(kd_rek64,3) union 
							select left(kd_rek64,2)rek,sum(nilai_ubah)anggaran from trdrka a join ms_rek5 b on kd_skpd='$kdskpd' and a.kd_rek5=b.kd_rek5 group by left(kd_rek64,2) union 
							select left(kd_rek64,1)rek,sum(nilai_ubah)anggaran from trdrka a join ms_rek5 b on kd_skpd='$kdskpd' and a.kd_rek5=b.kd_rek5 group by left(kd_rek64,1)
							";
					$this->db->query($sql);
				}
			}
		
		$cetak	= $cetak;
		$id		= $skpd;
		$sqldns = "SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
		$sqlskpd = $this->db->query($sqldns);
		foreach ($sqlskpd->result() as $rowdns)
		{

			$kd_urusan = $rowdns->kd_u;
			$nm_urusan = $rowdns->nm_u;
			$kd_skpd = $rowdns->kd_sk;
			$nm_skpd = $rowdns->nm_sk;
		}

		$sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
		$sqlsclient = $this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc)
		{

			$tgl = $rowsc->tgl_rka;
			$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
			$kab = $rowsc->kab_kota;
			$daerah = $rowsc->daerah;
			$thn = $rowsc->thn_ang;
		}
		$sqlttd1 = "SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$id' and kode='PA'";
		$sqlttd = $this->db->query($sqlttd1);
		foreach ($sqlttd->result() as $rowttd)
		{
			$nip = $rowttd->nip;
			$namap = $rowttd->nm;
			$jabatan = $rowttd->jab;
		}

		$cRet = '';
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
						<td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"15%\"><strong><h5>LAMPIRAN I.2  :</h5></strong></td>
						<td colspan=\"2\" align=\"left\" width=\"25%\"><strong><h5>RANCANGAN PERATURAN DAERAH</strong></h5></td>
					</tr>
					<tr> 
						<td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>:</h5></td>
					</tr>
					<tr>
						<td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>:</h5></td>
					</tr>
				</table>";
				
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td align=\"center\"><strong>$kab</strong></td>
					</tr>
					<tr>
						<td align=\"center\"><strong>RINGKASAN LAPORAN REALISASI ANGGARAN MENURUT URUSAN PEMERINTAH DAERAH,<br>ORGANISASI,PENDAPATAN,BELANJA DAN PEMBIAYAAN </strong></td>
					</tr>
					<tr>
						<td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
					</tr>

				</table>";
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
					<tr>
						<td width=\"20%\">Urusan Organisasi </td>
						<td width=\"80%\">:$kd_urusan - $nm_urusan</td>
					</tr>
					<tr>
						<td>Organisasi</td>
						<td>:$kd_skpd - $nm_skpd</td>
					</tr>";

		$cRet .= "</table>";

		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
					<thead>					
						<tr><td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Kode Rekening</b></td>							
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"26%\" align=\"center\"><b>Uraian</b></td>							
							<td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"28%\" align=\"center\"><b>Jumlah (Rp.)</b></td>
							<td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"16%\" align=\"center\"><b>Bertambah/ (berkurang)</b></td>
							<td  rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"13%\" align=\"center\"><b>Dasar Hukum</b></td>							
							</tr>
						<tr>
 							<td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Anggaran<br>Perubahan </td>
							<td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Realisasi</td>
							<td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Jumlah</td>
							<td width=\"3%\" bgcolor=\"#CCCCCC\" align=\"center\">%</td>
							
						</tr>	
					</thead>
					<tfoot>
						<tr>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>  
							<td style=\"border-top: none;\"></td>
																				
						</tr>
					</tfoot>
					
					
						<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"center\">&nbsp;</td>							
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"26%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>							
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"14%\">&nbsp;</td>
							</tr>
						";

 
 //====DN

	$sql_p = "
	SELECT * FROM (
			    SELECT SUBSTR(b.no_trdrka,12,23)AS kd_rek,c.`nm_rek1` AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND kd_kegiatan=b.`kd_kegiatan` AND LEFT(kd_rek5_ang,1)=4),0) AS cp,'0' AS kredit,'0' AS debet,
			    '1' AS nu FROM trskpd a
			    LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
			    INNER JOIN ms_rek1 c ON LEFT(b.kd_rek5,1)=c.kd_rek1
			    WHERE a.kd_skpd='$id' AND LEFT(b.`kd_rek5`,1)='4'
			    GROUP BY kd_rek
			    UNION
			    SELECT SUBSTR(b.no_trdrka,12,24)  AS kd_rek,c.nm_rek2 AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND kd_kegiatan=b.`kd_kegiatan` AND LEFT(kd_rek5_ang,2)=c.kd_rek2),0) AS cp,'0' AS kredit,'0' AS debet,
			    '2' AS nu FROM trskpd a
			    LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
			    INNER JOIN ms_rek2 c ON LEFT(b.kd_rek5,2)=c.kd_rek2
			    WHERE a.kd_skpd='$id' AND LEFT(b.`kd_rek5`,1)='4'
			    GROUP BY kd_rek
			    UNION 
			    SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND kd_kegiatan=a.`kd_kegiatan` AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS cp,'0' AS kredit,'0' AS debet,
			    '3' AS nu
			    FROM trdrka a 
			    INNER JOIN ms_rek3 b 
			    ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' 
			    GROUP BY SUBSTR(a.no_trdrka,12,25)
			    UNION
			    SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND kd_kegiatan=a.`kd_kegiatan` AND LEFT(kd_rek5_ang,5)=b.kd_rek4),0) AS cp,'0' AS kredit,'0' AS debet,
			    '4' AS nu
			    FROM trdrka a INNER JOIN ms_rek4 b 
			    ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' 
			    GROUP BY SUBSTR(a.no_trdrka,12,27),nm_rek) a ORDER BY kd_rek,nu  
				";
						
		if($id=='1.20.06.00')
		{
	         $sql_p = "
	        SELECT * FROM (
			    SELECT SUBSTR(b.no_trdrka,12,23)AS kd_rek,c.`nm_rek1` AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=4),0) AS cp,'0' AS kredit,'0' AS debet,
			    '1' AS nu FROM trskpd a
			    LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
			    INNER JOIN ms_rek1 c ON LEFT(b.kd_rek5,1)=c.kd_rek1
			    WHERE a.kd_skpd='1.20.06.00' AND LEFT(b.`kd_rek5`,1)='4'
			    GROUP BY kd_rek
			    UNION
			    SELECT SUBSTR(b.no_trdrka,12,24)  AS kd_rek,c.nm_rek2 AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,2)=c.kd_rek2),0) AS cp,'0' AS kredit,'0' AS debet,
			    '2' AS nu FROM trskpd a
			    LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
			    INNER JOIN ms_rek2 c ON LEFT(b.kd_rek5,2)=c.kd_rek2
			    WHERE a.kd_skpd='1.20.06.00' AND LEFT(b.`kd_rek5`,1)='4'
			    GROUP BY kd_rek
			    UNION 
			    SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS cp,'0' AS kredit,'0' AS debet,
			    '3' AS nu
			    FROM trdrka a 
			    INNER JOIN ms_rek3 b 
			    ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='1.20.06.00' AND LEFT(a.kd_rek5,1)='4' 
			    GROUP BY SUBSTR(a.no_trdrka,12,25)
			    UNION
			    SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,5)=b.kd_rek4),0) AS cp,'0' AS kredit,'0' AS debet,
			    '4' AS nu
			    FROM trdrka a INNER JOIN ms_rek4 b 
			    ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='1.20.06.00' AND LEFT(a.kd_rek5,1)='4' 
			    GROUP BY SUBSTR(a.no_trdrka,12,27),nm_rek) a ORDER BY kd_rek,nu  
			";
		}
		if($id=='1.20.06.00')
		{
	         $sql_p = "
	        SELECT * FROM (
			    SELECT SUBSTR(b.no_trdrka,12,23)AS kd_rek,c.`nm_rek1` AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=4),0) AS cp,'0' AS kredit,'0' AS debet,
			    '1' AS nu FROM trskpd a
			    LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
			    INNER JOIN ms_rek1 c ON LEFT(b.kd_rek5,1)=c.kd_rek1
			    WHERE a.kd_skpd='1.20.06.00' AND LEFT(b.`kd_rek5`,1)='4'
			    GROUP BY kd_rek
			    UNION
			    SELECT SUBSTR(b.no_trdrka,12,24)  AS kd_rek,c.nm_rek2 AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,2)=c.kd_rek2),0) AS cp,'0' AS kredit,'0' AS debet,
			    '2' AS nu FROM trskpd a
			    LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
			    INNER JOIN ms_rek2 c ON LEFT(b.kd_rek5,2)=c.kd_rek2
			    WHERE a.kd_skpd='1.20.06.00' AND LEFT(b.`kd_rek5`,1)='4'
			    GROUP BY kd_rek
			    UNION 
			    SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS cp,'0' AS kredit,'0' AS debet,
			    '3' AS nu
			    FROM trdrka a 
			    INNER JOIN ms_rek3 b 
			    ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='1.20.06.00' AND LEFT(a.kd_rek5,1)='4' 
			    GROUP BY SUBSTR(a.no_trdrka,12,25)
			    UNION
			    SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,5)=b.kd_rek4),0) AS cp,'0' AS kredit,'0' AS debet,
			    '4' AS nu
			    FROM trdrka a INNER JOIN ms_rek4 b 
			    ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='1.20.06.00' AND LEFT(a.kd_rek5,1)='4' 
			    GROUP BY SUBSTR(a.no_trdrka,12,27),nm_rek) a ORDER BY kd_rek,nu  
			";
		}

				
				
//DNA 
		$pend = $this->db->query($sql_p);
		
		
		foreach ($pend->result() as $row)
		{
			$kode = $row->kd_rek;
			$nama = $row->nm_rek;
			$ang = number_format($row->nilai_u, "2", ".", ",");
			$angaran = $row->nilai_u;
			$pen = $row->cp;
			$debet = $row->debet;
			$kredit = $row->kredit;
			$real = ($pen + $kredit) - $debet;
			$nreal = number_format($real, "2", ".", ",");
			$real_s = $real - $angaran;
			if ($real_s < 0)
			{
				$x1 = "(";
				$real_s = $real_s * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisih = number_format($real_s, "2", ".", ",");
			$per1 = ($real_s != 0) ? ($real_s / $row->nilai_u) * 100 : 0;
			$persen1 = number_format($per1);

	if(strlen($kode)<=24){
			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\"><b>$kode</b></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"><b>$nama</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$ang</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nreal</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$pend_selisih$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen1</b></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"><b></td>
									</tr>
									";
		} else {
					$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$kode</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisih$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
									</tr>
									";
			}
		}

		$sqltp = "SELECT SUM(a.nilai) AS totp,SUM(a.nilai_ubah) AS totp_u, 
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=4),0) AS cp,'0' AS kredit,'0' AS debet
						FROM trdrka a
						WHERE LEFT(kd_rek5,1)='4' AND kd_skpd='$id'";

		if($id=='1.20.06.00' )
		{
		$sqltp = "SELECT SUM(a.nilai) AS totp,SUM(a.nilai_ubah) AS totp_u, 
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=4),0) AS cp,'0' AS kredit,'0' AS debet
						FROM trdrka a
						WHERE LEFT(kd_rek5,1)='4' AND kd_skpd='1.20.06.00'";
		}
		if($id=='1.20.06.00' )
		{
		$sqltp = "SELECT SUM(a.nilai) AS totp,SUM(a.nilai_ubah) AS totp_u, 
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=4),0) AS cp,'0' AS kredit,'0' AS debet
						FROM trdrka a
						WHERE LEFT(kd_rek5,1)='4' AND kd_skpd='1.20.06.00'";
		}

						
						
		$sqlp = $this->db->query($sqltp);
		foreach ($sqlp->result() as $rowp)
		{
			$angp = number_format($rowp->totp_u, "2", ".", ",");
			$angaranp = $rowp->totp_u;
			$penp = $rowp->cp;
			$debetp = $rowp->debet;
			$kreditp = $rowp->kredit;
			$realp = ($penp + $kreditp) - $debetp;
			$nrealp = number_format($realp, "2", ".", ",");
			$real_sp = $realp - $angaranp;
			if ($real_sp < 0)
			{
				$x1 = "(";
				$real_sp = $real_sp * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$pend_selisihp = number_format($real_sp, "2", ".", ",");
			$per1p = ($real_sp != 0) ? ($real_sp / $rowp->totp_u) * 100 : 0;
			$persen1p = number_format($per1p);

			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\"><b>Jumlah Pendapatan Daerah</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$angp</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nrealp</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$pend_selisihp$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen1p</b></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";

			$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";
		}

/*
		$sqltb = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u, 
			(SELECT SUM(rupiah) FROM trdkasin_ppkd a INNER JOIN trhkasin_ppkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,1)='5' AND a.kd_skpd='$id' ) AS cp,
			(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5_ang,1)='5' AND d.kd_skpd='$id' ) AS debet,
			(SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5_ang,1)='5' AND f.kd_skpd='$id' ) AS kredit FROM trdrka a
			WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='$id'";
*/			
        $sqltb="
				SELECT SUM(nilai) AS totb,SUM(nilai_ubah) AS totb_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,1)=5),0) AS debet,'0' AS kredit,'' AS cp
				FROM trdrka WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='$id'";
				
		if($id=='1.20.06.00')
		{
        $sqltb="
				SELECT SUM(nilai) AS totb,SUM(nilai_ubah) AS totb_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=5),0) AS debet,'0' AS kredit,'' AS cp
				FROM trdrka WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='1.20.06.00'";
		}
		if($id=='1.20.06.00')
		{
        $sqltb="
				SELECT SUM(nilai) AS totb,SUM(nilai_ubah) AS totb_u,
			    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=5),0) AS debet,'0' AS kredit,'' AS cp
				FROM trdrka WHERE LEFT(kd_rek5,1)='5' AND kd_skpd='1.20.06.00'";
		}

	
		$sqlb = $this->db->query($sqltb);
		foreach ($sqlb->result() as $rowb_5)
		{
			$ang_5 = number_format($rowb_5->totb_u, "2", ".", ",");
			$angaran_5 = $rowb_5->totb_u;
			$in_5 = $rowb_5->cp;
			$debet_5 = $rowb_5->debet;
			$kredit_5 = $rowb_5->kredit;
			$real_5 = $debet_5 - ($in_5 + $kredit_5);
			$nreal_5 = number_format($real_5, "2", ".", ",");
			$real_s_5 = $real_5 - $angaran_5;
			if ($real_s_5 < 0)
			{
				$x1 = "(";
				$real_s_5 = $real_s_5 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_5 = number_format($real_s_5, "2", ".", ",");
			$per_5 = ($real_s_5 != 0) ? ($real_s_5 / $rowb_5->totb_u) * 100 : 0;
			$persen_5 = number_format($per_5);

			$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\"><b>Belanja Daerah</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$ang_5</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nreal_5</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$selisih_5$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen_5</b></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";


		}

		$sqltbtl = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u, 
			        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,2)=51),0) AS debet,'0' AS kredit,'' AS cp
					FROM trdrka a
					WHERE LEFT(kd_rek5,2)='51' AND kd_skpd='$id'";
		if($id=='1.20.06.00')
		{
		$sqltbtl = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u,
			        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,2)=51),0) AS debet,'0' AS kredit,'' AS cp
							FROM trdrka a
							WHERE LEFT(kd_rek5,2)='51' AND kd_skpd='1.20.06.00'";
		}
		if($id=='1.20.06.00')
		{
		$sqltbtl = "SELECT SUM(a.nilai) AS totb,SUM(a.nilai_ubah) AS totb_u,
			        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,2)=51),0) AS debet,'0' AS kredit,'' AS cp
							FROM trdrka a
							WHERE LEFT(kd_rek5,2)='51' AND kd_skpd='1.20.06.00'";
		}
					

		$sqlbtl = $this->db->query($sqltbtl);
		foreach ($sqlbtl->result() as $rowbtl)
		{
			$ang_51 = number_format($rowbtl->totb_u, "2", ".", ",");
			$angaran_51 = $rowbtl->totb_u;
			$in_51 = $rowbtl->cp;
			$debet_51 = $rowbtl->debet;
			$kredit_51 = $rowbtl->kredit;
			$real_51 = $debet_51 - ($in_51 + $kredit_51);
			$nreal_51 = number_format($real_51, "2", ".", ",");
			$real_s_51 = $real_51 - $angaran_51;
			if ($real_s_51 < 0)
			{
				$x1 = "(";
				$real_s_51 = $real_s_51 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_51 = number_format($real_s_51, "2", ".", ",");
			$per_51 = ($real_s_51 != 0) ? ($real_s_51 / $rowbtl->totb_u) * 100 : 0;
			$persen_51 = number_format($per_51);


		}

		//=====DN
		$sql_btl = "
		SELECT * FROM (
						SELECT SUBSTR(b.no_trdrka,12,24)  AS kd_rek,c.nm_rek2 AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND kd_kegiatan=a.`kd_kegiatan` AND LEFT(kd_rek5_ang,2)=c.kd_rek2),0) AS debet,'0' AS kredit,'' AS cp,
						'2' AS nu 
						FROM trskpd a 
						LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						INNER JOIN ms_rek2 c ON LEFT(b.kd_rek5,2)=c.kd_rek2
						WHERE a.kd_skpd='$id' AND RIGHT(a.kd_kegiatan,6) ='.00.02' AND LEFT(b.`kd_rek5`,1)='5'
						GROUP BY a.kd_kegiatan
						UNION ALL 
						SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND kd_kegiatan=a.`kd_kegiatan` AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'0' AS kredit,'' AS cp,
						'3' AS nu 
						FROM trdrka a INNER JOIN ms_rek3 b 
						ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND RIGHT(a.kd_kegiatan,6) ='.00.02' AND LEFT(a.kd_rek5,1)='5' GROUP BY SUBSTR(a.no_trdrka,12,25)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND kd_kegiatan=a.`kd_kegiatan` AND LEFT(kd_rek5_ang,5)=b.kd_rek4),0) AS debet,'0' AS kredit,'' AS cp,
						'4' AS nu 
						FROM trdrka a INNER JOIN ms_rek4 b 
						ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND RIGHT(a.kd_kegiatan,6) ='.00.02' AND LEFT(a.kd_rek5,1)='5' GROUP BY SUBSTR(a.no_trdrka,12,27)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,b.nm_rek5 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND kd_kegiatan=a.`kd_kegiatan` AND kd_rek5_ang=b.kd_rek5),0) AS debet,'0' AS kredit,'' AS cp,
						'5' AS nu
						FROM trdrka a INNER JOIN ms_rek5 b 
						ON a.kd_rek5=b.kd_rek5 WHERE a.kd_skpd='$id' AND RIGHT(a.kd_kegiatan,6) ='.00.02' AND LEFT(a.kd_rek5,1)='5' GROUP BY SUBSTR(a.no_trdrka,12,29)
						) a ORDER BY kd_rek,nu ";
						
		if($id=='1.20.06.00')
		{
		$sql_btl = "	
		SELECT * FROM (
						SELECT SUBSTR(b.no_trdrka,12,24)  AS kd_rek,c.nm_rek2 AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,2)=c.kd_rek2),0) AS debet,'0' AS kredit,'' AS cp,
						'2' AS nu 
						FROM trskpd a 
						LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						INNER JOIN ms_rek2 c ON LEFT(b.kd_rek5,2)=c.kd_rek2
						WHERE a.kd_skpd='1.20.06.00' AND RIGHT(a.kd_kegiatan,6) ='.00.02' AND LEFT(b.`kd_rek5`,1)='5'
						GROUP BY a.kd_kegiatan
						UNION ALL 
						SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'0' AS kredit,'' AS cp,
						'3' AS nu 
						FROM trdrka a INNER JOIN ms_rek3 b 
						ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='1.20.06.00' AND RIGHT(a.kd_kegiatan,6) ='.00.02' AND LEFT(a.kd_rek5,1)='5' GROUP BY SUBSTR(a.no_trdrka,12,25)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00'  AND LEFT(kd_rek5_ang,5)=b.kd_rek4),0) AS debet,'0' AS kredit,'' AS cp,
						'4' AS nu 
						FROM trdrka a INNER JOIN ms_rek4 b 
						ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='1.20.06.00' AND RIGHT(a.kd_kegiatan,6) ='.00.02' AND LEFT(a.kd_rek5,1)='5' GROUP BY SUBSTR(a.no_trdrka,12,27)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,b.nm_rek5 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00'  AND kd_rek5_ang=b.kd_rek5),0) AS debet,'0' AS kredit,'' AS cp,
						'5' AS nu
						FROM trdrka a INNER JOIN ms_rek5 b 
						ON a.kd_rek5=b.kd_rek5 WHERE a.kd_skpd='1.20.06.00' AND RIGHT(a.kd_kegiatan,6) ='.00.02' AND LEFT(a.kd_rek5,1)='5' GROUP BY SUBSTR(a.no_trdrka,12,29)
						) a ORDER BY kd_rek,nu ";
		}
		$btl = $this->db->query($sql_btl);

//====DNA


		foreach ($btl->result() as $row_btl)
		{
			$kode = $row_btl->kd_rek;
			$nama = $row_btl->nm_rek;
			$ang_511 = number_format($row_btl->nilai_u, "2", ".", ",");
			$angaran_511 = $row_btl->nilai_u;
			$in_511 = $row_btl->cp;
			$debet_511 = $row_btl->debet;
			$kredit_511 = $row_btl->kredit;
			$real_511 = $debet_511 - ($in_511 + $kredit_511);
			$nreal_511 = number_format($real_511, "2", ".", ",");
			$real_s_511 = $real_511 - $angaran_511;
			if ($real_s_511 < 0)
			{
				$x1 = "(";
				$real_s_511 = $real_s_511 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_511 = number_format($real_s_511, "2", ".", ",");
			$per_511 = ($real_s_511 != 0) ? ($real_s_511 / $row_btl->nilai_u) * 100 : 0;
			$persen_511 = number_format($per_511);

	if(strlen($kode)<=24)
	{			
	$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\"><b>$kode</b></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"><b>$nama</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$ang_511</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nreal_511</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$selisih_511$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen_511</b></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"><b></b></td>
									</tr>
									";


	}else{
	$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$kode</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_511</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_511</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_511$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_511</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
									</tr>
									";
	}
}
		$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";

/*
		$sqltbl = "SELECT SUM(a.nilai) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
						(SELECT SUM(rupiah) FROM trdkasin_ppkd a INNER JOIN trhkasin_ppkd b ON a.no_sts=b.no_sts WHERE LEFT(a.kd_rek5,2)='52' AND a.kd_skpd='$id') AS cp,
						(SELECT SUM(debet) FROM trdju_pkd c INNER JOIN trhju_pkd d ON c.no_voucher = d.no_voucher WHERE LEFT(c.kd_rek5_ang,2)='52' AND d.kd_skpd='$id') AS debet,
						(SELECT SUM(kredit) FROM trdju_pkd e INNER JOIN trhju_pkd f ON e.no_voucher = f.no_voucher WHERE LEFT(e.kd_rek5_ang,2)='52' AND f.kd_skpd='$id') AS kredit FROM trdrka a
						WHERE LEFT(kd_rek5,2)='52' AND kd_skpd='$id'";
*/						
		$sqltbl = "SELECT SUM(a.nilai) AS totbl,SUM(a.nilai_ubah) AS totbl_u, 
			        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND LEFT(kd_rek5_ang,2)=51),0) AS debet,'0' AS kredit,'' AS cp
					FROM trdrka a
					WHERE LEFT(kd_rek5,2)='52' AND kd_skpd='$id'";
		if($id=='1.20.06.00')
		{
		$sqltbl = "SELECT SUM(a.nilai) AS totbl,SUM(a.nilai_ubah) AS totbl_u,
			        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,2)=52),0) AS debet,'0' AS kredit,'' AS cp
							FROM trdrka a
							WHERE LEFT(kd_rek5,2)='52' AND kd_skpd='1.20.06.00'";
		}
		if($id=='1.20.06.00')
		{
		$sqltbl = "SELECT SUM(a.nilai) AS totbl,SUM(a.nilai_ubah) AS totbl_u,
			        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,2)=51),0) AS debet,'0' AS kredit,'' AS cp
							FROM trdrka a
							WHERE LEFT(kd_rek5,2)='52' AND kd_skpd='1.20.06.00'";
		}

		$sqlbl = $this->db->query($sqltbl);
		foreach ($sqlbl->result() as $rowbl)
		{
			$ang_52 = number_format($rowbl->totbl_u, "2", ".", ",");
			$angaran_52 = $rowbl->totbl_u;
			$in_52 = $rowbl->cp;
			$debet_52 = $rowbl->debet;
			$kredit_52 = $rowbl->kredit;
			$real_52 = $debet_52 - ($in_52 + $kredit_52);
			$nreal_52 = number_format($real_52, "2", ".", ",");
			$real_s_52 = $real_52 - $angaran_52;
			if ($real_s_52 < 0)
			{
				$x1 = "(";
				$real_s_52 = $real_s_52 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_52 = number_format($real_s_52, "2", ".", ",");
			$per_52 = ($real_s_52 != 0) ? ($real_s_52 / $rowbl->totbl_u) * 100 : 0;
			$persen_52 = number_format($per_52);


			$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\"><b>Belanja Langsung</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$ang_52</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nreal_52</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$selisih_52$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen_52</b></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";
	}
		$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";


		$sql_bl = "		
					SELECT * FROM (
						SELECT a.`kd_program` AS kd_rek,a.`nm_program` AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id'  AND SUBSTR(kd_kegiatan,1,18)=a.`kd_program` AND LEFT(kd_rek5_ang,1)=c.kd_rek1),0) AS debet,'0' AS kredit,'' AS cp,
						'1' AS nu FROM trskpd a 
						LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						INNER JOIN ms_rek1 c ON LEFT(b.kd_rek5,1)=c.kd_rek1
						WHERE a.kd_skpd='$id' AND RIGHT(a.kd_kegiatan,6) <>'.00.02' AND LEFT(b.`kd_rek5`,2)='52'
						GROUP BY a.`kd_program`
						UNION
						SELECT a.`kd_kegiatan` AS kd_rek,a.`nm_kegiatan` AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND kd_kegiatan=a.`kd_kegiatan` AND LEFT(kd_rek5_ang,2)=c.kd_rek2),0) AS debet,'0' AS kredit,'' AS cp,
						'2' AS nu FROM trskpd a 
						LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						INNER JOIN ms_rek2 c ON LEFT(b.kd_rek5,2)=c.kd_rek2
						WHERE a.kd_skpd='$id' AND RIGHT(a.kd_kegiatan,6) <>'.00.02' AND RIGHT(a.kd_kegiatan,6) <>'.00.01'
						GROUP BY a.`kd_kegiatan`
						UNION
						SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,b.nm_rek5 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='$id' AND kd_kegiatan=a.`kd_kegiatan` AND kd_rek5_ang=b.kd_rek5),0) AS debet,'0' AS kredit,'' AS cp,
						'5' AS nu FROM trdrka a INNER JOIN ms_rek5 b 
						ON a.kd_rek5=b.kd_rek5 WHERE a.kd_skpd='$id'  AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,29)
						) a ORDER BY kd_rek,nu 
						";
		if($id=='1.20.06.00')
		{
		$sql_bl = "		
					SELECT * FROM (
						SELECT a.`kd_program` AS kd_rek,a.`nm_program` AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND LEFT(kd_rek5_ang,1)=c.kd_rek1),0) AS debet,'0' AS kredit,'' AS cp,
						'1' AS nu FROM trskpd a 
						LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						INNER JOIN ms_rek1 c ON LEFT(b.kd_rek5,1)=c.kd_rek1
						WHERE a.kd_skpd='1.20.06.00' AND LEFT(b.`kd_rek5`,2)='52' AND RIGHT(a.kd_kegiatan,6) <>'.00.02'
						GROUP BY a.`kd_program`
						UNION
						SELECT a.`kd_kegiatan` AS kd_rek,a.`nm_kegiatan` AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00'  AND LEFT(kd_rek5_ang,2)=c.kd_rek2),0) AS debet,'0' AS kredit,'' AS cp,
						'2' AS nu FROM trskpd a 
						LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						INNER JOIN ms_rek2 c ON LEFT(b.kd_rek5,2)=c.kd_rek2
						WHERE a.kd_skpd='1.20.06.00' AND LEFT(b.kd_rek5,2)='52' AND RIGHT(a.kd_kegiatan,6) <>'.00.02'
						GROUP BY a.`kd_kegiatan`
						UNION
						SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,b.nm_rek5 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
			            IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd='1.20.06.00' AND kd_rek5_ang=b.kd_rek5),0) AS debet,'0' AS kredit,'' AS cp,
						'5' AS nu FROM trdrka a INNER JOIN ms_rek5 b 
						ON a.kd_rek5=b.kd_rek5 WHERE a.kd_skpd='1.20.06.00' AND RIGHT(a.kd_kegiatan,6) <>'.00.02' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,29)
						) a ORDER BY kd_rek,nu 
						";
		}
		
		//====DNA
		$bl = $this->db->query($sql_bl);
		foreach ($bl->result() as $row_bl)
		{
			$kode = $row_bl->kd_rek;
			$nama = $row_bl->nm_rek;
			$ang_522 = number_format($row_bl->nilai_u, "2", ".", ",");
			$angaran_522 = $row_bl->nilai_u;
			$in_522 = $row_bl->cp;
			$debet_522 = $row_bl->debet;
			$kredit_522 = $row_bl->kredit;
			$real_522 = $debet_522 - ($in_522 + $kredit_522);
			$nreal_522 = number_format($real_522, "2", ".", ",");
			$real_s_522 = $real_522 - $angaran_522;
			if ($real_s_522 < 0)
			{
				$x1 = "(";
				$real_s_522 = $real_s_522 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_522 = number_format($real_s_522, "2", ".", ",");
			$per_522 = ($real_s_522 != 0) ? ($real_s_522 / $row_bl->nilai_u) * 100 : 0;
			$persen_522 = number_format($per_522);

			if(strlen($kode)<=21){
				$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\"><b>$kode</b></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"><b>$nama</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$ang_522</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nreal_522</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$selisih_522$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen_522</b></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
									</tr>
									";
			}ELSE{
				$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$kode</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang_522</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal_522</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$selisih_522$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen_522</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
									</tr>
									";
			}

		}
		$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";


		$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\"><b>Belanja Daerah</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$ang_5</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nreal_5</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$selisih_5$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen_5</b></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";
		$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";

						
		$sqltpm = "				
				    SELECT IFNULL(SUM(a.nilai_ubah),0) AS totbl_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=61 AND kd_skpd='$id'),0)
					AS debet,'0' AS kredit,'' as cp
					FROM trdrka a 
					WHERE LEFT (a.kd_rek5,2)=61 AND kd_skpd='$id' ";
					
		if($id=='1.20.06.00')
		{
		$sqltpm = "				
				    SELECT IFNULL(SUM(a.nilai_ubah),0) AS totbl_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=61 AND kd_skpd='1.20.06.00'),0)
					AS debet,'0' AS kredit,'' as cp
					FROM trdrka a 
					WHERE LEFT (a.kd_rek5,2)=61 AND kd_skpd='1.20.06.00' ";
		}
		
		$sqlpm = $this->db->query($sqltpm);
		foreach ($sqlpm->result() as $rowpm)
		{
			$ang_61 = number_format($rowpm->totbl_u, "2", ".", ",");
			$angaran_61 = $rowpm->totbl_u;
			$in_61 = $rowpm->cp;
			$debet_61 = $rowpm->debet;
			$kredit_61 = $rowpm->kredit;
			$real_61 = $debet_61 - ($in_61 + $kredit_61);
			$nreal_61 = number_format($real_61, "2", ".", ",");
			$real_s_61 = $real_61 - $angaran_61;
			if ($real_s_61 < 0)
			{
				$x1 = "(";
				$real_s_61 = $real_s_61 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_61 = number_format($real_s_61, "2", ".", ",");
			$per_61 = ($real_s_61 != 0) ? ($real_s_61 / $rowpm->totbl_u) * 100 : 0;
			$persen_61 = number_format($per_61);
			
								$cRet	.= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
												<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\"><b>Pembiayaan Masuk</b></td>
												<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$ang_61</b></td>
												<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nreal_61</b></td>
												<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$selisih_61$y1</b></td>
												<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen_61</b></td>
												<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
												</tr>";
		}


		$sqlpm = "
			        SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.`lra` AS Rekening,b.nm_rek2 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=b.`kd_rek2` and kd_skpd='$id' ),0)
					AS debet,'0' AS kredit,'0' AS Realisasi,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.`kd_rek5`,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=6 and a.kd_skpd='$id'
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.`lra` AS Rekening,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=6 AND LEFT(kd_rek5_ang,3)=b.kd_rek3 and kd_skpd='$id'),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3
					WHERE LEFT (a.kd_rek5,1)=6 and a.kd_skpd='$id'
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.`lra` AS Rekening,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=6 AND LEFT(kd_rek5_ang,3)=b.kd_rek3 and kd_skpd='$id'),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=6 and a.kd_skpd='$id'
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.`lra` AS Rekening,b.nm_rek4 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=6 AND LEFT(kd_rek5_ang,5)=b.kd_rek4 and kd_skpd='$id'),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'4' AS nu
					FROM trdrka a JOIN ms_rek4 b ON LEFT(a.kd_rek5,3)=b.kd_rek4
					WHERE LEFT(a.kd_rek5,1)=6 and a.kd_skpd='$id'
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,b.`lra` AS Rekening,b.nm_rek5 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=6 AND kd_rek5_ang=b.kd_rek5 and kd_skpd='$id'),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'5' AS nu
					FROM trdrka a JOIN ms_rek5 b ON LEFT(a.kd_rek5,3)=b.kd_rek5
					WHERE LEFT(a.kd_rek5,1)=6 and a.kd_skpd='$id'
					GROUP BY b.`lra`					
					ORDER BY kd_rek,Rekening,nu ";
					
		if($id=='1.20.06.00')
		{
		$sqlpm = "
			        SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.`lra` AS Rekening,b.nm_rek2 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=61 AND LEFT(kd_rek5_ang,2)=b.`kd_rek2`),0)
					AS debet,'0' AS kredit,'0' AS Realisasi,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.`kd_rek5`,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,2)=61
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.`lra` AS Rekening,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,2)=61 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3
					WHERE LEFT (a.kd_rek5,2)=61
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.`lra` AS Rekening,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,2)=61 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,2)=61
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.`lra` AS Rekening,b.nm_rek4 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,2)=61 AND LEFT(kd_rek5_ang,5)=b.kd_rek4),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'4' AS nu
					FROM trdrka a JOIN ms_rek4 b ON LEFT(a.kd_rek5,3)=b.kd_rek4
					WHERE LEFT(a.kd_rek5,2)=61
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,b.`lra` AS Rekening,b.nm_rek5 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,2)=61 AND kd_rek5_ang=b.kd_rek5),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'5' AS nu
					FROM trdrka a JOIN ms_rek5 b ON LEFT(a.kd_rek5,3)=b.kd_rek5
					WHERE LEFT(a.kd_rek5,2)=61
					GROUP BY b.`lra`					
					ORDER BY kd_rek,Rekening,nu ";
		}
		
		$sql611 = $this->db->query($sqlpm);
		foreach ($sql611->result() as $row_61)
		{
			$kd = $row_61->kd_rek;
			$nm = $row_61->nm_rek;
			$ang_611 = number_format($row_61->nilai_u, "2", ".", ",");
			$angaran_611 = $row_61->nilai_u;
			$in_611 = $row_61->cp;
			$debet_611 = $row_61->debet;
			$kredit_611 = $row_61->kredit;
			$real_611 = $debet_611 - ($in_611 + $kredit_611);
			$nreal_611 = number_format($real_611, "2", ".", ",");
			$real_s_611 = $real_611 - $angaran_611;
			if ($real_s_611 < 0)
			{
				$x1 = "(";
				$real_s_611 = $real_s_611 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_611 = number_format($real_s_611, "2", ".", ",");
			$per_611 = ($real_s_611 != 0) ? ($real_s_611 / $row_61->nilai_u) * 100 : 0;
			$persen_611 = number_format($per_611);

	if(strlen($kd)<=24)
	{
			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"15%\" align=\"left\"><b>$kd</b></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"26%\"><b>$nm</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\"><b>$ang_611</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\"><b>$nreal_611</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\"><b>$x1$selisih_611$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"3%\" align=\"right\"><b>$persen_611</b></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";
	}else{
			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"15%\" align=\"left\">$kd</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"26%\">$nm</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$ang_611</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$nreal_611</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$x1$selisih_611$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"3%\" align=\"right\">$persen_611</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";
	}
}
		$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";

		$sqltpk = "
				    SELECT IFNULL(SUM(a.nilai_ubah),0) AS totbl_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=62 AND kd_skpd='$id'),0)
					AS debet,'0' AS kredit,'' as cp
					FROM trdrka a 
					WHERE LEFT (a.kd_rek5,2)=62 AND kd_skpd='$id' ";
		
		if($id=='1.20.06.00')
	  {
		$sqltpk = "
				    SELECT IFNULL(SUM(a.nilai_ubah),0) AS totbl_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=62 AND kd_skpd='1.20.06.00'),0)
					AS debet,'0' AS kredit,'' as cp
					FROM trdrka a 
					WHERE LEFT (a.kd_rek5,2)=62 AND kd_skpd='1.20.06.00' ";
	  }
	  

		$sqlpk = $this->db->query($sqltpk);
		foreach ($sqlpk->result() as $rowpk)
		{
			$ang_62 = number_format($rowpk->totbl_u, "2", ".", ",");
			$angaran_62 = $rowpk->totbl_u;
			//echo($angaran_62);
			$in_62 = $rowpk->cp;
			$debet_62 = $rowpk->debet;
			$kredit_62 = $rowpk->kredit;
			$real_62 = $debet_62 - ($in_62 + $kredit_62);
			$nreal_62 = number_format($real_62, "2", ".", ",");
			$real_s_62 = $real_62 - $angaran_62;
			if ($real_s_62 < 0)
			{
				$x1 = "(";
				$real_s_62 = $real_s_62 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_62 = number_format($real_s_62, "2", ".", ",");
			$per_62 = ($real_s_62 != 0) ? ($real_s_62 / $rowpk->totbl_u) * 100 : 0;
			$persen_62 = number_format($per_62);

								$cRet	.= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
												<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\"><b>Pembiayaan Keluar</b></td>
												<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$ang_62</b></td>
												<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nreal_62</b></td>
												<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$selisih_62$y1</b></td>
												<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen_62</b></td>
												<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
												</tr>";
		}
/*
		$sqlpk = "
		SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_ppkd c INNER JOIN trhkasin_ppkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5_ang,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5_ang,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
						ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,25)
						UNION ALL
						SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						(SELECT SUM(c.rupiah) FROM trdkasin_ppkd c INNER JOIN trhkasin_ppkd d ON c.no_sts = d.no_sts WHERE c.kd_skpd='$id' AND LEFT(c.kd_rek5,5)= LEFT(a.kd_rek5,5) AND d.kd_kegiatan = a.kd_kegiatan )AS cp,
						(SELECT SUM(e.debet) FROM trdju_pkd e  INNER JOIN trhju_pkd g ON e.no_voucher = g.no_voucher WHERE g.kd_skpd='$id' AND LEFT(e.kd_rek5_ang,3)= LEFT(a.kd_rek5,3) AND e.kd_kegiatan = a.kd_kegiatan )AS debet,
						(SELECT SUM(f.kredit) FROM trdju_pkd f INNER JOIN trhju_pkd h ON f.no_voucher = h.no_voucher WHERE h.kd_skpd='$id' AND LEFT(f.kd_rek5_ang,3)= LEFT(a.kd_rek5,3) AND f.kd_kegiatan = a.kd_kegiatan )AS kredit,'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
						ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,26) ) a ORDER BY kd_rek,nu";
*/						
		$sqlpk = "
					SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,3)=LEFT(a.kd_rek5,3) AND kd_kegiatan=a.kd_kegiatan AND kd_skpd='$id'),0) AS debet,'0' AS kredit,'' AS cp,
					'4' AS nu FROM trdrka a INNER JOIN ms_rek2 b 
					ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,25)
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,3)=LEFT(a.kd_rek5,3) AND kd_kegiatan=a.kd_kegiatan AND kd_skpd='$id'),0) AS debet,'0' AS kredit,'' AS cp,
					'4' AS nu FROM trdrka a INNER JOIN ms_rek3 b 
					ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,26) ) a ORDER BY kd_rek,nu ";
		
		IF($id=='1.20.06.00')
		{
		$sqlpk = "
		        SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,b.`lra` AS Rekening,b.nm_rek2 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=62 AND LEFT(kd_rek5_ang,2)=b.`kd_rek2`),0)
					AS debet,'0' AS kredit,'0' AS Realisasi,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.`kd_rek5`,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,2)=62
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,b.`lra` AS Rekening,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,2)=62 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3
					WHERE LEFT (a.kd_rek5,2)=62
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,26) AS kd_rek,b.`lra` AS Rekening,b.nm_rek3 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,2)=62 AND LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,2)=62
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,b.`lra` AS Rekening,b.nm_rek4 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,2)=62 AND LEFT(kd_rek5_ang,5)=b.kd_rek4),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'4' AS nu
					FROM trdrka a JOIN ms_rek4 b ON LEFT(a.kd_rek5,3)=b.kd_rek4
					WHERE LEFT(a.kd_rek5,2)=62
					GROUP BY kd_rek,nm_rek
					UNION ALL
					SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,b.`lra` AS Rekening,b.nm_rek5 AS nm_rek,IFNULL(SUM(a.nilai_ubah),0) AS nilai_u,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,2)=62 AND kd_rek5_ang=b.kd_rek5),0) AS debet,'0' AS kredit,
					'0' AS Realisasi,'' AS cp
					,'5' AS nu
					FROM trdrka a JOIN ms_rek5 b ON LEFT(a.kd_rek5,3)=b.kd_rek5
					WHERE LEFT(a.kd_rek5,2)=62
					GROUP BY b.`lra`					
					ORDER BY kd_rek,Rekening,nu ";
			}
		
		$sql62 = $this->db->query($sqlpk);
		foreach ($sql62->result() as $row_62)
		{
			$kd = $row_62->kd_rek;
			$nm = $row_62->nm_rek;
			$ang_622 = number_format($row_62->nilai_u, "2", ".", ",");
			$angaran_622 = $row_62->nilai_u;
			$in_622 = $row_62->cp;
			$debet_622 = $row_62->debet;
			$kredit_622 = $row_62->kredit;
			$real_622 = $debet_622 - ($in_622 + $kredit_622);
			$nreal_622 = number_format($real_622, "2", ".", ",");
			$real_s_622 = $real_622 - $angaran_622;
			if ($real_s_622 < 0)
			{
				$x1 = "(";
				$real_s_622 = $real_s_622 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$selisih_622 = number_format($real_s_622, "2", ".", ",");
			$per_622 = ($real_s_611 != 0) ? ($real_s_622 / $row_62->nilai_u) * 100 : 0;
			$persen_622 = number_format($per_622);

	if(strlen($kd)<=24)
	{
			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"15%\" align=\"left\"><b>$kd</b></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"26%\"><b>$nm</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\"><b>$ang_622</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\"><b>$nreal_622</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\"><b>$x1$selisih_622$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"3%\" align=\"right\"><b>$persen_622</b></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";
	}else{
			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"15%\" align=\"left\">$kd</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"26%\">$nm</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$ang_622</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$nreal_622</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"13%\" align=\"right\">$x1$selisih_622$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"3%\" align=\"right\">$persen_622</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";
	}
}
		$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";


		$netto = $angaran_61 - $angaran_62;
		$net = number_format($netto, "2", ",", ".");
		$netto_r = $real_61 - $real_62;
		$net_r = number_format($netto_r, "2", ",", ".");
		$netto_s = $netto_r - $netto;
		if ($netto_s < 0)
		{
			$x1 = "(";
			$netto_s = $netto_s * -1;
			$y1 = ")";
		} else
		{
			$x1 = "";
			$y1 = "";
		}
		$netto_selisih = number_format($netto_s, "2", ",", ".");
		$perpnet = ($netto_s != 0) ? ($netto_s / $netto) * 100 : 0;
		$persennet = number_format($perpnet);


		$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\"><b>Pembiayaan Netto</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$net</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$net_r</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$netto_selisih$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persennet</b></td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
									</tr>";

		$silpa = ($angaranp + $angaran_61) - ($angaran_5 + $angaran_62);
		if ($silpa < 0)
		{
			$a = "(";
			$silpa = $silpa * -1;
			$b = ")";
		} else
		{
			$a = "";
			$b = "";
		}
		$silp = number_format($silpa, "2", ",", ".");
		$silpa_real = ($realp + $real_61) - ($real_5 + $real_62);
		if ($silpa_real < 0)
		{
			$c = "(";
			$silpa_real = $silpa_real * -1;
			$d = ")";
		} else
		{
			$c = "";
			$d = "";
		}
		$silp_real = number_format($silpa_real, "2", ",", ".");
		$silpa_s = $silpa_real - $silpa;
		if ($silpa_s < 0)
		{
			$x = "(";
			$silpa_s = $silpa_s * -1;
			$y = ")";
		} else
		{
			$x = "";
			$y = "";
		}
		$silpa_selisih = number_format($silpa_s, "2", ",", ".");
		$persil = ($silpa_s != 0) ? ($silpa_s / $silpa) * 100 : 0;
		$persensilpa = number_format($persil);

		$cRet .= " </table>";
		
		
		
		$data['prev'] = $cRet;
		$this->template->set('title', 'CETAK REALISASI LAMPIRAN III');
		$this->db->query("drop table realisasi_akt");

		switch ($cetak)
		{
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}

	}

	
	//REALISASI PERKADA LAMPIRAN I AKUTANSI	

	function lampiran_perkadaI()
	{
		$data['page_title'] = 'REALISASI';
		$this->template->set('title', 'REALISASI');
		$this->template->load('template', 'akuntansi/perkada_real_1', $data);
	}

	function perkada_real_1pdf(){
        $thn_ang	   = $this->session->userdata('pcThang');
        //$skpd = $lcskpd;
        //$nama=  $this->tukd_model->get_nama($lcskpd,'nm_skpd','ms_skpd','kd_skpd');
        //$bulan= $this->tukd_model->getBulan($nbulan); 
        $cRet = '';
        $cRet = "
		<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">
					<tr>
						<td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
						<td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"15%\"><h6>LAMPIRAN I  :</h6></td>
						<td colspan=\"2\" align=\"left\" width=\"40%\"><h6>PERATURAN KEPALA DAERAH</h6></td>
					</tr>
					<tr> 
						<td align=\"left\" width=\"10%\"><h6>NOMOR</h6></td><td width=\"20%\" align=\"left\" ><h5>:</h5></td>
					</tr>
					<tr>
						<td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h6>TANGGAL</h6></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>:</h5></td>
					</tr>	
        </table>'
		<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"1\" cellpadding=\"1\">
				<tr>
                    <td align=\"center\" style=\"font-size:14px;\" colspan=\"3\"><b>
                      <strong>PEMERINTAH KABUPATEN MAMBERAMO TENGAH</strong><BR>
                      <strong>RINGKASAN REALISASI APBD</strong><br>
					  <strong>TAHUN ANGGARAN $thn_ang</b></strong><br>&nbsp;
                    </td>
                </tr>";
				
        $cRet .='</table>';          
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
                <thead>
                <tr>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" rowspan=\"2\" style=\"font-size:14px\"><strong>NO<br>URUT</strong></td>
                    <td bgcolor=\"#CCCCCC\"  width=\"15%\" align=\"center\" rowspan=\"2\" style=\"font-size:14px\"><strong>URAIAN</strong></td>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" colspan=\"2\" style=\"font-size:14px\"><strong>JUMLAH (Rp)</strong></td>
					<td bgcolor=\"#CCCCCC\"  align=\"center\" rowspan=\"2\" style=\"font-size:14px\"><strong>LEBIH<br>(KURANG)</strong></td> 
                    <td bgcolor=\"#CCCCCC\"  width=\"5%\" align=\"center\" rowspan=\"2\" style=\"font-size:14px\"><strong>%</strong></td>
                </tr> 
				<tr>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><strong>ANGGARAN</strong></td>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><strong>REALISASI</strong></td>
				</tr>
				<tr>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><b>1</b></td>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><b>2</b></td>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><b>3</b></td>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><b>4</b></td>
				    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><b>5 = 3-4</b></td>
                    <td bgcolor=\"#CCCCCC\"  width=\"5%\" align=\"center\" style=\"font-size:14px\"><b>6</b></td>
				</tr>
                </thead>"; 
				
        $sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                 {
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                 }
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kode='KD' and kd_skpd='1.20.02.00'";
                 $sqlttd=$this->db->query($sqlttd1);
				 $kos=0;
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip=$rowttd->nip;                    
                    $nama= $rowttd->nm;
                    $jabatan  = $rowttd->jab;
					$kos++;
                }
				if($kos==0){
					$nip='Belum ada nip';
					$nama='Belum ada nama';
					$jabatan='Belum ada jabatan';
				}
				
			//REK PENDAPATAN                   
			$sql1="	
			        SELECT LEFT(a.kd_rek5,1) AS Kode,b.`lra` AS Rekening,b.nm_rek1 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=4),0) AS cp,'0' AS Realisasi,'0' AS kredit,'0' AS debet,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=4
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS Kode,b.`lra` AS Rekening,b.nm_rek2 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS cp,'0' AS Realisasi,'0' AS kredit,'0' AS debet
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=4
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS Kode,b.`lra` AS Rekening,b.nm_rek3 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS cp,'0' AS Realisasi,'0' AS kredit,'0' AS debet
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=4
					GROUP BY b.`lra`					
					ORDER BY Kode,nu
					";
					
			    $query = $this->db->query($sql1);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query->result() as $row)
                {
                    $coba1=$row->Rekening;
                    $coba2=$row->Belanja;
                    $coba3= number_format($row->Anggaran,"2",".",",");
					$anggaran =$row->Anggaran;
                    $coba4= number_format($row->Realisasi,"2",".",",");
					$pen = number_format($row->cp,"2",".",",");
					$pen4 =$row->cp;
					$debet = number_format($row->debet,"2",".",",");
					$debetp = $row->debet;
					$kredit = number_format($row->kredit,"2",".",",");
					$kreditp = $row->kredit;
                    $coba5= $row->Anggaran - $row->Realisasi;
					$penp = $row->cp;
					//$realp = $kreditp - $debetp;
					$realp = $anggaran - $pen4;
					$nrealp = number_format($realp,"2", ".", ",");
					$real_sp = $anggaran - $pen4;
/*					
                    if ($coba5 < 0){
                    	$x1="(";
                    	$coba5=$coba5*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba5,"2",".",",");  
                    $per1   = ($coba5!=0)?($coba5 / $row->Anggaran ) * 100:0; 
                    $persen1= number_format($per1,"2",".",","); 
*/					
					if ($real_sp < 0)
					{
						$x1 = "(";
						$real_sp = $real_sp * -1;
						$y1 = ")";
					} else
					{
						$x1 = "";
						$y1 = "";
					}
					$pend_selisihp = number_format($real_sp, "2", ".", ",");
					$per1p = ($realp != 0) ? ($realp / $row->Anggaran) * 100 : 0;
					$persen1p = number_format($per1p, "2", ".", ",");
							
                    if(strlen($coba1)<=3){
                        $coba1= strtoupper($coba1);
                        $coba2= strtoupper($coba2);
                        $cRet .= "<tr>
						            <td width=\"10%\" align=\"center\">&nbsp;</td>                            
                                    <td width=\"40%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"5%\">&nbsp;</td>
								  </tr>";
									
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\"><b>$coba1</b></td>                                     
                                 <td width=\"40%\"><b>$coba2</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$coba3</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$pen</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$x1$pend_selisihp$y1</b></td>
                                 <td width=\"5%\" align=\"right\"><b>$persen1p</b></td></tr>";
                    }else{
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\">$coba1</td>                                     
                                 <td width=\"40%\">$coba2</td>
                                 <td width=\"15%\" align=\"right\">$coba3</td>
                                 <td width=\"15%\" align=\"right\">$pen</td>
                                 <td width=\"15%\" align=\"right\">$pend_selisihp</td>
                                 <td width=\"5%\" align=\"right\">$persen1p</td></tr>";
                    }
                    
                }
				
                $sqltp="
						SELECT SUM(nilai_ubah) AS totp,
						IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=4),0) AS cp,'0' AS Realisasi,'0' AS kredit,'0' AS debet
						FROM trdrka WHERE LEFT(kd_rek5,1)='4' ";
						
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                   $coba6=number_format($rowp->totp,"2",".",",");
				   $cob6 = $rowp->totp;
                   $coba7=number_format($rowp->cp,"2",".",",");
				   $cob7 = $rowp->cp;
                   $coba8= $rowp->totp - $rowp->cp;
                    if ($coba8 < 0){
                    	$x1="(";
                    	$coba8=$coba8*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba8,"2",".",",");  
                    $per1   = ($coba8!=0)?($coba8 / $rowp->totp ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");   
                   //$cob1=$rowp->totp;
                   
                    $cRet    .= " <tr><td idth=\"10%\" align=\"left\"></td>                                     
                                     <td width=\"40%\" align=\"right\"><b>JUMLAH PENDAPATAN&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba6</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba7</b></td>
                                     <td width=\"15%\" align=\"right\"><b>".number_format($coba8)."</b></td>
                                     <td width=\"5%\" align=\"right\"><b>$persen1</b></td></tr>";
                 }     

			//REK BELANJA				 
			$sql2="
					SELECT LEFT(a.kd_rek5,1) AS Kode,b.`lra` AS Rekening,b.nm_rek1 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE  LEFT(kd_rek5_ang,1)=5),0) AS debet,'' AS cp,'0' AS Realisasi,'0' AS kredit,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=5
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS Kode,b.`lra` AS Rekening,b.nm_rek2 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE  LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS debet,'' AS cp,'0' AS Realisasi,'0' AS kredit
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=5
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS Kode,b.`lra` AS Rekening,b.nm_rek3 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE  LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'' AS cp,'0' AS Realisasi,'0' AS kredit
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=5
					GROUP BY b.`lra`					
					ORDER BY Kode,nu 
					";
					
			    $query = $this->db->query($sql2);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query->result() as $row)
                {
                    $coba9=$row->Rekening;
                    $coba10=$row->Belanja;
                    $coba11= number_format($row->Anggaran,"2",".",",");
					$anggaran = $row->Anggaran;
                    $coba12= number_format($row->Realisasi,"2",".",",");
                    $coba13= $row->Anggaran - $row->Realisasi;
					$pen5 = $row->cp;
					$debet5 = $row->debet;
					$kredit5 = $row->kredit;
					$real5 = $debet5 - $kredit5;
					$nreal5 = number_format($real5, "2", ".", ",");
					$real_s5 = $anggaran - $real5;
					
/*					
                    if ($coba13 < 0){
                    	$x1="(";
                    	$coba13=$coba13*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba13,"2",".",",");  
                    $per1   = ($coba13!=0)?($coba13 / $row->Anggaran ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");  
*/

					
					if ($real_s5 < 0)
					{
						$x1 = "(";
						$real_s5 = $real_s5 * -1;
						$y1 = ")";
					} else
					{
						$x1 = "";
						$y1 = "";
					}
					$pend_selisih5 = number_format($real_s5, "2", ".", ",");
					$per15 = ($real_s5 != 0) ? ($real_s5 / $row->Anggaran) * 100 : 0;
					$persen15 = number_format($per15, "2", ".", ",");

					
                    if(strlen($coba9)<=3){
                        $coba9= strtoupper($coba9);
                        $coba10= strtoupper($coba10);
                        $cRet .= "<tr><td width=\"10%\" align=\"center\">&nbsp;</td>                            
                                    <td width=\"40%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"5%\">&nbsp;</td>
								</tr>";
									
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\"><b>$coba9</b></td>                                     
                                 <td width=\"40%\"><b>$coba10</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$coba11</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$nreal5</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$pend_selisih5</b></td>
                                 <td width=\"5%\" align=\"right\"><b>$persen15</b></td></tr>";
                    }else{
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\">$coba9</td>                                     
                                 <td width=\"40%\">$coba10</td>
                                 <td width=\"15%\" align=\"right\">$coba11</td>
                                 <td width=\"15%\" align=\"right\">$nreal5</td>
                                 <td width=\"15%\" align=\"right\">$x1$pend_selisih5$y1</td>
                                 <td width=\"5%\" align=\"right\">$persen15</td></tr>";
                    }
                    
                }
				
                $sqltp="
						SELECT SUM(nilai_ubah) AS totb,
						IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE  LEFT(kd_rek5_ang,1)=5),0) AS debet,''AS kredit
						FROM trdrka  WHERE LEFT(kd_rek5,1)='5'	
						";
						
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                   $coba14=number_format($rowp->totb,"2",".",",");
				   $cob14 = $rowp->totb;
				   $debet = number_format($rowp->debet,"2",".",",");
				   $debet5 = $rowp->debet;
				   $kredit =number_format($rowp->kredit,"2",".",",");
				   $kredit5 = $rowp->kredit;
				   $real5  =$debet5-$kredit5;
				   $nreal5 = number_format($real5, "2", ".", ",");
                   $coba16= $cob14 - $real5;
                    if ($coba16 < 0){
                    	$x1="(";
                    	$coba16=$coba16*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba16,"2",".",",");  
                    $per1   = ($coba16!=0)?($coba16 / $rowp->totb ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");
					
                  $suplus=$cob6-$cob14; 
                  if ($suplus < 0){
                	$x1="(";
                	$suplus=$suplus*-1;
                	$y1=")";}
                  else {
                	$x1="";
	                $y1="";}
                 $surp1=number_format($suplus,2,',','.'); 
				 
                 $suplus1=$cob7-$real5; 
                  if ($suplus1 < 0){
                	$x1="(";
                	$suplus1=$suplus1*-1;
                	$y1=")";}
                  else {
                	$x1="";
	                $y1="";}
                 $surp2=number_format($suplus1,"2",".",","); 				 
                  
                    $cRet    .= " <tr>
					              <td idth=\"10%\" align=\"left\"></td>                                     
                                     <td width=\"40%\" align=\"right\"><b>JUMLAH BELANJA&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba14</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$nreal5</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$total1</b></td>
                                     <td width=\"5%\" align=\"right\"><b>$persen1</b></td></tr>
								<tr>
								<td idth=\"10%\" align=\"left\"></td>                                     
                                     <td width=\"40%\" align=\"right\"><b>SURPLUS/DEFISIT&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$x1$surp1$y1</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$x1$surp2$y1</b></td>
                                     <td width=\"15%\" align=\"right\"><b></b></td>
                                     <td width=\"5%\" align=\"right\"><b></b></td>
								</tr>";
									 
                 }    

				//REK PEMBIAYAAN
				$sql3="
				SELECT LEFT(a.kd_rek5,1) AS Kode,b.`lra` AS Rekening,b.nm_rek1 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=6),0)AS Realisasi,'0' AS kredit,'0' AS debet,'' AS cp,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=6
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS Kode,b.`lra` AS Rekening,b.nm_rek2 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2),0)AS Realisasi,'0' AS kredit,'0' AS debet,'' AS cp
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=6
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS Kode,b.`lra` AS Rekening,b.nm_rek3 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,3)=b.kd_rek3),0)AS Realisasi,'0' AS kredit,'0' AS debet,'' AS cp
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=6
					GROUP BY b.`lra`					
					ORDER BY Kode,nu  
					";
										
			    $query = $this->db->query($sql3);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query->result() as $row)
                {
                    $coba17=$row->Rekening;
                    $coba18=$row->Belanja;
                    $coba19= number_format($row->Anggaran,"2",".",",");
                    $coba20= number_format($row->Realisasi,"2",".",",");
                    $coba21= $row->Anggaran - $row->Realisasi;
					$realisasi =$row->Realisasi;
					$ang61 = number_format($row->Anggaran, "2", ".", ",");
					$angaran61 = $row->Anggaran;
					//echo($angaran61);
					$pen61 = $row->cp;
					$debet61 = $row->debet;
					$kredit61 = $row->kredit;
					$real61 = $kredit61 - $debet61;
					$nreal61 = number_format($real61, "2", ".", ",");
					$real_s61 = $angaran61 - $realisasi;
					if ($real_s61 < 0)
					{
						$x1 = "(";
						$real_s61 = $real_s61 * -1;
						$y1 = ")";
					} else
					{
						$x1 = "";
						$y1 = "";
					}
					$pend_selisih61 = number_format($real_s61, "2", ".", ",");
					$per161 = ($real_s61 != 0) ? ($real_s61 / $row->Anggaran) * 100 : 0;
					$persen161 = number_format($per161, "2", ".", ",");

                    if(strlen($coba17)<=3){
                        $cRet .= "<tr><td width=\"10%\" align=\"center\">&nbsp;</td>                            
                                    <td width=\"40%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"5%\">&nbsp;</td></tr>";
									
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\"><b>$coba17</b></td>                                     
                                 <td width=\"40%\"><b>$coba18</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$coba19</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$coba20</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$x1$pend_selisih61$y1</b></td>
                                 <td width=\"5%\" align=\"right\"><b>$persen161</b></td></tr>";
                       }else{
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\">$coba17</td>                                     
                                 <td width=\"40%\">$coba18</td>
                                 <td width=\"15%\" align=\"right\">$coba19</td>
                                 <td width=\"15%\" align=\"right\">$coba20</td>
                                 <td width=\"15%\" align=\"right\">$x1$pend_selisih61$y1</td>
                                 <td width=\"5%\" align=\"right\">$persen161</td></tr>";
                    }
                    
                }
				
                $sqltp="
			        SELECT IFNULL(SUM(a.nilai_ubah),0) AS totp,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=6),0)
					AS Realisasi,'0' AS kredit,'0' AS debet
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=6						
					";
						
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                   $coba22=number_format($rowp->totp,"2",".",",");
				   $coba2a=$rowp->totp;
				   $realisasi =number_format($rowp->Realisasi,"2",".",",");
				   $realis6 =$rowp->Realisasi;
                   $debet=number_format($rowp->debet,"2",".",",");
                   $kredit=number_format($rowp->kredit,"2",".",",");
				   $real6 = $kredit - $debet;
				   $sisa =$coba2a - $realis6;
                   $coba24= $rowp->totp - $realis6;
				   
                    if ($coba24 < 0){
                    	$x1="(";
                    	$coba24=$coba24*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba24,"2",".",",");  
                    $per1   = ($realis6!=0)?($coba24 / $rowp->totp ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");   
                   
                    $cRet    .= " <tr><td idth=\"10%\" align=\"left\"></td>                                     
                                     <td width=\"40%\" align=\"right\"><b>PEMBIAYAAN/NETTO&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba22</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$realisasi</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$x1$total1$y1</b></td>
                                     <td width=\"5%\" align=\"right\"><b>$persen1</b></td></tr>";
									 
                 }
    $cRet .='</table>';
	
	//Aktifkan Jika Penandatangan Perlu

		 $cRet .="<table>;
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
					</tr>
		 </table>";
 		 $cRet .=" <table width='100%' border=\"0\" cellspacing=\"1\" cellpadding=\"1\">
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>$daerah, ".$this->tukd_model->tanggal_format_indonesia(date("Y-m-d"))."</td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>$jabatan</td>
					</tr>
					<tr>
						<td align='center' width='40%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>&nbsp;</td>
					</tr>
					<tr>
						<td align='center' width='40%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>&nbsp;</td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>$nama</td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>$nip</td>
					</tr>
				  </table>
				";		

         $data['prev']= $cRet;    
         $this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0'); 
    }	

	//RANCANGAN PERKADA I 
	
	function perkada_real_12pdf(){
        $thn_ang	   = $this->session->userdata('pcThang');
        //$skpd = $lcskpd;
        //$nama=  $this->tukd_model->get_nama($lcskpd,'nm_skpd','ms_skpd','kd_skpd');
        //$bulan= $this->tukd_model->getBulan($nbulan); 
        $cRet = '';
        $cRet = "
		<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\" cellspacing=\"0\" cellpadding=\"0\">
					<tr>
						<td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
						<td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"15%\"><h6>LAMPIRAN I  :</h6></td>
						<td colspan=\"2\" align=\"left\" width=\"40%\"><h6>RANCANGAN PERATURAN KEPALA DAERAH</h6></td>
					</tr>
					<tr> 
						<td align=\"left\" width=\"10%\"><h6>NOMOR</h6></td><td width=\"20%\" align=\"left\" ><h5>:</h5></td>
					</tr>
					<tr>
						<td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h6>TANGGAL</h6></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>:</h5></td>
					</tr>	
        </table>'
		<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"1\" cellpadding=\"1\">
				<tr>
                    <td align=\"center\" style=\"font-size:14px;\" colspan=\"3\"><b>
                      <strong>PEMERINTAH KABUPATEN MAMBERAMO TENGAH</strong><BR>
                      <strong>RINGKASAN REALISASI APBD</strong><br>
					  <strong>TAHUN ANGGARAN $thn_ang</b></strong><br>&nbsp;
                    </td>
                </tr>";
				
        $cRet .='</table>';          
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
                <thead>
                <tr>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" rowspan=\"2\" style=\"font-size:14px\"><strong>NO<br>URUT</strong></td>
                    <td bgcolor=\"#CCCCCC\"  width=\"15%\" align=\"center\" rowspan=\"2\" style=\"font-size:14px\"><strong>URAIAN</strong></td>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" colspan=\"2\" style=\"font-size:14px\"><strong>JUMLAH (Rp)</strong></td>
					<td bgcolor=\"#CCCCCC\"  align=\"center\" rowspan=\"2\" style=\"font-size:14px\"><strong>LEBIH<br>(KURANG)</strong></td> 
                    <td bgcolor=\"#CCCCCC\"  width=\"5%\" align=\"center\" rowspan=\"2\" style=\"font-size:14px\"><strong>%</strong></td>
                </tr> 
				<tr>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><strong>ANGGARAN</strong></td>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><strong>REALISASI</strong></td>
				</tr>
				<tr>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><b>1</b></td>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><b>2</b></td>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><b>3</b></td>
                    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><b>4</b></td>
				    <td bgcolor=\"#CCCCCC\"  align=\"center\" style=\"font-size:14px\"><b>5 = 3-4</b></td>
                    <td bgcolor=\"#CCCCCC\"  width=\"5%\" align=\"center\" style=\"font-size:14px\"><b>6</b></td>
				</tr>
                </thead>"; 
				
        $sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                 {
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                 }
		$sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kode='PA' and kd_skpd='1.20.06.00'";
                 $sqlttd=$this->db->query($sqlttd1);
				 $kos=0;
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip=$rowttd->nip;                    
                    $nama= $rowttd->nm;
                    $jabatan  = $rowttd->jab;
					$kos++;
                }
				if($kos==0){
					$nip='Belum ada nip';
					$nama='Belum ada nama';
					$jabatan='Belum ada jabatan';
				}
				
			//REK PENDAPATAN                   
			$sql1="	
			        SELECT LEFT(a.kd_rek5,1) AS Kode,b.`lra` AS Rekening,b.nm_rek1 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=4),0) AS cp,'0' AS Realisasi,'0' AS kredit,'0' AS debet,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=4
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS Kode,b.`lra` AS Rekening,b.nm_rek2 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS cp,'0' AS Realisasi,'0' AS kredit,'0' AS debet
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=4
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS Kode,b.`lra` AS Rekening,b.nm_rek3 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS cp,'0' AS Realisasi,'0' AS kredit,'0' AS debet
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=4
					GROUP BY b.`lra`					
					ORDER BY Kode,nu
					";
					
			    $query = $this->db->query($sql1);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query->result() as $row)
                {
                    $coba1=$row->Rekening;
                    $coba2=$row->Belanja;
                    $coba3= number_format($row->Anggaran,"2",".",",");
					$anggaran =$row->Anggaran;
                    $coba4= number_format($row->Realisasi,"2",".",",");
					$pen = number_format($row->cp,"2",".",",");
					$pen4 =$row->cp;
					$debet = number_format($row->debet,"2",".",",");
					$debetp = $row->debet;
					$kredit = number_format($row->kredit,"2",".",",");
					$kreditp = $row->kredit;
                    $coba5= $row->Anggaran - $row->Realisasi;
					$penp = $row->cp;
					//$realp = $kreditp - $debetp;
					$realp = $anggaran - $pen4;
					$nrealp = number_format($realp,"2", ".", ",");
					$real_sp = $anggaran - $pen4;

					if ($real_sp < 0)
					{
						$x1 = "(";
						$real_sp = $real_sp * -1;
						$y1 = ")";
					} else
					{
						$x1 = "";
						$y1 = "";
					}
					$pend_selisihp = number_format($real_sp, "2", ".", ",");
					$per1p = ($realp != 0) ? ($realp / $row->Anggaran) * 100 : 0;
					$persen1p = number_format($per1p, "2", ".", ",");
							
                    if(strlen($coba1)<=3){
                        $coba1= strtoupper($coba1);
                        $coba2= strtoupper($coba2);
                        $cRet .= "<tr>
						            <td width=\"10%\" align=\"center\">&nbsp;</td>                            
                                    <td width=\"40%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"5%\">&nbsp;</td>
								  </tr>";
									
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\"><b>$coba1</b></td>                                     
                                 <td width=\"40%\"><b>$coba2</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$coba3</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$pen</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$x1$pend_selisihp$y1</b></td>
                                 <td width=\"5%\" align=\"right\"><b>$persen1p</b></td></tr>";
                    }else{
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\">$coba1</td>                                     
                                 <td width=\"40%\">$coba2</td>
                                 <td width=\"15%\" align=\"right\">$coba3</td>
                                 <td width=\"15%\" align=\"right\">$pen</td>
                                 <td width=\"15%\" align=\"right\">$pend_selisihp</td>
                                 <td width=\"5%\" align=\"right\">$persen1p</td></tr>";
                    }
                    
                }
				
                $sqltp="
						SELECT SUM(nilai_ubah) AS totp,
						IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=4),0) AS cp,'0' AS Realisasi,'0' AS kredit,'0' AS debet
						FROM trdrka WHERE LEFT(kd_rek5,1)='4' ";
						
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                   $coba6=number_format($rowp->totp,"2",".",",");
				   $cob6 = $rowp->totp;
                   $coba7=number_format($rowp->cp,"2",".",",");
				   $cob7 = $rowp->cp;
                   $coba8= $rowp->totp - $rowp->cp;
                    if ($coba8 < 0){
                    	$x1="(";
                    	$coba8=$coba8*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba8,"2",".",",");  
                    $per1   = ($coba8!=0)?($coba8 / $rowp->totp ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");   
                   //$cob1=$rowp->totp;
                   
                    $cRet    .= " <tr><td idth=\"10%\" align=\"left\"></td>                                     
                                     <td width=\"40%\" align=\"right\"><b>JUMLAH PENDAPATAN&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba6</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba7</b></td>
                                     <td width=\"15%\" align=\"right\"><b>".number_format($coba8)."</b></td>
                                     <td width=\"5%\" align=\"right\"><b>$persen1</b></td></tr>";
                 }     

			//REK BELANJA				 
			$sql2="
					SELECT LEFT(a.kd_rek5,1) AS Kode,b.`lra` AS Rekening,b.nm_rek1 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE  LEFT(kd_rek5_ang,1)=5),0) AS debet,'' AS cp,'0' AS Realisasi,'0' AS kredit,
					'1' AS nu
					FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
					WHERE LEFT (a.kd_rek5,1)=5
					UNION ALL
					SELECT LEFT(a.kd_rek5,2) AS Kode,b.`lra` AS Rekening,b.nm_rek2 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE  LEFT(kd_rek5_ang,2)=b.kd_rek2),0) AS debet,'' AS cp,'0' AS Realisasi,'0' AS kredit
					,'2' AS nu
					FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
					WHERE LEFT (a.kd_rek5,1)=5
					GROUP BY b.`nm_rek2`
					UNION ALL
					SELECT LEFT(a.kd_rek5,3) AS Kode,b.`lra` AS Rekening,b.nm_rek3 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE  LEFT(kd_rek5_ang,3)=b.kd_rek3),0) AS debet,'' AS cp,'0' AS Realisasi,'0' AS kredit
					,'3' AS nu
					FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					WHERE LEFT(a.kd_rek5,1)=5
					GROUP BY b.`lra`					
					ORDER BY Kode,nu 
					";
					
			    $query = $this->db->query($sql2);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query->result() as $row)
                {
                    $coba9=$row->Rekening;
                    $coba10=$row->Belanja;
                    $coba11= number_format($row->Anggaran,"2",".",",");
					$anggaran = $row->Anggaran;
                    $coba12= number_format($row->Realisasi,"2",".",",");
                    $coba13= $row->Anggaran - $row->Realisasi;
					$pen5 = $row->cp;
					$debet5 = $row->debet;
					$kredit5 = $row->kredit;
					$real5 = $debet5 - $kredit5;
					$nreal5 = number_format($real5, "2", ".", ",");
					$real_s5 = $anggaran - $real5;
					
/*					
                    if ($coba13 < 0){
                    	$x1="(";
                    	$coba13=$coba13*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba13,"2",".",",");  
                    $per1   = ($coba13!=0)?($coba13 / $row->Anggaran ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");  
*/

					
					if ($real_s5 < 0)
					{
						$x1 = "(";
						$real_s5 = $real_s5 * -1;
						$y1 = ")";
					} else
					{
						$x1 = "";
						$y1 = "";
					}
					$pend_selisih5 = number_format($real_s5, "2", ".", ",");
					$per15 = ($real_s5 != 0) ? ($real_s5 / $row->Anggaran) * 100 : 0;
					$persen15 = number_format($per15, "2", ".", ",");

					
                    if(strlen($coba9)<=3){
                        $coba9= strtoupper($coba9);
                        $coba10= strtoupper($coba10);
                        $cRet .= "<tr><td width=\"10%\" align=\"center\">&nbsp;</td>                            
                                    <td width=\"40%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"5%\">&nbsp;</td>
								</tr>";
									
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\"><b>$coba9</b></td>                                     
                                 <td width=\"40%\"><b>$coba10</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$coba11</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$nreal5</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$pend_selisih5</b></td>
                                 <td width=\"5%\" align=\"right\"><b>$persen15</b></td></tr>";
                    }else{
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\">$coba9</td>                                     
                                 <td width=\"40%\">$coba10</td>
                                 <td width=\"15%\" align=\"right\">$coba11</td>
                                 <td width=\"15%\" align=\"right\">$nreal5</td>
                                 <td width=\"15%\" align=\"right\">$x1$pend_selisih5$y1</td>
                                 <td width=\"5%\" align=\"right\">$persen15</td></tr>";
                    }
                    
                }
				
                $sqltp="
						SELECT SUM(nilai_ubah) AS totb,
						IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE  LEFT(kd_rek5_ang,1)=5),0) AS debet,''AS kredit
						FROM trdrka  WHERE LEFT(kd_rek5,1)='5'	
						";
						
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                   $coba14=number_format($rowp->totb,"2",".",",");
				   $cob14 = $rowp->totb;
				   $debet = number_format($rowp->debet,"2",".",",");
				   $debet5 = $rowp->debet;
				   $kredit =number_format($rowp->kredit,"2",".",",");
				   $kredit5 = $rowp->kredit;
				   $real5  =$debet5-$kredit5;
				   $nreal5 = number_format($real5, "2", ".", ",");
                   $coba16= $cob14 - $real5;
                    if ($coba16 < 0){
                    	$x1="(";
                    	$coba16=$coba16*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba16,"2",".",",");  
                    $per1   = ($coba16!=0)?($coba16 / $rowp->totb ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");
					
                  $suplus=$cob6-$cob14; 
                  if ($suplus < 0){
                	$x1="(";
                	$suplus=$suplus*-1;
                	$y1=")";}
                  else {
                	$x1="";
	                $y1="";}
                 $surp1=number_format($suplus,2,',','.'); 
				 
                 $suplus1=$cob7-$real5; 
                  if ($suplus1 < 0){
                	$x1="(";
                	$suplus1=$suplus1*-1;
                	$y1=")";}
                  else {
                	$x1="";
	                $y1="";}
                 $surp2=number_format($suplus1,"2",".",","); 				 
                  
                    $cRet    .= " <tr>
					              <td idth=\"10%\" align=\"left\"></td>                                     
                                     <td width=\"40%\" align=\"right\"><b>JUMLAH BELANJA&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba14</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$nreal5</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$total1</b></td>
                                     <td width=\"5%\" align=\"right\"><b>$persen1</b></td></tr>
								<tr>
								<td idth=\"10%\" align=\"left\"></td>                                     
                                     <td width=\"40%\" align=\"right\"><b>SURPLUS/DEFISIT&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$x1$surp1$y1</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$x1$surp2$y1</b></td>
                                     <td width=\"15%\" align=\"right\"><b></b></td>
                                     <td width=\"5%\" align=\"right\"><b></b></td>
								</tr>";
									 
                 }    

				//REK PEMBIAYAAN
				$sql3="
						SELECT LEFT(a.kd_rek5,1) AS Kode,b.`lra` AS Rekening,b.nm_rek1 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
							IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=6),0)AS Realisasi,'0' AS kredit,'0' AS debet,'' AS cp,
							'1' AS nu
							FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
							WHERE LEFT (a.kd_rek5,1)=6
							UNION ALL
							SELECT LEFT(a.kd_rek5,2) AS Kode,b.`lra` AS Rekening,b.nm_rek2 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
							IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=b.kd_rek2),0)AS Realisasi,'0' AS kredit,'0' AS debet,'' AS cp
							,'2' AS nu
							FROM trdrka a JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2
							WHERE LEFT (a.kd_rek5,1)=6
							GROUP BY b.`nm_rek2`
							UNION ALL
							SELECT LEFT(a.kd_rek5,3) AS Kode,b.`lra` AS Rekening,b.nm_rek3 AS Belanja,IFNULL(SUM(a.nilai_ubah),0) AS Anggaran,
							IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,3)=b.kd_rek3),0)AS Realisasi,'0' AS kredit,'0' AS debet,'' AS cp
							,'3' AS nu
							FROM trdrka a JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
							WHERE LEFT(a.kd_rek5,1)=6
							GROUP BY b.`lra`					
							ORDER BY Kode,nu  
					    ";					
			    $query = $this->db->query($sql3);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query->result() as $row)
                {
                    $coba17=$row->Rekening;
                    $coba18=$row->Belanja;
                    $coba19= number_format($row->Anggaran,"2",".",",");
                    $coba20= number_format($row->Realisasi,"2",".",",");
                    $coba21= $row->Anggaran - $row->Realisasi;
					$realisasi =$row->Realisasi;
					$ang61 = number_format($row->Anggaran, "2", ".", ",");
					$angaran61 = $row->Anggaran;
					//echo($angaran61);
					$pen61 = $row->cp;
					$debet61 = $row->debet;
					$kredit61 = $row->kredit;
					$real61 = $kredit61 - $debet61;
					$nreal61 = number_format($real61, "2", ".", ",");
					$real_s61 = $angaran61 - $realisasi;
					if ($real_s61 < 0)
					{
						$x1 = "(";
						$real_s61 = $real_s61 * -1;
						$y1 = ")";
					} else
					{
						$x1 = "";
						$y1 = "";
					}
					$pend_selisih61 = number_format($real_s61, "2", ".", ",");
					$per161 = ($real_s61 != 0) ? ($real_s61 / $row->Anggaran) * 100 : 0;
					$persen161 = number_format($per161, "2", ".", ",");

                    if(strlen($coba17)<=3){
                        //$coba17= strtoupper($coba9);
                        //$coba18= strtoupper($coba10);
                        
                        $cRet .= "<tr><td width=\"10%\" align=\"center\">&nbsp;</td>                            
                                    <td width=\"40%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"15%\">&nbsp;</td>
                                    <td width=\"5%\">&nbsp;</td></tr>";
									
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\"><b>$coba17</b></td>                                     
                                 <td width=\"40%\"><b>$coba18</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$coba19</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$coba20</b></td>
                                 <td width=\"15%\" align=\"right\"><b>$x1$pend_selisih61$y1</b></td>
                                 <td width=\"5%\" align=\"right\"><b>$persen161</b></td></tr>";
                       }else{
                        $cRet    .= " <tr><td  width=\"10%\" align=\"left\">$coba17</td>                                     
                                 <td width=\"40%\">$coba18</td>
                                 <td width=\"15%\" align=\"right\">$coba19</td>
                                 <td width=\"15%\" align=\"right\">$coba20</td>
                                 <td width=\"15%\" align=\"right\">$x1$pend_selisih61$y1</td>
                                 <td width=\"5%\" align=\"right\">$persen161</td></tr>";
                    }
                    
                }
				
                $sqltp="
						SELECT IFNULL(SUM(a.nilai_ubah),0) AS totp,
						IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=6),0)
						AS Realisasi,'0' AS kredit,'0' AS debet
						FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
						WHERE LEFT (a.kd_rek5,1)=6 
						";					
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                   $coba22=number_format($rowp->totp,"2",".",",");
				   $realisasi =number_format($rowp->Realisasi,"2",".",",");
				   $realis6 =$rowp->Realisasi;
                   $debet=number_format($rowp->debet,"2",".",",");
                   $kredit=number_format($rowp->kredit,"2",".",",");
				   $real6 = $kredit - $debet;
				   $sisa =$coba22 - $realis6;
                   $coba24= $rowp->totp - $realis6;
				   
                    if ($coba24 < 0){
                    	$x1="(";
                    	$coba24=$coba24*-1;
                    	$y1=")";}
                    else {
                    	$x1="";
    	                $y1="";}
                    $total1 = number_format($coba24,"2",".",",");  
                    $per1   = ($coba24!=0)?($coba24 / $rowp->totp ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");   
                   
                    $cRet    .= " <tr><td idth=\"10%\" align=\"left\"></td>                                     
                                     <td width=\"40%\" align=\"right\"><b>PEMBIAYAAN/NETTO&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba22</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$realisasi</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$x1$total1$y1</b></td>
                                     <td width=\"5%\" align=\"right\"><b>$persen1</b></td></tr>";
									 
                 }
		$cRet .='</table>';
	

		$data['prev']= $cRet;    
		$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0'); 
    }	
	
	function lampiran_perkadaII()
	{
		$data['page_title'] = 'REALISASI ';
		$this->template->set('title', 'REALISASI');
		$this->template->load('template', 'akuntansi/perkada_real_2', $data);
	}

   function lampiran_perkada_ubahII($lap = '', $ctk = '', $skpd = ''){
		$id = $skpd;
		$cetak = $ctk;
		$laporan = $lap;

		if ($laporan <> '2')
		{
			$sts = "AND MONTH(d.tgl_sts)<='12'";
			$jurnal = "AND MONTH(d.tgl_voucher)<='12'";
		} else
		{
			$sts = "AND MONTH(d.tgl_sts)<='12'";
			$jurnal = "AND MONTH(d.tgl_voucher)<='12'";
		}	
	   
        $thn_ang	   = $this->session->userdata('pcThang');
        $skpd = $skpd;
        $nama=  $this->tukd_model->get_nama($skpd,'nm_skpd','ms_skpd','kd_skpd');

        $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                   
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                }
       
        $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang,upper(spd_head3) as spd_head3,upper(spd_head4) as spd_head4, no_qanun, tgl_qanun, no_perbup, tgl_perbup, bupati FROM sclient";        
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tanggal=$rowsc->tgl_rka;
                    $tglrka = $this->tanggal_format_indonesia($rowsc->tgl_rka);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                    $head3 = $rowsc->spd_head3;
					$head4   = $rowsc->spd_head4;                    
                    $bupati     = $rowsc->bupati;
                    $no_qanun   = $rowsc->no_qanun;
                    $tgl_qanun  = $this->tanggal_format_indonesia($rowsc->tgl_qanun);
                    $no_perbup  = $rowsc->no_perbup;
                    $tgl_perbup = $this->tanggal_format_indonesia($rowsc->tgl_perbup);                    
                }
        
        
        $cRet='';
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>PENJABARAN REALISASI PERUBAHAN APBD </strong></td>
                    </tr>
                    
                    <tr>
                         <td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>

                  </table>";
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                    <tr>
                        <td width=\"20%\">Urusan Organisasi </td>
                        <td width=\"80%\">:$kd_urusan - $nm_urusan</td>
                    </tr>
                    <tr>
                        <td>Organisasi</td>
                        <td>:$kd_skpd - $nm_skpd</td>
                    </tr>
                    
                </table>";  
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>Kode Rekening</b></td>                            
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>Uraian</b></td>                            
                            <td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Jumlah (Rp.)</b></td>
                            <td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"13%\" align=\"center\"><b>Bertambah/ (Berkurang)</b></td>
                            <td colspan=\"5\" rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"25%\" align=\"center\"><b>Penjelasan</b></td>                            
                            </tr>
                        <tr>
 		                     <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">Anggaran<br>Perubahan</td>
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">Realisasi<br>Perubahan</td>
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">Jumlah</td>
                             <td width=\"3%\" bgcolor=\"#CCCCCC\" align=\"center\">%</td>
                             
                        </tr> 
                        <tr>
							<td bgcolor=\"#CCCCCC\" style=\"vertical-align:top;border-top: none;border-left: solid 1px black;border-bottom: solid 1px black;\"  align=\"center\">1</td>
							 <td bgcolor=\"#CCCCCC\" style=\"vertical-align:top;border-top: none;border-left: solid 1px black;border-bottom: solid 1px black;\"  align=\"center\">2</td>                            
                             <td bgcolor=\"#CCCCCC\" style=\"vertical-align:top;border-top: none;border-left: solid 1px black;border-bottom: solid 1px black;\"  align=\"center\">3</td>
 		                     <td bgcolor=\"#CCCCCC\" style=\"vertical-align:top;border-top: none;border-left: solid 1px black;border-bottom: solid 1px black;\"  align=\"center\">4</td>
							 <td bgcolor=\"#CCCCCC\" style=\"vertical-align:top;border-top: none;border-left: solid 1px black;border-bottom: solid 1px black;\"  align=\"center\">5</td>                            
                             <td bgcolor=\"#CCCCCC\" style=\"vertical-align:top;border-top: none;border-left: solid 1px black;border-bottom: solid 1px black;\"  align=\"center\">6</td>
                             <td colspan=\"5\" bgcolor=\"#CCCCCC\" style=\"vertical-align:top;border-top: none;border-left: solid 1px black;border-bottom: solid 1px black;\"  align=\"center\">7</td>
							                  
                             
                        </tr>    
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>  
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;border-left: solid 1px white;\"></td>
                            <td style=\"border-top: none;border-left: solid 1px white;\"></td>  
                            <td style=\"border-top: none;border-left: solid 1px white;\"></td>
                            <td style=\"border-top: none;border-left: solid 1px white;\"></td>                                                       
                         </tr>
                     </tfoot>
                    
                     
                        <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"18%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\">&nbsp;</td></tr>
                        ";
                        
                 $sqltp="
						SELECT IFNULL(SUM(a.nilai_ubah),0) AS totp_u,'' as totp,
						IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=4 AND kd_skpd='$id'),0)
						AS realisasi
						FROM trdrka a JOIN ms_rek1 b ON LEFT(a.`kd_rek5`,1)=b.kd_rek1
						WHERE LEFT (a.kd_rek5,1)=4 AND a.kd_skpd='$id'
					";
				 
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                    $pend=number_format($rowp->totp,"2",".",",");
                    $pen=$rowp->totp;
                    $pend_u=number_format($rowp->totp_u,"2",".",",");
                    $pen_u=$rowp->totp_u;
					$realisasi =$rowp->realisasi;
					$real =number_format($rowp->realisasi,"2",".",",");
                    $pend_s = $rowp->totp_u - $rowp->realisasi;
                    if ($pend_s < 0){
                    	$x1="("; $pend_s=$pend_s*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $pend_selisih = number_format($pend_s,"2",".",",");
                    $per1   = ($pend_s!=0)?($pend_s / $rowp->realisasi ) * 100:0; 
                    
					if(empty($pend_selisih)){
					$persen1='';
					}else{
                    $persen1= number_format($per1,"2",".",",");
					}
					
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"><b>Pendapatan Daerah</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$pend_u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$real</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$pend_selisih$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"18%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\"></td></tr>";
                                     
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"18%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\"></td></tr>";
                 } 
                 $sql1="
						SELECT * FROM 
						(SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,SUBSTR(a.no_trdrka,12,24) AS kd_rek1,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
						' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,
					    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,1)=4 AND kd_skpd='$id'),0) AS Realisasi,
						'1' AS nu,' ' AS po
						FROM trdrka a INNER JOIN ms_rek2 b 
						ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id'  AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,24),b.nm_rek2
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,SUBSTR(a.no_trdrka,12,25) AS kd_rek1,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        ' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,
						IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,3)=b.kd_rek3 AND kd_skpd='$id'),0) AS Realisasi,
                         '2' AS nu,' ' AS po FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id'  AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,25),b.nm_rek3
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,SUBSTR(a.no_trdrka,12,27) AS kd_rek1,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        ' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,
						IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,4)=b.kd_rek4 AND kd_skpd='$id'),0) AS Realisasi,
                         '3' AS nu,' ' AS po FROM trdrka a INNER JOIN ms_rek4 b 
                        ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,27),b.nm_rek4
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,SUBSTR(a.no_trdrka,12,29) AS kd_rek1,b.nm_rek5 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,
                        ' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,
						IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,5)=b.kd_rek5 AND kd_skpd='$id'),0) AS Realisasi,
                         '4' AS nu,' ' AS po FROM trdrka a INNER JOIN ms_rek5 b 
                        ON a.kd_rek5=b.kd_rek5 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,29),b.nm_rek5
                        UNION ALL
                        SELECT SUBSTR(no_trdrka,12,29) AS kd_rek,' ' AS kd_rek1,' 'AS nm_rek,' 'AS nilai,' ' AS nilai_u,
                        uraian AS uraian,volume_ubah1 AS volume,satuan_ubah1 AS satuan,harga_ubah1 AS harga,total_ubah AS total,
                        '0' AS Realisasi,
                         '5' AS nu,no_po AS po FROM trdpo
                        WHERE LEFT(no_trdrka,10)='$id' AND SUBSTR(no_trdrka,34,1)='4') a ORDER BY kd_rek,nu,po
						";
                 
                 $query = $this->db->query($sql1);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query->result() as $row)
                {
                    $kode=$row->kd_rek1;
                    $nama=$row->nm_rek;                    
                    $nilai  = empty($row->nilai) || $row->nilai == 0 ? '' :number_format($row->nilai,2,',','.');
                    $nilai_u= empty($row->nilai_u) || $row->nilai_u == 0 ? '' :number_format($row->nilai_u,2,',','.');
					$realp  =empty($row->Realisasi) || $row->Realisasi == 0 ? '' :number_format($row->Realisasi,2,',','.');
                    $uraian=$row->uraian;
                    $volume=$row->volume;
                    $satuan=$row->satuan; 
                    $harga= empty($row->harga) || $row->harga == 0 ? '' :number_format($row->harga,2,',','.');
                    $total= empty($row->total) || $row->total == 0 ? '' :number_format($row->total,2,',','.');
                    $nu=$row->nilai_u;
                    $n=$row->nilai;
					$real =$row->Realisasi;
					
					$nilaip_s = $nu - $real;   //$n
                    if ($nilaip_s < 0){
                    	$x1="("; $nilaip_s=$nilaip_s*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $nilaip_selisih = empty($nilaip_s) || $nilaip_s == 0 ? '' :number_format($nilaip_s,"2",".",",");
                    //$perp   = ($nilaip_s!=0)?($nilaip_s / $row->nilai ) * 100:0; 
                    //$persenp= empty($perp) || $perp == 0 ? '' :number_format($perp,"2",".",",");
                    if ($realp<>0){
						$perp=($nilaip_s!=0)?($nilaip_s/$row->Realisasi)*100:0;
					}else if($nilai_u<>0 and $realp==0){
						$perp=100;
					}else{
						$perp=0;
					}
					if(empty($nilaip_selisih)){
					  $persenp='';
					  }else{
                        $persenp= number_format($perp,"2",".",",");
					   }
					  
					  
					//$persenp=number_format($perp,"2",".",",");
				   
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$nilai_u</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$realp</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$nilaip_selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\">$persenp</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"left\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"center\">$volume</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"center\">$satuan</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\">$harga</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\">$total</td></tr>
                                     ";
                
        
                  }
                  
                   $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"18%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\"></td></tr>";
                                                       
                   $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none; border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"><b>Pendapatan Daerah</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$pend_u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$realisasi</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$pend_selisih$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\"></td></tr>";
                                     
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\"></td></tr>";

/*									 
                 $sqltb="SELECT SUM(nilai) AS totb,SUM(nilai_ubah) AS totb_u,
          				 FROM trdrka WHERE LEFT(kd_rek5,1)='5' and kd_skpd='$id'";
*/						 
				$sqltb="
					 SELECT SUM(nilai_ubah) AS totb_u,'' as totb,
					 IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE  LEFT(kd_rek5_ang,1)=5 and kd_skpd='$id'),0) AS debet,''AS kredit
					 FROM trdrka  WHERE LEFT(kd_rek5,1)='5' and kd_skpd='$id'
					 ";
						 
                 $sqlb=$this->db->query($sqltb);
                 foreach ($sqlb->result() as $rowb)
                {
                   $blj=number_format($rowb->totb,"2",".",",");
                   $blj1=$rowb->totb;
                   $blj_u=number_format($rowb->totb_u,"2",".",",");
                   $blj_u1=$rowb->totb_u;
                   $debet= empty($rowb->debet) || $rowb->debet == 0 ? '' :number_format($rowb->debet,2,',','.');
                   $kredit= empty($rowb->kredit) || $rowb->kredit == 0 ? '' :number_format($rowb->kredit,2,',','.');
				   $debetbl =$rowb->debet;
				   $kreditbl=$rowb->kredit;
				   $blj_s  = $rowb->debet- $rowb->kredit;
                   $realisasi5= number_format($blj_s,2,',','.');
				   //selisih
                   $blj5_s = $rowb->totb_u - $rowb->debet- $rowb->kredit;
                    if ($blj5_s < 0){
                    	$x1="("; $blj5_s=$blj5_s*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $blj_selisih = number_format($blj5_s,"2",".",",");
                    $per1   = ($blj_s!=0)?($blj5_s / $realisasi5 ) * 100:0; 

					if($blj <> 0){
						$per1_blj   = ($blj_s!=0)?($blj_s /$rowb->debet - $rowb->kredit) * 100:0; 
					}else if($blj_u <> 0 and $blj ==0){
						$per1_blj=100;
					}else{
						$per1_blj=0;
					}
				
                    if(empty($blj_selisih)){
					$persen_blj='';
					}else{
                    $persen_blj= number_format($per1_blj,"2",".",",");
					}
					
                    //$persen_blj= number_format($per1_blj,"2",".",",");
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"><b>Belanja Daerah</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$blj_u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$realisasi5</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$blj_selisih$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen_blj</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\"></td></tr>";
                                     
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\"></td></tr>";
                 }

/*                 
                 $sqltbtl="SELECT SUM(nilai) AS totbtl,SUM(nilai_ubah) AS totbtl_u,
					       IFNULL((SELECT SUM(rupiah) FROM trdju_pkd WHERE LEFT(kd_rek5,2)=51 AND no_voucher IN (SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='12' and kd_skpd='$id' )),0)AS realisasi
				           FROM trdrka WHERE LEFT(kd_rek5,2)='51' and kd_skpd='$id'";
*/
                 $sqltbtl="
							SELECT SUM(nilai_ubah) AS totbtl_u,'' as totbtl,
							IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE  LEFT(kd_rek5_ang,2)=51),0) AS debet,'0' AS kredit
							FROM trdrka  WHERE LEFT(kd_rek5,2)='51'
							";

				 $sqlbtl=$this->db->query($sqltbtl);
                 foreach ($sqlbtl->result() as $rowbtl)
                {
                   $bljbtl=number_format($rowbtl->totbtl,"2",".",",");
                   $bljbtl1=$rowbtl->totbtl;
                   $bljbtl_u=number_format($rowbtl->totbtl_u,"2",".",",");
                   $bljbtl1_u=$rowbtl->totbtl_u;
                   $debet= empty($rowbtl->debet) || $rowbtl->debet == 0 ? '' :number_format($rowbtl->debet,2,',','.');
                   $kredit= empty($rowbtl->kredit) || $rowbtl->kredit == 0 ? '' :number_format($rowbtl->kredit,2,',','.');
				   $debetbl =$rowbtl->debet;
				   $kreditbl=$rowbtl->kredit;
				   $btl_s  =$rowbtl->debet- $rowbtl->kredit;
                   $realisasi= number_format($btl_s,2,',','.');
				   
                    if ($btl_s < 0){
                    	$x1="("; $btl_s=$btl_s*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $btl_selisih = number_format($btl_s,"2",".",",");
                    //$per1_btl  = ($pend_s!=0)?($btl_s / $rowbtl->totbtl ) * 100:0; 
                    //$persen_btl= number_format($per1_btl,"2",".",",");
					if($bljbtl <> 0){
						$per1_btl   = ($btl_s!=0)?($btl_s /$rowbtl->debet - $rowbtl->kredit) * 100:0; 
					}else if($bljbtl_u <> 0 and $bljbtl ==0){
						$per1_btl=100;
					}else{
						$per1_btl=0;
					}

                    $persen_btl= number_format($per1_btl,"2",".",",");
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"><b>Belanja Tidak Langsung</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$bljbtl_u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$realisasi</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$btl_selisih$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen_btl</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\"></td></tr>";
                                     
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\"></td></tr>";
                                     
                                                                                              
                 } 
 
/* 
                 $sql2="SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,SUBSTR(a.no_trdrka,12,25) AS kd_rek1,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,'1' AS nu,' ' AS po FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id'  AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,25),b.nm_rek3
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,SUBSTR(a.no_trdrka,12,27) AS kd_rek1,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,'2' AS nu,' ' AS po FROM trdrka a INNER JOIN ms_rek4 b 
                        ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,27),b.nm_rek4
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,SUBSTR(a.no_trdrka,12,29) AS kd_rek1,b.nm_rek5 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,'3' AS nu,' ' AS po FROM trdrka a INNER JOIN ms_rek5 b 
                        ON a.kd_rek5=b.kd_rek5 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,29),b.nm_rek5
                        UNION ALL
                        SELECT SUBSTR(no_trdrka,12,29) AS kd_rek,' ' AS kd_rek1,' 'AS nm_rek,' 'AS nilai,' ' as nilai_u,uraian AS uraian,volume1 AS volume,satuan1 AS satuan,harga1 AS harga,total AS total, '4' AS nu,no_po AS po  FROM trdpo
                        WHERE LEFT(no_trdrka,10)='$id' AND SUBSTR(no_trdrka,34,2)='51'
                        ) a ORDER BY kd_rek,nu,po";
*/
						
				$sql2="
					SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,SUBSTR(a.no_trdrka,12,25) AS kd_rek1,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE  LEFT(kd_rek5_ang,3)=b.kd_rek3 AND kd_skpd='$id'),0) AS debet,'0' AS kredit
						,'1' AS nu,' ' AS po FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id'  AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,25),b.nm_rek3
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,SUBSTR(a.no_trdrka,12,27) AS kd_rek1,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE  LEFT(kd_rek5_ang,5)=b.kd_rek4 AND kd_skpd='$id'),0) AS debet,'0' AS kredit
						, '2' AS nu,' ' AS po FROM trdrka a INNER JOIN ms_rek4 b 
                        ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,27),b.nm_rek4
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,SUBSTR(a.no_trdrka,12,29) AS kd_rek1,b.nm_rek5 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE  kd_rek5_ang=b.kd_rek5 AND kd_skpd='$id'),0) AS debet,'0' AS kredit
						,'3' AS nu,' ' AS po FROM trdrka a INNER JOIN ms_rek5 b 
                        ON a.kd_rek5=b.kd_rek5 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY SUBSTR(a.no_trdrka,12,29),b.nm_rek5
                        UNION ALL
                        SELECT SUBSTR(no_trdrka,12,29) AS kd_rek,' ' AS kd_rek1,' 'AS nm_rek,' 'AS nilai,' ' AS nilai_u,uraian AS uraian,volume1 AS volume,satuan1 AS satuan,harga1 AS harga,total AS total, 
						'0' AS debet,'0' AS Realisasi
						,'4' AS nu,no_po AS po  FROM trdpo
                        WHERE LEFT(no_trdrka,10)='$id' AND SUBSTR(no_trdrka,34,2)='51'
                        ) a ORDER BY kd_rek,nu,po 
						";
                 
                 $query1 = $this->db->query($sql2);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query1->result() as $row)
                {
                    $kode=$row->kd_rek1;
                    $nama=$row->nm_rek;                    
                    $nilai= empty($row->nilai) || $row->nilai == 0 ? '' :number_format($row->nilai,2,',','.');
                    $nilai_u= empty($row->nilai_u) || $row->nilai_u == 0 ? '' :number_format($row->nilai_u,2,',','.');
                    $uraian=$row->uraian;
                    $volume=$row->volume;
                    $satuan=$row->satuan; 
                    $harga= empty($row->harga) || $row->harga == 0 ? '' :number_format($row->harga,2,',','.');
                    $total= empty($row->total) || $row->total == 0 ? '' :number_format($row->total,2,',','.');
                    $debet= empty($row->debet) || $row->debet == 0 ? '' :number_format($row->debet,2,',','.');
                    $kredit= empty($row->kredit) || $row->kredit == 0 ? '' :number_format($row->kredit,2,',','.');
					$debet51 =$row->debet;
					$kredit51=$row->kredit;
					$real51  =$row->debet- $row->kredit;
                    $realisasi= number_format($real51,2,',','.');
                    $realisasi51= empty($real51) || $real51 == 0 ? '' :number_format($real51,2,',','.');  //membuat cetakan kosong tanda 00
                    $nilaip_s = $row->nilai_u - $row->debet - $row->kredit;
										
					//ilham 1
					$nilaip_nol = number_format($nilaip_s,2,',','.');
					//selesai
                    if ($nilaip_s < 0){
                    	$x1="("; $nilaip_s=$nilaip_s*-1; $y1=")";}
                    else {
                    	$x1=""; $nilaip_selisih='0.00'; $y1="";}
                    
					$nilaip_selisih = empty($nilaip_s) || $nilaip_s == 0 ? '' :number_format($nilaip_s,"2",".",",");
					
					//$perp   = ($nilaip_s!=0)?($nilaip_s / $row->nilai ) * 100:0; 
                    //$persenp= empty($perp) || $perp == 0 ? '' :number_format($perp,"2",".",",");
                    if ($realisasi<>0){
						$perp=($nilaip_s!=0)?($nilaip_s/$row->debet - $row->kredit)*100:0;
					}else if($nilai_u<>0 and $realisasi==0){
						$perp=100;
					}else{
						$perp=0;
					}
					
					if(empty($nilaip_selisih)){
					$persenp='';
					}else{
                    $persenp= number_format($perp,"2",".",",");
					}
					
					//$persenp=number_format($perp,"2",".",",");
					
					if (strlen($kode) <=25){
                        $cRet    .= " <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$nilai_u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$realisasi51</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$nilaip_selisih$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persenp</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"left\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"center\">$volume</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"center\">$satuan</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\">$harga</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\">$total</td>
                                     </tr> ";
                    }else{
                   
                     $cRet    .= " <tr>
                                    <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$nilai_u</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$realisasi51</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$nilaip_nol$y1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\">$persenp</td>";
                             If (strlen($kode)==29){
									$cRet    .= "<td colspan=\"5\" style=\"vertical-align:top;border-top: none;border-left: solid 1px black;border-bottom: none; border-right: solid 1px black;\" width=\"49%\" align=\"left\">Dipergunakan untuk Pembayaran $nama</td>";
								}else{
                                     $cRet    .= "<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"18%\" align=\"left\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"center\">$volume</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"center\">$satuan</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\">$harga</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\">$total</td></tr>
                                     ";
                                     }
                               $cRet    .= "</tr>";       
                     }
                
        
                  }
                  
                 //$sqltbl="SELECT SUM(nilai) AS totbl,SUM(nilai_ubah) AS totbl_u FROM trdrka WHERE LEFT(kd_rek5,2)='52' and kd_skpd='$id'";
                 $sqltbl="
							SELECT SUM(nilai) AS totbl,SUM(nilai_ubah) AS totbl_u,
							IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE  left(kd_rek5_ang,2)='52' AND kd_skpd='$id'),0) AS debet,'0' AS kredit
							FROM trdrka WHERE LEFT(kd_rek5,2)='52' AND kd_skpd='$id'
							";
				 
				 $sqlbl=$this->db->query($sqltbl);
                 foreach ($sqlbl->result() as $rowbl)
                {
                   $bljbl=number_format($rowbl->totbl,"2",".",",");
                   $bljbl1=$rowbl->totbl;
                   $bljbl_u=number_format($rowbl->totbl_u,"2",".",",");
                   $bljbl1_u=$rowbl->totbl_u;
                   $debet= empty($rowbl->debet) || $rowbl->debet == 0 ? '' :number_format($rowbl->debet,2,',','.');
                   $kredit= empty($rowbl->kredit) || $rowbl->kredit == 0 ? '' :number_format($rowbl->kredit,2,',','.');
				   $debetbl =$rowbl->debet;
				   $kreditbl=$rowbl->kredit;
				   $realbl  =$rowbl->debet- $rowbl->kredit;
                   $realisasi= number_format($realbl,2,',','.');
				   
                   $bl_s = $bljbl1_u - $realbl;
                    if ($bl_s < 0){
                    	$x1="("; $bl_s=$bl_s*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $bl_selisih = empty($bl_s) || $bl_s == 0 ? '' :number_format($bl_s,"2",".",",");
                    
					
			      //$per1_bl  = ($pend_s!=0)?($bl_s / $rowbl->totbl ) * 100:0; 
                  //  $persen_bl= empty($per1_bl) || $per1_bl == 0 ? '' :number_format($per1_bl,"2",".",",");
			   
                    if ($bljbl1<>0){
						$per1_bl=($realbl!=0)?($bl_s/$rowbl->debet-$rowbl->kredit)*100:0; 
					}else if($bljbl1_u<>0 and $bljbl1==0){
						$per1_bl=100;
					}else{
						$per1_bl=0;
					}
					$persen_bl = number_format($per1_bl,"2",".",",");
					
					
				   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"><b>Belanja Langsung</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$bljbl_u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$realisasi</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$bl_selisih$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen_bl</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\"></td></tr>";
                                     
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;\" width=\"17%\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;border-left: solid 1px white;\" width=\"8%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;border-left: solid 1px white;\" width=\"10%\" align=\"right\"></td></tr>";
                 } 
                 
                 $sql3="
						SELECT a.kd_program AS kd_rek, a.kd_program AS kd_rek1,c.nm_program AS nm_rek,(SELECT SUM(nilai) FROM trdrka WHERE LEFT(kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program) AS nilai,(SELECT SUM(nilai_ubah) FROM trdrka WHERE LEFT(kd_kegiatan,(LENGTH(a.kd_program))) = a.kd_program) AS nilai_u,' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE  SUBSTR(kd_kegiatan,1,18)=a.kd_program AND LEFT(kd_rek5_ang,2)='52' AND kd_skpd='$id'),0) AS debet,'0' AS kredit
						,'1' AS nu,' ' AS po FROM trskpd a INNER JOIN m_prog c ON a.kd_program1=c.kd_program
                        LEFT JOIN trdrka b ON a.kd_program=LEFT(b.kd_kegiatan,(LENGTH(a.kd_program))) WHERE a.kd_skpd='$id' AND RIGHT(a.kd_program,2) <>'00' AND LEFT(b.kd_rek5,2)='52' GROUP BY a.kd_program,c.nm_program 
                        UNION ALL
                        SELECT a.kd_kegiatan AS kd_rek,a.kd_kegiatan AS kd_rek1,c.nm_kegiatan AS nm_rek,SUM(b.nilai)AS nilai,SUM(b.nilai_ubah)AS nilai_u,' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE  kd_kegiatan=a.kd_kegiatan AND LEFT(kd_rek5_ang,2)='52' AND kd_skpd='$id'),0) AS debet,'0' AS kredit
                        ,'2' AS nu,' ' AS po FROM trskpd a INNER JOIN m_giat c ON a.kd_kegiatan1=c.kd_kegiatan
                        LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan WHERE a.kd_skpd='$id' AND RIGHT(a.kd_program,2) <>'00' AND LEFT(b.kd_rek5,2)='52' GROUP BY a.kd_kegiatan,c.nm_kegiatan 
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,24) AS kd_rek,SUBSTR(a.no_trdrka,12,24) AS kd_rek1,b.nm_rek2 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE  CONCAT(kd_kegiatan,'.',SUBSTR(kd_rek5_ang,1,2))=SUBSTR(a.no_trdrka,12,24) AND LEFT(kd_rek5_ang,2)='52' AND kd_skpd='$id'),0) AS debet,'0' AS kredit
                        ,'3' AS nu,' ' AS po FROM trdrka a INNER JOIN ms_rek2 b 
                        ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id'  AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,24),b.nm_rek2
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,SUBSTR(a.no_trdrka,12,25) AS kd_rek1,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE  kd_kegiatan=a.kd_kegiatan AND LEFT(kd_rek5_ang,3)=b.kd_rek3 AND kd_skpd='$id'),0) AS debet,'0' AS kredit
                        ,'4' AS nu,' ' AS po FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id'  AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,25),b.nm_rek3
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,SUBSTR(a.no_trdrka,12,27) AS kd_rek1,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE  kd_kegiatan=a.kd_kegiatan AND LEFT(kd_rek5_ang,5)=b.kd_rek4 AND kd_skpd='$id'),0) AS debet,'0' AS kredit
                        ,'5' AS nu,' ' AS po FROM trdrka a INNER JOIN ms_rek4 b 
                        ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id'  AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,27),b.nm_rek4
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,SUBSTR(a.no_trdrka,12,29) AS kd_rek1,b.nm_rek5 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE  kd_kegiatan=a.kd_kegiatan AND kd_rek5_ang=b.kd_rek5 AND kd_skpd='$id'),0) AS debet,'0' AS kredit
                        ,'6' AS nu,' ' AS po FROM trdrka a INNER JOIN ms_rek5 b 
                        ON a.kd_rek5=b.kd_rek5 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY SUBSTR(a.no_trdrka,12,29),b.nm_rek5
                        UNION ALL
                        SELECT SUBSTR(no_trdrka,12,29) AS kd_rek,' ' AS kd_rek1,' 'AS nm_rek,' 'AS nilai,' 'AS nilai_u,uraian AS uraian,volume_ubah1 AS volume,satuan_ubah1 AS satuan,harga_ubah1 AS harga,total_ubah AS total,
                        '0' AS debet,'0' AS kredit,
                        '7' AS nu,no_po AS po FROM trdpo
                        WHERE LEFT(no_trdrka,10)='$id' AND SUBSTR(no_trdrka,34,2)='52'
                        ORDER BY kd_rek,nu,po 
						
						";
                 
                 $query2 = $this->db->query($sql3);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query2->result() as $row)
                {
                    $kode=$row->kd_rek1;
                    $nama=$row->nm_rek;                    
                    $nilai= empty($row->nilai) || $row->nilai == 0 ? '' :number_format($row->nilai,2,',','.');
                    $nilai_u= empty($row->nilai_u) || $row->nilai_u == 0 ? '' :number_format($row->nilai_u,2,',','.');
                    $uraian=$row->uraian;
                    $volume=$row->volume;
                    $satuan=$row->satuan; 
                    $harga= empty($row->harga) || $row->harga == 0 ? '' :number_format($row->harga,2,',','.');
                    $total= empty($row->total) || $row->total == 0 ? '' :number_format($row->total,2,',','.');
                    $debet= empty($row->debet) || $row->debet == 0 ? '' :number_format($row->debet,2,',','.');
                    $kredit= empty($row->kredit) || $row->kredit == 0 ? '' :number_format($row->kredit,2,',','.');
					$debet52 =$row->debet;
					$kredit52=$row->kredit;
					$real52  =$row->debet- $row->kredit;
                    $realisasi= number_format($real52,2,',','.');
                    $realisasi52= empty($real52) || $real52 == 0 ? '' :number_format($real52,2,',','.');  //membuat cetakan kosong tanda 00
					$nilaib_s = $row->nilai_u - $row->debet - $row->kredit;
					
					//ilham 1
					$nilaib_nol = number_format($nilaib_s,2,',','.');  //nilaib_s
					//selesai
					
					if ($nilaib_s < 0){
                    	$x1="("; $nilaib_s=$nilaib_s*-1; $y1=")";}
                    else {
                    	$x1=""; $nilaip_selisih='0.00'; $y1="";}
				
					
                    $nilaib_selisih = empty($real52) || $real52 == 0 ? '' :number_format($real52,"2",".",",");
                    
					if($nilai <> 0){
						$perb   = ($real52!=0)?($real52 /$row->debet-$row->kredit) * 100:0; 
					}else if($nilai_u <> 0 and $nilai ==0){
						$perb=100;
					}else{
						$perb=0;
					}

                    if(empty($nilaib_selisih)){
					$persenb='';
					}else{
                    $persenb= number_format($perb,"2",".",",");
					}
					
                    if (strlen($kode) <=25 && $kode!=" "){
                        $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$nilai_u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$realisasi52</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$nilaib_nol$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persenb</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"left\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"center\">$volume</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"center\">$satuan</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\">$harga</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\">$total</td></tr>
                                     ";
                    }else{
					    if ($nilaib_s < 0){
                    	$x1="("; $nilaib_s=$nilaib_s*-1; $y1=")";}
                        else {
                    	$x1=""; $nilaip_selisih='0.00'; $y1="";}
					
                        $nilaib_selisih = empty($nilaib_s) || $nilaib_s == 0 ? '' :number_format($nilaib_s,"2",".",",");
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$nilai_u</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$realisasi52</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$nilaib_selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\">$persenb</td>";
                      If (strlen($kode)==29){
									$cRet    .= "<td colspan=\"5\" style=\"vertical-align:top;border-top: none;border-left: solid 1px black;border-bottom: none; border-right: solid 1px black;\" width=\"49%\" align=\"left\">Dipergunakan untuk Pembayaran $nama</td>";
								}else{
                                     $cRet    .= "
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"18%\" align=\"left\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"center\">$volume</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"center\">$satuan</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\">$harga</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\">$total</td></tr>
                                     ";
                                     }
                                    $cRet    .= "</tr>";
                    }
        
                  }
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;\" width=\"17%\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;border-left: solid 1px white;\" width=\"8%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: solid 1px black;border-left: solid 1px white;\" width=\"10%\" align=\"right\"></td></tr>";
                                     
                   $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"><b>Belanja Daerah</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$blj_u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$realisasi5</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$blj_selisih$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen_blj</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\"></td></tr>";
                                     
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\"></td></tr>";
                                     
                 //$sqltpm="
							//SELECT SUM(nilai) AS totpm,SUM(nilai_ubah) AS totpm_u FROM trdrka WHERE LEFT(kd_rek5,2)='61' and kd_skpd='$id'";
                 
				 $sqltpm="
				 SELECT SUM(nilai) AS totpm,SUM(nilai_ubah) AS totpm_u,
				 IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=61 AND kd_skpd='$id'),0)
					AS debet,'0' AS kredit
				 FROM trdrka WHERE LEFT(kd_rek5,2)='61' AND kd_skpd='$id'
				 ";
				 
				 $sqlpm=$this->db->query($sqltpm);
                 foreach ($sqlpm->result() as $rowpm)
                {
                   $bljpm=number_format($rowpm->totpm,"2",".",",");
                   $pm=$rowpm->totpm;
                   $bljpm_u=number_format($rowpm->totpm_u,"2",".",",");
                   $pm_u=$rowpm->totpm_u;                   
                   //$pm_s = $pm_u - $pm;
				   
                   $debet= empty($rowpm->debet) || $rowpm->debet == 0 ? '' :number_format($rowpm->debet,2,',','.');
                   $kredit= empty($rowpm->kredit) || $rowpm->kredit == 0 ? '' :number_format($rowpm->kredit,2,',','.');
				   $debet61 =$rowpm->debet;
				   $kredit61=$rowpm->kredit;
				   $real61  =$rowpm->debet- $rowpm->kredit;
                   $realisasi= number_format($real61,2,',','.');
				   $pm_s = $rowpm->totpm_u - $rowpm->debet - $rowpm->kredit;
				   
                    if ($pm_s < 0){
                    	$x1="("; $pm_s=$pm_s*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $pm_selisih = number_format($pm_s,"2",".",",");
                    $per1_pm  = ($pm_s!=0)?($pm_s / $rowpm->debet - $rowpm->kredit ) * 100:0; 
                    $persen_pm= number_format($per1_pm,"2",".",",");
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"><b>Pembiayaan Masuk</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$bljpm_u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$realisasi</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$pm_selisih$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen_pm</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\"></td></tr>";
                                     
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\"></td></tr>";
                 
                 }
                 
                 $sql4="
						SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,SUBSTR(a.no_trdrka,12,25) AS kd_rek1,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_kegiatan=a.kd_kegiatan AND LEFT(kd_rek5_ang,3)=b.kd_rek3 AND kd_skpd='$id'),0)AS debet,'0' AS kredit
					,'1' AS nu,' ' AS po FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id'  AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,25),b.nm_rek3
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,SUBSTR(a.no_trdrka,12,27) AS kd_rek1,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_kegiatan=a.kd_kegiatan AND LEFT(kd_rek5_ang,5)=b.kd_rek4 AND kd_skpd='$id'),0)AS debet,'0' AS kredit
                        ,'2' AS nu,' ' AS po FROM trdrka a INNER JOIN ms_rek4 b 
                        ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,27),b.nm_rek4
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,SUBSTR(a.no_trdrka,12,29) AS kd_rek1,b.nm_rek5 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,
					IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_kegiatan=a.kd_kegiatan AND kd_rek5_ang=b.kd_rek5 AND kd_skpd='$id'),0)AS debet,'0' AS kredit
                        ,'3' AS nu,' ' AS po FROM trdrka a INNER JOIN ms_rek5 b 
                        ON a.kd_rek5=b.kd_rek5 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY SUBSTR(a.no_trdrka,12,29),b.nm_rek5
                        UNION ALL
                        SELECT SUBSTR(no_trdrka,12,29) AS kd_rek,' ' AS kd_rek1,' 'AS nm_rek,' 'AS nilai,' ' AS nilai_u,uraian AS uraian,volume1 AS volume,satuan1 AS satuan,harga1 AS harga,total AS total, 
                        '0' AS debet,'0' AS kredit,
                        '4' AS nu,no_po AS po  FROM trdpo
                        WHERE LEFT(no_trdrka,10)='$id' AND SUBSTR(no_trdrka,34,2)='61'
                        ) a ORDER BY kd_rek,nu,po 
						";
                 
                 $query3 = $this->db->query($sql4);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query3->result() as $row)
                {
                    $kode=$row->kd_rek1;
                    $nama=$row->nm_rek;                    
                    $nilai= empty($row->nilai) || $row->nilai == 0 ? '' :number_format($row->nilai,2,',','.');
                    $nilai_u= empty($row->nilai_u) || $row->nilai_u == 0 ? '' :number_format($row->nilai_u,2,',','.');
                    $uraian=$row->uraian;
                    $volume=$row->volume;
                    $satuan=$row->satuan; 
                    $harga= empty($row->harga) || $row->harga == 0 ? '' :number_format($row->harga,2,',','.');
                    $total= empty($row->total) || $row->total == 0 ? '' :number_format($row->total,2,',','.');
                    //$nilaipm_s = $row->nilai_u - $row->nilai;
                    
					$debetpm= empty($row->debet) || $row->debet == 0 ? '' :number_format($row->debet,2,',','.');
                    $kreditpm= empty($row->kredit) || $row->kredit == 0 ? '' :number_format($row->kredit,2,',','.');
				    $debet16 =$row->debet;
				    $kredit16=$row->kredit;
				    $real16  =$row->debet- $row->kredit;
                    $realisasi16= number_format($real16,2,',','.');
				    $nilaipm_s = $row->nilai_u - $row->debet - $row->kredit;
					
					
                    if ($nilaipm_s < 0){
                    	$x1="("; $nilaipm_s=$nilaipm_s*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $nilaipm_selisih = empty($nilaipm_s) || $nilaipm_s == 0 ? '' :number_format($nilaipm_s,"2",".",",");
                    //$perpm   = ($nilaipm_s!=0)?($nilaipm_s / $row->nilai ) * 100:0; 
                   // $persenpm= empty($perpm) || $perpm == 0 ? '' :number_format($perpm,"2",".",",");
                   
				   
				   //$perp   = ($nilaip_s!=0)?($nilaip_s / $row->nilai ) * 100:0; 
                    //$perpm   = ($nilaipm_s!=0)?($nilaipm_s / $row->nilai ) * 100:0;
                    if ($nilai<>0){
						$perpm=($nilaipm_s!=0)?($nilaipm_s/$row->debet - $row->kredit)*100:0;
					}else if($nilai_u<>0 and $nilai==0){
						$perpm=100;
					}else{
						$perpm=0;
					}
			//tambah firman 5 baris ke bawah ganti yang satu		
					if(empty($nilaipm_selisih)){
					$persenpm='';
					}else{
                    $persenpm= number_format($perpm,"2",".",",");
					}
					//$persenpm = number_format($perpm,"2",".",",");
					
					
				   
                     if (strlen($kode) <=25 && $kode!=" "){
                        $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$nilai_u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$realisasi16</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$nilaipm_selisih$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persenpm</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"left\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"center\">$volume</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"center\">$satuan</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\">$harga</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\">$total</td></tr>
                                     ";
                    }else{
                   
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$nilai_u</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$realisasi16</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$nilaipm_selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\">$persenpm</td>";
                      If (strlen($kode)==29){
									$cRet    .= "<td colspan=\"5\" style=\"vertical-align:top;border-top: none;border-left: solid 1px black;border-bottom: none; border-right: solid 1px black;\" width=\"49%\" align=\"left\">Dipergunakan untuk Pembayaran $nama</td>";
								}else{
                                     $cRet    .= "
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"left\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"center\">$volume</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"center\">$satuan</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\">$harga</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\">$total</td></tr>
                                     ";
                                     }
                                    $cRet    .= "</tr>";
                    }
                
        
                  }
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\"></td></tr>";
                 
                  
                  //$sqltpk="SELECT SUM(nilai) AS totpk,SUM(nilai_ubah) AS totpk_u FROM trdrka WHERE LEFT(kd_rek5,2)='62' and kd_skpd='$id'";
			
			$sqltpk="	 
				 SELECT SUM(nilai) AS totpk,SUM(nilai_ubah) AS totpk_u,
				 IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=62 AND kd_skpd='$id'),0)
					AS debet,'0' AS kredit
				 FROM trdrka WHERE LEFT(kd_rek5,2)='62' AND kd_skpd='$id' 
				 
				 ";
				 

					$sqlpk=$this->db->query($sqltpk);
                 foreach ($sqlpk->result() as $rowpk)
                {
                   $bljpk=number_format($rowpk->totpk,"2",".",",");
                   $bljpk1=$rowpk->totpk;
                   $bljpk_u=number_format($rowpk->totpk_u,"2",".",",");
                   $bljpk1_u=$rowpk->totpk_u;                   
                   //$pk_s = $bljpk1_u - $bljpk1;
				   
				   $debet26= empty($rowpk->debet) || $rowpk->debet == 0 ? '' :number_format($rowpk->debet,2,',','.');
                   $kredit26= empty($rowpk->kredit) || $rowpk->kredit == 0 ? '' :number_format($rowpk->kredit,2,',','.');
				   $debet26 =$rowpk->debet;
				   $kredit26=$rowpk->kredit;
				   $real26  =$rowpk->debet- $rowpk->kredit;
                   $realisasi26= number_format($real26,2,',','.');
				   $pk_s = $rowpk->totpk_u - $rowpk->debet - $rowpk->kredit;
				   
                    if ($pk_s < 0){
                    	$x1="("; $pk_s=$pk_s*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $pk_selisih = number_format($pk_s,"2",".",",");
                    
                   // $persen_pk= number_format($per1_pk,"2",".",",");
					
					
                    //$persenpk= empty($perpk) || $perpk == 0 ? '' :number_format($perpk,"2",",",".");
                    if ($nilai<>0){
					$per1_pk  = ($pend_s!=0)?($pk_s / $rowpk->debet - $rowpk-kredit ) * 100:0; 
					}else if($nilai_u<>0 and $nilai==0){
						$per1_pk=100;
					}else{
						$per1_pk=0;
					}
					$persen_pk = number_format($per1_pk,"2",".",",");
					
					
					
					
					
					
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"><b>Pembiayaan Keluar</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$bljpk_u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$realisasi26</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$pk_selisih$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen_pk</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\"></td></tr>";
                                     
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\"></td></tr>";
                  }                   
                    
                 
                 
                 $sql5="
						SELECT * FROM (SELECT SUBSTR(a.no_trdrka,12,25) AS kd_rek,SUBSTR(a.no_trdrka,12,25) AS kd_rek1,b.nm_rek3 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,
					    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_kegiatan=a.kd_kegiatan AND LEFT(kd_rek5_ang,3)=b.kd_rek3 AND kd_skpd='$id'),0)AS debet,'0' AS kredit
					,'1' AS nu,' ' AS po FROM trdrka a INNER JOIN ms_rek3 b 
                        ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id'  AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,25),b.nm_rek3
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,27) AS kd_rek,SUBSTR(a.no_trdrka,12,27) AS kd_rek1,b.nm_rek4 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,
					    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_kegiatan=a.kd_kegiatan AND LEFT(kd_rek5_ang,5)=b.kd_rek4 AND kd_skpd='$id'),0)AS debet,'0' AS kredit
                        ,'2' AS nu,' ' AS po FROM trdrka a INNER JOIN ms_rek4 b 
                        ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,27),b.nm_rek4
                        UNION ALL
                        SELECT SUBSTR(a.no_trdrka,12,29) AS kd_rek,SUBSTR(a.no_trdrka,12,29) AS kd_rek1,b.nm_rek5 AS nm_rek,SUM(a.nilai)AS nilai,SUM(a.nilai_ubah)AS nilai_u,' ' AS uraian,' 'AS volume,' 'AS satuan,' 'AS harga,' 'AS total,
					    IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_kegiatan=a.kd_kegiatan AND kd_rek5_ang=b.kd_rek5 AND kd_skpd='$id'),0)AS debet,'0' AS kredit
                        ,'3' AS nu,' ' AS po FROM trdrka a INNER JOIN ms_rek5 b 
                        ON a.kd_rek5=b.kd_rek5 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='62' GROUP BY SUBSTR(a.no_trdrka,12,29),b.nm_rek5
                        UNION ALL
                        SELECT SUBSTR(no_trdrka,12,29) AS kd_rek,' ' AS kd_rek1,' 'AS nm_rek,' 'AS nilai,' ' AS nilai_u,uraian AS uraian,volume1 AS volume,satuan1 AS satuan,harga1 AS harga,total AS total, 
                        '0' AS debet,'0' AS kredit,
                        '4' AS nu,no_po AS po  FROM trdpo
                        WHERE LEFT(no_trdrka,10)='$id' AND SUBSTR(no_trdrka,34,2)='62'
                        ) a ORDER BY kd_rek,nu,po 
						
						";
                 
                 $query4 = $this->db->query($sql5);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query4->result() as $row)
                {
                    $kode=$row->kd_rek1;
                    $nama=$row->nm_rek;                    
                    $nilai= empty($row->nilai) || $row->nilai == 0 ? '' :number_format($row->nilai,2,',','.');
                    $nilai_u= empty($row->nilai_u) || $row->nilai_u == 0 ? '' :number_format($row->nilai_u,2,',','.');
                    $uraian=$row->uraian;
                    $volume=$row->volume;
                    $satuan=$row->satuan; 
                    $harga= empty($row->harga) || $row->harga == 0 ? '' :number_format($row->harga,2,',','.');
                    $total= empty($row->total) || $row->total == 0 ? '' :number_format($row->total,2,',','.');
                    $pk=$row->nilai;
                    $pk_u=$row->nilai_u;
                    //$nilaipk_s = $pk_u - $pk;
					
				    $debet62= empty($row->debet) || $row->debet == 0 ? '' :number_format($row->debet,2,',','.');
                    $kredit62= empty($row->kredit) || $row->kredit == 0 ? '' :number_format($row->kredit,2,',','.');
				    $debet62 =$row->debet;
				    $kredit62=$row->kredit;
				    $real62  =$row->debet- $row->kredit;
                    $realisasi62= number_format($real62,2,',','.');
				    $nilaipk_s = $row->nilai_u - $row->debet - $row->kredit;
					
                    if ($nilaipk_s < 0){
                    	$x1="("; $nilaipk_s=$nilaipk_s*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $nilaipk_selisih = empty($nilaipk_s) || $nilaipk_s == 0 ? '' :number_format($nilaipk_s,"2",",",".");
				   
                    //$persenpk= empty($perpk) || $perpk == 0 ? '' :number_format($perpk,"2",",",".");
                    if ($nilai<>0){
					$perpk   = ($nilaipk_s!=0)?($nilaipk_s / $row->nilai ) * 100:0; 
					}else if($nilai_u<>0 and $nilai==0){
						$perpk=100;
					}else{
						$perpk=0;
					}
					if(empty($nilaipk_selisih)){
					$persenpk='';
					}else{
                    $persenpk= number_format($perpk,"2",".",",");
					}
					
					//$persenpk = number_format($perpk,"2",".",",");
					
			
					
                     if (strlen($kode) <=25 && $kode!=" "){
                        $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$nilai_u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$realisasi62</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$nilaipk_selisih$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persenpk</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"left\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"center\">$volume</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"center\">$satuan</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\">$harga</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\">$total</td></tr>
                                     ";
                    }else{
                   
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$nilai_u</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$realisasi62</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$nilaipk_selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\">$persenpk</td>";
                      If (strlen($kode)==29){
									$cRet    .= "<td colspan=\"5\" style=\"vertical-align:top;border-top: none;border-left: solid 1px black;border-bottom: none; border-right: solid 1px black;\" width=\"49%\" align=\"left\">Dipergunakan untuk Pembayaran $nama</td>";
								}else{
                                     $cRet    .= "
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"left\">$uraian</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"center\">$volume</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"center\">$satuan</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\">$harga</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\">$total</td></tr>
                                     ";
                                     }
                                    $cRet    .= "</tr>";
                	}
        
                  }
                  //$sqltpk="SELECT SUM(nilai) AS totpk,sum(nilai_ubah)as totpk_u FROM trdrka WHERE LEFT(kd_rek5,2)='62' and kd_skpd='$id'";
				 $sqltpk="
				 SELECT SUM(nilai) AS totpk,SUM(nilai_ubah) AS totpk_u,
				 IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_rek5_ang,2)=62 AND kd_skpd='$id'),0)
				 AS debet,'0' AS kredit
				 FROM trdrka WHERE LEFT(kd_rek5,2)='62' AND kd_skpd='$id'
				 ";
				 
				  $sqlpk=$this->db->query($sqltpk);
                  foreach ($sqlpk->result() as $rowpklr)
                    {
                       $pk=$rowpklr->totpk;
                       $pk_u=$rowpklr->totpk_u;
				       $debet62= empty($rowpklr->debet) || $rowpklr->debet == 0 ? '' :number_format($rowpklr->debet,2,',','.');
                       $kredit62= empty($rowpklr->kredit) || $rowpklr->kredit == 0 ? '' :number_format($rowpklr->kredit,2,',','.');
				       $debet62 =$rowpklr->debet;
				       $kredit62=$rowpklr->kredit;
				       $real62  =$rowpklr->debet- $rowpklr->kredit;
                       $realisasi62= number_format($real62,2,',','.');
				       $nilaipk_s = $rowpklr->totpk_u - $rowpklr->debet - $rowpklr->kredit;
                 }
					
                  $netto=$pm - $pk;
                  $net=number_format($netto,"2",",",".");
                  $netto_u=$pm_u - $pk_u;
                  $net_u=number_format($netto_u,"2",",",".");
                  $netto_s=$netto_u - $netto;
				  
                  if ($netto_s < 0){
                    	$x1="("; $netto_s=$netto_s*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $netto_selisih = number_format($netto_s,"2",",",".");
                    $perpnet   = ($netto_s!=0)?($netto_s / $real62 ) * 100:0; 
                    $persennet= number_format($perpnet,"2",",",".");                   
                    
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"17%\"><b>Pembiayaan Netto</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$net_u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$realisasi62</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$netto_selisih$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persennet</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"18%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"2%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"8%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;border-left: solid 1px white;\" width=\"10%\" align=\"right\"></td></tr>";
        $cRet .=       " </table>";
		$data['prev'] = $cRet;
		$data['sikap'] = 'preview';


		$this->template->set('title', 'CETAK PERDA REALISASI SEMESTER LAMPIRAN I');
		$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
	}
	
	
//Cetak Laporan Realisasi Ringkasan APBD Perkada 
	

	function lampiran_IV()
	{
		$data['page_title'] = 'REALISASI';
		$this->template->set('title', 'REALISASI');
		$this->template->load('template', 'akuntansi/perda_real_iv', $data);
	}
	function cetak_lra2()
	{
		$data['page_title'] = 'REALISASI';
		$this->template->set('title', 'REALISASI');
		$this->template->load('template', 'akuntansi/cetak_lra', $data);
	}

	function cetak_lra_ppkd()
	{
		$data['page_title'] = 'LRA PPKD';
		$this->template->set('title', 'LRA PPKD');
		$this->template->load('template', 'akuntansi/cetak_lra_ppkd', $data);
	}

	function cetak_lra_lo_v()
	{
		$data['page_title'] = 'REALISASI';
		$this->template->set('title', 'REALISASI');
		$this->template->load('template', 'akuntansi/cetak_lra_lo', $data);
	}

	function cetak_lra_lo_ppkd()
	{
		$data['page_title'] = 'REALISASI';
		$this->template->set('title', 'REALISASI');
		$this->template->load('template', 'akuntansi/cetak_lra_lo_ppkd', $data);
	}
	
	function ctk_lo_pemda()
	{
		$data['page_title'] = 'REALISASI OPERASIONAL';
		$this->template->set('title', 'REALISASI OPERASIONAL');
		$this->template->load('template', 'akuntansi/cetak_lo_pemda', $data);
	}

	function cetak_lpe_ppkd()
	{
		$data['page_title'] = 'LPE';
		$this->template->set('title', 'LPE');
		$this->template->load('template', 'akuntansi/cetak_lpe_ppkd', $data);
	}

	function cetak_lpe()
	{
		$data['page_title'] = 'LPE';
		$this->template->set('title', 'LPE');
		$this->template->load('template', 'akuntansi/cetak_lpe', $data);
	}

	function cetak_lra_pemda()
	{
		$data['page_title'] = 'LRA';
		$this->template->set('title', 'LRA');
		$this->template->load('template', 'akuntansi/cetak_lra_pemda', $data);
	}
	
	function cetak_lpsal()
	{
		$data['page_title'] = 'LPSAL';
		$this->template->set('title', 'LPSAL');
		$this->template->load('template', 'akuntansi/cetak_lpsal', $data);
	}

	function cetak_perdaIV_real($cetak = 1)
	{

		$sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
		$sqlsclient = $this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc)
		{

			$tgl = $rowsc->tgl_rka;
			$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
			$kab = $rowsc->kab_kota;
			$daerah = $rowsc->daerah;
			$thn = $rowsc->thn_ang;
		}


		$cRet = '';
		if ($cetak <>0)
		{
			$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
						<td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"10%\"><strong><h5>LAMPIRAN I.3  :</h6></strong></td>
						<td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>PERATURAN DAERAH</strong></h5></td>
					</tr>
					<tr> 
						<td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>:</h5></td>
					</tr>
					<tr>
						<td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>:</h5></td>
					</tr>
										
				
				</table>";
		}
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td align=\"center\"><strong>$kab</strong></td>
						
					</tr>
					<tr>
						<td align=\"center\"><strong>LAPORAN REALISASI BELANJA MENURUT URUSAN PEMERINTAHAN DAERAH, ORGANISASI, PROGRAM DAN KEGIATAN</strong></td>
					</tr>
					
					<tr>
						<td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
					</tr>

				</table>";

		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
					<thead>					
						<tr><td rowspan=\"3\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>KODE</b></td>							
							<td rowspan=\"3\" bgcolor=\"#CCCCCC\" width=\"22%\" align=\"center\"><b>URAIAN URUSAN, ORGANISASI, PROGRAM DAN KEGIATAN PEMERINTAH DAERAH</b></td>							
							<td style=\"border-bottom: solid 1px black;\" colspan=\"4\" bgcolor=\"#CCCCCC\" width=\"49%\" align=\"center\"><b>SETELAH PERUBAHAN</b></td>
							<td style=\"border-bottom: solid 1px black;\" colspan=\"4\" bgcolor=\"#CCCCCC\" width=\"49%\" align=\"center\"><b>REALISASI</b></td>
							<td style=\"border-bottom: solid 1px black;\" colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\"><b>LEBIH/(KURANG)</b></td>
						</tr>
						<tr>
							<td style=\"border-bottom: solid 1px black;\" colspan=\"3\" width=\"21%\" bgcolor=\"#CCCCCC\" align=\"center\">JENIS BELANJA</td>
							<td rowspan=\"2\" width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">JUMLAH</td>
							<td style=\"border-bottom: solid 1px black;\" colspan=\"3\" width=\"21%\" bgcolor=\"#CCCCCC\" align=\"center\">JENIS BELANJA</td>
							<td rowspan=\"2\" width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">JUMLAH</td>
							<td rowspan=\"2\" width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">(Rp)</td>
							<td rowspan=\"2\" width=\"5%\" bgcolor=\"#CCCCCC\" align=\"center\">%</td>
						</tr>
						<tr>
 							<td width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">PEGAWAI</td>
							<td width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">BARANG DAN JASA</td>
							<td width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">MODAL</td>
							<td width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">PEGAWAI</td>
							<td width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">BARANG DAN JASA</td>
							<td width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">MODAL</td>
						</tr>	
					</thead>
					
					
						<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>							
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"22%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
						</tr>
						";
 
 
//===DNA BARU FIRMAN

			$sql1 = "
			SELECT
						a.kd_urusan1 AS kode,
						a.nm_urusan1 AS nama,
						SUM(IF(LEFT(x.kd_rek5,3)='521',x.nilai_ubah,0)) AS ang_521,
						SUM(IF(LEFT(x.kd_rek5,3)='522',x.nilai_ubah,0)) AS ang_522,
						SUM(IF(LEFT(x.kd_rek5,3)='523',x.nilai_ubah,0)) AS ang_523,
						SUM(IF(LEFT(x.kd_rek5,2)='52',x.nilai_ubah,0)) AS ang_jumlah,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_skpd,1)=a.kd_urusan1 AND LEFT(kd_rek5_ang,3)='521'),0) AS real_521,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_skpd,1)=a.kd_urusan1 AND LEFT(kd_rek5_ang,3)='522'),0) AS real_522,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_skpd,1)=a.kd_urusan1 AND LEFT(kd_rek5_ang,3)='523'),0) AS real_523,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_skpd,1)=a.kd_urusan1 AND LEFT(kd_rek5_ang,2)='52'),0) AS real_jumlah,
						'1' AS nu
						FROM
						trdrka X
						LEFT JOIN ms_urusan1 a ON  LEFT(x.kd_skpd,1)=a.kd_urusan1 GROUP BY  a.kd_urusan1 ,a.nm_urusan1
						UNION ALL
						SELECT
						a.kd_urusan AS kode,
						a.nm_urusan AS nama,
						SUM(IF(LEFT(x.kd_rek5,3)='521',x.nilai_ubah,0)) AS ang_521,
						SUM(IF(LEFT(x.kd_rek5,3)='522',x.nilai_ubah,0)) AS ang_522,
						SUM(IF(LEFT(x.kd_rek5,3)='523',x.nilai_ubah,0)) AS ang_523,
						SUM(IF(LEFT(x.kd_rek5,2)='52',x.nilai_ubah,0)) AS ang_jumlah,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_skpd,4)=a.kd_urusan AND LEFT(kd_rek5_ang,3)='521'),0) AS real_521,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_skpd,4)=a.kd_urusan AND LEFT(kd_rek5_ang,3)='522'),0) AS real_522,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_skpd,4)=a.kd_urusan AND LEFT(kd_rek5_ang,3)='523'),0) AS real_523,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_skpd,4)=a.kd_urusan AND LEFT(kd_rek5_ang,2)='52'),0) AS real_jumlah,
						'2' AS nu
						FROM
						trdrka X
						LEFT JOIN ms_urusan a ON LEFT(x.kd_skpd,4)=a.kd_urusan GROUP BY  a.kd_urusan ,a.nm_urusan
						UNION
						SELECT
						a.kd_skpd AS kode,
						a.nm_skpd AS nama,
						SUM(IF(LEFT(x.kd_rek5,3)='521',x.nilai_ubah,0)) AS ang_521,
						SUM(IF(LEFT(x.kd_rek5,3)='522',x.nilai_ubah,0)) AS ang_522,
						SUM(IF(LEFT(x.kd_rek5,3)='523',x.nilai_ubah,0)) AS ang_523,
						SUM(IF(LEFT(x.kd_rek5,2)='52',x.nilai_ubah,0)) AS ang_jumlah,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd=a.kd_skpd AND LEFT(kd_rek5_ang,3)='521'),0) AS real_521,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd=a.kd_skpd AND LEFT(kd_rek5_ang,3)='522'),0) AS real_522,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd=a.kd_skpd AND LEFT(kd_rek5_ang,3)='523'),0) AS real_523,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd=a.kd_skpd AND LEFT(kd_rek5_ang,2)='52'),0) AS real_jumlah,
						'3' AS nu
						FROM
						trdrka X
						LEFT JOIN ms_skpd a ON x.kd_skpd=a.kd_skpd  GROUP BY a.kd_skpd,a.nm_skpd
						UNION
						SELECT
						b.kd_program AS kode,
						b.nm_program AS nama,
						SUM(IF(LEFT(x.kd_rek5,3)='521',x.nilai_ubah,0)) AS ang_521,
						SUM(IF(LEFT(x.kd_rek5,3)='522',x.nilai_ubah,0)) AS ang_522,
						SUM(IF(LEFT(x.kd_rek5,3)='523',x.nilai_ubah,0)) AS ang_523,
						SUM(IF(LEFT(x.kd_rek5,2)='52',x.nilai_ubah,0)) AS ang_jumlah,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_program=b.kd_program AND LEFT(kd_rek5_ang,3)='521'),0) AS real_521,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_program=b.kd_program AND LEFT(kd_rek5_ang,3)='522'),0) AS real_522,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_program=b.kd_program AND LEFT(kd_rek5_ang,3)='523'),0) AS real_523,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_program=b.kd_program AND LEFT(kd_rek5_ang,2)='52'),0) AS real_jumlah,
						'4' AS nu
						FROM
						trdrka X LEFT JOIN trskpd b ON SUBSTR(x.kd_kegiatan,1,18)=b.`kd_program`
						GROUP BY kode,nama
						UNION
						SELECT
						x.kd_kegiatan AS kode,
						x.nm_kegiatan AS nama,
						SUM(IF(LEFT(x.kd_rek5,3)='521',x.nilai_ubah,0)) AS ang_521,
						SUM(IF(LEFT(x.kd_rek5,3)='522',x.nilai_ubah,0)) AS ang_522,
						SUM(IF(LEFT(x.kd_rek5,3)='523',x.nilai_ubah,0)) AS ang_523,
						SUM(IF(LEFT(x.kd_rek5,2)='52',x.nilai_ubah,0)) AS ang_jumlah,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_kegiatan=x.kd_kegiatan AND LEFT(kd_rek5_ang,3)='521'),0) AS real_521,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_kegiatan=x.kd_kegiatan AND LEFT(kd_rek5_ang,3)='522'),0) AS real_522,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_kegiatan=x.kd_kegiatan AND LEFT(kd_rek5_ang,3)='523'),0) AS real_523,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_kegiatan=x.kd_kegiatan AND LEFT(kd_rek5_ang,2)='52'),0) AS real_jumlah,
						'5' AS nu
						FROM
						trdrka X
						GROUP BY x.kd_kegiatan,x.nm_kegiatan
						ORDER BY kode,nu  ";

//===DNA FIRMAN

 
		$query = $this->db->query($sql1);
		//$query = $this->skpd_model->getAllc();

		foreach ($query->result() as $row)
		{
			$kode = $row->kode;
			$nama = $row->nama;
			$ang521 = number_format($row->ang_521, "2", ".", ",");
			$ang522 = number_format($row->ang_522, "2", ".", ",");
			$ang523 = number_format($row->ang_523, "2", ".", ",");
			$jum_ang = number_format($row->ang_jumlah, "2", ".", ",");
			$jum_angga = $row->ang_jumlah;
			$real521 = number_format($row->real_521, "2", ".", ",");
			$real522 = number_format($row->real_522, "2", ".", ",");
			$real523 = number_format($row->real_523, "2", ".", ",");
			$jum_real = number_format($row->real_jumlah, "2", ".", ",");
			$rumus1 = $row->real_jumlah - $row->ang_jumlah ;
			
			if ($rumus1 < 0)
			{
				$x1 = "(";
				$rumus1 = $rumus1 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$total1 = number_format($rumus1, "2", ".", ",");
			$per1 = ($jum_angga != 0) ? ($rumus1 / $row->ang_jumlah) * 100 : 0;
			$persen1 = number_format($per1, "2", ".", ",");

			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"10%\" align=\"left\">$kode</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"22%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$ang521</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$ang522</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$ang523</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$jum_ang</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$real521</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$real522</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$real523</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$jum_real</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$x1$total1$y1</td>              
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"right\">$persen1</td>
								</tr> ";
		}

		$cRet .= " </table>";
		
//Aktifkan Jika Penandatangan Perlu
		$sqlttd1 = "SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='1.20.02.00' and kode='KD'";
		$sqlttd = $this->db->query($sqlttd1);
		foreach ($sqlttd->result() as $rowttd)
		{
			$nip = $rowttd->nip;
			$nama = $rowttd->nm;
			$jabatan = $rowttd->jab;
		}
		$cRet .="<table>;
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
					</tr>
		 </table>";
 		 $cRet .=" <table width='100%' border=\"0\" cellspacing=\"1\" cellpadding=\"1\">
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>$daerah, ".$this->tukd_model->tanggal_format_indonesia(date("Y-m-d"))."</td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'><b>$jabatan</b></td>
					</tr>
					<tr>
						<td align='center' width='40%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>&nbsp;</td>
					</tr>
					<tr>
						<td align='center' width='40%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>&nbsp;</td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'><b>$nama</b></td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'><b>$nip</b></td>
					</tr>
				  </table>
				";				
						
		$data['prev'] = $cRet;
		$judul = 'Laporan Realisasi APBD  Lamp IV ';
		$this->template->set('title', 'CETAK PERDA REALISASI LAMPIRAN IV');
		switch ($cetak)
		{
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, 'L');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");

				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}
	}
	
	function cetak_perdaIV_real2($cetak = 1)
	{

		$sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
		$sqlsclient = $this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc)
		{

			$tgl = $rowsc->tgl_rka;
			$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
			$kab = $rowsc->kab_kota;
			$daerah = $rowsc->daerah;
			$thn = $rowsc->thn_ang;
		}


		$cRet = '';
		if ($cetak <>0)
		{
			$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
						<td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"10%\"><strong><h5>LAMPIRAN I.3  :</h6></strong></td>
						<td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>RANCANGAN PERATURAN DAERAH</strong></h5></td>
					</tr>
					<tr> 
						<td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>:</h5></td>
					</tr>
					<tr>
						<td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>:</h5></td>
					</tr>
										
				
				</table>";
		}
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td align=\"center\"><strong>$kab</strong></td>
						
					</tr>
					<tr>
						<td align=\"center\"><strong>LAPORAN REALISASI BELANJA MENURUT URUSAN PEMERINTAHAN DAERAH, ORGANISASI, PROGRAM DAN KEGIATAN</strong></td>
					</tr>
					
					<tr>
						<td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
					</tr>

				</table>";

		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
					<thead>					
						<tr><td rowspan=\"3\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>KODE</b></td>							
							<td rowspan=\"3\" bgcolor=\"#CCCCCC\" width=\"22%\" align=\"center\"><b>URAIAN URUSAN, ORGANISASI, PROGRAM DAN KEGIATAN PEMERINTAH DAERAH</b></td>							
							<td style=\"border-bottom: solid 1px black;\" colspan=\"4\" bgcolor=\"#CCCCCC\" width=\"49%\" align=\"center\"><b>SETELAH PERUBAHAN</b></td>
							<td style=\"border-bottom: solid 1px black;\" colspan=\"4\" bgcolor=\"#CCCCCC\" width=\"49%\" align=\"center\"><b>REALISASI</b></td>
							<td style=\"border-bottom: solid 1px black;\" colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\"><b>LEBIH/(KURANG)</b></td>
						</tr>
						<tr>
							<td style=\"border-bottom: solid 1px black;\" colspan=\"3\" width=\"21%\" bgcolor=\"#CCCCCC\" align=\"center\">JENIS BELANJA</td>
							<td rowspan=\"2\" width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">JUMLAH</td>
							<td style=\"border-bottom: solid 1px black;\" colspan=\"3\" width=\"21%\" bgcolor=\"#CCCCCC\" align=\"center\">JENIS BELANJA</td>
							<td rowspan=\"2\" width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">JUMLAH</td>
							<td rowspan=\"2\" width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">(Rp)</td>
							<td rowspan=\"2\" width=\"5%\" bgcolor=\"#CCCCCC\" align=\"center\">%</td>
						</tr>
						<tr>
 							<td width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">PEGAWAI</td>
							<td width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">BARANG DAN JASA</td>
							<td width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">MODAL</td>
							<td width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">PEGAWAI</td>
							<td width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">BARANG DAN JASA</td>
							<td width=\"7%\" bgcolor=\"#CCCCCC\" align=\"center\">MODAL</td>
						</tr>	
					</thead>
					
					
						<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>							
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"22%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"7%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\">&nbsp;</td>
						</tr>
						";
 
 
//===DNA BARU FIRMAN

			$sql1 = "
			SELECT
						a.kd_urusan1 AS kode,
						a.nm_urusan1 AS nama,
						SUM(IF(LEFT(x.kd_rek5,3)='521',x.nilai_ubah,0)) AS ang_521,
						SUM(IF(LEFT(x.kd_rek5,3)='522',x.nilai_ubah,0)) AS ang_522,
						SUM(IF(LEFT(x.kd_rek5,3)='523',x.nilai_ubah,0)) AS ang_523,
						SUM(IF(LEFT(x.kd_rek5,2)='52',x.nilai_ubah,0)) AS ang_jumlah,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_skpd,1)=a.kd_urusan1 AND LEFT(kd_rek5_ang,3)='521'),0) AS real_521,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_skpd,1)=a.kd_urusan1 AND LEFT(kd_rek5_ang,3)='522'),0) AS real_522,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_skpd,1)=a.kd_urusan1 AND LEFT(kd_rek5_ang,3)='523'),0) AS real_523,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_skpd,1)=a.kd_urusan1 AND LEFT(kd_rek5_ang,2)='52'),0) AS real_jumlah,
						'1' AS nu
						FROM
						trdrka X
						LEFT JOIN ms_urusan1 a ON  LEFT(x.kd_skpd,1)=a.kd_urusan1 GROUP BY  a.kd_urusan1 ,a.nm_urusan1
						UNION ALL
						SELECT
						a.kd_urusan AS kode,
						a.nm_urusan AS nama,
						SUM(IF(LEFT(x.kd_rek5,3)='521',x.nilai_ubah,0)) AS ang_521,
						SUM(IF(LEFT(x.kd_rek5,3)='522',x.nilai_ubah,0)) AS ang_522,
						SUM(IF(LEFT(x.kd_rek5,3)='523',x.nilai_ubah,0)) AS ang_523,
						SUM(IF(LEFT(x.kd_rek5,2)='52',x.nilai_ubah,0)) AS ang_jumlah,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_skpd,4)=a.kd_urusan AND LEFT(kd_rek5_ang,3)='521'),0) AS real_521,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_skpd,4)=a.kd_urusan AND LEFT(kd_rek5_ang,3)='522'),0) AS real_522,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_skpd,4)=a.kd_urusan AND LEFT(kd_rek5_ang,3)='523'),0) AS real_523,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE LEFT(kd_skpd,4)=a.kd_urusan AND LEFT(kd_rek5_ang,2)='52'),0) AS real_jumlah,
						'2' AS nu
						FROM
						trdrka X
						LEFT JOIN ms_urusan a ON LEFT(x.kd_skpd,4)=a.kd_urusan GROUP BY  a.kd_urusan ,a.nm_urusan
						UNION
						SELECT
						a.kd_skpd AS kode,
						a.nm_skpd AS nama,
						SUM(IF(LEFT(x.kd_rek5,3)='521',x.nilai_ubah,0)) AS ang_521,
						SUM(IF(LEFT(x.kd_rek5,3)='522',x.nilai_ubah,0)) AS ang_522,
						SUM(IF(LEFT(x.kd_rek5,3)='523',x.nilai_ubah,0)) AS ang_523,
						SUM(IF(LEFT(x.kd_rek5,2)='52',x.nilai_ubah,0)) AS ang_jumlah,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd=a.kd_skpd AND LEFT(kd_rek5_ang,3)='521'),0) AS real_521,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd=a.kd_skpd AND LEFT(kd_rek5_ang,3)='522'),0) AS real_522,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd=a.kd_skpd AND LEFT(kd_rek5_ang,3)='523'),0) AS real_523,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_skpd=a.kd_skpd AND LEFT(kd_rek5_ang,2)='52'),0) AS real_jumlah,
						'3' AS nu
						FROM
						trdrka X
						LEFT JOIN ms_skpd a ON x.kd_skpd=a.kd_skpd  GROUP BY a.kd_skpd,a.nm_skpd
						UNION
						SELECT
						b.kd_program AS kode,
						b.nm_program AS nama,
						SUM(IF(LEFT(x.kd_rek5,3)='521',x.nilai_ubah,0)) AS ang_521,
						SUM(IF(LEFT(x.kd_rek5,3)='522',x.nilai_ubah,0)) AS ang_522,
						SUM(IF(LEFT(x.kd_rek5,3)='523',x.nilai_ubah,0)) AS ang_523,
						SUM(IF(LEFT(x.kd_rek5,2)='52',x.nilai_ubah,0)) AS ang_jumlah,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_program=b.kd_program AND LEFT(kd_rek5_ang,3)='521'),0) AS real_521,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_program=b.kd_program AND LEFT(kd_rek5_ang,3)='522'),0) AS real_522,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_program=b.kd_program AND LEFT(kd_rek5_ang,3)='523'),0) AS real_523,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_program=b.kd_program AND LEFT(kd_rek5_ang,2)='52'),0) AS real_jumlah,
						'4' AS nu
						FROM
						trdrka X LEFT JOIN trskpd b ON SUBSTR(x.kd_kegiatan,1,18)=b.`kd_program`
						GROUP BY kode,nama
						UNION
						SELECT
						x.kd_kegiatan AS kode,
						x.nm_kegiatan AS nama,
						SUM(IF(LEFT(x.kd_rek5,3)='521',x.nilai_ubah,0)) AS ang_521,
						SUM(IF(LEFT(x.kd_rek5,3)='522',x.nilai_ubah,0)) AS ang_522,
						SUM(IF(LEFT(x.kd_rek5,3)='523',x.nilai_ubah,0)) AS ang_523,
						SUM(IF(LEFT(x.kd_rek5,2)='52',x.nilai_ubah,0)) AS ang_jumlah,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_kegiatan=x.kd_kegiatan AND LEFT(kd_rek5_ang,3)='521'),0) AS real_521,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_kegiatan=x.kd_kegiatan AND LEFT(kd_rek5_ang,3)='522'),0) AS real_522,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_kegiatan=x.kd_kegiatan AND LEFT(kd_rek5_ang,3)='523'),0) AS real_523,
					        IFNULL((SELECT SUM(nilai) FROM realisasi_akt  WHERE kd_kegiatan=x.kd_kegiatan AND LEFT(kd_rek5_ang,2)='52'),0) AS real_jumlah,
						'5' AS nu
						FROM
						trdrka X
						GROUP BY x.kd_kegiatan,x.nm_kegiatan
						ORDER BY kode,nu 

						";

//===DNA FIRMAN
		$query = $this->db->query($sql1);
		//$query = $this->skpd_model->getAllc();

		foreach ($query->result() as $row)
		{
			$kode = $row->kode;
			$nama = $row->nama;
			$ang521 = number_format($row->ang_521, "2", ".", ",");
			$ang522 = number_format($row->ang_522, "2", ".", ",");
			$ang523 = number_format($row->ang_523, "2", ".", ",");
			$jum_ang = number_format($row->ang_jumlah, "2", ".", ",");
			$jum_angga = $row->ang_jumlah;
			$real521 = number_format($row->real_521, "2", ".", ",");
			$real522 = number_format($row->real_522, "2", ".", ",");
			$real523 = number_format($row->real_523, "2", ".", ",");
			$jum_real = number_format($row->real_jumlah, "2", ".", ",");
			$rumus1 = $row->real_jumlah - $row->ang_jumlah ;
			
			if ($rumus1 < 0)
			{
				$x1 = "(";
				$rumus1 = $rumus1 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$total1 = number_format($rumus1, "2", ".", ",");
			$per1 = ($jum_angga != 0) ? ($rumus1 / $row->ang_jumlah) * 100 : 0;
			$persen1 = number_format($per1, "2", ".", ",");

			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"10%\" align=\"left\">$kode</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"22%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$ang521</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$ang522</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$ang523</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$jum_ang</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$real521</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$real522</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$real523</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$jum_real</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"7%\" align=\"right\">$x1$total1$y1</td>              
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"right\">$persen1</td>
								</tr> ";
		}

		$cRet .= " </table>";
		
						
		$data['prev'] = $cRet;
		$judul = 'Laporan Realisasi APBD  Lamp IV ';
		$this->template->set('title', 'CETAK PERDA REALISASI LAMPIRAN IV');
		switch ($cetak)
		{
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, 'L');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");

				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}
	}

	

	function lampiran_V()
	{
		$data['page_title'] = 'REALISASI';
		$this->template->set('title', 'REALISASI');
		$this->template->load('template', 'akuntansi/perda_real_v', $data);
	}

	function cetak_perdaV_real($cetak = 1)
	{

		$sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
		$sqlsclient = $this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc)
		{

			$tgl = $rowsc->tgl_rka;
			$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
			$kab = $rowsc->kab_kota;
			$daerah = $rowsc->daerah;
			$thn = $rowsc->thn_ang;
		}


		$cRet = '';
		if ($cetak <> 0)
		{
			$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
						<td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"15%\"><strong><h5>LAMPIRAN I.4 : </h6></strong></td>
						<td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>PERATURAN DAERAH </strong></h5></td>
					</tr>
					<tr> 
						<td align=\"left\" width=\"15%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>:</h5></td>
					</tr>
					<tr>
						<td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"15%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>:</h5></td>
					</tr>
										
				
				</table>";
		}
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td align=\"center\"><strong>$kab</strong></td>
						
					</tr>
					<tr>
						<td align=\"center\"><strong>REAKAPITULASI REALISASI ANGGARAN BELANJA DAERAH UNTUK<BR>KESELARASAN DAN KETERPADUAN URUSAN PEMERINTAHAN<BR>DAERAH DAN FUNGSI DALAM KERANGKA PENGELOLAAN<BR>KEUANGAN NEGARA </strong></td>
					</tr>
					
					<tr>
						<td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
					</tr>

				</table>";

		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
					<thead>					
						<tr><td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>KODE</b></td>							
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"39%\" align=\"center\"><b>URAIAN</b></td>							
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"16%\" align=\"center\"><b>ANGGARAN<BR>PERUBAHAN</b></td>
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"16%\" align=\"center\"><b>REALISASI</b></td>
							<td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"19%\" align=\"center\"><b>LEBIH/(KURANG)</b></td>
							</tr>
						<tr>
 							<td width=\"16%\" bgcolor=\"#CCCCCC\" align=\"center\">JUMLAH</td>
							<td width=\"3%\" bgcolor=\"#CCCCCC\" align=\"center\">%</td>
						</tr>	
					</thead>
					<tfoot>
						<tr>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>						
						</tr>
					</tfoot>
					
						<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>							
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"39%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"16%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"16%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"16%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\">&nbsp;</td>
						</tr>
						";
/*
		$sql1 = "SELECT * FROM (SELECT b.kd_fungsi AS kode, c.nm_fungsi AS nama,b.kd_fungsi AS kode1,'1' AS kode2,' 'AS skpd,
						(SELECT SUM(a.anggaran) FROM realisasi a LEFT JOIN ms_skpd b ON a.kd_skpd=b.kd_skpd WHERE LEFT(a.kd_rek5,1)='5' AND b.kd_fungsi=c.kd_fungsi)AS anggaran,
						(SELECT SUM(a.real_spj) FROM realisasi a LEFT JOIN ms_skpd b ON a.kd_skpd=b.kd_skpd WHERE LEFT(a.kd_rek5,1)='5' AND b.kd_fungsi=c.kd_fungsi)AS realisasi 
						FROM trdrka a  INNER JOIN ms_skpd b ON a.kd_skpd=b.kd_skpd LEFT JOIN ms_fungsi c ON b.kd_fungsi=c.kd_fungsi GROUP BY b.kd_fungsi,c.nm_fungsi,b.kd_fungsi
						UNION
						SELECT a.kd_skpd AS kode, b.nm_skpd AS nama,b.kd_fungsi AS kode1,'2' AS kode2,a.kd_skpd AS skpd,
						(SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,1)='5' AND kd_skpd=a.kd_skpd)AS anggaran,
						(SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,1)='5' AND kd_skpd=a.kd_skpd)AS realisasi FROM trdrka a 
						INNER JOIN ms_skpd b ON a.kd_skpd=b.kd_skpd GROUP BY a.kd_skpd,b.nm_skpd,b.kd_fungsi
						UNION	
						SELECT DISTINCT '' AS kode, 'JUMLAH' AS nama,'99' AS kode1,'3' AS kode2,'' AS skpd,
						(SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,1)='5') AS anggaran,										
						(SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,1)='5' ) AS realisasi FROM trdrka) a ORDER BY kode1,a.kode2,skpd";
*/
						
//firman fungsi
		$sql1 = "
                 SELECT
                            c.kd_fungsi AS kdfungsi,
                            c.kd_fungsi AS kode,
                            c.nm_fungsi AS nama,
                            SUM(IF(LEFT(x.kd_rek5,1)='5',x.nilai_ubah,0)) AS anggaran,
                            IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=5 AND fungsi=c.`kd_fungsi`),0)AS realisasi,
			    '1' AS nu
                          FROM
                            trdrka X
                            INNER JOIN ms_skpd a ON x.`kd_skpd`=a.kd_skpd 
                            INNER JOIN ms_fungsi c ON a.kd_fungsi=c.kd_fungsi
                            GROUP BY  c.kd_fungsi ,c.kd_fungsi
                            UNION ALL
				SELECT b.kd_fungsi AS kdfungsi,a.kd_skpd AS kode,a.nm_skpd AS nama,SUM(a.nilai_ubah) AS anggaran,
				IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=5 AND kd_skpd=b.kd_skpd),0)AS realisasi,
				'2' AS nu 
				FROM trdrka a INNER JOIN ms_skpd b ON a.kd_skpd=b.kd_skpd
				WHERE LEFT(a.kd_rek5,1)='5'
				GROUP BY a.kd_skpd
				ORDER BY kdfungsi,nu,kode
				";
					
						
		$query = $this->db->query($sql1);
		//$query = $this->skpd_model->getAllc();

		foreach ($query->result() as $row)
		{
			$kode = $row->kode;
			$nama = $row->nama;
			$ang = number_format($row->anggaran, "2", ".", ",");
			$real = number_format($row->realisasi, "2", ".", ",");
			$rumus1 = $row->realisasi - $row->anggaran;
			if ($rumus1 < 0)
			{
				$x1 = "(";
				$rumus1 = $rumus1 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$total1 = number_format($rumus1, "2", ".", ",");
			$per1 = ($rumus1 != 0) ? ($rumus1 / $row->anggaran) * 100 : 0;
			$persen1 = number_format($per1, "2", ".", ",");
			
        if(strlen($kode)<=2)
		 {
			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"8%\" align=\"left\"><b>$kode</b></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\"><b>$nama</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"12%\" align=\"right\"><b>$ang</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"12%\" align=\"right\"><b>$real</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"12%\" align=\"right\"><b>$x1$total1$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"12%\" align=\"right\"><b>$persen1</b></td>
									</tr>
									";


		}else{
			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"8%\" align=\"left\">$kode</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"12%\" align=\"right\">$ang</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"12%\" align=\"right\">$real</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"12%\" align=\"right\">$x1$total1$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"12%\" align=\"right\">$persen1</td>
									</tr>
									";
			 }
		}
		$cRet .= " </table>";
//Aktifkan Jika Penandatangan Perlu
		$sqlttd1 = "SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='1.20.02.00' and kode='KD'";
		$sqlttd = $this->db->query($sqlttd1);
		foreach ($sqlttd->result() as $rowttd)
		{
			$nip = $rowttd->nip;
			$nama = $rowttd->nm;
			$jabatan = $rowttd->jab;
		}
		$cRet .="<table>;
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
					</tr>
		 </table>";
 		 $cRet .=" <table width='100%' border=\"0\" cellspacing=\"1\" cellpadding=\"1\">
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>$daerah, ".$this->tukd_model->tanggal_format_indonesia(date("Y-m-d"))."</td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'><b>$jabatan</b></td>
					</tr>
					<tr>
						<td align='center' width='40%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>&nbsp;</td>
					</tr>
					<tr>
						<td align='center' width='40%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'>&nbsp;</td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'><b>$nama</b></td>
					</tr>
					<tr>
						<td align='center' width='40%'></td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='10%'>&nbsp;</td>
						<td align='center' width='40%'><b>$nip</b></td>
					</tr>
				  </table>
				";				
		
		$data['prev'] = $cRet;
		$judul = 'Laporan Realisasi APBD  Lamp V ';
		$this->template->set('title', 'CETAK PERDA REALISASI LAMPIRAN V');
		switch ($cetak)
		{
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");

				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}

	}
	
	function cetak_perdaV_real2($cetak = 1)
	{

		$sqlsc = "SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
		$sqlsclient = $this->db->query($sqlsc);
		foreach ($sqlsclient->result() as $rowsc)
		{

			$tgl = $rowsc->tgl_rka;
			$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
			$kab = $rowsc->kab_kota;
			$daerah = $rowsc->daerah;
			$thn = $rowsc->thn_ang;
		}


		$cRet = '';
		if ($cetak <> 0)
		{
			$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
						<td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"15%\"><strong><h5>LAMPIRAN I.4 : </h6></strong></td>
						<td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>RANCANGAN PERATURAN DAERAH </strong></h5></td>
					</tr>
					<tr> 
						<td align=\"left\" width=\"15%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>:</h5></td>
					</tr>
					<tr>
						<td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"15%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>:</h5></td>
					</tr>
										
				
				</table>";
		}
		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td align=\"center\"><strong>$kab</strong></td>
						
					</tr>
					<tr>
						<td align=\"center\"><strong>REKAPITULASI REALISASI ANGGARAN BELANJA DAERAH UNTUK<BR>KESELARASAN DAN KETERPADUAN URUSAN PEMERINTAHAN<BR>DAERAH DAN FUNGSI DALAM KERANGKA PENGELOLAAN<BR>KEUANGAN NEGARA </strong></td>
					</tr>
					
					<tr>
						<td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
					</tr>

				</table>";

		$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
					<thead>					
						<tr><td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>KODE</b></td>							
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"39%\" align=\"center\"><b>URAIAN</b></td>							
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"16%\" align=\"center\"><b>ANGGARAN<BR>PERUBAHAN</b></td>
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"16%\" align=\"center\"><b>REALISASI</b></td>
							<td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"19%\" align=\"center\"><b>LEBIH/(KURANG)</b></td>
							</tr>
						<tr>
 							<td width=\"16%\" bgcolor=\"#CCCCCC\" align=\"center\">JUMLAH</td>
							<td width=\"3%\" bgcolor=\"#CCCCCC\" align=\"center\">%</td>
						</tr>	
					</thead>
					<tfoot>
						<tr>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>						
						</tr>
					</tfoot>
					
						<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>							
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"39%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"16%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"16%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"16%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\">&nbsp;</td>
						</tr>
						";
/*
		$sql1 = "SELECT * FROM (SELECT b.kd_fungsi AS kode, c.nm_fungsi AS nama,b.kd_fungsi AS kode1,'1' AS kode2,' 'AS skpd,
						(SELECT SUM(a.anggaran) FROM realisasi a LEFT JOIN ms_skpd b ON a.kd_skpd=b.kd_skpd WHERE LEFT(a.kd_rek5,1)='5' AND b.kd_fungsi=c.kd_fungsi)AS anggaran,
						(SELECT SUM(a.real_spj) FROM realisasi a LEFT JOIN ms_skpd b ON a.kd_skpd=b.kd_skpd WHERE LEFT(a.kd_rek5,1)='5' AND b.kd_fungsi=c.kd_fungsi)AS realisasi 
						FROM trdrka a  INNER JOIN ms_skpd b ON a.kd_skpd=b.kd_skpd LEFT JOIN ms_fungsi c ON b.kd_fungsi=c.kd_fungsi GROUP BY b.kd_fungsi,c.nm_fungsi,b.kd_fungsi
						UNION
						SELECT a.kd_skpd AS kode, b.nm_skpd AS nama,b.kd_fungsi AS kode1,'2' AS kode2,a.kd_skpd AS skpd,
						(SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,1)='5' AND kd_skpd=a.kd_skpd)AS anggaran,
						(SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,1)='5' AND kd_skpd=a.kd_skpd)AS realisasi FROM trdrka a 
						INNER JOIN ms_skpd b ON a.kd_skpd=b.kd_skpd GROUP BY a.kd_skpd,b.nm_skpd,b.kd_fungsi
						UNION	
						SELECT DISTINCT '' AS kode, 'JUMLAH' AS nama,'99' AS kode1,'3' AS kode2,'' AS skpd,
						(SELECT SUM(anggaran) FROM realisasi WHERE LEFT(kd_rek5,1)='5') AS anggaran,										
						(SELECT SUM(real_spj) FROM realisasi WHERE LEFT(kd_rek5,1)='5' ) AS realisasi FROM trdrka) a ORDER BY kode1,a.kode2,skpd";
*/
						
//firman fungsi
		$sql1 = "
                 SELECT
                            c.kd_fungsi AS kdfungsi,
                            c.kd_fungsi AS kode,
                            c.nm_fungsi AS nama,
                            SUM(IF(LEFT(x.kd_rek5,1)='5',x.nilai_ubah,0)) AS anggaran,
                            IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=5 AND fungsi=c.`kd_fungsi`),0)AS realisasi,
			    '1' AS nu
                          FROM
                            trdrka X
                            INNER JOIN ms_skpd a ON x.`kd_skpd`=a.kd_skpd 
                            INNER JOIN ms_fungsi c ON a.kd_fungsi=c.kd_fungsi
                            GROUP BY  c.kd_fungsi ,c.kd_fungsi
                            UNION ALL
				SELECT b.kd_fungsi AS kdfungsi,a.kd_skpd AS kode,a.nm_skpd AS nama,SUM(a.nilai_ubah) AS anggaran,
				IFNULL((SELECT SUM(nilai) FROM realisasi_akt WHERE LEFT(kd_rek5_ang,1)=5 AND kd_skpd=b.kd_skpd),0)AS realisasi,
				'2' AS nu 
				FROM trdrka a INNER JOIN ms_skpd b ON a.kd_skpd=b.kd_skpd
				WHERE LEFT(a.kd_rek5,1)='5'
				GROUP BY a.kd_skpd
				ORDER BY kdfungsi,nu,kode					
					";
					
						
		$query = $this->db->query($sql1);
		//$query = $this->skpd_model->getAllc();

		foreach ($query->result() as $row)
		{
			$kode = $row->kode;
			$nama = $row->nama;
			$ang = number_format($row->anggaran, "2", ".", ",");
			$real = number_format($row->realisasi, "2", ".", ",");
			$rumus1 = $row->realisasi - $row->anggaran;
			if ($rumus1 < 0)
			{
				$x1 = "(";
				$rumus1 = $rumus1 * -1;
				$y1 = ")";
			} else
			{
				$x1 = "";
				$y1 = "";
			}
			$total1 = number_format($rumus1, "2", ".", ",");
			$per1 = ($rumus1 != 0) ? ($rumus1 / $row->anggaran) * 100 : 0;
			$persen1 = number_format($per1, "2", ".", ",");
			
        if(strlen($kode)<=2)
		 {
			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"8%\" align=\"left\"><b>$kode</b></td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\"><b>$nama</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"12%\" align=\"right\"><b>$ang</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"12%\" align=\"right\"><b>$real</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"12%\" align=\"right\"><b>$x1$total1$y1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"12%\" align=\"right\"><b>$persen1</b></td>
									</tr>
									";


		}else{
			$cRet .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"8%\" align=\"left\">$kode</td>									
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\">$nama</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"12%\" align=\"right\">$ang</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"12%\" align=\"right\">$real</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"12%\" align=\"right\">$x1$total1$y1</td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"12%\" align=\"right\">$persen1</td>
									</tr>
									";
			 }
		}
		$cRet .= " </table>";			
		
		$data['prev'] = $cRet;
		$judul = 'Laporan Realisasi APBD  Lamp V ';
		$this->template->set('title', 'CETAK PERDA REALISASI LAMPIRAN V');
		switch ($cetak)
		{
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");

				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}

	}
	

	function jur_umum(){
		$data['page_title'] = 'JURNAL UMUM';
		$this->template->set('title', 'JURNAL UMUM');
		$this->template->load('template', 'akuntansi/jur_umum', $data);
	}

	function jur_umum_ppkd(){
		$data['page_title'] = 'JURNAL UMUM';
		$this->template->set('title', 'JURNAL UMUM');
		$this->template->load('template', 'akuntansi/jur_umum_ppkd', $data);
	}

	function ctk_jurum($dcetak='',$dcetak2='',$skpd=''){
		$csql11	= " select nm_skpd from ms_skpd where kd_skpd = '$skpd'"; 
		$rs1	= $this->db->query($csql11);
		$trh1	= $rs1->row();
		$lcskpd	= strtoupper ($trh1->nm_skpd);
		$tgl	= $this->tukd_model->tanggal_format_indonesia($dcetak);
		$tgl2	= $this->tukd_model->tanggal_format_indonesia($dcetak2);

		$cRet ="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
			<tr>
				<td colspan=\"11\" align=\"center\" style=\"border: solid 1px white;\">$lcskpd</td>
			</tr>
			<tr>
				<td colspan=\"11\" align=\"center\" style=\"border: solid 1px white;font-size:14px\"><b>JURNAL UMUM</b></td>
			</tr>
			<tr>
				<td colspan=\"11\" align=\"center\" style=\"border: solid 1px white;border-bottom:solid 1px black;\">PERIODE $tgl S.D $tgl2</td>
			</tr>
			<tr>
				<td align=\"center\" rowspan=\"2\">Tanggal</td>
				<td align=\"center\" rowspan=\"2\">Nomor<br>Bukti</td>
				<td colspan=\"5\" align=\"center\" rowspan=\"2\">Kode<br>Rekening</td>
				<td align=\"center\" rowspan=\"2\">Uraian</td>
				<td align=\"center\" rowspan=\"2\">ref</td>
				<td align=\"center\" colspan=\"2\">Jumlah Rp</td>
			</tr>
			<tr>
				<td align=\"center\">Debit</td>
				<td align=\"center\">Kredit</td>
			</tr>
			<tr>
				<td align=\"center\" width=\"10%\">1</td>
				<td align=\"center\" width=\"10%\">2</td>
				<td colspan=\"5\" align=\"center\" width=\"15%\">3</td>
				<td align=\"center\" width=\"42%\">4</td>
				<td align=\"center\" width=\"3%\"></td>
				<td align=\"center\" width=\"10%\">5</td>
				<td align=\"center\" width=\"10%\">6</td>
			</tr> ";
		
		$csql1 = "select count(*) as tot FROM 
				trdju_pkd a JOIN trhju_pkd b ON a.kd_skpd='$skpd' and b.kd_skpd = '$skpd' and a.no_voucher= b.no_voucher
				where b.tgl_voucher >= '$dcetak' and b.tgl_voucher <= '$dcetak2' "; 
		$rs = $this->db->query($csql1);
		$trh = $rs->row();

		$csql = "SELECT b.tgl_voucher,a.no_voucher,a.kd_rek5,CONCAT(a.nm_rek5,IF(pos='0','','')) AS nm_rek5,a.debet,a.kredit FROM 
				trdju_pkd a JOIN trhju_pkd b ON a.kd_skpd='$skpd' and b.kd_skpd = '$skpd' and a.no_voucher= b.no_voucher
				where b.tgl_voucher >= '$dcetak' and b.tgl_voucher <= '$dcetak2'
				ORDER BY b.tgl_voucher ,a.no_voucher,a.urut,a.rk,a.kd_rek5";   
		
		$query = $this->db->query($csql);  
		$cnovoc = '';
		$lcno = 0;
		foreach($query->result_array() as $res){
				$lcno = $lcno + 1;
				if ($lcno==$trh->tot){
					$cRet .="<tr>
								<td style=\"border-bottom:none;border-top:none;\"></td>
								<td style=\"border-bottom:none;border-top:none;\"></td>
								<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],0,1)."</td>
								<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],1,1)."</td>
								<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],2,1)."</td>
								<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],3,2)."</td>
								<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],5,2)."</td>
								<td style=\"border-bottom:none;\">".$res['nm_rek5']."</td>
								<td style=\"border-bottom:none;\"></td>";
								if($res['debet']==0){
									$cRet .=" <td style=\"border-bottom:none;\"></td>
											<td style=\"border-bottom:none;\" align=\"right\">".number_format($res['kredit'])."</td>";
								}else{$cRet .="<td style=\"border-bottom:none;\" align=\"right\">".number_format($res['debet'])."</td>
											<td style=\"border-bottom:none;\"></td>";									
								}
					
					$cRet .="</tr>"; 
				}else{
						if($cnovoc==$res['no_voucher']){
							$cRet .="<tr>
								<td style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
								<td style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
								<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],0,1)."</td>
								<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],1,1)."</td>
								<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],2,1)."</td>
								<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],3,2)."</td>
								<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],5,2)."</td>
								<td style=\"border-bottom:none;\">".$res['nm_rek5']."</td>
								<td style=\"border-bottom:none;\"></td>";
								if($res['debet']==0){
									$cRet .=" <td style=\"border-bottom:none;\"></td>
											<td style=\"border-bottom:none;\" align=\"right\">".number_format($res['kredit'])."</td>";
								}else{$cRet .="<td style=\"border-bottom:none;\" align=\"right\">".number_format($res['debet'])."</td>
											<td style=\"border-bottom:none;\"></td>";									
								}
					
					$cRet .="</tr>";					
						}else{
						$cRet .="<tr>
								<td style=\"border-bottom:none\">".$this->tukd_model->tanggal_ind($res['tgl_voucher'])."</td>
								<td style=\"border-bottom:none\">".$res['no_voucher']."</td>
								<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],0,1)."</td>
								<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],1,1)."</td>
								<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],2,1)."</td>
								<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],3,2)."</td>
								<td style=\"border-bottom:none;\">".substr($res['kd_rek5'],5,2)."</td>
								<td style=\"border-bottom:none;\">".$res['nm_rek5']."</td>
								<td style=\"border-bottom:none;\"></td>";
								if($res['debet']==0){
									$cRet .=" <td style=\"border-bottom:none;\"></td>
											<td style=\"border-bottom:none;\" align=\"right\">".number_format($res['kredit'])."</td>";
								}else{$cRet .="<td style=\"border-bottom:none;\" align=\"right\">".number_format($res['debet'])."</td>
											<td style=\"border-bottom:none;\"></td>";									
								}
					
					$cRet .="</tr>";
						}
						$cnovoc=$res['no_voucher'];
				}
				
			}
			
		$cRet .=" <tr>
						<td style=\"border-top:none\"></td>
						<td style=\"border-top:none\"></td>
						<td style=\"border-top:none\"></td>
						<td style=\"border-top:none\"></td>
						<td style=\"border-top:none\"></td>
						<td style=\"border-top:none\"></td>
						<td style=\"border-top:none\"></td>
						<td style=\"border-top:none\"></td>
						<td style=\"border-top:none\"></td>
						<td style=\"border-top:none\"></td>
						<td style=\"border-top:none\"></td>
					</tr>  
		</table>";

			$data['prev']= 'JURNAL UMUM';
			$this->tukd_model->_mpdf('',$cRet,5,5,10,'0');	
	
	} 


	function ctk_jurum_ppkd($dcetak = '', $dcetak2 = '', $skpd = ''){
		$tgl_cetak = $this->tukd_model->rev_date($dcetak);
		$tgl_cetak2 = $this->tukd_model->rev_date($dcetak2);


		$cRet = "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
					<tr>
						<td colspan=\"11\" align=\"center\" style=\"border: solid 1px white;\">PEMERINTAH KABUPATEN MAMBERAMO TENGAH</td>
					</tr>
					<tr>
						<td colspan=\"11\" align=\"center\" style=\"border: solid 1px white;\">JURNAL UMUM PPKD</td>
					</tr>
					<tr>
						<td colspan=\"11\" align=\"center\" style=\"border: solid 1px white;border-bottom:solid 1px black;\">PERIODE $tgl_cetak S.D $tgl_cetak2</td>
					</tr>
					<tr>
						<td colspan=\"11\" align=\"center\" style=\"border: solid 1px white;border-bottom:solid 1px black;\">&nbsp;</td>
					</tr>
					<tr>
						<td align=\"center\" rowspan=\"2\">Tanggal</td>
						<td align=\"center\" rowspan=\"2\">Nomor<br>Bukti</td>
						<td colspan=\"5\" align=\"center\" rowspan=\"2\">Kode<br>Rekening</td>
						<td align=\"center\" rowspan=\"2\">Uraian</td>
						<td align=\"center\" rowspan=\"2\">ref</td>
						<td align=\"center\" colspan=\"2\">Jumlah Rp</td>
					</tr>
					<tr>
						<td align=\"center\">Debit</td>
						<td align=\"center\">Kredit</td>
					</tr>
					<tr>
						<td align=\"center\" width=\"10%\">1</td>
						<td align=\"center\" width=\"10%\">2</td>
						<td colspan=\"5\" align=\"center\" width=\"15%\">3</td>
						<td align=\"center\" width=\"42%\">4</td>
						<td align=\"center\" width=\"3%\"></td>
						<td align=\"center\" width=\"10%\">5</td>
						<td align=\"center\" width=\"10%\">6</td>
					</tr>";

		$csql1	= "	select count(*) as tot FROM trdju_ppkd a LEFT JOIN trhju_ppkd b ON a.no_voucher= b.no_voucher and a.kd_skpd=b.kd_skpd
					where b.tgl_voucher >= '$dcetak' and b.tgl_voucher <= '$dcetak2' ";
		$rs = $this->db->query($csql1);
		$trh = $rs->row();


		$csql	= "	SELECT b.tgl_voucher,a.no_voucher,a.kd_rek5,CONCAT(a.nm_rek5,IF(pos='0',' *','')) AS nm_rek5,a.debet,a.kredit,'1'topi,urut,rk FROM 
					trdju_ppkd a LEFT JOIN trhju_ppkd b ON a.no_voucher= b.no_voucher and a.kd_skpd=b.kd_skpd
					where b.tgl_voucher >= '$dcetak' and b.tgl_voucher <= '$dcetak2' and left(kd_rek5,1) in (1,2,3,7,8,9)
					union all
					SELECT b.tgl_voucher,a.no_voucher,a.kd_rek5,CONCAT(a.nm_rek5,IF(pos='0',' *','')) AS nm_rek5,a.debet,a.kredit,'2'topi,urut,rk FROM 
					trdju_ppkd a LEFT JOIN trhju_ppkd b ON a.no_voucher= b.no_voucher and a.kd_skpd=b.kd_skpd
					where b.tgl_voucher >= '$dcetak' and b.tgl_voucher <= '$dcetak2' and left(kd_rek5,1) in (0,4,5,6)
					ORDER BY tgl_voucher,no_voucher,topi,urut,rk,kd_rek5";
		$query = $this->db->query($csql);
		$cnovoc = '';
		$lcno = 0;
		foreach ($query->result_array() as $res){
			$lcno = $lcno + 1;
			if ($lcno == $trh->tot){
				$cRet .= "<tr>
								<td style=\"border-bottom:none;border-top:none;\"></td>
								<td style=\"border-bottom:none;border-top:none;\"></td>
								<td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],0, 1) . "</td>
								<td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],1, 1) . "</td>
								<td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],2, 1) . "</td>
								<td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],3, 2) . "</td>
								<td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],5, 2) . "</td>
								<td style=\"border-bottom:none;\">" . $res['nm_rek5'] ."</td>
								<td style=\"border-bottom:none;\"></td>";
				if ($res['debet'] == 0)
				{
					$cRet .= " <td style=\"border-bottom:none;\"></td>
											<td style=\"border-bottom:none;\" align=\"right\">" .
						number_format($res['kredit']) . "</td>";
				} else
				{
					$cRet .= "<td style=\"border-bottom:none;\" align=\"right\">" . number_format($res['debet']) .
						"</td>
											<td style=\"border-bottom:none;\"></td>";
				}

				$cRet .= "</tr>";
			} else
			{
				if ($cnovoc == $res['no_voucher'])
				{
					$cRet .= "<tr>
								<td style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
								<td style=\"border-bottom:none;border-top:none;\">&nbsp;</td>
								<td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],0, 1) . "</td>
								<td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],1, 1) . "</td>
								<td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],2, 1) . "</td>
								<td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],3, 2) . "</td>
								<td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],5, 2) . "</td>
								<td style=\"border-bottom:none;\">" . $res['nm_rek5'] ."</td>
								<td style=\"border-bottom:none;\"></td>";
					if ($res['debet'] == 0)
					{
						$cRet .= " <td style=\"border-bottom:none;\"></td>
											<td style=\"border-bottom:none;\" align=\"right\">" .
							number_format($res['kredit']) . "</td>";
					} else
					{
						$cRet .= "<td style=\"border-bottom:none;\" align=\"right\">" . number_format($res['debet']) .
							"</td>
											<td style=\"border-bottom:none;\"></td>";
					}

					$cRet .= "</tr>";
				} else
				{
					$cRet .= "<tr>
								<td style=\"border-bottom:none\">" . $this->
						tukd_model->rev_date($res['tgl_voucher']) . "</td>
								<td style=\"border-bottom:none\">" . $res['no_voucher'] ."</td>
								<td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],0, 1) . "</td>
								<td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],1, 1) . "</td>
								<td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],2, 1) . "</td>
								<td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],3, 2) . "</td>
								<td style=\"border-bottom:none;\">" . substr($res['kd_rek5'],5, 2) . "</td>
								<td style=\"border-bottom:none;\">" . $res['nm_rek5'] ."</td>
								<td style=\"border-bottom:none;\"></td>";
					if ($res['debet'] == 0)
					{
						$cRet .= " <td style=\"border-bottom:none;\"></td>
											<td style=\"border-bottom:none;\" align=\"right\">" .
							number_format($res['kredit']) . "</td>";
					} else
					{
						$cRet .= "<td style=\"border-bottom:none;\" align=\"right\">" . number_format($res['debet']) .
							"</td>
											<td style=\"border-bottom:none;\"></td>";
					}

					$cRet .= "</tr>";
				}
				$cnovoc = $res['no_voucher'];
			}

		}

			$cRet .= " <tr>
							<td style=\"border-top:none\"></td>
							<td style=\"border-top:none\"></td>
							<td style=\"border-top:none\"></td>
							<td style=\"border-top:none\"></td>
							<td style=\"border-top:none\"></td>
							<td style=\"border-top:none\"></td>
							<td style=\"border-top:none\"></td>
							<td style=\"border-top:none\"></td>
							<td style=\"border-top:none\"></td>
							<td style=\"border-top:none\"></td>
							<td style=\"border-top:none\"></td>
						</tr>  
					<table>";

		
		$data['prev'] = 'JURNAL UMUM PPKD';
		//$this->tukd_model->_mpdf('', $cRet, 5, 5, 10, '0');
		echo "<title>JURNAL UMUM PPKD</title>";
		print($cRet);
	}


	//wahyu========================================================================
	function cetak_lak(){
		$data['page_title'] = 'LAPORAN ARUS KAS';
		$this->template->set('title', 'LAPORAN ARUS KAS');
		$this->template->load('template', 'akuntansi/cetak_lak', $data);
	}

	function rpt_lak(){
		$periode	= $_REQUEST['periode'];
		$Periode	= $this->tukd_model->tanggal_format_indonesia($periode);
		$cetak		= $_REQUEST['cetak'];
		$ppkd		= 'PPKD';
		$kdskpd		= '1.20.06.00';
		$nmskpd		= $this->tukd_model->get_nama($kdskpd,'nm_skpd','ms_skpd','kd_skpd');
		$thi		= $this->session->userdata('pcThang');
		$thl		= $thi-1;
		$kab_kota	= $this->akuntansi_model->get_sclient('kab_kota');


		$this->db->query("DROP TABLE IF EXISTS realisasi_akt");
		$this->db->query("DROP TABLE IF EXISTS the_real_akt");
		$this->db->query("DROP TABLE IF EXISTS the_real_ang");
			$sql	= "	CREATE TEMPORARY TABLE realisasi_akt (
						`periode`  varchar(255) ,
						`kd_skpd`  varchar(255) ,
						`nm_skpd`  varchar(255) ,
						`kd_rek5`  varchar(255) ,
						`nm_rek5`  varchar(255) ,
						`nilai`  decimal(20,2) NULL DEFAULT NULL ,
						`lalu`  decimal(20,2) NULL DEFAULT NULL ,
						INDEX `id_akt` (`periode`, `kd_skpd`, `kd_rek5`) USING BTREE 
						) ENGINE=InnoDB DEFAULT CHARACTER SET=latin1 COLLATE=latin1_swedish_ci ROW_FORMAT=COMPACT";
			$del_exec	= $this->db->query($sql);
			if($del_exec){
				$qry	= "	select '$periode'periode,'$kdskpd' kd_skpd,a.nm_skpd,kd_rek5,nm_rek5,
							sum(if(year(tgl_voucher)<='$thi',(if(left(kd_rek5,1)in(1,5,9),debet-kredit,kredit-debet)),0))Nilai,
							sum(if(year(tgl_voucher)='$thl',(if(left(kd_rek5,1)in(1,5,9),debet-kredit,kredit-debet)),0))Lalu
							from trhju_ppkd a join trdju_ppkd b on a.kd_skpd=b.kd_skpd and left(kd_rek5,1) in(1,2,3,4,5,6,7,8,9) 
							and a.no_voucher=b.no_voucher and a.tgl_voucher<='$periode'
							GROUP BY kd_rek5
							union all
							select '$periode'periode,'$kdskpd' kd_skpd,a.nm_skpd,kd_rek5,nm_rek5,
							sum(if(year(tgl_voucher)<='$thi',(if(left(kd_rek5,1)in(1,5,9),debet-kredit,kredit-debet)),0))Nilai,
							sum(if(year(tgl_voucher)='$thl',(if(left(kd_rek5,1)in(1,5,9),debet-kredit,kredit-debet)),0))Lalu
							from trhju_pkd a join trdju_pkd b on a.kd_skpd=b.kd_skpd and left(kd_rek5,1) in(1,2,3,4,5,6,7,8,9) 
							and a.no_voucher=b.no_voucher and a.tgl_voucher<='$periode'
							GROUP BY kd_rek5
							";
				$ins_exec	= $this->db->query("insert into realisasi_akt (periode,kd_skpd,nm_skpd,kd_rek5,nm_rek5,nilai,lalu) ".$qry);
				
				$a0	= $this->db->query("CREATE TEMPORARY TABLE the_real_akt (kode varchar(10),Rupiah decimal(20,2),Lalu decimal(20,2) )");
				if($a0){
					$a1	= $this->db->query("insert into the_real_akt select left(kd_rek5,1),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
				if($a1){
					$a2	= $this->db->query("insert into the_real_akt select left(kd_rek5,2),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
				if($a2){
					$a3	= $this->db->query("insert into the_real_akt select left(kd_rek5,3),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
				if($a3){
					$a4	= $this->db->query("insert into the_real_akt select left(kd_rek5,5),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
				if($a4){
					$a5	= $this->db->query("insert into the_real_akt select left(kd_rek5,8),sum(nilai)Rupiah,sum(lalu)Lalu from realisasi_akt	GROUP BY left(kd_rek5,3)");
				}
			}

		$cRet ='<TABLE width="100%">
					<tr>
						<td align="center" style="font-size:12px"><b>'.$kab_kota.'</b></TD>
					</tr>
					<tr>
						<td align="center" style="font-size:15px"><b>LAPORAN ARUS KAS</b></TD>
					</tr>
					<tr>
						<td align="center" style="font-size:12px"><b>Untuk Tahun Yang Berakhir Sampai Dengan '.$Periode.' dan '.$thl.'<b></TD>
					</tr>
					</TABLE><br>';


		$cRet .= '<table style="border-collapse:collapse;font-size:12px" width="100%" align="center" border="1" cellspacing="1" cellpadding="0">
					<thead>
					<tr>
						<td align="center" width="5%" bgcolor="#cccccc" ><b>No.</b></TD>
						<td align="center" width="50%" bgcolor="#cccccc"><b>Uaraian</b></TD>
						<td align="center" width="15%" bgcolor="#cccccc"><b>'.$thi.'</b></TD>
						<td align="center" width="15%" bgcolor="#cccccc"><b>'.$thl.'</b></TD>
					</tr>
					</thead>';

		$csql	= " select nor,kode_1,uraian,bold from map_lak_kab order by nor ";
		$query = $this->db->query($csql);

		$kas	= " select kd_rek5,sum(nilai) sekarang, sum(lalu)lalu
					from realisasi_akt where periode='$periode' and left(kd_rek5,5)= ";
		$kas_bud_ini	= $this->db->query($kas."'11101'")->row('sekarang');
		$kas_bud_lalu	= $this->db->query($kas."'11101'")->row('lalu');
		$kas_bk_ini		= $this->db->query($kas."'11103'")->row('sekarang');
		$kas_bk_lalu	= $this->db->query($kas."'11103'")->row('lalu');
		$kas_bt_ini		= $this->db->query($kas."'11102'")->row('sekarang');
		$kas_bt_lalu	= $this->db->query($kas."'11102'")->row('lalu');
		
		foreach ( $query->result() as $res){
			$nor		= $res->nor;
			$kodenya	= $res->kode_1;
			$uraian		= $res->uraian;
			$bold		= $res->bold;

			if($kodenya){
				$csqlr	= " select kode,sum(Rupiah)Rupiah,sum(Lalu)Lalu from the_real_akt where kode in ($kodenya)  ";

				$queryr = $this->db->query($csqlr);
				foreach ($queryr->result() as $resr){
					$rupiah		= $resr->Rupiah;
					$lalu		= $resr->Lalu;
				}
			}else{
				$rupiah	= 0;
				$lalu	= 0;
			}
			
			if($nor=='19'){
				$masuk_operasi_ini		= $rupiah;
				$masuk_operasi_lalu		= $lalu;
			}elseif($nor=='32'){
				$keluar_operasi_ini		= $rupiah;
				$keluar_operasi_lalu	= $lalu;
			}elseif($nor=='33'){
				$jumlah_operasi_ini		= $masuk_operasi_ini-$keluar_operasi_ini;
				$jumlah_operasi_lalu	= $masuk_operasi_lalu-$keluar_operasi_lalu;
				$rupiah					= $jumlah_operasi_ini;
				$lalu					= $jumlah_operasi_lalu;
			}elseif($nor=='45'){
				$masuk_investasi_ini	= $rupiah;
				$masuk_investasi_lalu	= $lalu;
			}elseif($nor=='56'){
				$keluar_investasi_ini	= $rupiah;
				$keluar_investasi_lalu	= $lalu;
			}elseif($nor=='57'){
				$jumlah_investasi_ini	= $masuk_investasi_ini-$keluar_investasi_ini;
				$jumlah_investasi_lalu	= $masuk_investasi_lalu-$keluar_investasi_lalu;
				$rupiah					= $jumlah_investasi_ini;
				$lalu					= $jumlah_investasi_lalu;
			}elseif($nor=='60'){
				$masuk_pendanaan_ini	= $rupiah;
				$masuk_pendanaan_lalu	= $lalu;
			}elseif($nor=='80'){
				$keluar_pendanaan_ini	= $rupiah;
				$keluar_pendanaan_lalu	= $lalu;
			}elseif($nor=='81'){
				$jumlah_pendanaan_ini	= $masuk_pendanaan_ini-$keluar_pendanaan_ini;
				$jumlah_pendanaan_lalu	= $masuk_pendanaan_lalu-$keluar_pendanaan_lalu;
				$rupiah					= $jumlah_pendanaan_ini;
				$lalu					= $jumlah_pendanaan_lalu;
			}elseif($nor=='85'){
				$masuk_transitoris_ini	= $rupiah;
				$masuk_transitoris_lalu	= $lalu;
			}elseif($nor=='88'){
				$keluar_transitoris_ini	= $rupiah;
				$keluar_transitoris_lalu= $lalu;
			}elseif($nor=='89'){
				$jumlah_transitoris_ini	= $masuk_transitoris_ini-$keluar_transitoris_ini;
				$jumlah_transitoris_lalu= $masuk_transitoris_lalu-$keluar_transitoris_lalu;
				$rupiah					= $jumlah_transitoris_ini;
				$lalu					= $jumlah_transitoris_lalu;
			}elseif($nor=='90'){
				$kenaikan_penurunan_ini	= $jumlah_operasi_ini+$jumlah_investasi_ini+$jumlah_pendanaan_ini+$jumlah_transitoris_ini;
				$kenaikan_penurunan_lalu= $jumlah_operasi_lalu+$jumlah_investasi_lalu+$jumlah_pendanaan_lalu+$jumlah_transitoris_lalu;
				$rupiah					= $kenaikan_penurunan_ini;
				$lalu					= $kenaikan_penurunan_lalu;
			}elseif($nor=='91'){
				$saldo_awal_bud_bk_ini	= $kas_bud_lalu+$kas_bk_lalu;
				$saldo_awal_bud_bk_lalu	= ($kas_bud_lalu+$kas_bk_lalu)-($kenaikan_penurunan_lalu);
				$rupiah					= $saldo_awal_bud_bk_ini;
				$lalu					= $saldo_awal_bud_bk_lalu;
			}elseif($nor=='92'){
				$saldo_akhir_bud_bk_ini	= $kas_bud_ini+$kas_bk_ini;
				$saldo_akhir_bud_bk_lalu= $kas_bud_lalu+$kas_bk_lalu;
				$rupiah					= $saldo_akhir_bud_bk_ini;
				$lalu					= $saldo_akhir_bud_bk_lalu;
			}elseif($nor=='93'){
				$saldo_bt_ini			= $kas_bt_ini;
				$saldo_bt_lalu			= $kas_bt_lalu;
				$rupiah					= $saldo_bt_ini;
				$lalu					= $saldo_bt_lalu;
			}elseif($nor=='94'){
				$saldo_kas_ini			= $kas_bud_ini+$kas_bk_ini+$kas_bt_ini;
				$saldo_kas_lalu			= $saldo_akhir_bud_bk_lalu+$kas_bt_lalu;
				$rupiah					= $saldo_kas_ini;
				$lalu					= $saldo_kas_lalu;
			}
			
			$rupiah	= number_format(($rupiah),"2",".",",");
			$lalu	= number_format(($lalu),"2",".",",");
			
			switch ($bold){
				case 6:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\"><b>$rupiah&nbsp;</b></TD>
							<td align=\"right\"><b>$lalu&nbsp;</b></TD>
						</tr>";
				break;
				case 5:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;$uraian</b></TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
				case 4:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
				case 3:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\"><b>$rupiah&nbsp;</b></TD>
							<td align=\"right\"><b>$lalu&nbsp;</b></TD>
						</tr>";
				break;
				case 2:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</TD>
							<td align=\"right\">$rupiah&nbsp;</TD>
							<td align=\"right\">$lalu&nbsp;</TD>
						</tr>";
				break;
				case 1:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</TD>
							<td align=\"right\">$rupiah&nbsp;</TD>
							<td align=\"right\">$lalu&nbsp;</TD>
						</tr>";
				break;
				default:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
			}
		}

		$cRet .= '</table>';
		$data['prev']= $cRet;
		$judul	= "LAPORAN ARUS KAS";
		switch ($cetak){
			case 0;
				echo $cRet;
				echo "<title>$judul</title>";
				break;
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");

				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}
	}

	function cetak_neraca()
	{
		$data['page_title'] = 'NERACA';
		$this->template->set('title', 'NERACA');
		$this->template->load('template', 'akuntansi/cetak_neraca', $data);
	}
	
	function cetak_neraca_ppkd()
	{
		$data['page_title'] = 'LAPORAN NERACA';
		$this->template->set('title', 'LAPORAN NERACA');
		$this->template->load('template', 'akuntansi/cetak_neraca_ppkd', $data);
	}

	function rpt_neraca_ppkd(){
		$cetak		= $_REQUEST['cetak'];
		$mapping	= $_REQUEST['mapping'];
		$periode	= $_REQUEST['periode'];
		if(!$periode){
			$periode	= date('Y-m-d');
		}else{
			$periode	= $periode;
		}
		$kdskpd		= 'PPKD';
		$thi		= $this->session->userdata('pcThang');
		$thl		= $thi-1;
		$kab_kota	= $this->akuntansi_model->get_sclient('kab_kota');
			
		if($mapping=='true'){
			$this->db->query("DROP TABLE IF EXISTS realisasi_akt");
			$this->db->query("DROP TABLE IF EXISTS the_real_akt");
			$this->db->query("DROP TABLE IF EXISTS the_real_ang");
			$qry	= "	select '$periode'periode,'$kdskpd' kd_skpd,a.nm_skpd,kd_rek5,nm_rek5,
					sum(if(year(tgl_voucher)<='$thi',(if(left(kd_rek5,1)in(1,5,9),debet-kredit,kredit-debet)),0))Nilai,
					sum(if(year(tgl_voucher)='$thl',(if(left(kd_rek5,1)in(1,5,9),debet-kredit,kredit-debet)),0))Lalu
					from trhju_ppkd a join trdju_ppkd b on a.kd_skpd=b.kd_skpd and left(kd_rek5,1) in(1,2,3) 
					and a.no_voucher=b.no_voucher and a.tgl_voucher<='$periode'
					GROUP BY kd_rek5 ";

			$sql	= "	CREATE TEMPORARY TABLE realisasi_akt (
						`periode`  varchar(255) ,
						`kd_skpd`  varchar(255) ,
						`nm_skpd`  varchar(255) ,
						`kd_rek5`  varchar(255) ,
						`nm_rek5`  varchar(255) ,
						`nilai`  decimal(20,2) NULL DEFAULT NULL ,
						`lalu`  decimal(20,2) NULL DEFAULT NULL ,
						INDEX `id_akt` (`periode`, `kd_skpd`, `kd_rek5`) USING BTREE 
						) ENGINE=InnoDB DEFAULT CHARACTER SET=latin1 COLLATE=latin1_swedish_ci ROW_FORMAT=COMPACT";
			$del_exec	= $this->db->query($sql);
			if($del_exec){
				$ins_exec	= $this->db->query("insert into realisasi_akt (periode,kd_skpd,nm_skpd,kd_rek5,nm_rek5,nilai,lalu) ".$qry);
			}
		}

		$cRet ='<TABLE width="100%">
					<tr>
						<td align="center" style="font-size:12px"><b> '.$kab_kota.'</b></TD>
					</tr>
					<tr>
						<td align="center" style="font-size:15px"><b>NERACA</b></TD>
					</tr>
					<tr>
						<td align="center" style="font-size:12px"><b>PPKD</b></TD>
					</tr>
					<tr>
						<td align="center" style="font-size:12px"><b>PER '.strtoupper($this->tukd_model->tanggal_format_indonesia($periode)).' DAN '.$thl.'</b></TD>
					</tr>
					</TABLE><br>';


		$cRet .= '<table style="border-collapse:collapse" width="100%" align="center" border="1" cellspacing="1" cellpadding="0">
					<thead>						
					<tr>
						<td align="center" width="5%" bgcolor="#cccccc" ><b>No.</b></TD>
						<td align="center" width="70%" bgcolor="#cccccc"><b>URAIAN</b></TD>
						<td align="center" width="20%" bgcolor="#cccccc"><b>'.$thi.'</b></TD>
						<td align="center" width="20%" bgcolor="#cccccc"><b>'.$thl.'</b></TD>
					</tr>
					</thead>';

		$ea	= " SELECT  sum(if(year(tgl_voucher)='$thl',debet-kredit,0))eaw FROM trhju_ppkd a 
						join trdju_ppkd b on a.kd_skpd=b.kd_skpd and a.no_voucher=b.no_voucher 
						where year(tgl_voucher)='$thl' and left(kd_rek5,1) in (1,2) ";

		$eaw	= $this->db->query($ea)->row('eaw');
		
		$sd	= " SELECT 
				sum(if(year(tgl_voucher)='$thl',kredit-debet,0))sdl,
				sum(if(year(tgl_voucher)='$thi' and tgl_voucher<='$periode',kredit-debet,0))sds
				FROM trhju_ppkd a 
				join trdju_ppkd b on a.kd_skpd=b.kd_skpd and a.no_voucher=b.no_voucher 
				where year(tgl_voucher) in ('$thl','$thi') and left(kd_rek5,1) in (8,9) ";
		$sds	= $this->db->query($sd)->row('sds');
		$sdl	= $this->db->query($sd)->row('sdl');

		$csql	= " select kode,uraian,bold,sum(b.nilai)Rupiah,sum(b.lalu)Lalu from map_neraca_ppkd a left join 
					(
						select 
						if(a is null and  k is null and j is null and o is null ,r,
						if(a is null and  k is null and j is null ,o,
						if(a is null and  k is null ,j,
						if(a is null ,k,a
						)
						)
						)
						)
						rek,sum(nilai)nilai,sum(lalu)lalu from (
						select left(kd_rek5,7)R,left(kd_rek5,5)O,left(kd_rek5,3)J,left(kd_rek5,2)K,left(kd_rek5,1)A,
							sum(nilai)Nilai,
							sum(lalu)Lalu
						from realisasi_akt where kd_skpd='$kdskpd' and left(kd_rek5,1) in(1,2,3) and kd_rek5!='3110201'
							group by left(kd_rek5,7),left(kd_rek5,5),left(kd_rek5,3),left(kd_rek5,2),left(kd_rek5,1) with ROLLUP
						) real_akt group by rek
					) b on rek in (kode_1,kode_2,kode_3,kode_4,kode_5,kode_6,kode_7,kode_8,kode_9,kode_10,kode_11,kode_12,kode_13,kode_14,kode_15)
						group by kode,uraian	";

		$query = $this->db->query($csql); 
		foreach ( $query->result() as $res){
			$nor	= $res->kode;
			$uraian	= $res->uraian;
			$bold	= $res->bold;
			$rupiah	= $res->Rupiah;
			$lalu	= $res->Lalu;

			/* Menghitung Nilai Ekuitas	*/
			if($nor=='59'){
				$utg_r	= $rupiah;
				$utg_l	= $lalu;
				$rupiah	= number_format(($utg_r),"2",".",",");
				$lalu	= number_format(($utg_l),"2",".",",");
			}elseif($nor=='64' || $nor=='65'){
				$ek_r	= $eaw+$sds;
				$ek_l	= $eaw;
				$rupiah	= number_format(($ek_r),"2",".",",");
				$lalu	= number_format(($ek_l),"2",".",",");
			}elseif($nor=='67'){
				$rupiah	= number_format(($utg_r+$ek_r),"2",".",",");
				$lalu	= number_format(($utg_l+$ek_l),"2",".",",");
			}else{
				$rupiah	= number_format(($rupiah),"2",".",",");
				$lalu	= number_format(($lalu),"2",".",",");
			}

			switch ($bold){
				case 6:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\"><b>$rupiah&nbsp;</b></TD>
							<td align=\"right\"><b>$lalu&nbsp;</b></TD>
						</tr>";
				break;
				case 5:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;$uraian</b></TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
				case 4:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
				case 3:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\"><b>$rupiah&nbsp;</b></TD>
							<td align=\"right\"><b>$lalu&nbsp;</b></TD>
						</tr>";
				break;
				case 2:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</TD>
							<td align=\"right\">$rupiah&nbsp;</TD>
							<td align=\"right\">$lalu&nbsp;</TD>
						</tr>";
				break;
				case 1:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</TD>
							<td align=\"right\">$rupiah&nbsp;</TD>
							<td align=\"right\">$lalu&nbsp;</TD>
						</tr>";
				break;
				default:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
			}
		}

		$cRet .= '</table>';
		$data['prev']= $cRet;
		$judul	= "NERACA PPKD";
		switch ($cetak){
			case 0;
				echo $cRet;
				echo "<title>$judul</title>";
				break;
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");

				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}
	}
	
	function rpt_neraca_pemda(){
		$periode	= $_REQUEST['periode'];
		$Periode	= $this->tukd_model->tanggal_format_indonesia($periode);
		$cetak		= $_REQUEST['cetak'];
		$ppkd		= 'PPKD';
		$kdskpd		= $_REQUEST['skpd'];
		if($kdskpd){
			$nmskpd		= strtoupper($this->tukd_model->get_nama($kdskpd,'nm_skpd','ms_skpd','kd_skpd'));
			$entitas	= " and kd_skpd='$kdskpd' ";
		}else{
			$nmskpd		= " ";
			$entitas	= " ";
		}
		$thi		= $this->session->userdata('pcThang');
		$thl		= $thi-1;
		$kab_kota	= $this->akuntansi_model->get_sclient('kab_kota');

		$this->db->query("DROP TABLE IF EXISTS realisasi_akt");
		$this->db->query("DROP TABLE IF EXISTS the_real_akt");
		$this->db->query("DROP TABLE IF EXISTS the_real_ang");
		$qry	= "	select '$periode'periode,'$ppkd' kd_skpd,a.nm_skpd,kd_rek5,nm_rek5,
					sum(if(year(tgl_voucher)<='$thi',(if(left(kd_rek5,1)in(1,5,9),debet-kredit,kredit-debet)),0))Nilai,
					sum(if(year(tgl_voucher)='$thl',(if(left(kd_rek5,1)in(1,5,9),debet-kredit,kredit-debet)),0))Lalu
					from trhju_ppkd a join trdju_ppkd b on a.kd_skpd=b.kd_skpd and left(kd_rek5,1) in(1,2,3,4,5,6,7,8,9) 
					and a.no_voucher=b.no_voucher and a.tgl_voucher<='$periode'
					GROUP BY kd_rek5 
					union all
					select '$periode'periode,a.kd_skpd,a.nm_skpd,kd_rek5,nm_rek5,
					sum(if(year(tgl_voucher)<='$thi',(if(left(kd_rek5,1)in(1,5,9),debet-kredit,kredit-debet)),0))Nilai,
					sum(if(year(tgl_voucher)='$thl',(if(left(kd_rek5,1)in(1,5,9),debet-kredit,kredit-debet)),0))Lalu
					from trhju_pkd a join trdju_pkd b on a.kd_skpd=b.kd_skpd and left(kd_rek5,1) in(1,2,3,4,5,6,7,8,9) 
					and a.no_voucher=b.no_voucher and a.tgl_voucher<='$periode'
					GROUP BY a.kd_skpd,kd_rek5 ";

		$sql	= "	CREATE TEMPORARY TABLE realisasi_akt (
					`periode`  varchar(255) ,
					`kd_skpd`  varchar(255) ,
					`nm_skpd`  varchar(255) ,
					`kd_rek5`  varchar(255) ,
					`nm_rek5`  varchar(255) ,
					`nilai`  decimal(20,2) NULL DEFAULT NULL ,
					`lalu`  decimal(20,2) NULL DEFAULT NULL ,
					INDEX `id_akt` (`periode`, `kd_skpd`, `kd_rek5`) USING BTREE 
					) ENGINE=InnoDB DEFAULT CHARACTER SET=latin1 COLLATE=latin1_swedish_ci ROW_FORMAT=COMPACT";
		$del_exec	= $this->db->query($sql);
		if($del_exec){
			$ins_exec	= $this->db->query("insert into realisasi_akt (periode,kd_skpd,nm_skpd,kd_rek5,nm_rek5,nilai,lalu) ".$qry);
		}

		$cRet ='<TABLE width="100%">
					<tr>
						<td align="center" colspan="2">'.$kab_kota.'</TD>
					</tr>
					<tr>
						<td align="center" colspan="2" style="font-size:15px"><b>NERACA</b></TD>
					</tr>
					<tr>
						<td align="center" colspan="2">PER '.$Periode.' DAN '.$thl.'</TD>
					</tr>
					<tr>
						<td align="center" colspan="2">&nbsp;</TD>
					</tr>';
		if($kdskpd){
			$cRet.='<tr>
						<td align="left" width="50px">SKPD&nbsp;&nbsp;:</TD>
						<td align="left" >'.$nmskpd.'</TD>
					</tr>';
			
		}
		$cRet	.= '</TABLE>';


		$cRet .= '<table style="border-collapse:collapse" width="100%" align="center" border="1" cellspacing="1" cellpadding="0">';
		$cRet .= '<thead>						
					<tr>
						<td align="center" width="5%" bgcolor="#cccccc" ><b>No.</b></TD>
						<td align="center" width="50%" bgcolor="#cccccc"><b>URAIAN</b></TD>
						<td align="center" width="15%" bgcolor="#cccccc"><b>'.$thi.'</b></TD>
						<td align="center" width="15%" bgcolor="#cccccc"><b>'.$thl.'</b></TD>
					</tr>
					</thead>';
		
		$ea		= "	SELECT  sum(eaw)eaw from (
					select sum(if(year(tgl_voucher)='$thl',debet-kredit,0))eaw 
					FROM trhju_ppkd a join trdju_ppkd b on a.kd_skpd=b.kd_skpd and a.no_voucher=b.no_voucher 
						where year(tgl_voucher)='$thl' and left(kd_rek5,1) in (1,2) 
					union all
					select sum(if(year(tgl_voucher)='$thl',debet-kredit,0))eaw 
					FROM trhju_pkd a join trdju_pkd b on a.kd_skpd=b.kd_skpd and a.no_voucher=b.no_voucher 
						where year(tgl_voucher)='$thl' and left(kd_rek5,1) in (1,2) 
				) a";

		$eaw	= $this->db->query($ea)->row('eaw');
		
		$sd	= " select 
				sum(if(left(kd_rek5,1)=8,nilai,0))-sum(if(left(kd_rek5,1)=9,nilai,0))sds,
				sum(if(left(kd_rek5,1)=8,lalu,0))-sum(if(left(kd_rek5,1)=9,lalu,0))sdl
				from realisasi_akt where periode='$periode' $entitas ";
		$sds	= $this->db->query($sd)->row('sds');
		$sdl	= $this->db->query($sd)->row('sdl');

		$csql	= " select kode,uraian,bold,sum(b.nilai)Rupiah,sum(b.lalu)Lalu from map_neraca_copy a left join 
					(
						select 
						if(a is null and  k is null and j is null and o is null ,r,
							if(a is null and  k is null and j is null ,o,
								if(a is null and  k is null ,j,
									if(a is null ,k,a)
								)
							)
						)
						rek,sum(nilai)nilai,sum(lalu)lalu from (
						select left(kd_rek5,7)R,left(kd_rek5,5)O,left(kd_rek5,3)J,left(kd_rek5,2)K,left(kd_rek5,1)A,
							sum(nilai)Nilai,
							sum(lalu)Lalu
						from realisasi_akt where periode='$periode' and left(kd_rek5,1) in(1,2,3) and kd_rek5 not in ('3110201','3130101','1180101') $entitas
							group by left(kd_rek5,7),left(kd_rek5,5),left(kd_rek5,3),left(kd_rek5,2),left(kd_rek5,1) with ROLLUP
						) real_akt group by rek
					) b on rek in (kode_1,kode_2,kode_3,kode_4,kode_5,kode_6,kode_7,kode_8,kode_9,kode_10,kode_11,kode_12,kode_13,kode_14,kode_15)
						group by kode,uraian	";

		$query = $this->db->query($csql); 
		
		#exit(json_encode($query->result()));
		
		foreach ( $query->result() as $res){
			$nor	= $res->kode;
			$uraian	= $res->uraian;
			$bold	= $res->bold;
			$rupiah	= $res->Rupiah;
			$lalu	= $res->Lalu;

			if($nor=='76'){
				$utg_r	= $rupiah;						#Total Utang Tahun ini 
				$utg_l	= $lalu;						#Total Utang Tahun Lalu 
				$rupiah	= number_format($utg_r);
				$lalu	= number_format($utg_l);
			}elseif($nor=='79'){
				$ek_r	= $eaw+$sds;					#Total Ekuitas Tahun ini 
				$ek_l	= $eaw;							#Total Ekuitas Tahun Lalu 
				$rupiah	= number_format($ek_r);
				$lalu	= number_format($ek_l);
			}elseif($nor=='80'){
				$rupiah	= number_format($utg_r+$ek_r);
				$lalu	= number_format($utg_l+$ek_l);
			}else{
				$rupiah	= number_format($rupiah);
				$lalu	= number_format($lalu);
			}

			#@ $rupiah	= number_format(($rupiah),"2",".",",");
			#@ $lalu	= number_format(($lalu),"2",".",",");

			switch ($bold){
				case 6:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\"><b>$rupiah&nbsp;</b></TD>
							<td align=\"right\"><b>$lalu&nbsp;</b></TD>
						</tr>";
				break;
				case 5:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;$uraian</b></TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
				case 4:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
				case 3:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\"><b>$rupiah&nbsp;</b></TD>
							<td align=\"right\"><b>$lalu&nbsp;</b></TD>
						</tr>";
				break;
				case 2:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</TD>
							<td align=\"right\">$rupiah&nbsp;</TD>
							<td align=\"right\">$lalu&nbsp;</TD>
						</tr>";
				break;
				case 1:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</TD>
							<td align=\"right\">$rupiah&nbsp;</TD>
							<td align=\"right\">$lalu&nbsp;</TD>
						</tr>";
				break;
				default:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
			}
		}

		$cRet .= '</table>';
		$data['prev']= $cRet;
		$judul	= "NERACA PEMDA";
		switch ($cetak){
			case 0;
				echo $cRet;
				echo "<title>$judul</title>";
				break;
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");

				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}
	}

	function rpt_neraca(){
		$cetak		= $_REQUEST['cetak'];
		$ppkd		= 'PPKD';
		$kdskpd		= '1.20.06.00';
		$nmskpd		= $this->tukd_model->get_nama($kdskpd,'nm_skpd','ms_skpd','kd_skpd');
		$thi		= $this->session->userdata('pcThang');
		$thl		= $thi-1;
		$kab_kota	= $this->akuntansi_model->get_sclient('kab_kota');

		$cRet ='<TABLE width="100%">
					<tr>
						<td align="center" style="font-size:12px"><b> '.$kab_kota.'</b></TD>
					</tr>
					<tr>
						<td align="center" style="font-size:15px"><b>NERACA</b></TD>
					</tr>
					<tr>
						<td align="center" style="font-size:12px"><b>PER '.$Periode.' DAN '.$thl.'<b></TD>
					</tr>
					</TABLE><br>';


		$cRet .= '<table style="border-collapse:collapse;font-size:12px" width="100%" align="center" border="1" cellspacing="1" cellpadding="0">
					<thead>
					<tr>
						<td align="center" width="5%" bgcolor="#cccccc" ><b>No.</b></TD>
						<td align="center" width="50%" bgcolor="#cccccc"><b>URAIAN</b></TD>
						<td align="center" width="15%" bgcolor="#cccccc"><b>'.$thi.'</b></TD>
						<td align="center" width="15%" bgcolor="#cccccc"><b>'.$thl.'</b></TD>
					</tr>
					</thead>';

		$csql	= " select kode nor,kode_1,uraian,bold from map_neraca ";
		$query = $this->db->query($csql);

		$anggaran	= 0;
		$persen		= 0;
		foreach ( $query->result() as $res){
			$nor		= $res->nor;
			$kodenya	= $res->kode_1;
			$uraian		= $res->uraian;
			$bold		= $res->bold;

			if($kodenya){
				$csqlr	= " select sum(Rupiah)Rupiah,sum(lalu)Lalu from (
								select left(kd_rek5,7)rek,sum(nilai)Rupiah,sum(lalu)lalu from realisasi_akt where periode='$periode' and left(kd_rek5,1) in (1,2,3) group by left(kd_rek5,7) union 
								select left(kd_rek5,5)rek,sum(nilai)Rupiah,sum(lalu)lalu from realisasi_akt where periode='$periode' and left(kd_rek5,1) in (1,2,3) group by left(kd_rek5,5) union 
								select left(kd_rek5,3)rek,sum(nilai)Rupiah,sum(lalu)lalu from realisasi_akt where periode='$periode' and left(kd_rek5,1) in (1,2,3) group by left(kd_rek5,3) union 
								select left(kd_rek5,2)rek,sum(nilai)Rupiah,sum(lalu)lalu from realisasi_akt where periode='$periode' and left(kd_rek5,1) in (1,2,3) group by left(kd_rek5,2) union 
								select left(kd_rek5,1)rek,sum(nilai)Rupiah,sum(lalu)lalu from realisasi_akt where periode='$periode' and left(kd_rek5,1) in (1,2,3) group by left(kd_rek5,1)  
							) a where rek in ($kodenya)  ";

				$queryr = $this->db->query($csqlr);
				foreach ($queryr->result() as $resr){
					$rupiah		= $resr->Rupiah;
					$lalu		= $resr->Lalu;
				}
			}else{
				$rupiah		= 0;
				$lalu		= 0;
			}

			/* Menghitung Nilai Surplus Defisit	(nsd) a=anggaran, s=sekarang, l=lalu */
			if($nor=='27'){
				$rupiah		= number_format($rupiah);
				$lalu		= number_format($lalu);
			}else{
				$rupiah		= number_format($rupiah);
				$lalu		= number_format($lalu);
			}

			
			switch ($bold){
				case 6:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\"><b>$rupiah&nbsp;</b></TD>
							<td align=\"right\"><b>$lalu&nbsp;</b></TD>
						</tr>";
				break;
				case 5:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;$uraian</b></TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
				case 4:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
				case 3:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\"><b>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</b></TD>
							<td align=\"right\"><b>$rupiah&nbsp;</b></TD>
							<td align=\"right\"><b>$lalu&nbsp;</b></TD>
						</tr>";
				break;
				case 2:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</TD>
							<td align=\"right\">$rupiah&nbsp;</TD>
							<td align=\"right\">$lalu&nbsp;</TD>
						</tr>";
				break;
				case 1:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$uraian</TD>
							<td align=\"right\">$rupiah&nbsp;</TD>
							<td align=\"right\">$lalu&nbsp;</TD>
						</tr>";
				break;
				default:
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
							<td align=\"right\">&nbsp;</TD>
						</tr>";
				break;
			}
		}

		$cRet .= '</table>';
		$judul	= "NERACA PPKD";
		switch ($cetak){
			case 0;
				echo $cRet;
				echo "<title>$judul</title>";
				break;
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, '0');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");

				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}
	}


	function ctk_neraca_saldo()
	{
		$thn_ang = $this->session->userdata('pcThang');
			
		
		$tgl= $_REQUEST['tgl1'];
		
		$tgl_ttd= $_REQUEST['tgl_ttd'];
				
	
		
		$csql	= "SELECT a.nama, a.nip FROM ms_ttd a WHERE kode = 'BP' AND a.kd_skpd = '1.20.06.00'";
		$hasil	= $this->db->query($csql);
		$trh2	= $hasil->row();		
		$lcNmBP	= $trh2->nama;
		$lcNipBP = $trh2->nip;				

	
			
		$cRet = '';
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
		
			<tr>
				<td align=\"center\" colspan=\"4\" style=\"font-size:14px;border: solid 1px white;\"><b>KABUPATEN MAHARDIKA<br>LAPORAN NERACA SALDO</b></td>
			</tr>
			<tr>
				<td align=\"left\" colspan=\"4\" style=\"font-size:12px;border: solid 1px white;\">&nbsp;</td>
			</tr>
			<tr>
				<td align=\"center\" colspan=\"4\" style=\"font-size:12px;border: solid 1px white;\"> TANGGAL : ".$this->tanggal_format_indonesia($tgl)."</td>
			</tr>
			
			<tr>
				<td align=\"left\"  style=\"font-size:12px;border: solid 1px white;border-bottom:solid 2px black;\">&nbsp;</td>
				<td align=\"left\" colspan=\"3\" style=\"font-size:12px;border: solid 1px white;border-bottom:solid 2px black;\">&nbsp;</td>
			</tr><table>";
	$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
			<thead> 
			<tr>
				<td align=\"center\" rowspan=\"2\" width=\"10%\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black;\" >Kode Rekening</td>
				<td align=\"center\" rowspan=\"2\" width=\"50%\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black;\">Nama Rekening</td>
				<td align=\"center\" colspan=\"2\" width=\"40%\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black;\">Jumlah</td>			
			</tr> 
			<tr>
				
				<td align=\"center\" width=\"20%\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black;\">Debet</td>
				<td align=\"center\" width=\"20%\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black;\">Kredit</td>			
			</tr> 
			</thead>		
			<tr>
				<td align=\"center\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">1</td>
				<td align=\"center\"  style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">2</td>
				<td align=\"center\"  style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">3</td>
				<td align=\"center\"  style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">4</td>			
			</tr>";
		
		


													
				
					$sql = "SELECT kd_rek64 as kd_rek5,nm_rek64 as nm_rek5,sal_n FROM ms_rek5 where left(kd_rek64,3) <> '312' group by kd_rek64 ORDER BY kd_rek5";

		
		
									
					$hasil = $this->db->query($sql); 
					foreach ($hasil->result() as $row)
					{
					
					$kd_rek   =$row->kd_rek5 ;
					$nama	=$row->nm_rek5;
					$sn	=$row->sal_n;
					
							$sql1 = "SELECT a.kd_rek5,SUM(a.debet)AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a inner join trhju_pkd b on a.no_voucher=b.no_voucher WHERE a.kd_rek5='$kd_rek' and b.tgl_voucher <='$tgl' GROUP BY a.kd_rek5 ";
							$hasil1 = $this->db->query($sql1); 
							foreach ($hasil1->result() as $row1)
							{
							$lcdebet	=$row1->debet ;
							$lckredit	=$row1->kredit;
								if($sn=='0'  ) {
									$nilai=$lcdebet-$lckredit;
								} else{
									$nilai=$lckredit-$lcdebet;
								}
								if($sn=='0'  ) {
									$cRet .="<tr>
										<td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">$kd_rek</td>
										<td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">$nama</td>
										<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"> ".number_format($nilai)."</td>
										<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">&nbsp;</td>
										</tr>";
								} else{
									$cRet .="<tr>
										<td valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">$kd_rek</td>
										<td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\">$nama</td>
										<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"> &nbsp;</td>
										<td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"> ".number_format($nilai)."</td>
										</tr>";
								}  
							
							}					
					
					}

		$cRet .='<table>';
		$data['prev']= $cRet;	
		//$this->tukd_model->_mpdf('',$cRet,'10','10',5,'0');
		//$this->tukd_model->_mpdf('', $cRet, 10, 10, 10, 'L');
		$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
		// echo $cRet;
	}

	function ctk_lpe(){
		$cetak		= $_REQUEST['cetak'];
		$periode	= $_REQUEST['periode'];
		if(!$periode){
			$periode	= date('Y-m-d');
		}else{
			$periode	= $periode;
		}
		$kdskpd		= "1.20.06.00";
		$nmskpd		= $this->tukd_model->get_nama($kdskpd,'nm_skpd','ms_skpd','kd_skpd');
		$thi		= $this->session->userdata('pcThang');
		$thl		= $thi-1;
		$kab_kota	= $this->akuntansi_model->get_sclient('kab_kota');
			
		$cRet ='<TABLE width="100%">
					<tr>
						<td align="center" >'.$kab_kota.'</TD>
					</tr>
					<tr>
						<td align="center" ><b>LAPORAN PERUBAHAN EKUITAS</b></TD>
					</tr>
					<tr>
						<td align="center" >UNTUK PERIODE YANG BERAKHIR SAMPAI DENGAN '.strtoupper($this->tukd_model->tanggal_format_indonesia($periode)).' DAN '.$thl.'</TD>
					</tr>
					</TABLE><br>';


		$cRet .= '<table style="border-collapse:collapse" width="100%" align="center" border="1" cellspacing="1" cellpadding="0">
					<thead>						
					<tr>
						<td align="center" width="10%" bgcolor="#cccccc" ><b>No.</b></TD>
						<td align="center" width="60%" bgcolor="#cccccc"><b>URAIAN</b></TD>
						<td align="center" width="15%" bgcolor="#cccccc"><b>'.$thi.'</b></TD>
						<td align="center" width="15%" bgcolor="#cccccc"><b>'.$thl.'</b></TD>
					</tr>
					</thead>';
			
		$this->db->query("DROP TABLE IF EXISTS realisasi_akt");
		$this->db->query("DROP TABLE IF EXISTS the_real_akt");
		$this->db->query("DROP TABLE IF EXISTS the_real_ang");
		$ea	= " SELECT  sum(eaw)eaw from (
					select sum(if(year(tgl_voucher)='$thl',debet-kredit,0))eaw 
					FROM trhju_ppkd a join trdju_ppkd b on a.kd_skpd=b.kd_skpd and a.no_voucher=b.no_voucher 
						where year(tgl_voucher)='$thl' and left(kd_rek5,1) in (1,2) 
					union all
					select sum(if(year(tgl_voucher)='$thl',debet-kredit,0))eaw 
					FROM trhju_pkd a join trdju_pkd b on a.kd_skpd=b.kd_skpd and a.no_voucher=b.no_voucher 
						where year(tgl_voucher)='$thl' and left(kd_rek5,1) in (1,2) 
				) a ";

		$eaw	= $this->db->query($ea)->row('eaw');

		$sd	= " select sum(sdl) as sdl, sum(sds) as sds from (
				SELECT 
				sum(if(year(tgl_voucher)='$thl',kredit-debet,0))sdl,
				sum(if(year(tgl_voucher)='$thi' and tgl_voucher<='$periode',kredit-debet,0))sds
				FROM trhju_ppkd a join trdju_ppkd b on a.kd_skpd=b.kd_skpd and a.no_voucher=b.no_voucher 
				where year(tgl_voucher) in ('$thl','$thi') and left(kd_rek5,1) in (8,9)
				union all
				SELECT 
				sum(if(year(tgl_voucher)='$thl',kredit-debet,0))sdl,
				sum(if(year(tgl_voucher)='$thi' and tgl_voucher<='$periode',kredit-debet,0))sds
				FROM trhju_pkd a join trdju_pkd b on a.kd_skpd=b.kd_skpd and a.no_voucher=b.no_voucher 
				where year(tgl_voucher) in ('$thl','$thi') and left(kd_rek5,1) in (8,9)
				) a
				";
		$sds	= $this->db->query($sd)->row('sds');
		$sdl	= $this->db->query($sd)->row('sdl');

		$csql	= " select nor,uraian,0 Rupiah,0 Lalu from map_lpe ";
		$query = $this->db->query($csql);
		foreach ( $query->result() as $res){
			$nor	= $res->nor;
			$uraian	= $res->uraian;
			$rupiah	= $res->Rupiah;
			$lalu	= $res->Lalu;

			/* Menghitung Nilai Ekuitas	*/
			/*	___________________
				Keterangan Perhitungan
				$eaw	= Ekuitas Awal
				$sdl	= Surplus Defisit Lalu (Pendapatan LO - Beban Tahun Sebelumnya)
				$sds	= Surplus Defisit Sekarang (Pendapatan LO - Bebabn Tahun ini)
			*/
			if($nor=='1'){
				$rupiah	= number_format($eaw);
				$lalu	= number_format($eaw-$sdl);
			}elseif($nor=='2'){
				$rupiah	= number_format($sds);
				$lalu	= number_format($sdl);
			}elseif($nor=='7'){
				$rupiah	= number_format($eaw+$sds);
				$lalu	= number_format($eaw);
			}else{
				$rupiah	= number_format(0);
				$lalu	= number_format(0);
			}
				$cRet .="
						<tr>
							<td align=\"center\">$nor</TD>
							<td align=\"left\">&nbsp;$uraian</TD>
							<td align=\"right\">$rupiah&nbsp;</TD>
							<td align=\"right\">$lalu&nbsp;</TD>
						</tr>";
		}

		$cRet .= '</table>';

		$data['prev']= $cRet;  
		$data['sikap'] = 'preview';
		$judul = 'L P E';
		switch ($cetak){
			case 0;
				echo $cRet;
				echo "<title>$judul</title>";
				break;
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");
				$this->load->view('anggaran/rka/perkadaII', $data);
			break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}
	}
	
	function ctk_lpsal(){
		$periode	= $_REQUEST['periode'];
		$Periode	= $this->tukd_model->tanggal_format_indonesia($periode);
		$cetak		= $_REQUEST['cetak'];
		$thn_ang	= $this->session->userdata('pcThang');
		$thn_ang_1	= $thn_ang-1;
		$kab_kota	= $this->akuntansi_model->get_sclient('kab_kota');
		
		$this->db->query("DROP TABLE IF EXISTS realisasi_akt");
		$this->db->query("DROP TABLE IF EXISTS the_real_akt");
		$this->db->query("DROP TABLE IF EXISTS the_real_ang");
		$sql	= "	CREATE TEMPORARY TABLE realisasi_akt (
					`periode`  varchar(255) ,
					`kd_skpd`  varchar(255) ,
					`nm_skpd`  varchar(255) ,
					`kd_rek5`  varchar(255) ,
					`nm_rek5`  varchar(255) ,
					`nilai`  decimal(20,2) NULL DEFAULT NULL ,
					`lalu`  decimal(20,2) NULL DEFAULT NULL ,
					INDEX `id_akt` (`periode`, `kd_skpd`, `kd_rek5`) USING BTREE 
					) ENGINE=InnoDB DEFAULT CHARACTER SET=latin1 COLLATE=latin1_swedish_ci ROW_FORMAT=COMPACT";
		$del_exec	= $this->db->query($sql);
		if($del_exec){
			$qry	= "	select '$periode'periode,'ppkd' kd_skpd,a.nm_skpd,kd_rek5,nm_rek5,
						sum(if(year(tgl_voucher)<='$thn_ang',(if(left(kd_rek5,1)in(1,5,9),debet-kredit,kredit-debet)),0))Nilai,
						sum(if(year(tgl_voucher)='$thn_ang_1',(if(left(kd_rek5,1)in(1,5,9),debet-kredit,kredit-debet)),0))Lalu
						from trhju_ppkd a join trdju_ppkd b on a.kd_skpd=b.kd_skpd and left(kd_rek5,1) in(4,5,6,7) 
						and a.no_voucher=b.no_voucher and a.tgl_voucher<='$periode'
						GROUP BY kd_rek5
						union all
						select '$periode'periode,a.kd_skpd,a.nm_skpd,kd_rek5,nm_rek5,
						sum(if(year(tgl_voucher)<='$thn_ang',(if(left(kd_rek5,1)in(1,5,9),debet-kredit,kredit-debet)),0))Nilai,
						sum(if(year(tgl_voucher)='$thn_ang_1',(if(left(kd_rek5,1)in(1,5,9),debet-kredit,kredit-debet)),0))Lalu
						from trhju_pkd a join trdju_pkd b on a.kd_skpd=b.kd_skpd and left(kd_rek5,1) in(4,5,6,7) 
						and a.no_voucher=b.no_voucher and a.tgl_voucher<='$periode'
						GROUP BY kd_rek5";
			$ins_exec	= $this->db->query("insert into realisasi_akt (periode,kd_skpd,nm_skpd,kd_rek5,nm_rek5,nilai,lalu) ".$qry);
		}
		
		#Perhitungan SILPA Tahun Ini
		$n_pend		= $this->db->query("select sum(nilai) as nilai from realisasi_akt where periode='$periode' and left(kd_rek5,1) = '4' ")->row("nilai");
		$n_bel		= $this->db->query("select sum(nilai) as nilai from realisasi_akt where periode='$periode' and left(kd_rek5,1) in (5,6) ")->row("nilai");
		$n_p_mas	= $this->db->query("select sum(nilai) as nilai from realisasi_akt where periode='$periode' and left(kd_rek5,2) = '71' ")->row("nilai");
		$n_p_kel	= $this->db->query("select sum(nilai) as nilai from realisasi_akt where periode='$periode' and left(kd_rek5,2) = '72' ")->row("nilai");
		$n_silpa	= $n_pend-$n_bel+$n_p_mas-$n_p_kel;

		#Perhitungan SILPA Tahun Lalu
		$l_pend		= $this->db->query("select sum(nilai) as nilai from realisasi_akt where periode<'$periode' and left(kd_rek5,1) = '4' ")->row("nilai");
		$l_bel		= $this->db->query("select sum(nilai) as nilai from realisasi_akt where periode<'$periode' and left(kd_rek5,1) in (5,6) ")->row("nilai");
		$l_p_mas	= $this->db->query("select sum(nilai) as nilai from realisasi_akt where periode<'$periode' and left(kd_rek5,2) = '71' ")->row("nilai");
		$l_p_kel	= $this->db->query("select sum(nilai) as nilai from realisasi_akt where periode<'$periode' and left(kd_rek5,2) = '72' ")->row("nilai");
		$l_silpa	= $l_pend-$l_bel+$l_p_mas-$l_p_kel;
		
		
		$cRet = '';
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
		
			<tr>
				<td align=\"center\" colspan=\"4\" style=\"font-size:14px;border: solid 1px white;\">
					$kab_kota
				</td>
			</tr>
			<tr>
				<td align=\"center\" colspan=\"4\" style=\"font-size:15px;border: solid 1px white;\">
					<b>LAPORAN PERUBAHAN SALDO ANGGARAN LEBIH</b>
				</td>
			</tr>
			<tr>
				<td align=\"center\" colspan=\"4\" style=\"font-size:14px;border: solid 1px white;\">
					PER $Periode DAN $thn_ang_1
				</td>
			</tr>
			<tr>
				<td align=\"left\" colspan=\"4\" style=\"font-size:14px;border: solid 1px white;\">&nbsp;</td>
			</tr>
			
			
			<tr>
				<td align=\"left\"  style=\"font-size:14px;border: solid 1px white;border-bottom:solid 2px black;\">&nbsp;</td>
				<td align=\"left\" colspan=\"3\" style=\"font-size:14px;border: solid 1px white;border-bottom:solid 2px black;\">&nbsp;</td>
			</tr>
	
			<tr>
				<td align=\"center\" width=\"5%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:solid 1px black;\" >NO</td>
				<td align=\"center\" width=\"65%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:solid 1px black;\">URAIAN</td>
				<td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:solid 1px black;\">$thn_ang</td> 
				<td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:solid 1px black;\">$thn_ang_1</td>		
			</tr>";
		
		$sql	= "SELECT * FROM map_lpsal  ORDER BY seq";
		$hasil	= $this->db->query($sql); 
		$nilai	= 0;
		$lalu	= 0;
		foreach ($hasil->result() as $row){
			$kd_rek		= $row->nor ;
			$nama		= $row->uraian;

			switch ($kd_rek){
				case 1:
					$N_01	= $l_silpa;
					$L_01	= $l_silpa;

					$nilai	= $N_01;
					$lalu	= $L_01;
					
					$cRet .="<tr>
							<td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
							<td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
							<td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> ".number_format($nilai)."</td>
							<td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">".number_format($lalu)."</td>
							</tr>";
					
				break; 
				case 2:
					$N_02	= -$l_silpa;
					$L_02	= -$l_silpa;

					$nilai	= $N_02;
					$lalu	= $L_02;
					
					$cRet .="<tr>
							<td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
							<td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
							<td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> ".number_format($nilai)."</td>
							<td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">".number_format($lalu)."</td>
							</tr>";
						
				break; 
				case 3:
					$N_03	= $N_01+$N_02;
					$L_03	= $L_01+$L_02;

					$nilai	= $N_03;
					$lalu	= $L_03;

					$cRet .="<tr>
							<td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
							<td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
							<td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> ".number_format($nilai)."</td>
							<td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">".number_format($lalu)."</td>
							</tr>";
				break;
				case 4:
					$N_04	= $n_silpa;
					$L_04	= $l_silpa;

					$nilai	= $N_04;
					$lalu	= $L_04;

					$cRet .="<tr>
						<td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
						<td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
						<td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> ".number_format($nilai)."</td>
						<td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">".number_format($lalu)."</td>
						</tr>";
				break; 
				case 5:
					$N_05	= $N_03+$N_04;
					$L_05	= $L_03+$L_04;

					$nilai	= $N_05;
					$lalu	= $L_05;

					$cRet .="<tr>
							<td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
							<td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
							<td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> ".number_format($nilai)."</td>
							<td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">".number_format($lalu)."</td>
							</tr>";
				break;
				case 6:
					$N_06	= 0;
					$L_06	= 0;

					$nilai	= $N_06;
					$lalu	= $L_06;

					$cRet .="<tr>
							<td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
							<td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
							<td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> ".number_format($nilai)."</td>
							<td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">".number_format($lalu)."</td>
							</tr>";
				break;
				case 7:
					$N_07	= 0;
					$L_07	= 0;

					$nilai	= $N_07;
					$lalu	= $L_07;

					$cRet .="<tr>
							<td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
							<td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
							<td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> ".number_format($nilai)."</td>
							<td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">".number_format($lalu)."</td>
							</tr>";
				break;
				case 8:
					$N_08	= $N_05+$N_06+$N_07;
					$L_08	= $L_05+$L_06+$L_07;

					$nilai	= $N_08;
					$lalu	= $L_08;

					$cRet .="<tr>
								<td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
								<td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">$nama</td>
								<td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> ".number_format($nilai)."</td>
								<td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">".number_format($lalu)."</td>
								</tr>";
				break;  
				default:  
					$N_00	= 0;
					$L_00	= 0;

					$nilai	= $N_00;
					$lalu	= $L_00;

					$cRet .="<tr>
						<td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\">$kd_rek</td>
						<td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\">&nbsp; &nbsp; &nbsp; &nbsp;$nama</td>
						<td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"> ".number_format($nilai)."</td>
						<td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\">".number_format($lalu)."</td>
						</tr>";					
			} 
		}
			$cRet .="<tr>
					<td align=\"center\" width=\"5%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\" >&nbsp;</td>
					<td align=\"center\" width=\"65%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td>
					<td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td> 
					<td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td>			
					</tr>";							

		$cRet .='</table>';
		$data['prev']= $cRet;  
		$data['sikap'] = 'preview';
		$judul = 'LAPORAN PERUBAHAN SALDO ANGGARAN LEBIH';
		$this->template->set('title', 'LAPORAN PERUBAHAN SALDO ANGGARAN LEBIH');  
		switch ($cetak){
			case 0;
				print($cRet);
				echo "<title>$judul</title>";
				break;
			case 1;
				$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
				break;
			case 2;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");

				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
			case 3;
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
				break;
		}

	}
	
	
	function  tanggal_format_indonesia($tgl){
		$tanggal  =  substr($tgl,8,2);
		$bulan  = substr($tgl,5,2);
		$tahun  =  substr($tgl,0,4);
		return  $tanggal.'-'.$bulan.'-'.$tahun;
/*
		$tanggal  = explode('-',$tgl); 
		$bulan  = $this-> getBulan($tanggal[1]);
		$tahun  =  $tanggal[0];
		return  $tanggal[2].' '.$bulan.' '.$tahun;
*/
		}
		
	function  tanggal_indonesia($tgl){
		$tanggal  =  substr($tgl,8,2);
		$bulan  = substr($tgl,5,2);
		$tahun  =  substr($tgl,0,4);
		return  $tanggal.'-'.$bulan.'-'.$tahun;

		}
		
	function  getBulan($bln){
		switch  ($bln){
			case  1:
			return  "Januari";
			break;
			case  2:
			return  "Februari";
			break;
			case  3:
			return  "Maret";
			break;
			case  4:
			return  "Maret";
			break;
			case  5:
			return  "Mei";
			break;
			case  6:
			return  "Juni";
			break;
			case  7:
			return  "Juli";
			break;
			case  8:
			return  "Agustus";
			break;
			case  9:
			return  "September";
			break;
			case  10:
			return  "Oktober";
			break;
			case  11:
			return  "November";
			break;
			case  12:
			return  "Desember";
			break;
		}
	}

	function periode_akt(){
		$qry	= " select ifnull(periode,'')periode from realisasi_akt GROUP BY periode ";
		$exec	= $this->db->query($qry);
		foreach($exec->result_array() as $hasil){
			$row[] = array(
				'periode' => $hasil['periode'],
			);
		}
		echo json_encode($row);
	}

	function neracasaldo(){
        $data['page_title']= 'CETAK NERACA SALDO';
        $this->template->set('title', 'CETAK NERACA SALDO');   
        $this->template->load('template','akuntansi/neracasaldo',$data) ;	
	}
	function neracasaldo_ppkd(){
        $data['page_title']= 'CETAK NERACA SALDO';
        $this->template->set('title', 'CETAK NERACA SALDO');   
        $this->template->load('template','akuntansi/neracasaldo_ppkd',$data) ;	
	}
    function cetak_neracasaldo(){
        $thn_ang    = $this->session->userdata('pcThang');
        $kd_skpd    = $_REQUEST['skpd'];
        $bulan      = $_REQUEST['tgl1'];
        $lcperiode  = $this->tukd_model->getBulan($bulan);
        $tgl_ttd    = $_REQUEST['tgl_ttd'];     
//      $ctk=1;
    $ctk = $this->uri->segment(3);

        $sqlsc = "SELECT kab_kota,daerah FROM sclient";
        $sqlsclient=$this->db->query($sqlsc);
        foreach ($sqlsclient->result() as $rowsc){
            $kota   = $rowsc->kab_kota;
            $daerah = $rowsc->daerah;
        }

        $csql2 = "SELECT nm_skpd FROM ms_skpd WHERE kd_skpd = '$kd_skpd'";
            $hasil2   = $this->db->query($csql2);
            $trh4     = $hasil2->row();          
            $lcNmskpd = $trh4->nm_skpd;
            
        $sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$kd_skpd' and kode='PA'";
        $sqlttd=$this->db->query($sqlttd1);
        $zz=0;
        foreach ($sqlttd->result() as $rowttd){
            $nip     = $rowttd->nip;                    
            $nama    = $rowttd->nm;
            $jabatan = $rowttd->jab;
            $zz++;
        }   


                
        if($zz == '0'){
             $nip='Belum ada Nip';                    
             $nama= 'Belum ada nama';
             $jabatan  = 'Belum ada jabatan';
        }       

        $cRet = '';
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"1\" cellpadding=\"1\">
                    <tr>
                        <td colspan=\"4\" align=\"center\" style=\"font-size:14px;border: solid 1px white;\"><b>$kota<br>NERACA SALDO</b></td>
                    </tr>
                    <tr>
                        <td colspan=\"4\" align=\"center\" style=\"font-size:14px;border: solid 1px white;\">Bulan $lcperiode</td>
                    </tr>           
                    <tr>
                        <td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    </tr>
                    <tr>
                        <td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    </tr>
                    <tr>
                        <td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    </tr>
                    <tr>
                        <td width=\"5%\" align=\"left\" style=\"font-size:10px;border: solid 1px white;\">SKPD</td>
                        <td width=\"95%\" align=\"left\" style=\"font-size:10px;border: solid 1px white;\">: $kd_skpd  $lcNmskpd</td>
                    </tr>
                    </table>";
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
            <thead>
            <tr>
                <td bgcolor=\"#CCCCCC\" rowspan=\"2\" align=\"center\" width=\"5%\" style=\"font-size:12px\">Kode Rekening</td>
                <td bgcolor=\"#CCCCCC\" rowspan=\"2\" align=\"center\" width=\"55%\" style=\"font-size:12px\">Nama Rekening</td>
                <td bgcolor=\"#CCCCCC\" colspan=\"2\" align=\"center\" width=\"40%\" style=\"font-size:12px\">Jumlah</td>          
            </tr> 
            <tr>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"20%\" style=\"font-size:12px\">Debet</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"20%\" style=\"font-size:12px\">Kredit</td>         
            </tr>           
            <tr>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">1</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">2</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">3</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">4</td>            
            </tr> 
            </thead>
            <tfoot>
                <tr><td style=\"border-bottom: none; border-left:none;border-right:none;\" colspan=\"4\"></td>
            </tfoot>            
            ";
            
            $sql = "SELECT a.kd_rek5,a.nm_rek5,
                        IF(LEFT(a.kd_rek5,1) IN ('1','5','6','9') || LEFT(a.kd_rek5,2) IN ('72'),SUM(debet)-SUM(kredit),0) AS debet,
                        IF(LEFT(a.kd_rek5,1) IN ('0','2','3','4','8') || LEFT(a.kd_rek5,2) IN ('71'),SUM(kredit)-SUM(debet),0) AS kredit 
                        FROM trdju_pkd a 
                        INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher 
                        WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND MONTH(b.tgl_voucher)<='$bulan' and YEAR(tgl_voucher)='$thn_ang'
                        GROUP BY a.kd_rek5
                        ORDER BY a.kd_rek5
                    ";          

                    $hasil = $this->db->query($sql);       
                    $saldo=0;
                    foreach ($hasil->result() as $row){
                       $kd_rek5  = $row->kd_rek5 ;
                       $nm_rek5  = $row->nm_rek5;
                       $debet    = $row->debet; 
                       $kredit   = $row->kredit;
                       
                    if($debet<0){
                        $xy="("; 
                        $debet=$debet*-1; 
                        $yx=")";                           
                    }else{
                        $xy=""; 
                        $debet=$debet*1; 
                        $yx="";                    
                    }
                    $debet1 = number_format($debet,2,',','.');
                    
                    if($kredit<0){
                        $as="("; 
                        $kredit=$kredit*-1; 
                        $sa=")";                           
                    }else{
                        $as=""; 
                        $kredit=$kredit*1; 
                        $sa="";                    
                    }
                    $kredit1 = number_format($kredit,2,',','.');                    

                        $cRet .="<tr>
                                  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$kd_rek5</td>
                                  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$nm_rek5</td>
                                  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$xy$debet1$yx</td>
                                  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$as$kredit1$sa</td>                                    
                                  </tr>";                              
                    } 

        $sql = "SELECT SUM(debet) AS debet , SUM(kredit) AS kredit FROM(
            SELECT a.kd_rek5,
                        IF(LEFT(a.kd_rek5,1) IN ('1','5','6','9') || LEFT(a.kd_rek5,2) IN ('72'),SUM(debet)-SUM(kredit),0) AS debet,
                        IF(LEFT(a.kd_rek5,1) IN ('0','2','3','4','8') || LEFT(a.kd_rek5,2) IN ('71'),SUM(kredit)-SUM(debet),0) AS kredit 
                        FROM trdju_pkd a 
                        INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher 
                        WHERE a.kd_skpd='$kd_skpd' AND b.kd_skpd='$kd_skpd' AND MONTH(b.tgl_voucher)<='$bulan' and YEAR(tgl_voucher)='$thn_ang'
                        GROUP BY a.kd_rek5
                    )z";          
       

                    $hasil = $this->db->query($sql);       
                    $debeta1  = 0;
                    $kredita1 = 0;
                    foreach ($hasil->result() as $row){
                       $debet    = $row->debet; 
                       $kredit   = $row->kredit;
                     
                       $debeta1  = $debeta1+$debet;
                       $kredita1 = $kredita1+$kredit;
                       
                        if($debeta1<0){
                            $qw="("; 
                            $debeta1=$debeta1*-1; 
                            $wq=")";                           
                        }else{
                            $qw=""; 
                            $debeta1=$debeta1*1; 
                            $wq="";                    
                        }
                        $debeta11 = number_format($debeta1,2,',','.');
                        
                        if($kredita1<0){
                            $zx="("; 
                            $kredita1=$kredita1*-1; 
                            $xz=")";                           
                        }else{
                            $zx=""; 
                            $kredita1=$kredita1*1; 
                            $xz="";                    
                        }
                        $kredit11 = number_format($kredita1,2,',','.');                            
                    }
                        $cRet .="<tr>
                                  <td colspan=\"2\" valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"><b>Total</b></td>
                                  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"><b>$qw$debeta11$wq</b></td>
                                  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"><b>$zx$kredit11$xz</b></td>                                    
                                  </tr>";                       
         $cRet .="<tr>
                    <td valign=\"top\" align=\"left\" style=\"font-size:12px;border: solid 1px white;border-top:solid 1px black;\">&nbsp;</td>
                    <td valign=\"top\" align=\"center\" style=\"font-size:12px;border: solid 1px white;border-top:none;\">&nbsp;</td>
                    <td valign=\"top\" align=\"center\" style=\"font-size:12px;border: solid 1px white;border-top:none;\">&nbsp;</td>
                 </tr>

                <tr>
                    <td align=\"center\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    <td align=\"center\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\">$daerah, tanggal ".$this->tanggal_format_indonesia($tgl_ttd)."</td>                                                                                                                                                                                
                </tr>
                <tr>                
                    <td align=\"center\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    <td align=\"center\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"><b>$jabatan</b></td>                    
                </tr>
                <tr>
                    <td align=\"left\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    <td align=\"left\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"></td>
                </tr>
                <tr>
                    <td align=\"left\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\">&nbsp;</td>
                    <td align=\"left\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"></td>
                </tr>
                <tr>
                    <td align=\"left\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\">&nbsp;</td>
                    <td align=\"left\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"></td>
                </tr>
                <tr>
                    <td align=\"left\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\">&nbsp;</td>
                    <td align=\"left\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"></td>
                </tr>
                <tr>
                    <td align=\"center\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"><u></u></td>
                    <td align=\"center\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"><u>$nama</u></td>
                </tr>
                <tr>
                    <td align=\"center\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    <td align=\"center\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\">$nip</td>
                </tr>";                     

         $cRet .='</table>';
         $data['prev']= $cRet;    
        // $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
         
         
           $data['prev']= $cRet;
            switch($ctk) {        
                case 1;
                      $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
                break;
                case 2;        
                    header("Cache-Control: no-cache, no-store, must-revalidate");
                    header("Content-Type: application/vnd.ms-excel");
                    header("Content-Disposition: attachment; filename=neracasaldo.xls");
                    $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            } 

             
    }

    function cetak_neracasaldo_all(){
        $thn_ang    = $this->session->userdata('pcThang');
        $kd_skpd    = '1.20.06.00';//$_REQUEST['skpd'];
        $bulan      = $_REQUEST['tgl1'];
        $lcperiode  = $this->tukd_model->getBulan($bulan);
        $tgl_ttd    = $_REQUEST['tgl_ttd'];     
        
        $sqlsc = "SELECT kab_kota,daerah FROM sclient";
        $sqlsclient=$this->db->query($sqlsc);
        foreach ($sqlsclient->result() as $rowsc){
            $kota   = $rowsc->kab_kota;
            $daerah = $rowsc->daerah;
        }

        $csql2 = "SELECT nm_skpd FROM ms_skpd WHERE kd_skpd = '$kd_skpd'";
            $hasil2   = $this->db->query($csql2);
            $trh4     = $hasil2->row();          
            $lcNmskpd = $trh4->nm_skpd;
            
        $sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$kd_skpd' and kode='PA'";
        $sqlttd=$this->db->query($sqlttd1);
        foreach ($sqlttd->result() as $rowttd){
            $nip     = $rowttd->nip;                    
            $nama    = $rowttd->nm;
            $jabatan = $rowttd->jab;
        }           

        $cRet = '';
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
                    <tr>
                        <td colspan=\"4\" align=\"center\" style=\"font-size:14px;border: solid 1px white;\"><b>$kota<br>NERACA SALDO</b></td>
                    </tr>
                    <tr>
                        <td colspan=\"4\" align=\"center\" style=\"font-size:14px;border: solid 1px white;\">Bulan $lcperiode</td>
                    </tr>           
                    <tr>
                        <td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    </tr>
                    <tr>
                        <td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    </tr>
                    <tr>
                        <td align=\"left\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    </tr>
                    
                    </table>";
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"1\" cellpadding=\"1\">
            <thead>
            <tr>
                <td bgcolor=\"#CCCCCC\" rowspan=\"2\" align=\"center\" width=\"5%\" style=\"font-size:12px\">Kode Rekening</td>
                <td bgcolor=\"#CCCCCC\" rowspan=\"2\" align=\"center\" width=\"55%\" style=\"font-size:12px\">Nama Rekening</td>
                <td bgcolor=\"#CCCCCC\" colspan=\"2\" align=\"center\" width=\"40%\" style=\"font-size:12px\">Jumlah</td>          
            </tr> 
            <tr>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"20%\" style=\"font-size:12px\">Debet</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" width=\"20%\" style=\"font-size:12px\">Kredit</td>         
            </tr>           
            <tr>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">1</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">2</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">3</td>
                <td bgcolor=\"#CCCCCC\" align=\"center\" style=\"font-size:12px\">4</td>            
            </tr> 
            </thead>
            <tfoot>
                <tr><td style=\"border-bottom: none; border-left:none;border-right:none;\" colspan=\"4\"></td>
            </tfoot>            
            ";
            
            $sql = "SELECT a.kd_rek5,a.nm_rek5,
                        IF(LEFT(a.kd_rek5,1) IN ('1','5','6','9') || LEFT(a.kd_rek5,2) IN ('72'),SUM(debet)-SUM(kredit),0) AS debet,
                        IF(LEFT(a.kd_rek5,1) IN ('0','2','3','4','8') || LEFT(a.kd_rek5,2) IN ('71'),SUM(kredit)-SUM(debet),0) AS kredit 
                        FROM trdju_pkd a 
                        INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                        WHERE  MONTH(b.tgl_voucher)<='$bulan' and YEAR(tgl_voucher)='$thn_ang'
                        GROUP BY a.kd_rek5
                        ORDER BY a.kd_rek5
                    ";          
      

                    $hasil = $this->db->query($sql);       
                    $saldo=0;
                    foreach ($hasil->result() as $row){
                       $kd_rek5  = $row->kd_rek5 ;
                       $nm_rek5  = $row->nm_rek5;
                       $debet    = $row->debet; 
                       $kredit   = $row->kredit;
                       
                    if($debet<0){
                        $xy="("; 
                        $debet=$debet*-1; 
                        $yx=")";                           
                    }else{
                        $xy=""; 
                        $debet=$debet*1; 
                        $yx="";                    
                    }
                    $debet1 = number_format($debet,2,',','.');
                    
                    if($kredit<0){
                        $as="("; 
                        $kredit=$kredit*-1; 
                        $sa=")";                           
                    }else{
                        $as=""; 
                        $kredit=$kredit*1; 
                        $sa="";                    
                    }
                    $kredit1 = number_format($kredit,2,',','.');                    

                        $cRet .="<tr>
                                  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$kd_rek5</td>
                                  <td valign=\"top\" align=\"left\" style=\"font-size:12px;border-bottom:none;border-top:none\">$nm_rek5</td>
                                  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$xy$debet1$yx</td>
                                  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:none;border-top:none\">$as$kredit1$sa</td>                                    
                                  </tr>";                              
                    } 

            $sql = "SELECT a.kd_rek5,
                        IF(LEFT(a.kd_rek5,1) IN ('1','5','6','9') || LEFT(a.kd_rek5,2) IN ('72'),SUM(debet)-SUM(kredit),0) AS debet,
                        IF(LEFT(a.kd_rek5,1) IN ('0','2','3','4','8') || LEFT(a.kd_rek5,2) IN ('71'),SUM(kredit)-SUM(debet),0) AS kredit 
                        FROM trdju_pkd a 
                        INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                        WHERE  MONTH(b.tgl_voucher)<='$bulan' and YEAR(tgl_voucher)='$thn_ang'
                        GROUP BY a.kd_rek5
                    ";          

                    $hasil = $this->db->query($sql);       
                    $debeta1  = 0;
                    $debeta11  = 0;
                    $kredita1 = 0;
                    foreach ($hasil->result() as $row){
                       $debet    = $row->debet; 
                       $kredit   = $row->kredit;
                     
                       $debeta1  = $debeta1+$debet;
                       $kredita1 = $kredita1+$kredit;
                       
                        if($debeta1<0){
                            $qw="("; 
                            $debeta11=$debeta1*-1; 
                            $wq=")";                           
                        }else{
                            $qw=""; 
                            $debeta11=$debeta1*1; 
                            $wq="";                    
                        }
                        $debeta11 = number_format($debeta11,2,',','.');
                        
                        if($kredita1<0){
                            $zx="("; 
                            $kredita11=$kredita1*-1; 
                            $xz=")";                           
                        }else{
                            $zx=""; 
                            $kredita11=$kredita1*1; 
                            $xz="";                    
                        }
                        $kredit11 = number_format($kredita11,2,',','.');                               
                    }
                        $cRet .="<tr>
                                  <td colspan=\"2\" valign=\"top\" align=\"center\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"><b>Total</b></td>
                                  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"><b>$qw$debeta11$wq</b></td>
                                  <td valign=\"top\" align=\"right\" style=\"font-size:12px;border-bottom:solid 1px black;border-top:solid 1px black\"><b>$zx$kredit11$xz</b></td>                                    
                                  </tr>";                       
         $cRet .="<tr>
                    <td valign=\"top\" align=\"left\" style=\"font-size:12px;border: solid 1px white;border-top:solid 1px black;\">&nbsp;</td>
                    <td valign=\"top\" align=\"center\" style=\"font-size:12px;border: solid 1px white;border-top:none;\">&nbsp;</td>
                    <td valign=\"top\" align=\"center\" style=\"font-size:12px;border: solid 1px white;border-top:none;\">&nbsp;</td>
                 </tr>

                <tr>
                    <td align=\"center\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    <td align=\"center\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\">$daerah, tanggal ".$this->tanggal_format_indonesia($tgl_ttd)."</td>                                                                                                                                                                                
                </tr>
                <tr>                
                    <td align=\"center\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    <td align=\"center\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"><b>$jabatan</b></td>                    
                </tr>
                <tr>
                    <td align=\"left\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    <td align=\"left\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"></td>
                </tr>
                <tr>
                    <td align=\"left\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\">&nbsp;</td>
                    <td align=\"left\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"></td>
                </tr>
                <tr>
                    <td align=\"left\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\">&nbsp;</td>
                    <td align=\"left\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"></td>
                </tr>
                <tr>
                    <td align=\"left\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\">&nbsp;</td>
                    <td align=\"left\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"></td>
                </tr>
                <tr>
                    <td align=\"center\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"><u></u></td>
                    <td align=\"center\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"><u>$nama</u></td>
                </tr>
                <tr>
                    <td align=\"center\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\"></td>
                    <td align=\"center\" colspan=\"2\" style=\"font-size:12px;border: solid 1px white;\">$nip</td>
                </tr>";                     

         $cRet .='</table>';
         $data['prev']= $cRet;    
        // $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
         
         
        $ctk = $this->uri->segment(3);

            $data['prev']= $cRet;
            switch($ctk) {        
                case 1;
                   $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
                break;
                case 2;        
                    header("Cache-Control: no-cache, no-store, must-revalidate");
                    header("Content-Type: application/vnd.ms-excel");
                    header("Content-Disposition: attachment; filename=neracasaldo.xls");
                    $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            } 
    }

    function rekening_bb(){
        $lccr = $this->input->post('q');
        $sql = "SELECT DISTINCT(kd_rek5),nm_rek5 FROM trdju_pkd WHERE kd_rek5 <> '' 
                    AND nm_rek5 <> '' AND (kd_rek5 LIKE '$lccr%' OR UPPER(nm_rek5) LIKE UPPER('$lccr%')) ORDER BY kd_rek5";
        
        $query1 = $this->db->query($sql);  
        $result = array();
        $ii = 0;
        foreach($query1->result_array() as $resulte){
            $result[] = array(
                'id' => $ii,        
                'kd_rek5' => $resulte['kd_rek5'],  
                'nm_rek5' => $resulte['nm_rek5'],                   
            );
            $ii++;
        }
        echo json_encode($result);
    }


    function cetakbb_edit(){
     $cetak = $this->uri->segment(3);
       $tglttd  = $_REQUEST['tglttd'];
            $dcetak  = $_REQUEST['dcetak'];
            $dcetak2 = $_REQUEST['dcetak2'];
            $skpd    = $_REQUEST['skpd'];
            $rek5    = $_REQUEST['rek5'];
            $space   = $_REQUEST['space'];
            $nip     = $_REQUEST['nip'];        
            $gl     = $_REQUEST['gl'];      
            $nip1    = $_REQUEST['nip1'];   
        
                
        if(substr($rek5,0,3)=='523' || substr($rek5,0,3)=='522' || substr($rek5,0,3)=='524' || substr($rek5,0,3)=='525' || substr($rek5,0,3)=='521'){
            $jabkabid='KEPALA BIDANG ASET';
            $nmkabid ='ALFIUS ADADIKAM, A.Md.Sos';
            $nipkabid='19600404 198603 1 029';
        }else{
            $jabkabid='KEPALA BIDANG AKUNTANSI';
            $nmkabid ='ROMEL TIMISELA,S.Sos., MM';
            $nipkabid='19710501 199703 1 002';
        }    
        $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                $sqlsclient=$this->db->query($sqlsc);
                foreach ($sqlsclient->result() as $rowsc){
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                }
                       $sqlttd="SELECT jabatan,nip,nama from ms_ttd where kd_skpd='1.20.06.00' and nip='$nip'";
         $z=0;
         $sqlsclient=$this->db->query($sqlttd);
         foreach ($sqlsclient->result() as $rowst)
        {
            $nipt     = $rowst->nip;
            $jabatant  = $rowst->jabatan;
            $namat     = $rowst->nama;
            $z++;
        }

            if($z=='0'){
                $nipt='BELUM ADA NIP';
                $namat='BELUM ADA NAMA';
                $jabatant='BELUM ADA JABATAN';
            
        } 

            $sqlttd1="SELECT jabatan,nip,nama from ms_ttd where kd_skpd='1.20.06.00' and nip='$nip1'";
                     $z=0;
                     $sqlsclient1=$this->db->query($sqlttd1);
                     foreach ($sqlsclient1->result() as $rowst1)
                    {
                        $nipt1     = $rowst1->nip;
                        $jabatant1  = $rowst1->jabatan;
                        $namat1     = $rowst1->nama;
                        $z++;
                    }

                        if($z=='0'){
                            $nipt1='BELUM ADA NIP';
                            $namat1='BELUM ADA NAMA';
                            $jabatant1='BELUM ADA JABATAN';
                        
                    }               


if($rek5=='0000000'){

    $nmrek="Perubahan Sal";
}else{

        $sqlnm="SELECT nm_rek64 as nm_rek5 FROM ms_rek5 WHERE kd_rek64='$rek5'";
                $sqlnmrek=$this->db->query($sqlnm);
                foreach ($sqlnmrek->result() as $row){
                    $nmrek=$row->nm_rek5;
                              }

}


        if((substr($rek5,0,1)=='0')||(substr($rek5,0,1)=='1')||(substr($rek5,0,1)=='2')||(substr($rek5,0,1)=='3')
                ||(substr($rek5,0,1)=='8')||(substr($rek5,0,1)=='9')){
                        $pokok = '0.00';
                        $ubah  = '0.00';
        }else{
            /*$sqlpg="SELECT
                        IFNULL((SELECT nilai FROM trdrka WHERE kd_skpd='$skpd' AND kd_rek5='$rek5'),0) AS pokok,
                        IFNULL((SELECT nilai_ubah FROM trdrka WHERE kd_skpd='$skpd' AND kd_rek5='$rek5'),0) AS ubah";*/
                $sqlpg="SELECT SUM(IF(kd_rek5='$rek5',nilai,0))AS pokok,
                        SUM(IF(kd_rek5='$rek5',nilai_ubah,0))AS ubah
                        FROM trdrka WHERE kd_skpd='$skpd'";
                    $sqlnilpg=$this->db->query($sqlpg);
                    foreach ($sqlnilpg->result() as $row){
                        if($row->pokok==0.00){
                        $pok = '0.00';
                        }else{
                        $pok = $row->pokok;
                        }
                        if($row->ubah==0.00){
                        $uba = '0.00';
                        }else{
                        $uba = $row->ubah;
                        }
                        $pokok = number_format($pok,'2',',','.');
                        $ubah  = number_format($uba,'2',',','.');
                    }       
        }
        //$cRet .="<TABLE style="border-collapse:collapse;" width="100%" align="center" border="1" cellspacing="0" cellpadding="4">

                $cRet ="<table width=\"100%\" border=\"0\" >
                    <tr>
                        <td  COLSPAN=\"6\" align=\"RIGHT\" style=\"font-size:8\"><b>PEMERINTAH $kab</b></td>
                    </tr>
                    <tr>
                        <td  COLSPAN=\"6\" align=\"RIGHT\" style=\"font-size:8\"><b>BADAN PENGELOLA KEUANGAN DAN ASET DAERAH</b></td>
                    </tr>
                    <tr>
                        <td  COLSPAN=\"6\"  align=\"RIGHT\" style=\"font-size:8\"><b>BIDANG AKUNTANSI</b></td>
                    </tr>
                    </table>";
        




            $cRet .="<table width=\"100%\">
                    <tr>
                        <td COLSPAN=\"6\" align=\"center\" ><b>BUKU BESAR </b></td>
                    </tr>
                    </table>";
            $cRet .="<br>";
            $cRet .="<table width=\"100%\">
                     <tr>
                        <td align=\"left\" width=\"25%\" >SKPD</td>
                        <td align=\"left\" width=\"75%\" >: $skpd ".$this->tukd_model->get_nama($skpd,'nm_skpd','ms_skpd','kd_skpd')."</td>
                     </tr>
                     <tr>
                        <td align=\"left\" width=\"25%\" >KODE REKENING</td>
                        <td align=\"left\" width=\"75%\" >: $rek5</td>
                     </tr>
                     <tr>
                        <td align=\"left\" width=\"25%\" >NAMA REKENING</td>
                        <td align=\"left\" width=\"75%\" >: $nmrek</td>
                     </tr> 
                     <tr>
                        <td align=\"left\" width=\"25%\" >PAGU APBD</td>
                        <td align=\"left\" width=\"75%\" >: $pokok</td>
                     </tr>
                     <tr>
                        <td align=\"left\" width=\"25%\" >PAGU PERUBAHAN APBD</td>
                        <td align=\"left\" width=\"75%\" >: $ubah</td>
                     </tr>                                                              
                     <tr>
                        <td align=\"left\" width=\"25%\" >Periode</td>
                        <td align=\"left\" width=\"75%\" >: ".$this->tukd_model->tanggal_format_indonesia($dcetak)." s/d ".$this->tukd_model->tanggal_format_indonesia($dcetak2)."</td>
                     </tr>
                     </table>";

            $cRet .='<TABLE style="border-collapse:collapse;" width="100%" align="center" border="1" cellspacing="0" cellpadding="4">
                     <THEAD>
                     <TR>
                        <TD width="20%"  bgcolor="#CCCCCC" align="center" >TANGGAL</TD>
                        <TD width="30%" bgcolor="#CCCCCC" align="center" >URAIAN</TD>
                        <TD width="5%" bgcolor="#CCCCCC" align="center" >REF</TD>
                        <TD width="15%" bgcolor="#CCCCCC" align="center" >DEBET</TD>
                        <TD width="15%" bgcolor="#CCCCCC" align="center" >KREDIT</TD>
                        <TD width="15%" bgcolor="#CCCCCC" align="center" >SALDO</TD>
                     </TR>
                     <TR>
                        <TD width="20%"  bgcolor="#CCCCCC" align="center" >1</TD>
                        <TD width="30%" bgcolor="#CCCCCC" align="center" >2</TD>
                        <TD width="5%" bgcolor="#CCCCCC" align="center" >3</TD>
                        <TD width="15%" bgcolor="#CCCCCC" align="center" >4</TD>
                        <TD width="15%" bgcolor="#CCCCCC" align="center" >5</TD>
                        <TD width="15%" bgcolor="#CCCCCC" align="center" >6</TD>
                     </TR>                     
                     </THEAD>';
                     
            $thn_ang=$this->session->userdata('pcThang')-1;

         $csql3 = "SELECT IF(SUM(a.debet)IS NULL,0,SUM(a.debet)) AS debet,IF(SUM(a.kredit)IS NULL,0,SUM(a.kredit)) AS kredit FROM trdju_pkd a 
                        LEFT JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_skpd WHERE a.kd_rek5='$rek5' AND b.kd_skpd='$skpd' 
                        and b.tgl_voucher <'$dcetak'";
                        
         $hasil = $this->db->query($csql3);
         $trh4 = $hasil->row(); 
         $awaldebet = $trh4->debet;
         $awalkredit = $trh4->kredit;
                    if ((substr($rek5,0,1)=='9') or (substr($rek5,0,1)=='5') or (substr($rek5,0,2)=='62') or (substr($rek5,0,2)=='72') or (substr($rek5,0,1)=='1')){                    
                        $saldo=$awaldebet-$awalkredit;
                    }else{
                        $saldo=$awalkredit-$awaldebet;
                    } 
                    
                    $cRet .='<TR>
                                <TD width="20%" align="left" ></TD>
                                <TD width="35%" align="left" >saldo awal</TD>
                                <TD width="5%" align="left" ></TD>
                                <TD width="15%" align="right" ></TD>
                                <TD width="15%" align="right" ></TD>
                                <TD width="15%" align="right" >'.number_format($saldo,2,',','.').'</TD>
                             </TR>';          
                
                $idx=1;
                $query = $this->db->query("SELECT a.kd_rek5,a.debet,a.kredit,b.tgl_voucher,b.ket,b.no_voucher FROM trdju_pkd a 
                                                LEFT JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_skpd WHERE a.kd_rek5='$rek5' 
                                                AND b.kd_skpd='$skpd' AND b.tgl_voucher between '$dcetak' AND '$dcetak2'
                                                ORDER BY b.tgl_voucher,a.no_voucher,a.urut"); 
                                                  
                if ($query->num_rows() > 0){
                    $jdebet=0;
                    $jkredit=0;
                    foreach($query->result_array() as $res){
                                            
                        $tgl_voucher=$res['tgl_voucher'];
                        $ket=$res['ket'];
                        $ref=$res['no_voucher'];
                        $debet=$res['debet'];
                        $kredit=$res['kredit'];
                        $idx++;
                        
                        $saldo=$saldo;
                        if ((substr($rek5,0,1)=='9') or (substr($rek5,0,1)=='5') or (substr($rek5,0,2)=='62') 
                                    or (substr($rek5,0,2)=='72') or (substr($rek5,0,1)=='1')){                  
                            $saldo=$saldo+$debet-$kredit;
                            
                        }else{
                            $saldo=$saldo+$kredit-$debet;
                            
                        }
                        
                        $cRet .='<TR>
                                    <TD width="20%" align="left" >'.$this->tukd_model->tanggal_format_indonesia($tgl_voucher).'</TD>
                                    <TD width="35%" align="left" >'.$ket.'</TD>
                                    <TD width="5%" align="left" >'.$ref.'</TD>
                                    <TD width="15%" align="right" >'.number_format($debet,2,',','.').'</TD>
                                    <TD width="15%" align="right" >'.number_format($kredit,2,',','.').'</TD>
                                    <TD width="15%" align="right" >'.number_format($saldo,2,',','.').'</TD>
                                 </TR>';
                                 
                        $jdebet=$jdebet+$debet;
                        $jkredit = $jkredit + $kredit;

                    }
                    $cRet .='<TR>
                                <TD align="left" ></TD>
                                <TD colspan=\"3\" align="right" ><b>JUMLAH</b></TD>
                                <TD align="left" ></TD>
                                <TD align="right" ><b>'.number_format($jdebet,2,',','.').'</b></TD>
                                <TD align="right" ><b>'.number_format($jkredit,2,',','.').'</b></TD>
                                <TD align="right" ><b>'.number_format($saldo,2,',','.').'</b></TD>
                             </TR>';
                    $cRet .='</TABLE>';              
                } else{
                $cRet .='</TABLE>';
                }
            

          $last=date('Y-m-t',strtotime($dcetak2));




        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\"  style=\"font-size:12\" align=\"left\" border=\"0\">";
                           for($i=0;$i<=$space;$i++){
                $cRet .="<tr>
                            <td colspan=\"3\">&nbsp;</td>
                        </tr>";
            }

                        $cRet.="<tr>
                            <td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td>
                        </tr>
                        <tr>
                            <td colspan=\"2\" width=\"41%\" align=\"center\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tglttd)."</td>
                        </tr>
                        <tr>
                            <td colspan=\"2\" width=\"41%\" align=\"center\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\"><b>DIBUAT OLEH</b></td>
                        </tr>
                        
                        <tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
                        <tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
                        <tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
                        
                        <tr>
                            <td colspan=\"2\" width=\"41%\" align=\"center\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\"><b><u>$namat</u></b></td>
                        </tr>
                        <tr>
                            <td colspan=\"2\" width=\"41%\" align=\"center\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\"><b>NIP : $nipt</b></td>
                        </tr>

                    </table>"; 

                    
                    

             $data['prev']= $cRet;    
        switch($cetak) {
        case 0;
            $this->template->load('template','anggaran/rka/perkadaII',$data);
        break;
        case 1;
            //$skpdx=$kd_skpd.' '.$nm_skpd;
             $this->tukd_model->_mpdf('',$cRet,10,5,10,'0');    
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= BB.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        
        }       
    }

    function cetakbbkonsol_edit(){
    
    $tglttd  = $_REQUEST['tglttd'];
            $dcetak  = $_REQUEST['dcetak'];
            $dcetak2 = $_REQUEST['dcetak2'];
            //$skpd      = $_REQUEST['skpd'];
            $rek5    = $_REQUEST['rek5'];
            $space   = $_REQUEST['space'];
            $nip     = $_REQUEST['nip'];        
            $nip1    = $_REQUEST['nip1'];   
                $gl    = $_REQUEST['gl'];
                
         $cetak = $this->uri->segment(3);
                           
                           /*if($skpd=='1.20.06.00'){
                                $skpd='1.20.08.00';
                           }else{
                           $skpd=$skpd;
                           }*/
            
        $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                $sqlsclient=$this->db->query($sqlsc);
                foreach ($sqlsclient->result() as $rowsc){
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                }
                       //$sqlttd="SELECT jabatan,nip,nama from ms_ttd where kd_skpd = '$skpd' and nip='$nip'";
                       $sqlttd="SELECT jabatan,nip,nama from ms_ttd where nip='$nip'";
         $z=0;
         $sqlsclient=$this->db->query($sqlttd);
         foreach ($sqlsclient->result() as $rowst)
        {
            $nipt     = $rowst->nip;
            $jabatant  = $rowst->jabatan;
            $namat     = $rowst->nama;
            $z++;
        }

            if($z=='0'){
                $nipt='BELUM ADA NIP';
                $namat='BELUM ADA NAMA';
                $jabatant='BELUM ADA JABATAN';
            
        } 

            //$sqlttd1="SELECT jabatan,nip,nama from ms_ttd where kd_skpd = '$skpd' and nip='$nip1'";
            $sqlttd1="SELECT jabatan,nip,nama from ms_ttd where nip='$nip1'";
                     $z=0;
                     $sqlsclient1=$this->db->query($sqlttd1);
                     foreach ($sqlsclient1->result() as $rowst1)
                    {
                        $nipt1     = $rowst1->nip;
                        $jabatant1  = $rowst1->jabatan;
                        $namat1     = $rowst1->nama;
                        $z++;
                    }

                        if($z=='0'){
                            $nipt1='BELUM ADA NIP';
                            $namat1='BELUM ADA NAMA';
                            $jabatant1='BELUM ADA JABATAN';
                        
                    }               


if($rek5=='0000000'){

    $nmrek="Perubahan Sal";
}else{

        $sqlnm="SELECT nm_rek64 as nm_rek5 FROM ms_rek5 WHERE kd_rek64='$rek5'";
                $sqlnmrek=$this->db->query($sqlnm);
                foreach ($sqlnmrek->result() as $row){
                    $nmrek=$row->nm_rek5;
                              }

}


        if((substr($rek5,0,1)=='0')||(substr($rek5,0,1)=='1')||(substr($rek5,0,1)=='2')||(substr($rek5,0,1)=='3')
                ||(substr($rek5,0,1)=='8')||(substr($rek5,0,1)=='9')){
                        $pokok = '0.00';
                        $ubah  = '0.00';
        }else{
            /*$sqlpg="SELECT
                        IFNULL((SELECT nilai FROM trdrka WHERE kd_skpd='$skpd' AND kd_rek5='$rek5'),0) AS pokok,
                        IFNULL((SELECT nilai_ubah FROM trdrka WHERE kd_skpd='$skpd' AND kd_rek5='$rek5'),0) AS ubah";*/
            $sqlpg="SELECT
                        IFNULL((SELECT sum(nilai) FROM trdrka WHERE kd_rek5='$rek5'),0) AS pokok,
                        IFNULL((SELECT sum(nilai_ubah) FROM trdrka WHERE kd_rek5='$rek5'),0) AS ubah FROM trdrka limit 1";
                    $sqlnilpg=$this->db->query($sqlpg);
                    foreach ($sqlnilpg->result() as $row){
                        if($row->pokok==0.00){
                        $pok = '0.00';
                        }else{
                        $pok = $row->pokok;
                        }
                        if($row->ubah==0.00){
                        $uba = '0.00';
                        }else{
                        $uba = $row->ubah;
                        }
                        $pokok = number_format($pok,'2',',','.');
                        $ubah  = number_format($uba,'2',',','.');
                    }       
        }
        //$cRet .="<TABLE style="border-collapse:collapse;" width="100%" align="center" border="1" cellspacing="0" cellpadding="4">

                $cRet ="<table width=\"100%\" border=\"0\" >
                    <tr>
                        <td align=\"RIGHT\" style=\"font-size:8\"><b>$kab</b></td>
                    </tr>
                    <tr>
                        <td align=\"RIGHT\" style=\"font-size:8\"><b>BADAN PENGELOLA KEUANGAN DAN ASET DAERAH</b></td>
                    </tr>
                    <tr>
                        <td align=\"RIGHT\" style=\"font-size:8\"><b>BIDANG AKUNTANSI</b></td>
                    </tr>
                    </table>";
        
            $cRet .="<table width=\"100%\">
                    <tr>
                        <td align=\"center\" ><b>BUKU BESAR </b></td>
                    </tr>
                    </table>";
            $cRet .="<br>";
            
            $cRet .="<table width=\"100%\">                  
                     <tr>
                        <td align=\"left\" width=\"25%\" >KODE REKENING</td>
                        <td align=\"left\" width=\"75%\" >: $rek5</td>
                     </tr>
                     <tr>
                        <td align=\"left\" width=\"25%\" >NAMA REKENING</td>
                        <td align=\"left\" width=\"75%\" >: $nmrek</td>
                     </tr> 
                     <tr>
                        <td align=\"left\" width=\"25%\" >PAGU APBD</td>
                        <td align=\"left\" width=\"75%\" >: $pokok</td>
                     </tr>
                     <tr>
                        <td align=\"left\" width=\"25%\" >PAGU PERUBAHAN APBD</td>
                        <td align=\"left\" width=\"75%\" >: $ubah</td>
                     </tr>                                                              
                     <tr>
                        <td align=\"left\" width=\"25%\" >Periode</td>
                        <td align=\"left\" width=\"75%\" >: ".$this->tukd_model->tanggal_format_indonesia($dcetak)." s/d ".$this->tukd_model->tanggal_format_indonesia($dcetak2)."</td>
                     </tr>
                     </table>";

            $cRet .='<TABLE style="border-collapse:collapse;" width="100%" align="center" border="1" cellspacing="0" cellpadding="4">
                     <THEAD>
                     <TR>
                        <TD width="20%"  bgcolor="#CCCCCC" align="center" >TANGGAL</TD>
                        <TD width="30%" bgcolor="#CCCCCC" align="center" >URAIAN</TD>
                        <TD width="5%" bgcolor="#CCCCCC" align="center" >REF</TD>
                        <TD width="15%" bgcolor="#CCCCCC" align="center" >DEBET</TD>
                        <TD width="15%" bgcolor="#CCCCCC" align="center" >KREDIT</TD>
                        <TD width="15%" bgcolor="#CCCCCC" align="center" >SALDO</TD>
                     </TR>
                     <TR>
                        <TD width="20%" bgcolor="#CCCCCC" align="center">1</TD>
                        <TD width="30%" bgcolor="#CCCCCC" align="center">2</TD>
                        <TD width="5%" bgcolor="#CCCCCC" align="center">3</TD>
                        <TD width="15%" bgcolor="#CCCCCC" align="center">4</TD>
                        <TD width="15%" bgcolor="#CCCCCC" align="center">5</TD>
                        <TD width="15%" bgcolor="#CCCCCC" align="center">6</TD>
                     </TR>                     
                     </THEAD>';
                     
            $thn_ang=$this->session->userdata('pcThang')-1;

         $csql3 = "SELECT IF(SUM(a.debet)IS NULL,0,SUM(a.debet)) AS debet,IF(SUM(a.kredit)IS NULL,0,SUM(a.kredit)) AS kredit FROM trdju_pkd a 
                        LEFT JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_skpd WHERE a.kd_rek5='$rek5' 
                        and b.tgl_voucher <'$dcetak'";
                        
         $hasil = $this->db->query($csql3);
         $trh4 = $hasil->row(); 
         $awaldebet = $trh4->debet;
         $awalkredit = $trh4->kredit;        
                    
                    if ((substr($rek5,0,1)=='9') or (substr($rek5,0,1)=='5') or (substr($rek5,0,2)=='62') or (substr($rek5,0,2)=='72') or (substr($rek5,0,1)=='1')){                    
                        $saldo=$awaldebet-$awalkredit;
                    }else{
                        $saldo=$awalkredit-$awaldebet;
                    } 
                    
                    $cRet .='<TR>
                                <TD width="20%" align="left" ></TD>
                                <TD width="35%" align="left" >saldo awal</TD>
                                <TD width="5%" align="left" ></TD>
                                <TD width="15%" align="right" >'.number_format($awaldebet,2,',','.').'</TD>
                                <TD width="15%" align="right" >'.number_format($awalkredit,2,',','.').'</TD>
                                <TD width="15%" align="right" >'.number_format($saldo,2,',','.').'</TD>
                             </TR>';          
                
                $idx=1;
                $query = $this->db->query("SELECT a.kd_rek5,a.debet,a.kredit,b.tgl_voucher,b.ket,b.no_voucher FROM trdju_pkd a 
                                           LEFT JOIN trhju_pkd b ON a.no_voucher=b.no_voucher and a.kd_skpd=b.kd_skpd WHERE a.kd_rek5='$rek5' 
                                           AND b.tgl_voucher between '$dcetak' AND '$dcetak2'
                                           ORDER BY b.tgl_voucher,a.no_voucher,a.urut");                                                   
                if ($query->num_rows() > 0){
                    $jdebet=0;
                    $jkredit=0;
                    foreach($query->result_array() as $res){
                                            
                        $tgl_voucher=$res['tgl_voucher'];
                        $ket=$res['ket'];
                        $ref=$res['no_voucher'];
                        $debet=$res['debet'];
                        $kredit=$res['kredit'];
                        $idx++;
                        
                        $saldo=$saldo;
                        if ((substr($rek5,0,1)=='9') or (substr($rek5,0,1)=='5') or (substr($rek5,0,2)=='62') 
                                    or (substr($rek5,0,2)=='72') or (substr($rek5,0,1)=='1')){                  
                            $saldo=$saldo+$debet-$kredit;
                            
                        }else{
                            $saldo=$saldo+$kredit-$debet;
                            
                        }                       
                        $cRet .='<TR>
                                    <TD width="20%" align="left" >'.$this->tukd_model->tanggal_format_indonesia($tgl_voucher).'</TD>
                                    <TD width="35%" align="left" >'.$ket.'</TD>
                                    <TD width="5%" align="left" >'.$ref.'</TD>
                                    <TD width="15%" align="right" >'.number_format($debet,2,',','.').'</TD>
                                    <TD width="15%" align="right" >'.number_format($kredit,2,',','.').'</TD>
                                    <TD width="15%" align="right" >'.number_format($saldo,2,',','.').'</TD>
                                 </TR>';
                                 
                        $jdebet=$jdebet+$debet;
                        $jkredit = $jkredit + $kredit;

                    }
                    $cRet .='<TR>
                                <TD align="left" ></TD>
                                <TD colspan=\"3\" align="right" ><b>JUMLAH</b></TD>
                                <TD align="left" ></TD>
                                <TD align="right" ><b>'.number_format($jdebet,2,',','.').'</b></TD>
                                <TD align="right" ><b>'.number_format($jkredit,2,',','.').'</b></TD>
                                <TD align="right" ><b>'.number_format($saldo,2,',','.').'</b></TD>
                             </TR>';
                    $cRet .='</TABLE>';              
                } else{
                $cRet .='</TABLE>';
                }
     
          $last=date('Y-m-t',strtotime($dcetak2));


        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\"  style=\"font-size:12\" align=\"left\" border=\"0\">";
                           for($i=0;$i<=$space;$i++){
                $cRet .="<tr>
                            <td colspan=\"3\">&nbsp;</td>
                        </tr>";
            }

                        $cRet.="<tr>
                            <td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td>
                        </tr>
                        <tr>
                            <td colspan=\"2\" width=\"41%\" align=\"center\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tglttd)."</td>
                        </tr>
                        <tr>
                            <td colspan=\"2\" width=\"41%\" align=\"center\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\"><b>DIBUAT OLEH</b></td>
                        </tr>
                        
                        <tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
                        <tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
                        <tr><td colspan=\"3\" width=\"41%\" align=\"center\">&nbsp;</td></tr>
                        
                        <tr>
                            <td colspan=\"2\" width=\"41%\" align=\"center\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\"><b><u>$namat</u></b></td>
                        </tr>
                        <tr>
                            <td colspan=\"2\" width=\"41%\" align=\"center\">&nbsp;</td>
                            <td width=\"41%\" align=\"center\"><b>NIP : $nipt</b></td>
                        </tr>

                    </table>"; 
                        
    
            ini_set("memory_limit",-1);

        $data['prev']= $cRet;
          
          $this->template->set('title', 'CETAK PERDA');
       // $this->_mpdf1('',$cRet,25,10,10,'P','',$hal);
         
        switch($cetak) {
            case 0;
                 echo ("<title>L R A</title>"); 
                 echo $cRet;
            break;      
            case 1;
                $this->tukd_model->_mpdf('',$cRet,10,5,10,'0'); 
            break;
            case 2;        
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-excel");
                header("Content-Disposition: attachment; filename= kertas_kerja.xls");
                $this->load->view('akuntansi/view_excel_word', $data);
            break;
            case 3;     
                header("Cache-Control: no-cache, no-store, must-revalidate");
                header("Content-Type: application/vnd.ms-word");
                header("Content-Disposition: attachment; filename= kertas_kerja.doc");
                $this->load->view('akuntansi/view_excel_word', $data);
            break;
        
        }

    }

    function lampiran_perkada_I(){
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/perkada_real_1', $data);
    }

    function cetak_lra2_hitung(){
        $data['page_title'] = 'REALISASI';
        $this->template->set('title', 'REALISASI');
        $this->template->load('template', 'akuntansi/cetak_lra_hitung', $data);
    }

    function hitrecord(){
		$this->db->query("delete from realisasi_bulan");	
		$query =$this->db->query("select * from trdrka order by kd_skpd,kd_kegiatan,kd_rek5");  
		$rec   = count($query->result_array());
		$data=array("jumlah"=>$rec);
		echo json_encode($data);
		$query->free_result();
	}

	function proses_mapping_lra_bulan(){
		$bulan = $this->input->post('bulan');
		$baris =$this->input->post('baris');
		$cek =$this->input->post('ccek');
	    $where='';
		if($cek=='1'){
			$where='nilai';
		}else if($cek=='0'){
			$where='nilai_ubah';
		}

		$sql = " select kd_skpd,nm_skpd,kd_kegiatan,nm_kegiatan,kd_rek5,nm_rek5,nilai_ubah as nilai,IF((LEFT(kd_rek5,3)='523' or LEFT(kd_rek5,3)='521'),LEFT(kd_rek5,3),LEFT(kd_rek5,3)) AS kd_akun from trdrka ORDER BY kd_kegiatan,kd_rek5 limit $baris,1";
        $query1 = $this->db->query($sql);  
		   foreach($query1->result_array() as $res){
				
				$in =0;
				$out=0;
				$cp =0;
				$real_in=0;
				$real_out=0;
				$skpd       =$res['kd_skpd'];
				$nm_skpd    =$res['nm_skpd'];
				$kd_kegiatan=$res['kd_kegiatan'];
				$nm_kegiatan=$res['nm_kegiatan'];
				$kd_rek5	=$res['kd_rek5'];
				$anggaran	=$res['nilai'];
				$kd_akun    =$res['kd_akun'];
				//$nm_rek5	=$res['nm_rek5'];
				
				$stsubah=$this->rka_model->get_nama($skpd,'status_ubah','trhrka','kd_skpd');
		        $nm_skpd=$this->rka_model->get_nama($skpd,'nm_skpd','ms_skpd','kd_skpd');

				$gt = substr($kd_kegiatan,5,strlen($kd_kegiatan)-5);
				//$nm_kegiatan="";
				//get_nama($kode,$hasil,$tabel,$field)
				$kd_rek5_64	=$this->tukd_model->get_nama($kd_rek5,'kd_rek64','ms_rek5','kd_rek5');
				$nm_rek5	=$this->tukd_model->get_nama($kd_rek5,'nm_rek5','ms_rek5','kd_rek5');
				if(strlen($kd_akun) <=4){
					$akun=substr($kd_rek5_64,0,3);
				}else{
					$akun=substr($kd_rek5_64,0,5);
				}
				//Rekening 4 
			
				if(substr($kd_rek5,0,2)=='41'){
					$query7 = $this->db->query("SELECT SUM(b.rupiah) AS nilai FROM trhkasin_pkd a INNER JOIN trdkasin_pkd b ON a.no_sts=b.no_sts 
												WHERE b.kd_rek5='$kd_rek5' AND MONTH(a.tgl_sts)<='$bulan' AND a.kd_skpd='$skpd'");
					foreach($query7->result_array() as $res7){
						 $nilai4=$res7['nilai'];
					}
					  $this->db->query(" insert into realisasi_bulan(kd_skpd,kd_kegiatan,kd_rek5,kd_rek64,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5,kd_akun64,kd_akun5) values('$skpd','$kd_kegiatan','$kd_rek5','$kd_rek5_64','$anggaran','$nilai4','$nm_skpd','$nm_kegiatan','$nm_rek5','$akun','$kd_akun') ");
					  $baris=$baris+1;
					  if($nilai4==null){$nilaix=0;}else{$nilaix=number_format($nilai4,2);};
					  $isi  ='['.$baris.']'.'.'.$this->titik($kd_kegiatan.'.'.$kd_rek5.'-'.$nm_rek5).'['.$nilaix.']';
					  $datx=array("isi"=>$isi,"baris"=>($baris),"pesan"=>'0');
					  echo json_encode($datx); 

				}else if(substr($kd_rek5,0,2)=='42'){
					$query7 = $this->db->query("SELECT SUM(b.rupiah) AS nilai FROM trhkasin_ppkd a INNER JOIN trdkasin_ppkd b ON a.no_sts=b.no_sts 
						WHERE LEFT(b.kd_rek5,2)='42' AND b.kd_rek5='$kd_rek5' AND MONTH(a.tgl_sts)<='$bulan' AND a.kd_skpd='$skpd'");
					foreach($query7->result_array() as $res7){
						 $nilai4=$res7['nilai'];
					}
					  $this->db->query(" insert into realisasi_bulan(kd_skpd,kd_kegiatan,kd_rek5,kd_rek64,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5,kd_akun64,kd_akun5) values('$skpd','$kd_kegiatan','$kd_rek5','$kd_rek5_64','$anggaran','$nilai4','$nm_skpd','$nm_kegiatan','$nm_rek5','$akun','$kd_akun') ");
					  $baris=$baris+1;
					  if($nilai4==null){$nilaix=0;}else{$nilaix=number_format($nilai4,2);};
					  $isi  ='['.$baris.']'.'.'.$this->titik($kd_kegiatan.'.'.$kd_rek5.'-'.$nm_rek5).'['.$nilaix.']';
					  $datx=array("isi"=>$isi,"baris"=>($baris),"pesan"=>'0');
					  echo json_encode($datx); 

				}else if(substr($kd_rek5,0,2)=='61'){
					$query7 = $this->db->query("SELECT SUM(b.rupiah) AS nilai FROM trhkasin_ppkd a INNER JOIN trdkasin_ppkd b ON a.no_sts=b.no_sts 
						WHERE LEFT(b.kd_rek5,2)='61' AND b.kd_rek5='$kd_rek5' AND MONTH(a.tgl_sts)<='$bulan' AND a.kd_skpd='$skpd'");
					foreach($query7->result_array() as $res7){
						 $nilai4=$res7['nilai'];
					}
					  $this->db->query(" insert into realisasi_bulan(kd_skpd,kd_kegiatan,kd_rek5,kd_rek64,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5,kd_akun64,kd_akun5) values('$skpd','$kd_kegiatan','$kd_rek5','$kd_rek5_64','$anggaran','$nilai4','$nm_skpd','$nm_kegiatan','$nm_rek5','$akun','$kd_akun') ");
					  $baris=$baris+1;
					  if($nilai4==null){$nilaix=0;}else{$nilaix=number_format($nilai4,2);};
					  $isi  ='['.$baris.']'.'.'.$this->titik($kd_kegiatan.'.'.$kd_rek5.'-'.$nm_rek5).'['.$nilaix.']';
					  $datx=array("isi"=>$isi,"baris"=>($baris),"pesan"=>'0');
					  echo json_encode($datx); 

				  	}else if(substr($kd_rek5,0,2)=='43'){
					$query7 = $this->db->query("SELECT SUM(b.rupiah) AS nilai FROM trhkasin_ppkd a INNER JOIN trdkasin_ppkd b ON a.no_sts=b.no_sts 
						WHERE LEFT(b.kd_rek5,2)='43' AND b.kd_rek5='$kd_rek5' AND MONTH(a.tgl_sts)<='$bulan' AND a.kd_skpd='$skpd'");
					foreach($query7->result_array() as $res7){
						 $nilai4=$res7['nilai'];
					}
					  $this->db->query(" insert into realisasi_bulan(kd_skpd,kd_kegiatan,kd_rek5,kd_rek64,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5,kd_akun64,kd_akun5) values('$skpd','$kd_kegiatan','$kd_rek5','$kd_rek5_64','$anggaran','$nilai4','$nm_skpd','$nm_kegiatan','$nm_rek5','$akun','$kd_akun') ");
					  $baris=$baris+1;
					  if($nilai4==null){$nilaix=0;}else{$nilaix=number_format($nilai4,2);};
					  $isi  ='['.$baris.']'.'.'.$this->titik($kd_kegiatan.'.'.$kd_rek5.'-'.$nm_rek5).'['.$nilaix.']';
					  $datx=array("isi"=>$isi,"baris"=>($baris),"pesan"=>'0');
					  echo json_encode($datx);
				  
				}else{
					$query2 = $this->db->query("SELECT SUM(nilai) as nilai FROM trdtransout a
											INNER JOIN trhtransout b ON a.no_bukti = b.no_bukti
											WHERE MONTH(b.tgl_bukti) <='$bulan'  AND
											b.kd_skpd='$skpd' AND a.kd_kegiatan='$kd_kegiatan' AND a.kd_rek5='$kd_rek5'");
					foreach($query2->result_array() as $res2){
						 $nilai5=$res2['nilai'];
					}
					$this->db->query(" insert into realisasi_bulan(kd_skpd,kd_kegiatan,kd_rek5,kd_rek64,anggaran,real_spj,nm_skpd,nm_kegiatan,nm_rek5,kd_akun64,kd_akun5) values('$skpd','$kd_kegiatan','$kd_rek5','$kd_rek5_64','$anggaran','$nilai5','$nm_skpd','$nm_kegiatan','$nm_rek5','$akun','$kd_akun') ");
					$baris=$baris+1;
					if($nilai5==null){$nilaix=0;}else{$nilaix=number_format($nilai5,2);};
					  $isi  ='['.$baris.']'.'.'.$this->titik($kd_kegiatan.'.'.$kd_rek5.'-'.$nm_rek5).'['.$nilaix.']';
					  $datx=array("isi"=>$isi,"baris"=>($baris),"pesan"=>'0');
					  echo json_encode($datx); 
				}
				

			}
	}

	function cetak_lra_bulan($cetak='', $bulan='',$hari='',$perkada=''){
		$thnx=$this->session->userdata('pcThang');
		if($bulan==''){
			$b=date('m');
			$bulanx=$thnx.'-'.$b.'-01';
		}else{
			$bulanx=$thnx.'-'.$bulan.'-01';
		}
		$date=date('Y-m-t',strtotime($bulanx));
		$last= strtoupper($this->tukd_model->tanggal_format_indonesia($date));
       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang, no_qanun, tgl_qanun, no_perbup, tgl_perbup, bupati FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl     = $rowsc->tgl_rka;
                    $tanggal = $this->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                    
                    $bupati     = $rowsc->bupati;
                    $no_qanun   = $rowsc->no_qanun;
                    $tgl_qanun  = $this->tukd_model->tanggal_format_indonesia($rowsc->tgl_qanun);
                    $no_perbup  = $rowsc->no_perbup;
                    $tgl_perbup = $rowsc->tgl_perbup;
                } 
        $cRet='';
       if($perkada=="2"){ 
        $cRet .="<table width=\"100%\" align=\"center\" border=\"0\">
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">LAMPIRAN I : PERATURAN BUPATI MAMBERAMO TENGAH</td>
                    </tr>
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">NOMOR : $no_perbup</td>
                    </tr>
                    
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">TANGGAL : ".$this->tukd_model->tanggal_format_indonesia($tgl_perbup)."</td>
                    </tr>

                  </table>
				  <br>";
            
        $cRet .="<table style=\"border-collapse:collapse;  style=\"font-size:12\"\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>LAPORAN REALISASI PENJABARAN ANGGARAN </strong></td>
                    </tr>
                    
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>

                  </table>"; 
				 $tanggal= $this->tukd_model->tanggal_format_indonesia($tgl_perbup);
	   }else{
		$cRet .="<table width=\"100%\" align=\"center\" border=\"0\">
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">LAMPIRAN I : PERATURAN DAERAH MAMBERAMO TENGAH</td>
                    </tr>
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">NOMOR : $no_qanun</td>
                    </tr>
                    
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">TANGGAL : $tgl_qanun</td>
                    </tr>

                  </table>
				  <br>";
            
        $cRet .="<table style=\"border-collapse:collapse;  style=\"font-size:12\"\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>LAPORAN REALISASI ANGGARAN </strong></td>
                    </tr>
                    
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>PER $last</strong></td>
                    </tr>

                  </table>"; 
				  $tanggal= $tgl_qanun;
	   	   }
        $cRet .= "<table style=\"border-collapse:collapse; font-size:14;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NOMOR URUT</b></td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"45%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>ANGGARAN</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>REALISASI</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>LEBIH<br>(KURANG)</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>%</b></td>
						</tr>
                     </thead>
					  <tfoot>
                        <tr><td style=\"border-bottom: none; border-left:none;border-right:none;\" colspan=\"6\"></td>
                     </tfoot>";
                 $sql1="SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
						IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek1 a INNER JOIN realisasi_bulan b
						ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='4'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
						UNION ALL
						SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
						IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek2 a 
						LEFT JOIN realisasi_bulan b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='4' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
						IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek3 a 
						LEFT JOIN realisasi_bulan b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='4'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3 
						ORDER BY kd_rek";
                 $query = $this->db->query($sql1);
                                                  
                foreach ($query->result() as $row)
                {
                    $coba1=$row->rek;
                    $coba2=ucwords(strtolower($row->nm_rek));
                    $coba3= number_format($row->anggaran,"2",",",".");
					$coba3x= number_format($row->realy,"2",",",".");
					$coba3xx=$row->anggaran - $row->realy;
					$coba3xx= number_format($coba3xx,"2",",",".");
					
					if ($row->anggaran==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$row->anggaran;
						$per1 = ($row->realy!=0)?( $row->realy /  $row->anggaran ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);
                    if(strlen($coba1)<=3){
                        $coba1_= strtoupper($coba1);
                        $coba2_= strtoupper($coba2);
                        
                        $cRet .= "<tr>
									<td width=\"10%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
                                    <td width=\"45%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
                                    <td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"5%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
								</tr>";
                        
                        $cRet    .= " <tr>
										<td  width=\"10%\" align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba1_</b></td>
										<td width=\"45%\" style=\"border-top:none;border-bottom:none;\"><b>$coba2_</b></td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba3</b></td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba3x</b></td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba3xx</b></td>
										<td width=\"5%\" align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$persen1</b></td>
									</tr>";
                    }else{
                        $cRet    .= " <tr>
										<td width=\"10%\" align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba1</td>
										<td width=\"45%\" style=\"border-top:none;border-bottom:none;\">$coba2</td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba3</td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba3x</td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba3xx</td>
										<td width=\"5%\" align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$persen1</td>
									</tr>";
                    }
                    
                }
                $sqltp="SELECT SUM(anggaran) AS totp,sum(real_spj)as realp FROM realisasi_bulan WHERE LEFT(kd_rek5,1)='4'";
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                   $coba4=number_format($rowp->totp,"2",",",".");
                    $cob1=$rowp->totp;
					$cob1x=$rowp->realp;
					$coba4x=number_format($rowp->realp,"2",",",".");
					$cob1xx=$cob1-$cob1x;
					$cob1xxx=number_format($cob1xx,"2",",",".");
					if ($cob1==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$cob1;
						$per1 = ($cob1x!=0)?( $cob1x /  $cob1 ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                    $cRet    .= " <tr><td idth=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"45%\" align=\"right\"><b>JUMLAH PENDAPATAN&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba4</b></td>
									 <td width=\"15%\" align=\"right\"><b>$coba4x</b></td>
									 <td width=\"15%\" align=\"right\"><b>$cob1xxx</b></td>
									 <td width=\"5%\" align=\"center\"><b>$persen1</b></td>
								  </tr>";
                 } 
				
                $sql2="SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
					IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek1 a INNER JOIN realisasi_bulan b
					ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='5'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
					UNION ALL 
					SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
					IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy  FROM ms_rek2 a LEFT JOIN realisasi_bulan b
					ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='5' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
					UNION ALL 
					SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
					IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek3 a LEFT JOIN realisasi_bulan b
					ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='5'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3 ORDER BY kd_rek";
                 
                 $query1 = $this->db->query($sql2);
                 foreach ($query1->result() as $row1)
                {
                    $coba5=$row1->rek;
                    $coba6=ucwords(strtolower($row1->nm_rek));
                    $coba7= number_format($row1->anggaran,"2",",",".");
					$coba7x= number_format($row1->realy,"2",",",".");
					$coba7xx=$row1->anggaran - $row1->realy;
					$coba7xxx= number_format($coba7xx,"2",",",".");

					if ($row1->anggaran==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$row1->anggaran;
						$per1 = ($row1->realy!=0)?($row1->realy /  $row1->anggaran ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                    if(strlen($coba5)<=3){
                        $coba5_= strtoupper($coba5);
                        $coba6_= strtoupper($coba6);
                        
                        $cRet .= "<tr><td width=\"10%\" align=\"center\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
										<td width=\"45%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
										<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
										<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
										<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
										<td width=\"5%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
								</tr>";
                        
                         $cRet    .= " <tr>
										<td width=\"10%\" align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba5_</b></td>
										<td width=\"45%\" align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba6_</b></td>
                                        <td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba7</b></td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba7x</b></td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba7xxx</b></td>
										<td width=\"5%\" align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$persen1</b></td>
									</tr>";
                    }else{
                         $cRet    .= " <tr><td width=\"10%\" align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba5</td>                                     
										<td width=\"45%\" align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba6</td>
										<td width=\"20%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba7</td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba7x</td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba7xxx</td>
										<td width=\"5%\" align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$persen1</td>
									</tr>";
                    }
                    
                }
                
                    $sqltb="SELECT SUM(anggaran) AS totb,sum(real_spj)as realb FROM realisasi_bulan WHERE LEFT(kd_rek5,1)='5'";
                    $sqlb=$this->db->query($sqltb);
                 foreach ($sqlb->result() as $rowb)
                {
                   $coba8=number_format($rowb->totb,"2",",",".");
                    $cob=$rowb->totb;
					$coba8x=number_format($rowb->realb,"2",",",".");
                    $cobx=$rowb->realb;
					$cobxx= $cob - $cobx;
					$cobxxx = number_format($cobxx,"2",",",".");

					if ($cob==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$cob;
						$per1 = ($cobx!=0)?($cobx /  $cob ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"45%\" align=\"right\"><b>JUMLAH BELANJA&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba8</b></td>
									<td width=\"15%\" align=\"right\"><b>$coba8x</b></td>
									<td width=\"15%\" align=\"right\"><b>$cobxxx</b></td>
									<td width=\"5%\" align=\"center\"><b>$persen1</b></td>
								</tr>";
                 } 
                  
                  $suplus=$cob1-$cob; 
                  if ($suplus < 0){
                	$x1="(";
                	$suplus=$suplus*-1;
                	$y1=")";}
                  else {
                	$x1="";
	                $y1="";}
                 $surp=number_format($suplus,2,',','.');

				  $suplusx=$cob1x-$cobx; 
                  if ($suplusx < 0){
                	$xx1="(";
                	$suplusx=$suplusx*-1;
                	$yy1=")";}
                  else {
                	$xx1="";
	                $yy1="";}
                 $surpx=number_format($suplusx,2,',','.');

				 
				 $xxx1='';
				 $yyx1='';
				 $yyy1='';
				 
				 $suplusxx=$cob1xx-$cobxx; 
                  if ($suplusxx < 0){
                	$xxx1="(";
                	$suplusxx=$suplusxx*-1;
                	$yyy1=")";}
                  else {
                	$xxx1="";
	                $yyx1="";}
                 $surpxx=number_format($suplusxx,2,',','.');
					
				 if ($suplus==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$suplus;
						$per1 = ($suplusx!=0)?($suplusx /  $suplus ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"45%\" align=\"right\"><b>SURPLUS/DEFISIT</b> &nbsp;&nbsp;&nbsp;&nbsp;</td>
                                     <td width=\"15%\" align=\"right\"><b>$x1$surp$y1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$xx1$surpx$yy1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$xxx1 $surpxx $yyy1</b></td>
									 <td width=\"5%\" align=\"center\"><b></b></td>
									</tr>";
                   
                    $sql3="SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
							IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek1 a INNER JOIN realisasi_bulan b
							ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='6'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
							UNION ALL 
							SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
							IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek2 a LEFT JOIN realisasi_bulan b
							ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='61' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
							UNION ALL 
							SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
							IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek3 a LEFT JOIN realisasi_bulan b
							ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='61'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3 ORDER BY kd_rek";
                 
                 $query3 = $this->db->query($sql3);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query3->result() as $row3)
                {
                    $coba9=$row3->rek;
                    $coba10=ucwords(strtolower($row3->nm_rek));
                    $coba11= number_format($row3->anggaran,"2",",",".");
					$coba11x=number_format($row3->realy,"2",",",".");
					$coba11xx=$row3->anggaran - $row3->realy;
					$coba11xxx=number_format($coba11xx,"2",",",".");

					if ($row3->anggaran==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$row3->anggaran;
						$per1 = ($row3->realy!=0)?($row3->realy /  $row3->anggaran ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                   if(strlen($coba9)<=3){
                        $coba9_= strtoupper($coba9);
                        $coba10_= strtoupper($coba10);
                        
                        $cRet .= "<tr><td width=\"10%\" valign=\"top\" align=\"center\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
									   <td width=\"45%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									   <td width=\"15%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									   <td width=\"15%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									   <td width=\"15%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									   <td width=\"5%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									</tr>";
                        if(strlen($coba9)==1){
                            $cRet    .= " <tr><td  width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"><b>$coba9_</b></td>                                     
                                     <td width=\"45%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba10_</b></td>
                                     <td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>&nbsp;</b></td>
										<td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>&nbsp;</b></td>
									   <td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>&nbsp;</b></td>
									   <td width=\"5%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>&nbsp;</b></td>
									 </tr>";
                        }else{
                            $cRet    .= " <tr>
										<td  width=\"10%\" valign=\"top\" align=\"left\" style=\"border-top:none;border-bottom:none;\"><b>$coba9_</b></td>
										<td width=\"45%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba10_</b></td>
										<td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba11</b></td>
										<td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba11x</b></td>
										<td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba11xxx</b></td>
										<td width=\"5%\" valign=\"top\" align=\"center\" style=\"border-top:none;border-bottom:none;\"><b>$persen1</b></td>
										</tr>";
                        }
                   }else{
                       $cRet    .= " <tr>
									<td  width=\"10%\" valign=\"top\" align=\"left\" style=\"border-top:none;border-bottom:none;\">$coba9</td>
									<td width=\"45%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba10</td>
                                     <td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba11</td>
									 <td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba11x</td>
									 <td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba11xxx</td>
									 <td width=\"5%\" valign=\"top\" align=\"center\" style=\"border-top:none;border-bottom:none;\">$persen1</td>
									</tr>";
                   }
                     
                }
                $sqltpm="SELECT SUM(anggaran) AS totpm, SUM(real_spj) AS realpm FROM realisasi_bulan WHERE LEFT(kd_rek5,2)='61'";
                 $sqlpm=$this->db->query($sqltpm);
                 foreach ($sqlpm->result() as $rowpm)
                {
                   $coba12=number_format($rowpm->totpm,"2",",",".");
                    $cob3=$rowpm->totpm;
					$cob3x=$rowpm->realpm;
				    $coba12x=number_format($cob3x,"2",",",".");
					$cob3xx=$cob3 - $cob3x;
					$cob3xxx=number_format($cob3xx,"2",",",".");
                   if ($cob3==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$cob3;
						$per1 = ($cob3x!=0)?($cob3x /  $cob3 ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);
                    $cRet    .= " <tr><td width=\"10%\" valign=\"top\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                      <td width=\"45%\" valign=\"top\" align=\"right\"><b>JUMLAH PEMBIAYAAN MASUK&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                      <td width=\"15%\" valign=\"top\" align=\"right\"><b>$coba12</b></td>
									  <td width=\"15%\" valign=\"top\" align=\"right\"><b>$coba12x</b></td>
									  <td width=\"15%\" valign=\"top\" align=\"right\"><b>$cob3xxx</b></td>
									  <td width=\"5%\" valign=\"top\" align=\"center\"><b>$persen1</b></td>
									</tr>";
                 }
                  
                $sql4="SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
						IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek2 a LEFT JOIN realisasi_bulan b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='62' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
						IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek3 a LEFT JOIN realisasi_bulan b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='62'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3 ORDER BY kd_rek";
                 
                 $query4 = $this->db->query($sql4);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query4->result() as $row4)
                {
                    $coba13=$row4->rek;
                    $coba14=ucwords(strtolower($row4->nm_rek));
                    $coba15= number_format($row4->anggaran,"2",",",".");
					$coba15x= number_format($row4->realy,"2",",",".");
					$coba15xx=$row4->anggaran - $row4->realy;
					$coba15xxx=number_format($coba15xx,"2",",",".");

					 if ($row4->anggaran==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$row4->anggaran;
						$per1 = ($row4->realy!=0)?($row4->realy /  $row4->anggaran ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                   if(strlen($coba13)<=3){
                        $coba13_= strtoupper($coba13);
                        $coba14_= strtoupper($coba14);

                        $cRet .= "<tr><td width=\"10%\" align=\"center\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
									<td width=\"45%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"5%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
								</tr>";
                        
                       $cRet    .= " <tr>
									<td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"><b>$coba13_</b></td>
                                     <td width=\"45%\" style=\"border-top:none;border-bottom:none;\"><b>$coba14_</b></td>
                                     <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba15</b></td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba15x</b></td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba15xxx</b></td>
									 <td width=\"5%\"  align=\"center\" style=\"border-top:none;border-bottom:none;\"><b>$persen1</b></td>
									</tr>";
                   }else{
                       $cRet    .= " <tr>
									<td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\">$coba13</td>                          
                                     <td width=\"45%\" style=\"border-top:none;border-bottom:none;\">$coba14</td>
                                     <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba15</td>
									<td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba15x</td>                          
                                     <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba15xxx</td>
                                     <td width=\"5%\" align=\"center\" style=\"border-top:none;border-bottom:none;\">$persen1</td>
									 </tr>";
                   }
                     
                }
                $sqltpk="SELECT SUM(anggaran) AS totpk,SUM(real_spj) AS realpk FROM realisasi_bulan WHERE LEFT(kd_rek5,2)='62'";
                 $sqlpk=$this->db->query($sqltpk);
                 foreach ($sqlpk->result() as $rowpk)
                {
                   $coba16=number_format($rowpk->totpk,"2",",",".");
				   $coba16x=number_format($rowpk->realpk,"2",",",".");
                    $cob4=$rowpk->totpk;
					$cob4x=$rowpk->realpk;
					$cob4xx=$cob4 - $cob4x;
					$cob4xxx=number_format($cob4xx,"2",",",".");

					if ($cob4==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$cob4;
						$per1 = ($cob4!=0)?($cob4x /  $cob4 ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);
                   
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"45%\" align=\"right\"><b>JUMLAH PEMBIAYAAN KELUAR&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba16</b></td>
									 <td width=\"15%\" align=\"right\"><b>$coba16x</b></td>
									 <td width=\"15%\" align=\"right\"><b>$cob4xxx</b></td>
									 <td width=\"5%\" align=\"center\"><b>$persen1</b></td>
									 </tr>";
                 }  
                  
                  $netto=$cob3-$cob4; 
                  if ($netto < 0){
                	$a1="(";
                	$netto=$netto*-1;
                	$b1=")";}
                  else {
                	$a1="";
	                $b1="";}
                 $nett=number_format($netto,2,',','.');
				 
				 $nettox=$cob3x-$cob4x; 
                  if ($nettox < 0){
                	$aa1="(";
                	$nettox=$nettox*-1;
                	$bb1=")";}
                  else {
                	$aa1="";
	                $bb1="";}
                 $nettx=number_format($nettox,2,',','.');

				 $nettoxx=$cob3xx-$cob4xx; 
                  if ($nettox < 0){
                	$aaa1="(";
                	$nettoxx=$nettoxx*-1;
                	$bbb1=")";}
                  else {
                	$aaa1="";
	                $bbb1="";}
                 $nettxx=number_format($nettoxx,2,',','.');
					
					if ($netto==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$netto;
						$per1 = ($nettox!=0)?($nettox /  $netto ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                    $cRet .= "<tr><td width=\"10%\" align=\"center\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
									<td width=\"45%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"5%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
							  </tr>";
                 
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"45%\" align=\"right\"><b>PEMBIAYAAN NETTO&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$a1$nett$b1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$aa1$nettx$bb1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$aaa1$nettxx$bbb1</b></td>
									 <td width=\"5%\" align=\"center\"><b>$persen1</b></td>
								</tr>";
                    $silpa=($cob1+$cob3)-($cob+$cob4);
                     if ($silpa < 0){
						$c1="(";
						$silpa=$silpa*-1;
						$d1=")";}
                    else {
						$c1="";
						$d1="";}
					$silp=number_format($silpa,2,',','.'); 
					
					$silpax=($cob1x+$cob3x)-($cobx+$cob4x);
                     if ($silpax < 0){
						$cc1="(";
						$silpax=$silpax*-1;
						$dd1=")";}
                    else {
						$cc1="";
						$dd1="";}
					$silpx=number_format($silpax,2,',','.'); 

					$silpaxx=($cob1xx+$cob3xx)-($cobxx+$cob4xx);
                     if ($silpaxx < 0){
						$ccc1="(";
						$silpaxx=$silpaxx*-1;
						$ddd1=")";}
                    else {
						$ccc1="";
						$ddd1="";}
					$silpxx=number_format($silpaxx,2,',','.'); 
					
					if ($silpa==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$silpa;
						$per1 = ($silpax!=0)?($silpax /  $silpa ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                    $cRet .= "<tr><td width=\"10%\" align=\"center\">&nbsp;</td>                            
								<td width=\"45%\">&nbsp;</td>
								<td width=\"15%\">&nbsp;</td>
								<td width=\"15%\">&nbsp;</td>
								<td width=\"15%\">&nbsp;</td>
								<td width=\"5%\">&nbsp;</td>
							</tr>";
                    
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\"><b>3.3</b></td>                                     
                                     <td width=\"45%\" ><b>SISA LEBIH PEMBIAYAAN ANGGARAN TAHUN BERKENAAN (SILPA)&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$c1$silp$d1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$cc1$silpx$dd1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$ccc1$silpxx$ddd1</b></td>
									 <td width=\"5%\" align=\"center\"><b></b></td>
									</tr>";
                    $cRet .="<tr>
                                <td width=\"100%\" align=\"left\" colspan=\"6\">
                                                    <table border=\"0\" cellpading = \"8\" width=\"100%\">
                                                        <tr>
                                                            <td width=\"90%\" align=\"left\">&nbsp;<br>&nbsp;
								<br>&nbsp;
								&nbsp;<br>
                                                                &nbsp;<br>
                                                                &nbsp;<br>
								&nbsp;	
                                                            </td>
                                                            <td width=\"30%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$last."
                                                                <p>BUPATI MAMBERAMO TENGAH</p>
                                                                <p>&nbsp;</p>
                                                                <br><br>
                                                                <br><b>$bupati</b>
                                                                <br>
                                                            </td>
                                                        </tr>
                                                    </table></td>
                             </tr>";
                    
        $cRet    .= "</table>";
        $data['prev']= $cRet;
        $this->template->set('title', 'CETAK PERDA');
       // $this->_mpdf1('',$cRet,25,10,10,'P','',$hal);
        switch($cetak) {
			case 0;
				 echo ("<title>L R A</title>"); 
				 echo $cRet;
			break;		
			case 1;
				 $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
			break;
			case 2;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");
				
				$this->load->view('anggaran/rka/perkadaII', $data);
			break;
			case 3;     
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
			break;
        
        }
    }

    function cetak_perkada_real_tambahan($ctk='',$skpd='',$awal='',$akhir=''){
         $cetak='1';        
         $id =$skpd;
         $date_awal = $awal;
         $date_akhir = $akhir;
         
        $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                   
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                }
       
        $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                }

        $cRet='';
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>RINCIAN LAPORAN REALISASI ANGGARAN MENURUT URUSAN PEMERINTAHAN DAERAH,ORGANISASI<br/>PENDAPATAN,BELANJA DAN PEMBIAYAAN </strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>
                  </table>";
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                    <tr>
                        <td width=\"20%\">Urusan Organisasi </td>
                        <td width=\"80%\">:$kd_urusan - $nm_urusan</td>
                    </tr>
                    <tr>
                        <td>Organisasi</td>
                        <td>:$kd_skpd - $nm_skpd</td>
                    </tr>";
        if ($cetak==2){ 
            $tgl_awal=$this->tukd_model->tanggal_format_indonesia($date_awal);
         $tgl_akhir=$this->tukd_model->tanggal_format_indonesia($date_akhir);
        $cRet .="<TR>                        
						<TD  align=\"left\" width=\"20%\" >PERIODE</TD>
						<TD align=\"left\" width=\"80%\" >:$tgl_awal s/d $tgl_akhir </TD>                      
					 </TR>";
        }            
        $cRet .="</table>";  
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Kode Rekening</b></td>                            
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"26%\" align=\"center\"><b>Uraian</b></td>                            
                            <td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"28%\" align=\"center\"><b>Jumlah (Rp.)</b></td>
                            <td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"16%\" align=\"center\"><b>Bertambah/ (berkurang)</b></td>
                            <td  rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"13%\" align=\"center\"><b>Dasar Hukum</b></td>                            
                            </tr>
                        <tr>
 		                     <td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Anggaran </td>
                             <td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Realisasi</td>
                             <td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\">Jumlah</td>
                             <td width=\"3%\" bgcolor=\"#CCCCCC\" align=\"center\">%</td>
                             
                        </tr>    
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>  
                            <td style=\"border-top: none;\"></td>                                                      
                         </tr>
                     </tfoot>
                        <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"26%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"3%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"14%\">&nbsp;</td>
                            </tr>
                        ";
                 if ($cetak==1){       
                 $sqltp="SELECT SUM(anggaran) AS totp_u,SUM(real_spj) AS realisasi FROM realisasi_bulan  WHERE kd_skpd='$id' AND LEFT(kd_rek5,1)='4' ";
                 }
                 
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                    $angp=number_format($rowp->totp_u,"2",".",",");
                    $angaranp=$rowp->totp_u;
                    $realp=$rowp->realisasi;
                    $nrealp=number_format($realp,"2",".",",");                    
                    $real_sp = $realp - $angaranp;
                    if ($real_sp < 0){
                    	$x1="("; $real_sp=$real_sp*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $pend_selisihp = number_format($real_sp,"2",".",",");
                    $per1p   = ($real_sp!=0)?($real_sp / $rowp->totp_u ) * 100:0; 
                    $persen1p= number_format($per1p);
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Pendapatan Daerah</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$angp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nrealp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisihp$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1p</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
                                     
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
                 }
                 if ($cetak==1){      
                 $sql_p="SELECT * FROM (SELECT a.kd_kegiatan AS kd_giat,LEFT(a.kd_rek5,2) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
				FROM realisasi_bulan a INNER JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' 
				GROUP BY a.kd_kegiatan ,LEFT(a.kd_rek5,2)
				UNION ALL
				SELECT a.kd_kegiatan AS kd_giat,LEFT(a.kd_rek5,3) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
				FROM realisasi_bulan a INNER JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' 
				GROUP BY a.kd_kegiatan ,LEFT(a.kd_rek5,3)
				UNION ALL
				SELECT a.kd_kegiatan AS kd_giat,LEFT(a.kd_rek5,5) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
				FROM realisasi_bulan a INNER JOIN ms_rek4 b ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' 
				GROUP BY a.kd_kegiatan ,LEFT(a.kd_rek5,5)
				UNION ALL
				SELECT a.kd_kegiatan AS kd_giat,a.kd_rek5 AS kd_rek,b.nm_rek5 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
				FROM realisasi_bulan a INNER JOIN ms_rek5 b ON a.kd_rek5=b.kd_rek5 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' 
				GROUP BY a.kd_kegiatan ,a.kd_rek5 ) a ORDER BY kd_rek";
                 }
                  
                 $pend = $this->db->query($sql_p);                           
                foreach ($pend->result() as $row)
                {
                    $giat=$row->kd_giat;
					$kode=$row->kd_rek;
                    $nama=$row->nm_rek;   
                    $ang=number_format($row->nilai_u,"2",".",",");
                    $angaran=$row->nilai_u;
                    $real=$row->realisasi;
                    $nreal=number_format($real,"2",".",",");                    
                    $real_s = $real - $angaran;
                    if ($real_s < 0){
                    	$x1="("; $real_s=$real_s*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $pend_selisih = number_format($real_s,"2",".",",");
                    $per1   = ($real_s!=0)?($real_s / $row->nilai_u ) * 100:0; 
                    $persen1= number_format($per1);

                    if (strlen($kode)<=3){
                   
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\"><b>$giat.$kode</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$ang</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nreal</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$pend_selisih$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
                                     </tr>";
                     }else{
                     	$cRet    .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$giat.$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
                                     </tr>";
                     }
                  }
                  
                   $cRet    .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";

            if ($cetak==1){       
                 $sqltp="SELECT SUM(anggaran) AS totp_u,SUM(real_spj) AS realisasi FROM realisasi_bulan  WHERE kd_skpd='$id' AND LEFT(kd_rek5,1)='5' ";
                 }
                 
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                    $angp=number_format($rowp->totp_u,"2",".",",");
                    $angaranp=$rowp->totp_u;
                    $realp=$rowp->realisasi;
                    $nrealp=number_format($realp,"2",".",",");                    
                    $real_sp = $realp - $angaranp;
                    if ($real_sp < 0){
                    	$x1="("; $real_sp=$real_sp*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $pend_selisihp = number_format($real_sp,"2",".",",");
                    $per1p   = ($real_sp!=0)?($real_sp / $rowp->totp_u ) * 100:0; 
                    $persen1p= number_format($per1p);
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Belanja Daerah</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$angp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nrealp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisihp$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1p</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
                                     
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
                 }
                

				if ($cetak==1){      
                 $sql_p="SELECT * FROM (
						SELECT LEFT(a.kd_kegiatan,18) AS kd_giat,'' AS kd_rek,b.nm_program AS nm_rek, SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a left JOIN trskpd b ON LEFT(a.kd_kegiatan,18)=b.kd_program WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='5' 
						GROUP BY LEFT(a.kd_kegiatan,18)
						UNION ALL
						SELECT kd_kegiatan AS kd_giat,'' AS kd_rek,a.nm_kegiatan AS nm_rek, SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a  WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='5' 
						GROUP BY a.kd_kegiatan
						UNION ALL
						SELECT a.kd_kegiatan AS kd_giat,LEFT(a.kd_rek5,2) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a left JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='5' 
						GROUP BY a.kd_kegiatan,b.kd_rek2
						UNION ALL
						SELECT a.kd_kegiatan AS kd_giat,LEFT(a.kd_rek5,3) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a left JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='5' 
						GROUP BY a.kd_kegiatan,b.kd_rek3
						UNION ALL
						SELECT a.kd_kegiatan AS kd_giat,LEFT(a.kd_rek5,5) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a left JOIN ms_rek4 b ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='5' 
						GROUP BY a.kd_kegiatan,b.kd_rek4
						UNION ALL
						SELECT a.kd_kegiatan AS kd_giat,a.kd_rek5 AS kd_rek,b.nm_rek5 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a left JOIN ms_rek5 b ON a.kd_rek5=b.kd_rek5 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='5' 
						GROUP BY a.kd_rek5 ) a ORDER BY kd_giat,kd_rek";
                 }
                  
                 $pend = $this->db->query($sql_p);                           
                foreach ($pend->result() as $row)
                {
                    $giat=$row->kd_giat;
					$kode=$row->kd_rek;
                    $nama=$row->nm_rek;   
                    $ang=number_format($row->nilai_u,"2",".",",");
                    $angaran=$row->nilai_u;
                    $real=$row->realisasi;
                    $nreal=number_format($real,"2",".",",");                    
                    $real_s = $real - $angaran;
                    if ($real_s < 0){
                    	$x1="("; $real_s=$real_s*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $pend_selisih = number_format($real_s,"2",".",",");
                    $per1   = ($real_s!=0)?($real_s / $row->nilai_u ) * 100:0; 
                    $persen1= number_format($per1);
                    if (strlen($kode)<=3){
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\"><b>$giat.$kode</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$ang</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$nreal</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$pend_selisih$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persen1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
                                     </tr>";
                      }else{
                      	 $cRet    .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$giat.$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
                                     </tr>";
                      }
                  }
                  
                   $cRet    .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";

                

				 if ($cetak==1){       
                 $sqltp="SELECT SUM(anggaran) AS totp_u,SUM(real_spj) AS realisasi FROM realisasi_bulan  WHERE kd_skpd='$id' AND LEFT(kd_rek5,1)='5' ";
                 }
                 
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                    $angp=number_format($rowp->totp_u,"2",".",",");
                    $angaranp=$rowp->totp_u;
                    $realp=$rowp->realisasi;
                    $nrealp=number_format($realp,"2",".",",");                    
                    $real_sp = $realp - $angaranp;
                    if ($real_sp < 0){
                    	$x1="("; $real_sp=$real_sp*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $pend_selisihp = number_format($real_sp,"2",".",",");
                    $per1p   = ($real_sp!=0)?($real_sp / $rowp->totp_u ) * 100:0; 
                    $persen1p= number_format($per1p);
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Jumlah Belanja Daerah</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$angp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nrealp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisihp$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1p</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
                                     
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
                 }
////----------------------------------------Pembiayaan
				if ($cetak==1){       
                 $sqltp="SELECT SUM(anggaran) AS totp_u,SUM(real_spj) AS realisasi FROM realisasi_bulan  WHERE kd_skpd='$id' AND LEFT(kd_rek5,1)='6' ";
                 }
                 
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                    $angp=number_format($rowp->totp_u,"2",".",",");
                    $angaranp=$rowp->totp_u;
                    $realp=$rowp->realisasi;
                    $nrealp=number_format($realp,"2",".",",");                    
                    $real_sp = $realp - $angaranp;
                    if ($real_sp < 0){
                    	$x1="("; $real_sp=$real_sp*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $pend_selisihp = number_format($real_sp,"2",".",",");
                    $per1p   = ($real_sp!=0)?($real_sp / $rowp->totp_u ) * 100:0; 
                    $persen1p= number_format($per1p);
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Pembiayaan Daerah</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$angp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nrealp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisihp$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1p</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
                                     
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
                 }
                

				if ($cetak==1){      
                 $sql_p="SELECT * FROM (
						SELECT LEFT(a.kd_kegiatan,18) AS kd_giat,'' AS kd_rek,b.nm_program AS nm_rek, SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a left JOIN trskpd b ON LEFT(a.kd_kegiatan,18)=b.kd_program WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='6' 
						GROUP BY LEFT(a.kd_kegiatan,18)
						UNION ALL
						SELECT kd_kegiatan AS kd_giat,'' AS kd_rek,a.nm_kegiatan AS nm_rek, SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a  WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='6' 
						GROUP BY a.kd_kegiatan
						UNION ALL
						SELECT a.kd_kegiatan AS kd_giat,LEFT(a.kd_rek5,2) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a left JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='6' 
						GROUP BY a.kd_kegiatan,b.kd_rek2
						UNION ALL
						SELECT a.kd_kegiatan AS kd_giat,LEFT(a.kd_rek5,3) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a left JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='6' 
						GROUP BY a.kd_kegiatan,b.kd_rek3
						UNION ALL
						SELECT a.kd_kegiatan AS kd_giat,LEFT(a.kd_rek5,5) AS kd_rek,b.nm_rek4 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a left JOIN ms_rek4 b ON LEFT(a.kd_rek5,5)=b.kd_rek4 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='6' 
						GROUP BY a.kd_kegiatan,b.kd_rek4
						UNION ALL
						SELECT a.kd_kegiatan AS kd_giat,a.kd_rek5 AS kd_rek,b.nm_rek5 AS nm_rek,SUM(a.anggaran)AS nilai_u,SUM(a.real_spj) AS realisasi
						FROM realisasi_bulan a left JOIN ms_rek5 b ON a.kd_rek5=b.kd_rek5 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='6' 
						GROUP BY a.kd_rek5 ) a ORDER BY kd_giat,kd_rek";
                 }
                  
                 $pend = $this->db->query($sql_p);                           
                foreach ($pend->result() as $row)
                {
                    $giat=$row->kd_giat;
					$kode=$row->kd_rek;
                    $nama=$row->nm_rek;   
                    $ang=number_format($row->nilai_u,"2",".",",");
                    $angaran=$row->nilai_u;
                    $real=$row->realisasi;
                    $nreal=number_format($real,"2",".",",");                    
                    $real_s = $real - $angaran;
                    if ($real_s < 0){
                    	$x1="("; $real_s=$real_s*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $pend_selisih = number_format($real_s,"2",".",",");
                    $per1   = ($real_s!=0)?($real_s / $row->nilai_u ) * 100:0; 
                    $persen1= number_format($per1);
                   
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">$giat.$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$ang</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nreal</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisih$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"left\"></td>
                                     </tr>";
                  }
                  
                   $cRet    .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";

                

				 if ($cetak==1){       
                 $sqltp="SELECT (SUM(totp_u61)-SUM(totp_u62)) AS totp_u ,(SUM(realisasi61)-SUM(realisasi62)) AS realisasi FROM(
						SELECT SUM(anggaran) AS totp_u61,SUM(real_spj) AS realisasi61,'' AS totp_u62,'' AS realisasi62 FROM realisasi_bulan  WHERE   kd_skpd='$id' and LEFT(kd_rek5,2)='61'
						UNION
						SELECT '' AS totp_u61,'' AS realisasi61,SUM(anggaran)  AS totp_u62,SUM(real_spj) AS realisasi62 FROM realisasi_bulan  WHERE  kd_skpd='$id' and LEFT(kd_rek5,2)='62'
						)w ";
                 }
                 
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                    $angp=number_format($rowp->totp_u,"2",".",",");
                    $angaranp=$rowp->totp_u;
                    $realp=$rowp->realisasi;
                    $nrealp=number_format($realp,"2",".",",");                    
                    $real_sp = $realp - $angaranp;
                    if ($real_sp < 0){
                    	$x1="("; $real_sp=$real_sp*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $pend_selisihp = number_format($real_sp,"2",".",",");
                    $per1p   = ($real_sp!=0)?($real_sp / $rowp->totp_u ) * 100:0; 
                    $persen1p= number_format($per1p);
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\">Jumlah Pembiayaan Netto</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$angp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$nrealp</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\">$x1$pend_selisihp$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\">$persen1p</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
                                     
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"26%\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
                                     </tr>";
                 }
				
            
                    $cRet .=       " </table>";
        $data['prev']= $cRet;
        $this->template->set('title', 'CETAK RINCIAN REALISASI');        
        $this->tukd_model->_mpdf('',$cRet,10,10,10,0);
    }

    function cetak_perda1_real_tambahan( $ctk = '',$lap = '', $skpd = ''){
        $id = $skpd;
        $cetak = $ctk;
        $laporan = $lap;

		$ww=$this->cetak_perda1_semester_tambahan('1',$laporan,$id);
        
    }

    function cetak_perda1_semester_tambahan($ctk = '',$lap = '', $skpd = ''){
        $id = $skpd;
        $cetak = 1;
        $laporan = $lap;

        if ($laporan <> '2')
        {
            $sts = '';
            $jurnal = '';
		    $zz=$this->cetak_lra_bulan('1','','','1');
        } else
        {
            $sts = "AND MONTH(d.tgl_sts)<='6'";
            $jurnal = "AND MONTH(d.tgl_voucher)<='6'";

        }
       
       
	   $sts = '';
	   $jurnal = '';           
       
        $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                }
                
         $sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$id' and kode='PA'";
                 $sqlttd=$this->db->query($sqlttd1);
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip=$rowttd->nip;                    
                    $namapa= $rowttd->nm;
                    $jabatan  = $rowttd->jab;
                }
       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang, no_qanun, tgl_qanun, no_perbup, tgl_perbup, bupati FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl     = $rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                    
                    $bupati     = $rowsc->bupati;
                    $no_qanun   = $rowsc->no_qanun;
                    $tgl_qanun  = $this->tukd_model->tanggal_format_indonesia($rowsc->tgl_qanun);
                    $no_perbup  = $rowsc->no_perbup;
                    $tgl_perbup = $rowsc->tgl_perbup;
                    
                }
        $jk=$this->rka_model->combo_skpd();
       
        $cRet='';
        
        if ($cetak == '1') {
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td rowspan=\"3\" align=\"left\" width=\"55%\"><strong></strong></td>
                         <td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"15%\"><strong><h5>LAMPIRAN I  :</h6></strong></td>
                         <td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>PERATURAN DAERAH</strong></h5></td>
                    </tr>
                    <tr> 
                         <td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>: $no_qanun</h5></td>
                    </tr>
                    <tr>
                        <td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>: $tgl_qanun</h5></td>
                    </tr>                                     
                   
                  </table>"; 
            }                 
             
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>RINGKASAN REALISASI APBD SEMESTER I</strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        if ($cetak == '1') {
            $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
                            <td width=\"20%\">Urusan Organisasi </td>
                            <td width=\"80%\">: $kd_urusan - $nm_urusan</td>
                        </tr>
                        <tr>
                            <td>Organisasi</td>
                            <td>: $kd_skpd - $nm_skpd </td>
                        </tr>
                    
                    </table>";      
        }
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NOMOR URUT</b></td>                            
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"40%\" align=\"center\"><b>URAIAN</b></td>
                            <td colspan=\"2\" bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>JUMLAH(Rp.)</b></td>
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>PROGNOSIS</b></td>
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>%</b></td>
						</tr>
						<tr>
							<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Anggaran</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Realisasi</b></td>
						</tr>
                     </thead>
					  <tfoot>
                        <tr><td style=\"border-bottom: none; border-left:none;border-right:none;\" colspan=\"6\"></td>
                     </tfoot>
                        <tr>
							<td  width=\"10%\" align=\"center\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
                               <td width=\"40%\">&nbsp;</td>
                               <td width=\"15%\">&nbsp;</td>
							    <td width=\"15%\">&nbsp;</td>
                               <td width=\"15%\">&nbsp;</td>
							    <td width=\"5%\">&nbsp;</td>
							 </tr>
                        ";
                 $sql1="SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,SUM(c.real_spj)AS realy FROM ms_rek1 a 
						INNER JOIN trdrka b ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) 
						INNER JOIN realisasi_bulan c ON a.kd_rek1=LEFT(c.kd_rek5,(LENGTH(a.kd_rek1)))AND c.kd_skpd=b.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan
						WHERE LEFT(a.kd_rek1,1)='4' AND b.kd_skpd='$id' GROUP BY a.kd_rek1,a.lra, a.nm_rek1
						UNION ALL 
						SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,SUM(c.real_spj)AS realy FROM ms_rek2 a 
						INNER JOIN trdrka b ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2)))
						INNER JOIN realisasi_bulan c ON a.kd_rek2=LEFT(c.kd_rek5,(LENGTH(a.kd_rek2)))AND c.kd_skpd=b.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan 
						WHERE LEFT(a.kd_rek2,1)='4' AND b.kd_skpd='$id' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,SUM(c.real_spj)AS realy FROM ms_rek3 a 
						INNER JOIN trdrka b ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) 
						INNER JOIN realisasi_bulan c ON a.kd_rek3=LEFT(c.kd_rek5,(LENGTH(a.kd_rek3)))AND c.kd_skpd=b.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan
						WHERE LEFT(a.kd_rek3,1)='4' AND b.kd_skpd='$id'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3 ORDER BY kd_rek";
                 
                 $query = $this->db->query($sql1);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query->result() as $row)
                {
                    $coba1=$row->rek;
                    $coba2=$row->nm_rek;
                    $coba3= number_format($row->nilai,"2",",",".");
					$coba4=number_format($row->realy,"2",",",".");
					$sisx=$row->nilai - $row->realy;
					$sis=number_format($sisx,"2",",",".");
					
					if ($row->realy < 0){
                    	$x1="("; $row->realy=$row->realy*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";
					}
                   
                    $perz   = ($row->realy!=0)?($row->realy / $row->nilai ) * 100:0; 
                    $persenz= number_format($perz,"2",".",",");  

                   if(strlen($coba1)<=3){
                        $cRet    .= " <tr>
										<td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"><b>$coba1</b></td>
										<td width=\"40%\" style=\"border-top:none;border-bottom:none;\"><b>$coba2</b></td>
										 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba3</b></td>
										 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba4</b></td>
										 <td width=\"10%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$sis</b></td>
										 <td width=\"5%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$persenz</b></td>
									 </tr>";
                    }else{
                        $cRet    .= " <tr>
										<td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\">$coba1</td>
										<td width=\"40%\"  style=\"border-top:none;border-bottom:none;\">$coba2</td>
										<td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba3</td>
										 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba4</td>
										  <td width=\"10%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$sis</td>
										 <td width=\"5%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$persenz</td>
									 </tr>";
                    }
                     
                }
                $sqltp="SELECT SUM(a.nilai_ubah) AS totp,sum(real_spj)as totpreal FROM trdrka a INNER JOIN realisasi_bulan b ON a.kd_rek5=b.kd_rek5 AND a.kd_skpd=b.kd_skpd and a.kd_kegiatan=b.kd_kegiatan WHERE LEFT(a.kd_rek5,1)='4' and a.kd_skpd='$id'";
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                   $coba4=number_format($rowp->totp,"2",",",".");
                    $cob1=$rowp->totp;
					 $cob2=$rowp->totpreal;
					 $sisx1= $cob1-$cob2;
					 $sisx2=number_format($sisx1,"2",",",".");
					  $coba3=number_format($rowp->totpreal,"2",",",".");

					if ($cob2 < 0){
                    	$x1="("; $cob2=$cob2*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";
					}
                   
                    $perx   = ($cob2!=0)?($rowp->totpreal / $rowp->totp ) * 100:0; 
                    $persenx= number_format($perx,"2",".",",");  
                   
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"40%\"><b>Jumlah Pendapatan</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba4</b></td>
									 <td width=\"15%\" align=\"right\"><b>$coba3</b></td>
									 <td width=\"15%\" align=\"right\"><b>$sisx2</b></td>
									 <td width=\"5%\" align=\"right\"><b>$persenx</b></td>
								</tr>
									 ";

                 }     
                $sql2="SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,SUM(c.real_spj) AS realy FROM ms_rek1 a 
						INNER JOIN trdrka b ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1)))
						LEFT JOIN realisasi_bulan c ON a.kd_rek1=LEFT(c.kd_rek5,(LENGTH(a.kd_rek1))) AND b.kd_skpd=c.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan
						WHERE LEFT(a.kd_rek1,1)='5' AND b.kd_skpd='$id' GROUP BY a.kd_rek1,a.lra, a.nm_rek1
						UNION ALL 
						SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,SUM(c.real_spj) AS realy FROM ms_rek2 a 
						INNER JOIN trdrka b ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2)))
						LEFT JOIN realisasi_bulan c ON a.kd_rek2=LEFT(c.kd_rek5,(LENGTH(a.kd_rek2)))AND c.kd_skpd=b.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan  
						WHERE LEFT(a.kd_rek2,1)='5' AND b.kd_skpd='$id' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,SUM(c.real_spj) AS realy FROM ms_rek3 a 
						INNER JOIN trdrka b ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3)))
						LEFT JOIN realisasi_bulan c ON a.kd_rek3=LEFT(c.kd_rek5,(LENGTH(a.kd_rek3)))AND c.kd_skpd=b.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan
						WHERE LEFT(a.kd_rek3,1)='5' AND b.kd_skpd='$id'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3 ORDER BY kd_rek";
                 
                 $query1 = $this->db->query($sql2);
                 foreach ($query1->result() as $row1)
                {
                    $coba5=$row1->rek;
                    $coba6=$row1->nm_rek;
                    $coba7= number_format($row1->nilai,"2",",",".");
					$coba8=number_format($row1->realy,"2",",",".");
					$sisax=$row1->nilai-$row1->realy;
					
                    if ($coba8 < 0){
                    	$x1="("; $coba8=$coba8*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                   
                    $per1   = ($coba8!=0)?($row1->realy / $row1->nilai ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");  
                   if(strlen($coba5)<=3){
                       $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"><b>$coba5</b></td>                                     
                                     <td width=\"40%\" style=\"border-top:none;border-bottom:none;\"><b>$coba6</b></td>
                                     <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba7</b></td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba8</b></td>
									<td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>".number_format($sisax,"2",",",".")."$</b></td>
									<td width=\"5%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$persen1</b></td></tr>";
                   }else{
                       $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\">$coba5</td>                                     
                                     <td width=\"40%\" style=\"border-top:none;border-bottom:none;\">$coba6</td>
                                     <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba7</td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba8</td>
									<td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">".number_format($sisax,"2",",",".")."$</td>
									<td width=\"5%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$persen1</td></tr>";
                   }
                }
                
                    $sqltb="SELECT SUM(a.nilai_ubah) AS totb,sum(real_spj)as totbreal FROM trdrka a INNER JOIN realisasi_bulan b ON a.kd_rek5=b.kd_rek5 AND a.kd_skpd=b.kd_skpd and a.kd_kegiatan=b.kd_kegiatan WHERE LEFT(a.kd_rek5,1)='5' and a.kd_skpd='$id'";
                    $sqlb=$this->db->query($sqltb);
                 foreach ($sqlb->result() as $rowb)
                {
                   $coba8=number_format($rowb->totb,"2",",",".");
                    $cob=$rowb->totb;
					$cobx=$rowb->totbreal;
					$coba9=number_format($rowb->totbreal,"2",",",".");
					$sisatb=$cob-$cobx;
					 if ($sisatb < 0){
                    	$x1="("; $sisatb=$sisatb*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                   
                    $per2   = ($sisatb!=0)?($rowb->totbreal / $rowb->totb ) * 100:0; 
                    $persen2= number_format($per2,"2",".",",");
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"40%\"><b>Jumlah Belanja</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba8</b></td>
									 <td width=\"15%\" align=\"right\"><b>$coba9</b></td>
									 <td width=\"15%\" align=\"right\"><b>".number_format($sisatb,"2",",",".")."</b></td>
									 <td width=\"5%\" align=\"right\"><b>$persen2</b></td>
									 </tr>";
                 } 
                  
                  $suplus=$cob1-$cob; 
                  if ($suplus < 0){
                	$x1="(";
                	$suplus=$suplus*-1;
                	$y1=")";}
                  else {
                	$x1="";
	                $y1="";}
                  $surp=number_format($suplus,2,',','.'); 
				  
				  $suplusx=$cob2-$cobx; 
                  if ($suplusx < 0){
                	$xx1="(";
                	$suplusx=$suplusx*-1;
                	$yy1=")";}
                  else {
                	$xx1="";
	                $yy1="";}
                 $surpx=number_format($suplusx,2,',','.');
				

				  $suplusxx=$suplus-$suplusx; 
                                    
                    $per3   = ($suplusxx!=0)?($suplusx / $suplus ) * 100:0; 
                    $persen3= number_format($per3,"2",".",",");
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"40%\"><b>Surplus/Defisit</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$x1$surp$y1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$xx1$surpx$yy1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$x1".number_format($suplusxx,2,',','.')."$y1</b></td>
									 <td width=\"5%\" align=\"right\"><b>$persen3</b></td>
									 </tr>";
                    
                    $sql3="SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,SUM(c.real_spj) AS realy FROM ms_rek1 a 
					INNER JOIN trdrka b ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1)))
					LEFT JOIN realisasi_bulan c ON a.kd_rek1=LEFT(c.kd_rek5,(LENGTH(a.kd_rek1))) AND b.kd_skpd=c.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan 
					WHERE LEFT(a.kd_rek1,1)='6' AND b.kd_skpd='$id' GROUP BY a.kd_rek1,a.lra, a.nm_rek1
					UNION ALL 
					SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,SUM(c.real_spj) AS realy FROM ms_rek2 a 
					INNER JOIN trdrka b ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2)))
					LEFT JOIN realisasi_bulan c ON a.kd_rek2=LEFT(c.kd_rek5,(LENGTH(a.kd_rek2))) AND b.kd_skpd=c.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan  
					WHERE LEFT(a.kd_rek2,2)='61' AND b.kd_skpd='$id' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
					UNION ALL 
					SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai_ubah) AS nilai,SUM(c.real_spj) AS realy FROM ms_rek3 a 
					INNER JOIN trdrka b ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) 
					LEFT JOIN realisasi_bulan c ON a.kd_rek3=LEFT(c.kd_rek5,(LENGTH(a.kd_rek3))) AND b.kd_skpd=c.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan 
					WHERE LEFT(a.kd_rek3,2)='61' AND b.kd_skpd='$id' GROUP BY a.kd_rek3,a.lra, a.nm_rek3 ORDER BY kd_rek";
                 
                 $query3 = $this->db->query($sql3);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query3->result() as $row3)
                {
                    $coba9=$row3->rek;
                    $coba10=$row3->nm_rek;
                    $coba11= number_format($row3->nilai,"2",",",".");
					$coba12= number_format($row3->realy,"2",",",".");
					$cobaw =$row3->nilai-$row3->realy;
					if ($cobaw < 0){
                    	$x1="("; $cobaw=$cobaw*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                   
                    $per3   = ($cobaw!=0)?($row3->realy / $row3->nilai ) * 100:0; 
                    $persen3= number_format($per3,"2",".",",");
                   
                     $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\">$coba9</td>                                     
                                     <td width=\"40%\" style=\"border-top:none;border-bottom:none;\">$coba10</td>
                                     <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba11</td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba12</td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">".number_format($cobaw,"2",",",".")."</td>
									 <td width=\"5%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$persen3</td>
									</tr>";
                }
                $sqltpm="SELECT SUM(nilai) AS totpm, sum(real_spj)as totpmreal FROM trdrka a INNER JOIN realisasi_bulan b ON a.kd_rek5=b.kd_rek5 AND a.kd_skpd=b.kd_skpd and a.kd_kegiatan=b.kd_kegiatan WHERE LEFT(a.kd_rek5,2)='61' and a.kd_skpd='$id'";
                 $sqlpm=$this->db->query($sqltpm);
                 foreach ($sqlpm->result() as $rowpm)
                {
                   $coba12=number_format($rowpm->totpm,"2",",",".");
                    $cob3=$rowpm->totpm;
					$cob3x=$rowpm->totpmreal;
				  $coba13=number_format($rowpm->totpmreal,"2",",",".");
				  $total= $rowpm->totpm - $rowpm->totpmreal;
				   if ($total < 0){
                    	$x1="("; $total=$total*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                   
                    $per3   = ($total!=0)?($rowpm->totbreal / $rowpm->totb ) * 100:0; 
                    $persen3= number_format($per3,"2",".",",");
                   
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"40%\"><b>Jumlah Pembiayaan Masuk </b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba12</b></td>
									 <td width=\"15%\" align=\"right\"><b>$coba13</b></td>
									 <td width=\"15%\" align=\"right\"><b>".number_format($total,"2",",",".")."</b></td>
									 <td width=\"5%\" align=\"right\"><b>$persen3</b></td>
									</tr>";
                 }     
                $sql4="SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,SUM(b.nilai) AS nilai,SUM(c.real_spj) AS realy FROM ms_rek2 a 
					INNER JOIN trdrka b ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2)))
					LEFT JOIN realisasi_bulan c ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) AND b.kd_skpd=c.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan 
					WHERE LEFT(a.kd_rek2,2)='62'  AND b.kd_skpd='$id' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
					UNION ALL 
					SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,SUM(b.nilai) AS nilai,SUM(c.real_spj) AS realy FROM ms_rek3 a 
					INNER JOIN trdrka b ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3)))
					LEFT JOIN realisasi_bulan c ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) AND b.kd_skpd=c.kd_skpd AND b.kd_rek5=c.kd_rek5 AND b.kd_kegiatan=c.kd_kegiatan 
					WHERE LEFT(a.kd_rek3,2)='62'  AND b.kd_skpd='$id' GROUP BY a.kd_rek3,a.lra, a.nm_rek3 ORDER BY kd_rek";
                 
                 $query4 = $this->db->query($sql4);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query4->result() as $row4)
                {
                    $coba13=$row4->rek;
                    $coba14=$row4->nm_rek;
                    $coba15= number_format($row4->nilai,"2",",",".");
					$coba16= number_format($row4->realy,"2",",",".");
					$coba17= $row4->nilai-$row4->realy;
					
				   if ($coba17 < 0){
                    	$x1="("; $coba17=$coba17*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                   
                    $per3   = ($coba17!=0)?($row4->realy / $row4->nilai ) * 100:0; 
                    $persen3= number_format($per3,"2",".",",");
                   if(strlen($coba13)<=3){
                       $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"><b>$coba13</b></td>                                     
                                     <td width=\"40%\" style=\"border-top:none;border-bottom:none;\"><b>$coba14</b></td>
                                     <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba15</b></td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba16</b></td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>".number_format($coba17,"2",",",".")."</b></td>
									 <td width=\"5%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$persen3</td></tr>";
                   }else{
                       $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\">$coba13</td>                                     
                                     <td width=\"40%\" style=\"border-top:none;border-bottom:none;\">$coba14</td>
                                     <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba15</td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba16</td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">".number_format($coba17,"2",",",".")."</td>
									 <td width=\"5%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$persen3</td></tr>";
                   }
                }
                $sqltpk="SELECT SUM(nilai) AS totpk, sum(real_spj)as totpkreal FROM trdrka a INNER JOIN realisasi_bulan b ON a.kd_rek5=b.kd_rek5 AND a.kd_skpd=b.kd_skpd and a.kd_kegiatan=b.kd_kegiatan WHERE LEFT(a.kd_rek5,2)='62' and a.kd_skpd='$id'";
                 $sqlpk=$this->db->query($sqltpk);
                 foreach ($sqlpk->result() as $rowpk)
                {
                   $coba16=number_format($rowpk->totpk,"2",",",".");
                    $cob4=$rowpk->totpk;
					$cob4x=$rowpk->totpkreal;
					 $coba17=number_format($rowpk->totpkreal,"2",",",".");
                    $total2= $rowpk->totpk - $rowpk->totpkreal;
				   if ($total2 < 0){
                    	$x1="("; $total2=$total2*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                   
                    $per4   = ($total2!=0)?($rowpk->totpkreal / $rowpk->totpk ) * 100:0; 
                    $persen4= number_format($per4,"2",".",",");
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"40%\"><b>Jumlah Pembiayaan Keluar</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba16</b></td>
									 <td width=\"15%\" align=\"right\"><b>$coba17</b></td>
									 <td width=\"15%\" align=\"right\"><b>".number_format($total2,"2",",",".")."</b></td>
									 <td width=\"5%\" align=\"right\"><b>$persen4</b></td>
									</tr>";
                 }  
                  
                  $netto=$cob3-$cob4; 
                  if ($netto < 0){
                	$a1="(";
                	$suplus=$netto*-1;
                	$b1=")";}
                  else {
                	$a1="";
	                $b1="";}
                 $nett=number_format($netto,2,',','.'); 
				 
				 $nettox=$cob3x-$cob4x; 
                  if ($nettox < 0){
                	$aa1="(";
                	$suplusx=$nettox*-1;
                	$bb1=")";}
                  else {
                	$aa1="";
	                $bb1="";}
                 $nettx=number_format($nettox,2,',','.');  

				 $nettoxx=$netto-$nettox; 
                  if ($nettoxx < 0){
                	$aaa1="(";
                	$suplusxx=$nettoxx*-1;
                	$bbb1=")";}
                  else {
                	$aaa1="";
	                $bbb1="";}
                 $nettxx=number_format($nettoxx,2,',','.');
				 
				  $per3   = ($nettoxx!=0)?($netto / $nettox ) * 100:0; 
                  $persen3= number_format($per3,"2",".",",");
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"40%\"><b>Pembiayaan Netto</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$a1$nett$b1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$aa1$nettx$bb1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$aaa1$nettxx$bbb1</b></td>
									 <td width=\"5%\" align=\"right\"><b> $persen3</b></td>
								</tr>";
                    $silpa=($cob1+$cob3)-($cob+$cob4);
                     if ($silpa < 0){
                		$c1="(";
                		$silpa=$silpa*-1;
                		$d1=")";
					}else {
                		$c1="";
						$d1="";
					}
                 $silp=number_format($silpa,2,',','.');  
				 
				 $silpax=($cob2+$cob3x)-($cobx+$cob4x);
                     if ($silpax < 0){
                		$cc1="(";
                		$silpax=$silpax*-1;
                		$dd1=")";
					}else {
                		$cc1="";
						$dd1="";
					}
                 $silpx=number_format($silpax,2,',','.');  

				  $silpaxx=$silpa-$silpax;
                 $silpxx=number_format($silpaxx,2,',','.');
				   $per3   = ($silpaxx!=0)?($silpax / $silpa ) * 100:0; 
                  $persen3= number_format($per3,"2",".",",");
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"40%\"><b>Sisa Lebih Pembiayaan(SILPA)</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$c1$silp$d1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$cc1$silpx$dd1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$c1$silpxx$d1</b></td>
									 <td width=\"5%\" align=\"right\"><b>$persen3</b></td>
								</tr>";
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                                     
                                     <td width=\"40%\">&nbsp;</td>
                                     <td width=\"15%\" align=\"right\">&nbsp;</td>
									 <td width=\"15%\" align=\"right\"><b></b></td>
									 <td width=\"15%\" align=\"right\"><b></b></td>
									 <td width=\"5%\" align=\"right\"><b></b></td>
								</tr>";
        $cRet    .= "</table>";
		   $date=date('Y-m-t');
        $cRet .= "<br><table width=\"100%\" border=\"0\" cellpading = \"8\">
                                <tr>
                                    <td width=\"60%\" align=\"left\">&nbsp;<br>&nbsp;
                                        <br>&nbsp;
                                        &nbsp;<br>
                                        &nbsp;<br>
                                        &nbsp;<br>
                                        &nbsp;	
                                    </td>
                                    <td width=\"40%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($date)."
                                        <p><b>$jabatan</b></p>
                                        <p>&nbsp;</p>
                                        <br><br>
                                        <br><b><u>$namapa</u></b>
                                        <br>$nip</b>
                                    </td>
                                </tr>";
         $cRet .=       " </table>";
        $data['prev']= $cRet;
        $this->template->set('title', 'CETAK PERDA'); 
		$skpdx  = $kd_skpd.' '. $nm_skpd;
        switch($cetak){   
        case 1;
			  $this->tukd_model->_mpdf('',$cRet,15,10,10,'0');
			break;
        case 0;
			$this->template->load('template','anggaran/rka/perda1_skpd',$data);
			break;
        case 2;        
			header("Cache-Control: no-cache, no-store, must-revalidate");
			header("Content-Type: application/vnd.ms-excel");
			header("Content-Disposition: attachment; filename=PERDA.xls");
			$this->load->view('anggaran/rka/perda1_skpd', $data);
        break;
        }           

	 }

	 function cetak_perdaII_real_tambahan(){
	   $cetak=$this->uri->segment(3);
       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang, no_qanun, tgl_qanun, no_perbup, tgl_perbup, bupati FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl     = $rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                    
                    $bupati     = $rowsc->bupati;
                    $no_qanun   = $rowsc->no_qanun;
                    $tgl_qanun  = $this->tukd_model->tanggal_format_indonesia($rowsc->tgl_qanun);
                    $no_perbup  = $rowsc->no_perbup;
                    $tgl_perbup = $rowsc->tgl_perbup;
                    
                } 
        
        $cRet='';
		  $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
                         <td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"10%\"><strong><h5>LAMPIRAN II  :</h6></strong></td>
                         <td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>PERATURAN DAERAH</strong></h5></td>
                    </tr>
                    <tr> 
                         <td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>: $no_qanun</h5></td>
                    </tr>
                    <tr>
                        <td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>: $tgl_qanun</h5></td>
                    </tr>
                                         
                   
                  </table>
				<br>";
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>RINGKASAN REALISASI APBD MENURUT URUSAN PEMERINTAHAN DAERAH DAN ORGANISASI </strong></td>
                    </tr>
                    
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>

                  </table><br>";  
        
        $cRet .= "<table style=\"border-collapse:collapse;font-size:14;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>KODE</b></td>                            
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"28%\" align=\"center\"><b>URUSAN PEMERINTAH DAERAH</b></td>
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"13%\" align=\"center\"><b>PENDAPATAN</b></td>
                            <td colspan=\"3\" bgcolor=\"#CCCCCC\" width=\"39%\" align=\"center\"><b>BELANJA</b></td>
							 <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"13%\" align=\"center\"><b>REALISASI<br>PENDAPATAN</b></td>
							 <td colspan=\"3\" bgcolor=\"#CCCCCC\" width=\"39%\" align=\"center\"><b>REALISASI BELANJA</b></td>
                         </tr>
                        <tr>
 		                    <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">TIDAK LANGSUNG</td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">LANGSUNG</td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">JUMLAH BELANJA</td>
							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">TIDAK LANGSUNG</td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">LANGSUNG</td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">JUMLAH BELANJA</td>
                        </tr>
						<tr>
							<td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\" style=\"border-top:none;\">1</td> 
                            <td bgcolor=\"#CCCCCC\" width=\"28%\" align=\"center\" style=\"border-top:none;\">2</td>
                            <td bgcolor=\"#CCCCCC\" width=\"13%\" align=\"center\" style=\"border-top:none;\">3</td>
							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">4</td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">5</td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">6= 4+5</td>
							<td width=\"13%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">7</td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">8</td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">9</td>
							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\" style=\"border-top:none;\">10= 8+9</td>
						</tr>
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>    
							<td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td> 
                         </tr>
                     </tfoot>
                    
                     
                        <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"28%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\">&nbsp;</td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\">&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\">&nbsp;</td>
						</tr>
                        ";
                 $sql1="SELECT
							a.kd_urusan1 AS kode,
							a.nm_urusan1 AS nama,
							SUM(IF(LEFT(x.kd_rek5,1)='4',x.anggaran,0)) AS pendapatan,
							SUM(IF(LEFT(x.kd_rek5,2)='51',x.anggaran,0)) AS btl,
							SUM(IF(LEFT(x.kd_rek5,2)='52',x.anggaran,0)) AS bl,
							SUM(IF(LEFT(x.kd_rek5,1)='5',x.anggaran,0)) AS jumlah,
							SUM(IF(LEFT(x.kd_rek5,1)='4',x.real_spj,0)) AS rpendapatan,
							SUM(IF(LEFT(x.kd_rek5,2)='51',x.real_spj,0)) AS rbtl,
							SUM(IF(LEFT(x.kd_rek5,2)='52',x.real_spj,0)) AS rbl,
							SUM(IF(LEFT(x.kd_rek5,1)='5',x.real_spj,0)) AS rjumlah
							FROM
							realisasi_bulan X
							LEFT JOIN ms_urusan1 a ON  LEFT(x.kd_skpd,1)=a.kd_urusan1 
							GROUP BY  a.kd_urusan1 ,a.nm_urusan1


							UNION

							SELECT
							a.kd_urusan AS kode,
							a.nm_urusan AS nama,
							SUM(IF(LEFT(x.kd_rek5,1)='4',x.anggaran,0)) AS pendapatan,
							SUM(IF(LEFT(x.kd_rek5,2)='51',x.anggaran,0)) AS btl,
							SUM(IF(LEFT(x.kd_rek5,2)='52',x.anggaran,0)) AS bl,
							SUM(IF(LEFT(x.kd_rek5,1)='5',x.anggaran,0)) AS jumlah,
							SUM(IF(LEFT(x.kd_rek5,1)='4',x.real_spj,0)) AS rpendapatan,
							SUM(IF(LEFT(x.kd_rek5,2)='51',x.real_spj,0)) AS rbtl,
							SUM(IF(LEFT(x.kd_rek5,2)='52',x.real_spj,0)) AS rbl,
							SUM(IF(LEFT(x.kd_rek5,1)='5',x.real_spj,0)) AS rjumlah
							FROM
							realisasi_bulan X
							LEFT JOIN ms_urusan a ON LEFT(x.kd_skpd,4)=a.kd_urusan 
							GROUP BY  a.kd_urusan ,a.nm_urusan

							UNION

							SELECT
							a.kd_skpd AS kode,
							a.nm_skpd AS nama,
							SUM(IF(LEFT(x.kd_rek5,1)='4',x.anggaran,0)) AS pendapatan,
							SUM(IF(LEFT(x.kd_rek5,2)='51',x.anggaran,0)) AS btl,
							SUM(IF(LEFT(x.kd_rek5,2)='52',x.anggaran,0)) AS bl,
							SUM(IF(LEFT(x.kd_rek5,1)='5',x.anggaran,0)) AS jumlah,
							SUM(IF(LEFT(x.kd_rek5,1)='4',x.real_spj,0)) AS rpendapatan,
							SUM(IF(LEFT(x.kd_rek5,2)='51',x.real_spj,0)) AS rbtl,
							SUM(IF(LEFT(x.kd_rek5,2)='52',x.real_spj,0)) AS rbl,
							SUM(IF(LEFT(x.kd_rek5,1)='5',x.real_spj,0)) AS rjumlah
							FROM
							realisasi_bulan X
							LEFT JOIN ms_skpd a ON x.kd_skpd=a.kd_skpd WHERE x.kd_skpd !='1.20.03.01' AND x.kd_skpd !='1.20.03.02'
                            AND x.kd_skpd !='1.20.03.03'
							GROUP BY a.kd_skpd,a.nm_skpd
							ORDER BY kode";
                 
                 $query = $this->db->query($sql1);
                 //$query = $this->skpd_model->getAllc();
                 
				 
				//tambahan sekda
				$sqlzz=$this->db->query("SELECT
						  a.kd_skpd AS kode,
						  a.nm_skpd AS nama,
						  SUM(IF(LEFT(x.kd_rek5,1)='4',x.anggaran,0)) AS pendapatan,
						  SUM(IF(LEFT(x.kd_rek5,2)='51',x.anggaran,0)) AS btl,
						  SUM(IF(LEFT(x.kd_rek5,2)='52',x.anggaran,0)) AS bl,
						  SUM(IF(LEFT(x.kd_rek5,1)='5',x.anggaran,0)) AS jumlah,
						  SUM(IF(LEFT(x.kd_rek5,1)='4',x.real_spj,0)) AS rpendapatan,
							SUM(IF(LEFT(x.kd_rek5,2)='51',x.real_spj,0)) AS rbtl,
							SUM(IF(LEFT(x.kd_rek5,2)='52',x.real_spj,0)) AS rbl,
							SUM(IF(LEFT(x.kd_rek5,1)='5',x.real_spj,0)) AS rjumlah
						FROM
						  realisasi_bulan X
						  LEFT JOIN ms_skpd a ON x.kd_skpd=a.kd_skpd 
						  WHERE LEFT(x.kd_skpd,7)='1.20.03' GROUP BY LEFT(a.kd_skpd,7) ");
				
				foreach($sqlzz->result() as $row1){
                    $pend1=number_format($row1->pendapatan,"2",",",".");
                    $btl1= number_format($row1->btl,"2",",",".");
                    $bl1= number_format($row1->bl,"2",",",".");
                    $jum1= number_format($row1->jumlah,"2",",",".");
					$rpend1=number_format($row1->rpendapatan,"2",",",".");
                    $rbtl1= number_format($row1->rbtl,"2",",",".");
                    $rbl1= number_format($row1->rbl,"2",",",".");
                    $rjum1= number_format($row1->rjumlah,"2",",",".");
					
				}								  
				
                foreach ($query->result() as $row)
                {
                    $kode=$row->kode;
                    $nama=$row->nama;
                    $pend=number_format($row->pendapatan,"2",",",".");
                    $btl= number_format($row->btl,"2",",",".");
                    $bl= number_format($row->bl,"2",",",".");
                    $jum= number_format($row->jumlah,"2",",",".");
					$rpend=number_format($row->rpendapatan,"2",",",".");
                    $rbtl= number_format($row->rbtl,"2",",",".");
                    $rbl= number_format($row->rbl,"2",",",".");
                    $rjum= number_format($row->rjumlah,"2",",",".");
					
                   if(strlen($kode) <=5){
                     $cRet    .= "<br></br>
									<br></br>
					 
									<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"28%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$pend</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$btl</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$bl</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$jum</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rpend</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rbtl</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rbl</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rjum</b></td>
									</tr>

                                     ";
				   }else{
					   if($kode=='1.20.03.00'){
						
						$cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"28%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\">$pend1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$btl1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$bl1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$jum1</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rpend1</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rbtl1</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rbl1</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rjum1</td>
									</tr>";					   
					   }else{
						$cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\">$kode</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"28%\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\">$pend</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$btl</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$bl</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$jum</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rpend</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rbtl</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rbl</td>
									<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rjum</td>
									</tr>";
					   }
				   }
        
                  }  

				  $sqlww=$this->db->query("SELECT 
							  SUM(IF(LEFT(x.kd_rek5,1)='4',x.anggaran,0)) AS pendapatan1,
                              SUM(IF(LEFT(x.kd_rek5,2)='51',x.anggaran,0)) AS btl1,
                              SUM(IF(LEFT(x.kd_rek5,2)='52',x.anggaran,0)) AS bl1,
                              SUM(IF(LEFT(x.kd_rek5,1)='5',x.anggaran,0)) AS jumlah1,
							  SUM(IF(LEFT(x.kd_rek5,1)='4',x.real_spj,0)) AS rpendapatan1,
                              SUM(IF(LEFT(x.kd_rek5,2)='51',x.real_spj,0)) AS rbtl1,
                              SUM(IF(LEFT(x.kd_rek5,2)='52',x.real_spj,0)) AS rbl1,
                              SUM(IF(LEFT(x.kd_rek5,1)='5',x.real_spj,0)) AS rjumlah1
                            FROM realisasi_bulan X");
				foreach($sqlww->result() as $roww){
					$pendapatan1=number_format($roww->pendapatan1,2,',','.');
					$btl1=number_format($roww->btl1,2,',','.');
					$bl1=number_format($roww->bl1,2,',','.');
					$jumlah1=number_format($roww->jumlah1,2,',','.');
					$rpendapatan1=number_format($roww->rpendapatan1,2,',','.');
					$rbtl1=number_format($roww->rbtl1,2,',','.');
					$rbl1=number_format($roww->rbl1,2,',','.');
					$rjumlah1=number_format($roww->rjumlah1,2,',','.');
				
				}

					$cRet    .= " <tr><td style=\"vertical-align:justify;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\"><b>&nbsp;<b></td>                                     
                                     <td style=\"vertical-align:justify;border-top: solid 1px black;border-bottom: none;\" width=\"28%\" align=\"center\"><b>TOTAL<b></td>    
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$pendapatan1</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$btl1</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$bl1</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$jumlah1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rpendapatan1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rbtl1</b></td>
									<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rbl1</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rjumlah1</b></td>
								</tr>
									";

        $cRet .=       " </table>";
		   $date=date('Y-m-t');
        $cRet .= "<br><table width=\"100%\" border=\"0\" cellpading = \"8\">
                                <tr>
                                    <td width=\"60%\" align=\"left\">&nbsp;<br>&nbsp;
                                        <br>&nbsp;
                                        &nbsp;<br>
                                        &nbsp;<br>
                                        &nbsp;<br>
                                        &nbsp;	
                                    </td>
                                    <td width=\"40%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($date)."
                                        <p><b>BUPATI MAMBERAMO TENGAH</b></p>
                                        <p>&nbsp;</p>
                                        <br><br>
                                        <br><b>$bupati</b>
                                        <br></b>
                                    </td>
                                </tr>";
         $cRet .=       " </table>";
        $data['prev']= $cRet;
		$this->template->set('title', 'CETAK PERDA LAMPIRAN II');        
        
        switch($cetak) {
        case 1;
			$this->tukd_model->_mpdf('',$cRet,10,10,10,'1');
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= PERDAII.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        
        }
        
                
    }

    

    function cetak_perdaIII_real_tambahan($cetak=''){
		 $cetak=$cetak;      
         $id   = $this->uri->segment(4);

        $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                }

	    $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang, no_qanun, tgl_qanun, no_perbup, tgl_perbup, bupati FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl     = $rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                    
                    $bupati     = $rowsc->bupati;
                    $no_qanun   = $rowsc->no_qanun;
                    $tgl_qanun  = $this->tukd_model->tanggal_format_indonesia($rowsc->tgl_qanun);
                    $no_perbup  = $rowsc->no_perbup;
                    $tgl_perbup = $rowsc->tgl_perbup;
                    
                }
        $sqlttd1="SELECT nama as nm,nip as nip,jabatan as jab FROM ms_ttd where kd_skpd='$id' and kode='PA'";
                 $sqlttd=$this->db->query($sqlttd1);
				 $z=0;
                 foreach ($sqlttd->result() as $rowttd)
                {
                    $nip=$rowttd->nip;                    
                    $namapa= $rowttd->nm;
                    $jabatan  = $rowttd->jab;
					$z++;
                }
		if($z == '0'){
			 $nip='Belum ada Nip';                    
			 $namapa= 'Belum ada nama';
			 $jabatan  = 'Belum ada jabatan';
		}
       
        $cRet='';
        
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td rowspan=\"3\" align=\"left\" width=\"55%\"><strong></strong></td>
                         <td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"15%\"><strong><h5>LAMPIRAN III:</h6></strong></td>
                         <td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>PERATURAN DAERAH</strong></h5></td>
                    </tr>
                    <tr> 
                         <td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>: $no_qanun</h5></td>
                    </tr>
                    <tr>
                        <td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>: $tgl_qanun</h5></td>
                    </tr>
                                         
                   
                  </table>"; 
                           
             
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>RINGKASAN REALISASI APBD </strong></td>
                    </tr>
                    
                    <tr>
                         <td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>

                  </table><br>";
       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                    <tr>
                        <td width=\"20%\">Urusan Organisasi </td>
                        <td width=\"80%\">: $kd_urusan - $nm_urusan</td>
                    </tr>
                    <tr>
                        <td>Organisasi</td>
                        <td>: $kd_skpd - $nm_skpd</td>
                    </tr>
                    
                </table>";        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td rowspan =\"2\" bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>NOMOR URUT</b></td>                            
                            <td rowspan =\"2\" bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>URAIAN</b></td>
                            <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;border-bottom;\" colspan =\"2\" bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>JUMLAH(Rp.)</b></td>
                            <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;border-bottom;\" colspan =\"2\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>LEBIH</br>(BERKURANG)</b></td>
                            <td rowspan =\"2\" bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>DASAR HUKUM</b></td>
                        </tr>
                        <tr><td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>Anggaran</b></td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>Realisasi</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>(Rp.)</b></td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>%</b></td>
                        </tr>
                     </thead>
                     
                       <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
                         </tr>
                    </tfoot>
                                                
                        ";
                 $sql1="SELECT * FROM (SELECT  CONCAT(a.kd_kegiatan, '.4') AS kd_rek,c.nm_kegiatan AS nm_rek,SUM(d.anggaran)AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trskpd a INNER JOIN m_giat c ON a.kd_kegiatan1=c.kd_kegiatan
                        LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						LEFT JOIN realisasi_bulan d ON a.kd_skpd=d.kd_skpd AND a.kd_kegiatan=d.kd_kegiatan AND b.kd_rek5=d.kd_rek5
						WHERE a.kd_skpd='$id' AND LEFT(b.kd_rek5,1)='4' GROUP BY a.kd_kegiatan,c.nm_kegiatan 
                        UNION ALL
                        SELECT CONCAT(a.kd_kegiatan,'.',LEFT(a.kd_rek5,2)) AS kd_rek,b.nm_rek2 AS nm_rek,SUM(d.anggaran)AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trdrka a LEFT JOIN ms_rek2 b ON LEFT(a.kd_rek5,2)=b.kd_rek2 
						LEFT JOIN realisasi_bulan d ON a.kd_skpd=d.kd_skpd AND a.kd_kegiatan=d.kd_kegiatan AND a.kd_rek5=d.kd_rek5 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,24),b.nm_rek2
                        UNION ALL
                        SELECT CONCAT(a.kd_kegiatan,'.',LEFT(a.kd_rek5,3)) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(d.anggaran)AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trdrka a LEFT JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
						LEFT JOIN realisasi_bulan d ON a.kd_skpd=d.kd_skpd AND a.kd_kegiatan=d.kd_kegiatan AND a.kd_rek5=d.kd_rek5 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,1)='4' GROUP BY SUBSTR(a.no_trdrka,12,25),b.nm_rek3
                        ) a ORDER BY kd_rek";
                 
                 $query = $this->db->query($sql1);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query->result() as $row)
                {
                    $coba1  = $row->kd_rek;
                    $coba2  = $row->nm_rek;
                    $coba3  = number_format($row->nilai,"2",".",",");
                    $coba3u = number_format($row->nilai_ubah,"2",".",",");
                    $rumus1 = $row->nilai_ubah - $row->nilai;
                    if ($rumus1 < 0){
                    	$x1="("; $rumus1=$rumus1*-1; $y1=")";}
                    else {
                    	$x1=""; $y1="";}
                    $total1 = number_format($rumus1,"2",".",",");  
                    $per1   = ($rumus1!=0)?($row->nilai_ubah / $row->nilai ) * 100:0; 
                    $persen1= number_format($per1,"2",".",",");    
                    
                    if(strlen($coba1)<=24){
		                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"><b>$coba1</b></td>                                     
		                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"><b>$coba2</b></td>
		                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$coba3</b></td>
		                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$coba3u</b></td>
		                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$total1$y1</b></td>
		                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen1</b></td>
		                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
		                                </tr>";
                        }else{
                        	$cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\">$coba1</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\">$coba2</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$coba3</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$coba3u</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$total1$y1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\">$persen1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>";
                        }
                }
                $sqltp="SELECT SUM(anggaran) AS totp, SUM(real_spj) as totp_ubah FROM realisasi_bulan WHERE LEFT(kd_rek5,1)='4' and kd_skpd='$id'";
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                   $coba4=number_format($rowp->totp,"2",".",",");
                   $coba4u=number_format($rowp->totp_ubah,"2",".",",");
                   $rumus2 = $rowp->totp_ubah - $rowp->totp;
                   if ($rumus2 < 0){
                        $x1="("; $rumus2=$rumus2*-1; $y1=")";}
                   else {
                        $x1=""; $y1="";}
                   $total2 = number_format($rumus2,"2",".",",");  
                   $per2   = ($rumus2!=0)?($rowp->totp_ubah / $rowp->totp ) * 100:0; 
                   $persen2= number_format($per2,"2",".",",");
                   $cob1=$rowp->totp;
                   $cob1u=$rowp->totp_ubah;
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"><b>JUMLAH PENDAPATAN</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$coba4</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$coba4u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$total2$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen2</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>";
                                     
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\">&nbsp;</td>
                                </tr>";
                 } 
                 
                 $sqltb="SELECT concat(a.kd_kegiatan, '.', 5) as kd_rek,SUM(b.anggaran) AS totb,SUM(b.real_spj) AS totb_ubah FROM trdrka a 
						LEFT JOIN realisasi_bulan b ON a.kd_skpd=b.kd_skpd AND a.kd_kegiatan=b.kd_kegiatan AND a.kd_rek5=b.kd_rek5 
						WHERE LEFT(a.kd_rek5,1)='5' AND a.kd_skpd='$id'";
                    $sqlb=$this->db->query($sqltb);
                 foreach ($sqlb->result() as $rowb)
                {
                   $jmlb=number_format($rowb->totb,"2",".",",");
                   $jmlbu=number_format($rowb->totb_ubah,"2",".",",");
				   $cob11  = $rowb->kd_rek;
                   $cob=$rowb->totb;
                   $cobu=$rowb->totb_ubah;
                   $rumus3 = $rowb->totb_ubah - $rowb->totb;
                   if ($rumus3 < 0){
                        $x1="("; $rumus3=$rumus3*-1; $y1=")";}
                   else {
                        $x1=""; $y1="";}
                   $total3 = number_format($rumus3,"2",".",",");  
                   $per3   = ($rumus3!=0)?($rowb->totb_ubah / $rowb->totb ) * 100:0; 
                   $persen3= number_format($per3,"2",".",",");
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: nonek;border-bottom: none;\" width=\"20%\" align=\"left\">$cob11</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"><b>BELANJA DAERAH</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$jmlb</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$jmlbu</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$total3$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen3</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>";
                 }    
                $sql2="SELECT * FROM (SELECT CONCAT(a.kd_kegiatan, '.', 51) AS kd_rek,c.nm_kegiatan AS nm_rek,SUM(d.anggaran)AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trskpd a 
				INNER JOIN m_giat c ON a.kd_kegiatan1=c.kd_kegiatan
				LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
				LEFT JOIN realisasi_bulan d ON b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan AND b.kd_rek5=d.kd_rek5 
				WHERE a.kd_skpd='$id' AND LEFT(b.kd_rek5,2)='51' GROUP BY a.kd_kegiatan,c.nm_kegiatan 
				UNION ALL
				SELECT CONCAT(a.kd_kegiatan,'.',LEFT(a.kd_rek5,3)) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(d.anggaran)AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trdrka a 
				INNER JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
				LEFT JOIN realisasi_bulan d ON a.kd_skpd=d.kd_skpd AND a.kd_kegiatan=d.kd_kegiatan AND a.kd_rek5=d.kd_rek5 
				WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='51' GROUP BY CONCAT(a.kd_kegiatan,'.',LEFT(a.kd_rek5,3)),b.nm_rek3
				) a ORDER BY kd_rek";
                 
                 $query1 = $this->db->query($sql2);
                 foreach ($query1->result() as $row1)
                {
                    $coba5  = $row1->kd_rek;
                    $coba6  = ucwords(strtolower($row1->nm_rek));
                    $coba7  = number_format($row1->nilai,"2",".",",");
                    $coba7u = number_format($row1->nilai_ubah,"2",".",",");
                    $rumus4 = $row1->nilai_ubah - $row1->nilai;
                    if ($rumus4 < 0){
                        $x1="("; $rumus4=$rumus4*-1; $y1=")";}
                   else {
                        $x1=""; $y1="";}
                   $total4 = number_format($rumus4,"2",".",",");  
                   $per4   = ($rumus4!=0)?($row1->nilai_ubah / $row1->nilai) * 100:0; 
                   $persen4= number_format($per4,"2",".",",");
                   if(strlen($coba5)<=24){
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"><b>$coba5</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"><b>$coba6</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$coba7</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$coba7u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$total4$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen4</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>
                                ";
                    
                   }else{
                   
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\">$coba5</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\">$coba6</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$coba7</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$coba7u</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$total4$y1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\">$persen4</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>
                                ";
                     }
                }
                
                    $sqltbl="SELECT CONCAT(a.kd_kegiatan, '.', 52) AS kd_rek,SUM(b.anggaran) AS totbl, SUM(b.real_spj) as totbl_ubah FROM trdrka a LEFT join realisasi_bulan b on a.kd_skpd=b.kd_skpd and a.kd_kegiatan=b.kd_kegiatan and a.kd_rek5=b.kd_rek5 WHERE LEFT(a.kd_rek5,2)='52' and a.kd_skpd='$id'";
                    $sqlbl=$this->db->query($sqltbl);
                 foreach ($sqlbl->result() as $rowbl)
                {
                   $jumbl   = number_format($rowbl->totbl,"2",".",",");
                   $jumblu  = number_format($rowbl->totbl_ubah,"2",".",",");
                   $rumus5  = $rowbl->totbl_ubah - $rowbl->totbl;
				    $cob2   = $rowbl->kd_rek;
                   if ($rumus5 < 0){
                        $x1="("; $rumus5=$rumus5*-1; $y1=")";}
                   else {
                        $x1=""; $y1="";}
                   $total5 = number_format($rumus5,"2",".",",");  
                   $per5   = ($rumus5!=0)?($rowbl->totbl_ubah / $rowbl->totbl) * 100:0; 
                   $persen5= number_format($per5,"2",".",",");
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"></td>                                     
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\">&nbsp;</td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\">&nbsp;</td>
                              </tr>
                              <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\">$cob2</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"><b>Belanja Langsung</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$jumbl</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$jumblu</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$total5$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen5</b></td>                                
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>";
                 }
                 $sql2bl="SELECT * FROM (SELECT a.kd_program AS kd_rek,c.nm_program AS nm_rek,
						(SELECT SUM(c.anggaran) FROM realisasi_bulan c WHERE a.kd_skpd=c.kd_skpd and a.kd_program=LEFT(c.kd_kegiatan,(LENGTH(a.kd_program))) ) AS nilai,
						(SELECT SUM(c.real_spj) FROM realisasi_bulan c WHERE a.kd_skpd=c.kd_skpd and a.kd_program=LEFT(c.kd_kegiatan,(LENGTH(a.kd_program))) ) AS nilai_ubah
						FROM trskpd a INNER JOIN m_prog c ON a.kd_program1=c.kd_program
						LEFT JOIN trdrka b ON a.kd_program=LEFT(b.kd_kegiatan,(LENGTH(a.kd_program))) WHERE a.kd_skpd='$id' AND RIGHT(a.kd_program,2)<>'00' GROUP BY a.kd_program,c.nm_program
						UNION ALL
						SELECT a.kd_kegiatan AS kd_rek,c.nm_kegiatan AS nm_rek,SUM(d.anggaran) AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trskpd a 
						INNER JOIN m_giat c ON a.kd_kegiatan1=c.kd_kegiatan
						LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
						left JOIN realisasi_bulan d ON a.kd_skpd=d.kd_skpd AND a.kd_kegiatan=d.kd_kegiatan AND b.kd_rek5=d.kd_rek5 
						WHERE a.kd_skpd='$id' AND RIGHT(a.kd_program,2)<>'00' GROUP BY a.kd_kegiatan,c.nm_kegiatan 
						UNION ALL
						SELECT CONCAT(a.kd_kegiatan,'.',LEFT(a.kd_rek5,3)) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(d.anggaran) AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trdrka a 
						LEFT JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
						LEFT JOIN realisasi_bulan d ON a.kd_skpd=d.kd_skpd AND a.kd_kegiatan=d.kd_kegiatan AND a.kd_rek5=d.kd_rek5 WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='52' GROUP BY CONCAT(a.kd_kegiatan,'.',LEFT(a.kd_rek5,3)),b.nm_rek3
						) a ORDER BY kd_rek";
                 
                 $query1bl = $this->db->query($sql2bl);
                 foreach ($query1bl->result() as $row1bl)
                {
                    $bl1    =$row1bl->kd_rek;
                    $bl2    =ucwords(strtolower($row1bl->nm_rek));
                    $bl3    = number_format($row1bl->nilai,"2",".",",");
                    $bl3u   = number_format($row1bl->nilai_ubah,"2",".",",");
                    $rumus6 = $row1bl->nilai_ubah - $row1bl->nilai;
                    if ($rumus6 < 0){
                        $x1="("; $rumus6=$rumus6*-1; $y1=")";}
                    else {
                        $x1=""; $y1="";}
                    $total6 = number_format($rumus6,"2",".",",");  
                    $per6   = ($rumus6!=0)?($row1bl->nilai_ubah / $row1bl->nilai) * 100:0; 
                    $persen6= number_format($per6,"2",".",",");
                    if(strlen($bl1)<=24){
                        $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"><b>$bl1</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"><b>$bl2</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$bl3</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$bl3u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$total6$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen6</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>";
                    }else{
                   
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\">$bl1</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\">$bl2</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$bl3</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$bl3u</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$total6$y1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\">$persen6</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>";
                     }
                }
                
                    $sqltbl="SELECT SUM(b.anggaran) AS totbl,Sum(b.real_spj) as totbl_ubah FROM trdrka a LEFT JOIN realisasi_bulan b on a.kd_skpd=b.kd_skpd and a.kd_kegiatan=b.kd_kegiatan and a.kd_rek5=b.kd_rek5 WHERE LEFT(a.kd_rek5,1)='5' and a.kd_skpd='$id'";
                    $sqlbl=$this->db->query($sqltbl);
                 foreach ($sqlbl->result() as $rowbl)
                {
                   $jumbl   = number_format($rowbl->totbl,"2",".",",");
                   $jumblu  = number_format($rowbl->totbl_ubah,"2",".",",");
                   $rumus7  = $rowbl->totbl_ubah - $rowbl->totbl;
                   if ($rumus7 < 0){
                        $x1="("; $rumus7=$rumus7*-1; $y1=")";}
                    else {
                        $x1=""; $y1="";}
                    $total7 = number_format($rumus7,"2",".",",");  
                    $per7   = ($rumus7!=0)?($rowbl->totbl_ubah / $rowbl->totbl) * 100:0; 
                    $persen7= number_format($per7,"2",".",",");
                   $cob=$rowbl->totbl;
                   $cobu=$rowbl->totbl_ubah;
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"30%\"><b>JUMLAH BELANJA</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"10%\" align=\"right\"><b>$jumbl</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"10%\" align=\"right\"><b>$jumblu</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"10%\" align=\"right\"><b>$x1$total7$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"right\"></strong><b>$persen7</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>";
                 }
                 
                 $suplus=$cob1-$cob;
                 $suplusu=$cob1u-$cobu; 
                  if ($suplus < 0){
                	$x1="(";
                	$suplus=$suplus*-1;
                	$y1=")";}
                 else {
                	$x1="";
	                $y1="";}
                 if ($suplusu < 0){
                	$x1="(";
                	$suplusu=$suplusu*-1;
                	$y1=")";}
                 else {
                	$x1="";
	                $y1="";}
                    
                 $surp  = number_format($suplus,2,',','.');
                 $surpu = number_format($suplusu,2,',','.');               
                  
               /* $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"></td>                                     
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"><b>Suprlus/(Defisit)</b></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$surp$y1</b></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$surpu$y1</b></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\">&nbsp;</td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\">&nbsp;</td>
                              </tr>*/
                 $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"></td>                                     
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\">&nbsp;</td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\">&nbsp;</td>
                              </tr>";
                
                 
                    
                    $sql3="SELECT * FROM (SELECT a.kd_kegiatan AS kd_rek,c.nm_kegiatan AS nm_rek,SUM(d.anggaran)AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trskpd a 
					INNER JOIN m_giat c ON a.kd_kegiatan1=c.kd_kegiatan
					LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan
					LEFT JOIN realisasi_bulan d ON b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan AND b.kd_rek5=d.kd_rek5 
					WHERE a.kd_skpd='$id' AND RIGHT(a.kd_kegiatan,5)='00.03' GROUP BY a.kd_kegiatan,c.nm_kegiatan 
					UNION ALL
					SELECT CONCAT(a.kd_kegiatan,'.',LEFT(a.kd_rek5,3)) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(d.anggaran)AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trdrka a 
					LEFT JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					LEFT JOIN realisasi_bulan d ON a.kd_skpd=d.kd_skpd AND a.kd_kegiatan=d.kd_kegiatan AND a.kd_rek5=d.kd_rek5 
					WHERE a.kd_skpd='$id' AND LEFT(a.kd_rek5,2)='61' GROUP BY CONCAT(a.kd_kegiatan,'.',LEFT(a.kd_rek5,3)),b.nm_rek3
					) a ORDER BY kd_rek";
                 
                 $query3 = $this->db->query($sql3);
                 //$query = $this->skpd_model->getAllc();
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"><b>PEMBIAYAAN DAERAH</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>";                                                  
                foreach ($query3->result() as $row3)
                {
                    $coba9  =$row3->kd_rek;
                    $coba10 =$row3->nm_rek;
                    $coba11 = number_format($row3->nilai,"2",".",",");
                    $coba11u= number_format($row3->nilai_ubah,"2",".",",");
                    $rumus8 = $row3->nilai_ubah - $row3->nilai;
                    if ($rumus8 < 0){
                        $x1="("; $rumus8=$rumus8*-1; $y1=")";}
                    else {
                        $x1=""; $y1="";}
                    $total8 = number_format($rumus8,"2",".",",");  
                    $per8   = ($rumus8!=0)?($row3->nilai_ubah / $row3->nilai) * 100:0; 
                    $persen8= number_format($per8,"2",".",",");
                    
                     $cRet    .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"><b>$coba9</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"30%\"><b>$coba10</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"10%\" align=\"right\"><b>$coba11</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"10%\" align=\"right\"><b>$coba11u</<b>b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"10%\" align=\"right\"><b>$x1$total8$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"right\"><b>$persen8</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>";
                }
                $sqltpm="SELECT SUM(b.anggaran) AS totpm,SUM(b.real_spj) AS totpm_ubah FROM trdrka a left join realisasi_bulan b on a.kd_skpd=b.kd_skpd and a.kd_kegiatan=b.kd_kegiatan and a.kd_rek5=b.kd_rek5 WHERE LEFT(a.kd_rek5,2)='61' and a.kd_skpd='$id'";
                 $sqlpm=$this->db->query($sqltpm);
                 foreach ($sqlpm->result() as $rowpm)
                {
                   $coba12  = number_format($rowpm->totpm,"2",".",",");
                   $coba12u = number_format($rowpm->totpm_ubah,"2",".",",");
                   $rumus9  = $rowpm->totpm_ubah - $rowpm->totpm;
                   if ($rumus9 < 0){
                        $x1="("; $rumus9=$rumus9*-1; $y1=")";}
                    else {
                        $x1=""; $y1="";}
                    $total9 = number_format($rumus9,"2",".",",");  
                    $per9   = ($rumus9!=0)?($rowpm->totpm_ubah / $rowpm->totpm) * 100:0; 
                    $persen9= number_format($per9,"2",".",",");
                    $cob3    = $rowpm->totpm;
                    $cob3u   = $rowpm->totpm_ubah;
                     $cRet    .= " 
                                <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"><b>JUMLAH PENERIMAAN PEMBIAYAAN</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$coba12</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$coba12u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$total9$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen9</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>
                                </tr>
                                <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"></td>                                     
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"></td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\">&nbsp;</td>
                                  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\">&nbsp;</td>
                              </tr>";
                 }     
                $sql4="SELECT * FROM (SELECT a.kd_kegiatan AS kd_rek,c.nm_kegiatan AS nm_rek,SUM(d.anggaran)AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trskpd a INNER JOIN m_giat c ON a.kd_kegiatan1=c.kd_kegiatan
                       LEFT JOIN trdrka b ON a.kd_kegiatan=b.kd_kegiatan 
					   LEFT JOIN realisasi_bulan d ON b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan AND b.kd_rek5=d.kd_rek5 
					   WHERE a.kd_skpd='$id' and right(a.kd_kegiatan,5)='00.04' GROUP BY a.kd_kegiatan,c.nm_kegiatan 
                       UNION ALL
                       SELECT CONCAT(a.kd_kegiatan,'.',LEFT(a.kd_rek5,3)) AS kd_rek,b.nm_rek3 AS nm_rek,SUM(d.anggaran)AS nilai,SUM(d.real_spj) AS nilai_ubah FROM trdrka a LEFT JOIN ms_rek3 b ON LEFT(a.kd_rek5,3)=b.kd_rek3 
					   LEFT JOIN realisasi_bulan d ON a.kd_skpd=d.kd_skpd AND a.kd_kegiatan=d.kd_kegiatan AND a.kd_rek5=d.kd_rek5 WHERE a.kd_skpd='$id' and left(a.kd_rek5,2)='62' GROUP BY CONCAT(a.kd_kegiatan,'.',LEFT(a.kd_rek5,3)),b.nm_rek3
                       ) a ORDER BY kd_rek";
                 
                 $query4 = $this->db->query($sql4);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query4->result() as $row4)
                {
                    $coba13     = $row4->kd_rek;
                    $coba14     = strtoupper($row4->nm_rek);
                    $coba15     = number_format($row4->nilai,"2",".",",");
                    $coba15u    = number_format($row4->nilai_ubah,"2",".",",");
                    $rumus10    = $row4->nilai_ubah - $row4->nilai;
                    if ($rumus10 < 0){
                        $x1="("; $rumus10=$rumus10*-1; $y1=")";}
                    else {
                        $x1=""; $y1="";}
                    $total10 = number_format($rumus10,"2",".",",");  
                    $per10   = ($rumus10!=0)?($row4->nilai_ubah / $row4->nilai) * 100:0; 
                    $persen10= number_format($per10,"2",".",",");
                    
                     $cRet    .= " <tr><td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"20%\" align=\"left\">$coba13</td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"30%\">$coba14</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$coba15</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$coba15u</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\">$x1$total10$y1</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"5%\" align=\"right\">$persen10</td>&nbsp;
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"15%\" align=\"right\"></td>&nbsp;
                                </tr>";
                }
                $sqltpk="SELECT SUM(b.anggaran) AS totpk,SUM(b.real_spj) AS totpk_ubah FROM trdrka a left join realisasi_bulan b on a.kd_skpd=b.kd_skpd and a.kd_kegiatan=b.kd_kegiatan and a.kd_rek5=b.kd_rek5 WHERE LEFT(a.kd_rek5,2)='62' and a.kd_skpd='$id'";
                 $sqlpk=$this->db->query($sqltpk);
                 foreach ($sqlpk->result() as $rowpk)
                {
                   $coba16  = number_format($rowpk->totpk,"2",".",",");
                   $coba16u = number_format($rowpk->totpk_ubah,"2",".",",");
                   $rumus11 = $rowpk->totpk_ubah - $rowpk->totpk;
                   if ($rumus11 < 0){
                        $x1="("; $rumus11=$rumus11*-1; $y1=")";}
                    else {
                        $x1=""; $y1="";}
                    $total11 = number_format($rumus11,"2",".",",");  
                    $per11   = ($rumus11!=0)?($rowpk->totpk_ubah / $rowpk->totpk) * 100:0; 
                    $persen11= number_format($per11,"2",".",",");
                    
                   $cob4    =$rowpk->totpk;
                   $cob4u   =$rowpk->totpk_ubah;
                   
                    $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"20%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"30%\"><b>JUMLAH PENGELUARAN PEMBIAYAAN</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$coba16</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$coba16u</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$x1$total11$y1</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"right\"><b>$persen11</b></td>&nbsp;
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"right\"></td>&nbsp;
                                </tr>";
                 }  
                  
				$netto=$cob3 - $cob4;
				$net=number_format($netto,"2",",",".");
				$netto_r= $cob3u -  $cob4u;
				$net_r=number_format($netto_r,"2",",",".");
				$netto_s=$netto_r - $netto;
				if ($netto_s < 0){
					$x1="("; $netto_s=$netto_s*-1; $y1=")";}
				else {
					$x1=""; $y1="";}
				$netto_selisih = number_format($netto_s,"2",",",".");
				$perpnet   = ($netto_s!=0)?($netto_s / $netto ) * 100:0; 
				$persennet= number_format($perpnet);                    
				
				
				$cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"15%\" align=\"left\"></td>
								<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"16%\"><b>PEMBIAYAAN NETTO</b></td>
								 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$net</b></td>
								 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$net_r</b></td>
								 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"13%\" align=\"right\"><b>$x1$netto_selisih$y1</b></td>
								 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"3%\" align=\"right\"><b>$persennet</b></td>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"13%\" align=\"right\"></td>
								 </tr>";
              
        $cRet    .= "</table>";
		 $date=date('Y-m-t');
        $cRet .= "<br><table width=\"100%\" border=\"0\" cellpading = \"8\">
                                <tr>
                                    <td width=\"60%\" align=\"left\">&nbsp;<br>&nbsp;
                                        <br>&nbsp;
                                        &nbsp;<br>
                                        &nbsp;<br>
                                        &nbsp;<br>
                                        &nbsp;	
                                    </td>
                                    <td width=\"40%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($date)."
                                        <p><b>$jabatan</b></p>
                                        <p>&nbsp;</p>
                                        <br><br>
                                        <br><b><u>$namapa</u></b>
                                        <br>$nip</b>
                                    </td>
                                </tr>";
         $cRet .=       " </table>";
        $data['prev']= $cRet;
        $data['sikap'] = 'preview';
        $judul     = 'Laporan real APBD Lamp III - '.$kd_skpd;
        $this->template->set('title', 'CETAK PERDA');    
        //$this->_mpdf('',$cRet,10,10,10,0);
        switch($cetak) {
        case 0;
              $this->template->load('template','anggaran/rka/perdaIII_ubah',$data);
        break;
        case 1;
             $this->tukd_model->_mpdf('',$cRet,10,10,10,'P');
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
           $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        }   
                
    }


    function cetak_perdaIV_real_tambahan(){
       
	   $cetak = $this->uri->segment(3);
		 $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang,upper(no_qanun)as no_qanun, tgl_qanun, no_perbup, tgl_perbup, bupati FROM sclient";
		 $sqlsclient=$this->db->query($sqlsc);
		 foreach ($sqlsclient->result() as $rowsc)
		{
		   
			$tgl     = $rowsc->tgl_rka;
			$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
			$kab     = $rowsc->kab_kota;
			$daerah  = $rowsc->daerah;
			$thn     = $rowsc->thn_ang;
			
			$bupati     = $rowsc->bupati;
			$no_qanun   = $rowsc->no_qanun;
			$tgl_qanun  = $this->tukd_model->tanggal_format_indonesia($rowsc->tgl_qanun);
			$no_perbup  = $rowsc->no_perbup;
			$tgl_perbup = $rowsc->tgl_perbup;
			
		}
		$sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='1.20.06.00' and kode='KD'");
		foreach($sqlttd->result() as $rowtd){
			$nip=$rowtd->nip;
			$namapa=$rowtd->nama;
			$jabatan=$rowtd->jabatan;
		}
        $cRet='';
		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
                         <td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"10%\"><strong><h5>LAMPIRAN IV  :</h6></strong></td>
                         <td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>PERATURAN DAERAH</strong></h5></td>
                    </tr>
                    <tr> 
                         <td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>: $no_qanun</h5></td>
                    </tr>
                    <tr>
                        <td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>: $tgl_qanun</h5></td>
                    </tr>
                                         
                   
                  </table>
				<br>";
        $cRet .="<table style=\"border-collapse:collapse;font-size:14;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td colspan = \"10\" align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                     <tr>
                         <td colspan = \"10\" align=\"center\"><strong>REKAPITULASI REALISASI BELANJA MENURUT URUSAN, ORGANISASI </strong></td>
                    </tr>
                    <tr>
                         <td colspan = \"10\" align=\"center\"><strong>PROGRAM, KEGIATAN DAN JENIS BELANJA TAHUN ANGARAN $thn</strong></td>
                    </tr>

                  </table><br>";  
        
        $cRet .= "<table style=\"border-collapse:collapse;font-size:14;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr>
							<td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>Kode Rekening</b></td>                            
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"39%\" align=\"center\"><b>Uraian Urusan, Organisasi,Program dan Kegiatan</b></td>                         
                            <td colspan=\"4\" bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>Jenis Belanja</b></td>
							<td colspan=\"4\" bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>Realisasi</b></td>
                            </tr>
                        <tr>
 							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Pegawai</b></td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Barang dan Jasa</b></td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Modal</b></td>
							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Jumlah</b></td>
							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Pegawai</b></td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Barang dan Jasa</b></td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Modal</b></td>
							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Jumlah</b></td>
                        </tr>    

						<tr>
							<td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">1</td>        
                            <td bgcolor=\"#CCCCCC\" width=\"39%\" align=\"center\">2</td> 
 							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">3</td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">4</td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">5</td>
                            <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">6 = 3+4+5</td>
							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">7</td>
							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">8</td>
							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">9</td>
							<td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">10 = 7+8+9</td>

                        </tr>   
                     </thead>
                    <tfoot>
                        <tr>
                            <td colspan=\"10\" style=\"border:solid 1px white;border-top: solid 1px black;\"></td>
                         </tr>
                    </tfoot>";
					 $cRet    .= "  <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"39%\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									 </tr>";
                                     
                 $sql1 = "SELECT 
							a.kd_urusan1 AS kode, 
							a.nm_urusan1 AS nama,
							SUM(IF(LEFT(c.kd_rek5,3)='521',c.anggaran,0)) AS bpeg,
							SUM(IF(LEFT(c.kd_rek5,3)='522',c.anggaran,0)) AS bbj,
							SUM(IF(LEFT(c.kd_rek5,3)='523',c.anggaran,0)) AS bm,
							SUM(IF(LEFT(c.kd_rek5,2)='52',c.anggaran,0))  AS jumlah,
							SUM(IF(LEFT(c.kd_rek5,3)='521',c.real_spj,0)) AS rbpeg,
							SUM(IF(LEFT(c.kd_rek5,3)='522',c.real_spj,0)) AS rbbj,
							SUM(IF(LEFT(c.kd_rek5,3)='523',c.real_spj,0)) AS rbm,
							SUM(IF(LEFT(c.kd_rek5,2)='52',c.real_spj,0))  AS rjumlah
							FROM trdrka b 
							INNER JOIN ms_urusan1 a ON LEFT(b.kd_skpd,1)=a.kd_urusan1 
							LEFT JOIN realisasi_bulan c ON b.kd_skpd=c.kd_skpd AND b.kd_kegiatan=c.kd_kegiatan AND b.kd_rek5=c.kd_rek5
							GROUP BY  a.kd_urusan1 ,a.nm_urusan1
							UNION
							SELECT 
							a.kd_urusan AS kode, 
							a.nm_urusan AS nama,
							SUM(IF(LEFT(c.kd_rek5,3)='521' AND LEFT(c.kd_skpd,4)=a.kd_urusan,c.anggaran,0)) AS bpeg,
							SUM(IF(LEFT(c.kd_rek5,3)='522' AND LEFT(c.kd_skpd,4)=a.kd_urusan,c.anggaran,0)) AS bbj,
							SUM(IF(LEFT(c.kd_rek5,3)='523' AND LEFT(c.kd_skpd,4)=a.kd_urusan,c.anggaran,0)) AS bm,
							SUM(IF(LEFT(c.kd_rek5,2)='52' AND LEFT(c.kd_skpd,4)=a.kd_urusan,c.anggaran,0)) AS jumlah,
							SUM(IF(LEFT(c.kd_rek5,3)='521' AND LEFT(c.kd_skpd,4)=a.kd_urusan,c.real_spj,0)) AS rbpeg,
							SUM(IF(LEFT(c.kd_rek5,3)='522' AND LEFT(c.kd_skpd,4)=a.kd_urusan,c.real_spj,0)) AS rbbj,
							SUM(IF(LEFT(c.kd_rek5,3)='523' AND LEFT(c.kd_skpd,4)=a.kd_urusan,c.real_spj,0)) AS rbm,
							SUM(IF(LEFT(c.kd_rek5,2)='52' AND LEFT(c.kd_skpd,4)=a.kd_urusan,c.real_spj,0)) AS rjumlah
							FROM trdrka b 
							INNER JOIN ms_urusan a ON LEFT(b.kd_skpd,4)=a.kd_urusan 
							LEFT JOIN realisasi_bulan c ON b.kd_skpd=c.kd_skpd AND b.kd_kegiatan=c.kd_kegiatan AND b.kd_rek5=c.kd_rek5 
							GROUP BY  a.kd_urusan ,a.nm_urusan
							UNION
							SELECT 
							a.kd_skpd AS kode, 
							b.nm_skpd AS nama,
							SUM(IF(LEFT(c.kd_rek5,3)='521' AND c.kd_skpd=a.kd_skpd,c.anggaran,0)) AS bpeg,
							SUM(IF(LEFT(c.kd_rek5,3)='522' AND c.kd_skpd=a.kd_skpd,c.anggaran,0)) AS bbj,
							SUM(IF(LEFT(c.kd_rek5,3)='523' AND c.kd_skpd=a.kd_skpd,c.anggaran,0)) AS bm,
							SUM(IF(LEFT(c.kd_rek5,2)='52' AND  c.kd_skpd=a.kd_skpd,c.anggaran,0)) AS jumlah,
							SUM(IF(LEFT(c.kd_rek5,3)='521' AND c.kd_skpd=a.kd_skpd,c.real_spj,0)) AS rbpeg,
							SUM(IF(LEFT(c.kd_rek5,3)='522' AND c.kd_skpd=a.kd_skpd,c.real_spj,0)) AS rbbj,
							SUM(IF(LEFT(c.kd_rek5,3)='523' AND c.kd_skpd=a.kd_skpd,c.real_spj,0)) AS rbm,
							SUM(IF(LEFT(c.kd_rek5,2)='52' AND c.kd_skpd=a.kd_skpd,c.real_spj,0)) AS rjumlah
							FROM trdrka a 
							INNER JOIN ms_skpd b ON a.kd_skpd=b.kd_skpd 
							LEFT JOIN realisasi_bulan c ON a.kd_skpd=c.kd_skpd AND a.kd_kegiatan=c.kd_kegiatan AND a.kd_rek5=c.kd_rek5 
							GROUP BY a.kd_skpd,b.nm_skpd       
							ORDER BY kode";
                 $query = $this->db->query($sql1);
                 //$query = $this->skpd_model->getAllc();
                foreach ($query->result() as $row)
                {
                    $kode=$row->kode;
                    $nama=$row->nama;
                    $pend=number_format($row->bpeg,"2",",",".");
                    $btl= number_format($row->bbj,"2",",",".");
                    $bl= number_format($row->bm,"2",",",".");
                    $jum= number_format($row->jumlah,"2",",",".");
					$rpend=number_format($row->rbpeg,"2",",",".");
                    $rbtl= number_format($row->rbbj,"2",",",".");
                    $rbl= number_format($row->rbm,"2",",",".");
                    $rjum= number_format($row->rjumlah,"2",",",".");
                   
                    if ($kode <> '2'){
                        $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"39%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$pend</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$btl</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$bl</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$jum</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rpend</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rbtl</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rbl</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rjum</b></td>
									</tr>
                                     ";
                    }else{
					
						 $cRet    .= "  <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\">&nbsp;</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"39%\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									</tr>
                                     
									<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"39%\"><b>$nama</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$pend</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$btl</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$bl</b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$jum</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rpend</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rbtl</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rbl</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rjum</b></td>
									</tr>
                                     ";
					
					}
                 
							

					$sql2=" SELECT a.kd_skpd AS skpdx,
					b.kd_program AS kode,
					c.nm_program AS nama,SUBSTR(b.kd_program,17,2)AS kodex,
					SUM(IF(LEFT(d.kd_rek5,3)='521' AND d.kd_skpd=a.kd_skpd AND LEFT(d.kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program,d.anggaran,0))  AS bpeg,
					SUM(IF(LEFT(d.kd_rek5,3)='522' AND d.kd_skpd=a.kd_skpd AND LEFT(d.kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program,d.anggaran,0)) AS bbj,
					SUM(IF(LEFT(d.kd_rek5,3)='523' AND d.kd_skpd=a.kd_skpd AND LEFT(d.kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program,d.anggaran,0)) AS bm,
					SUM(IF(LEFT(d.kd_rek5,2)='52' AND d.kd_skpd=a.kd_skpd AND LEFT(d.kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program,d.anggaran,0)) AS jumlah,
					SUM(IF(LEFT(d.kd_rek5,3)='521' AND d.kd_skpd=a.kd_skpd AND LEFT(d.kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program,d.real_spj,0))  AS rbpeg,
					SUM(IF(LEFT(d.kd_rek5,3)='522' AND d.kd_skpd=a.kd_skpd AND LEFT(d.kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program,d.real_spj,0)) AS rbbj,
					SUM(IF(LEFT(d.kd_rek5,3)='523' AND d.kd_skpd=a.kd_skpd AND LEFT(d.kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program,d.real_spj,0)) AS rbm,
					SUM(IF(LEFT(d.kd_rek5,2)='52' AND d.kd_skpd=a.kd_skpd AND LEFT(d.kd_kegiatan,(LENGTH(b.kd_program)))=b.kd_program,d.real_spj,0)) AS rjumlah
					FROM trdrka a 
					JOIN trskpd b ON a.kd_kegiatan=b.kd_kegiatan
					LEFT JOIN m_prog c ON b.kd_program1 = c.kd_program 
					LEFT JOIN realisasi_bulan d ON a.kd_skpd=d.kd_skpd AND a.kd_kegiatan=d.kd_kegiatan AND a.kd_rek5=d.kd_rek5 
					WHERE a.kd_skpd='$kode' and RIGHT(b.kd_program,2) <>'00' GROUP BY b.kd_program,c.nm_program ORDER BY kode";

					$query1 = $this->db->query($sql2);
                                                  
					foreach ($query1->result() as $row1)
					{
						$kode1=$row1->kode;
						$nama1=$row1->nama;
						$kodex=$row1->kodex;
						$skpdx=$row1->skpdx;
						$pend1=number_format($row1->bpeg,"2",",",".");
						$btl1= number_format($row1->bbj,"2",",",".");
						$bl1= number_format($row1->bm,"2",",",".");
						$jum1= number_format($row1->jumlah,"2",",",".");
						$rpend1=number_format($row1->rbpeg,"2",",",".");
						$rbtl1= number_format($row1->rbbj,"2",",",".");
						$rbl1= number_format($row1->rbm,"2",",",".");
						$rjum1= number_format($row1->rjumlah,"2",",",".");

						$cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\"><b>$kode1</b></td>                                     
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"39%\"><b>$nama1</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$pend1</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$btl1</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$bl1</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$jum1</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rpend1</b></td>
									  <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rbtl1</b></td>
									   <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rbl1</b></td>
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>$rjum1</b></td>
									</tr>

										 ";
								

							$sql3="SELECT 
							b.kd_kegiatan AS kode,
							c.nm_kegiatan AS nama,
							SUM(IF(LEFT(d.kd_rek5,3)='521' AND b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan,d.anggaran,0)) AS bpeg,
							SUM(IF(LEFT(d.kd_rek5,3)='522' AND b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan,d.anggaran,0)) AS bbj,
							SUM(IF(LEFT(d.kd_rek5,3)='523' AND b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan,d.anggaran,0)) AS bm,
							SUM(IF(LEFT(d.kd_rek5,2)='52' AND b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan,d.anggaran,0)) AS jumlah,
							SUM(IF(LEFT(d.kd_rek5,3)='521' AND b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan,d.real_spj,0)) AS rbpeg,
							SUM(IF(LEFT(d.kd_rek5,3)='522' AND b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan,d.real_spj,0)) AS rbbj,
							SUM(IF(LEFT(d.kd_rek5,3)='523' AND b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan,d.real_spj,0)) AS rbm,
							SUM(IF(LEFT(d.kd_rek5,2)='52' AND b.kd_skpd=d.kd_skpd AND b.kd_kegiatan=d.kd_kegiatan,d.real_spj,0)) AS rjumlah
							FROM trdrka a JOIN trskpd b ON a.kd_kegiatan=b.kd_kegiatan
							LEFT JOIN m_giat c ON b.kd_kegiatan1 = c.kd_kegiatan 
							LEFT JOIN realisasi_bulan d ON a.kd_skpd=d.kd_skpd AND a.kd_kegiatan=d.kd_kegiatan AND a.kd_rek5=d.kd_rek5
							WHERE a.kd_skpd='$skpdx' AND LEFT(b.kd_kegiatan,18)='$kode1' AND
							SUBSTR(b.kd_program,17,2) ='$kodex' GROUP BY  b.kd_kegiatan,c.nm_kegiatan ORDER BY kode";
								$query2 = $this->db->query($sql3);
                                                  
							foreach ($query2->result() as $row2)
							{
								$kode2=$row2->kode;
								$nama2=$row2->nama;
								$pend2=number_format($row2->bpeg,"2",",",".");
								$btl2= number_format($row2->bbj,"2",",",".");
								$bl2= number_format($row2->bm,"2",",",".");
								$jum2= number_format($row2->jumlah,"2",",",".");
								$rpend2=number_format($row2->rbpeg,"2",",",".");
								$rbtl2= number_format($row2->rbbj,"2",",",".");
								$rbl2= number_format($row2->rbm,"2",",",".");
								$rjum2= number_format($row2->rjumlah,"2",",",".");

								$cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\">$kode2</td>                                     
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"39%\">$nama2</td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$pend2</td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$btl2</td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$bl2</td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$jum2</td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rpend2</td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rbtl2</td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rbl2</td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rjum2</td>
											</tr>
											 ";
							}
								
						$cRet    .= "<tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"left\">&nbsp;</td>                                     
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"39%\">&nbsp;</td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
										<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">&nbsp;</td>
									</tr>";

								

						}
					
						
                  }  
				  $sqly="SELECT 
						a.kd_urusan1 AS kode, 
						a.nm_urusan1 AS nama,
						SUM(IF(LEFT(c.kd_rek5,3)='521',c.anggaran,0)) AS bpeg,
						SUM(IF(LEFT(c.kd_rek5,3)='522',c.anggaran,0)) AS bbj,
						SUM(IF(LEFT(c.kd_rek5,3)='523',c.anggaran,0)) AS bm,
						SUM(IF(LEFT(c.kd_rek5,2)='52',c.anggaran,0))  AS jumlah,
						SUM(IF(LEFT(c.kd_rek5,3)='521',c.real_spj,0)) AS rbpeg,
						SUM(IF(LEFT(c.kd_rek5,3)='522',c.real_spj,0)) AS rbbj,
						SUM(IF(LEFT(c.kd_rek5,3)='523',c.real_spj,0)) AS rbm,
						SUM(IF(LEFT(c.kd_rek5,2)='52',c.real_spj,0))  AS rjumlah
						FROM trdrka b 
						INNER JOIN ms_urusan1 a ON LEFT(b.kd_skpd,1)=a.kd_urusan1 
						LEFT JOIN realisasi_bulan c ON b.kd_skpd=c.kd_skpd AND b.kd_kegiatan=c.kd_kegiatan AND b.kd_rek5=c.kd_rek5
						GROUP BY  a.kd_urusan1 ,a.nm_urusan1";
					$queryxy=$this->db->query($sqly);
					$tot1=0; $tot2=0; $tot3=0; $tot4=0;$tot5=0; $tot6=0; $tot7=0; $tot8=0;
					foreach($queryxy->result() as $rowxy){
								$pendxy=$rowxy->bpeg;
								$btlxy= $rowxy->bbj;
								$blxy= $rowxy->bm;
								$jumxy= $rowxy->jumlah;
								$rpendxy=$rowxy->rbpeg;
								$rbtlxy= $rowxy->rbbj;
								$rblxy= $rowxy->rbm;
								$rjumxy= $rowxy->rjumlah;
							$tot1=$tot1 + $pendxy;
							$tot2=$tot2 + $btlxy;
							$tot3=$tot3 + $blxy;
							$tot4=$tot4 + $jumxy;
							$tot5=$tot5 + $rpendxy;
							$tot6=$tot6 + $rbtlxy;
							$tot7=$tot7 + $rblxy;
							$tot8=$tot8 + $rjumxy;
						
						
					}
				  
				  
				  
				  $cRet    .= "<tr>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"center\"></td>    
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"34%\" align=\"center\"><b>Jumlah</b></td>                                     
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($tot1,2,',','.')."</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($tot2,2,',','.')."</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($tot3,2,',','.')."</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($tot4,2,',','.')."</b></td>
									  <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($tot5,2,',','.')."</b></td>
									  <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($tot6,2,',','.')."</b></td>
									  <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($tot7,2,',','.')."</b></td>
									  <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($tot8,2,',','.')."</b></td>
							</tr>";

        $cRet .=       " </table>";
		$date=date('Y-m-t');
        $cRet .= "<br><table width=\"100%\" border=\"0\" cellpading = \"8\">
                                <tr>
                                    <td width=\"60%\" align=\"left\">&nbsp;<br>&nbsp;
                                        <br>&nbsp;
                                        &nbsp;<br>
                                        &nbsp;<br>
                                        &nbsp;<br>
                                        &nbsp;	
                                    </td>
                                    <td width=\"40%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($date)."
                                        <p><b>BUPATI MAMBERAMO TENGAH</b></p>
                                        <p>&nbsp;</p>
                                        <br><br>
                                        <br><b><u>$bupati</u></b>
                                        <br></b>
                                    </td>
                                </tr>";
         $cRet .=       "                 </table>";
        $data['prev']= $cRet;
        $this->template->set('title', 'CETAK PERDA LAMPIRAN IV');        
        //$this->_mpdf('',$cRet,10,10,10,1,'',$hal);
        //$this->template->load('template','anggaran/rka/perdaIV',$data);
        switch($cetak) {
        case 0;
           // $this->template->load('template','anggaran/rka/perkadaII',$data);
        break;
        case 1;
		     $hal=1;
            $this->tukd_model->_mpdf('',$cRet,10,10,10,'L');
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= PerdaIV.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        
        }
        
    }

    function cetak_perdaV_real_tambahan($cetak=''){
	   $skpd=$this->session->userdata('kdskpd');
       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang, no_qanun, tgl_qanun, no_perbup, tgl_perbup, bupati FROM sclient";
		 $sqlsclient=$this->db->query($sqlsc);
		 foreach ($sqlsclient->result() as $rowsc)
		{
		   
			$tgl     = $rowsc->tgl_rka;
			$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
			$kab     = $rowsc->kab_kota;
			$daerah  = $rowsc->daerah;
			$thn     = $rowsc->thn_ang;
			
			$bupati     = $rowsc->bupati;
			$no_qanun   = $rowsc->no_qanun;
			$tgl_qanun  = $this->tukd_model->tanggal_format_indonesia($rowsc->tgl_qanun);
			$no_perbup  = $rowsc->no_perbup;
			$tgl_perbup = $rowsc->tgl_perbup;
			
		} 
		$sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='1.20.06.00' and kode='KD'");
		foreach($sqlttd->result() as $rowtd){
			$nip=$rowtd->nip;
			$namapa=$rowtd->nama;
			$jabatan=$rowtd->jabatan;
		}
        $cRet='';
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td rowspan=\"3\" align=\"left\" width=\"60%\"><strong></strong></td>
                         <td rowspan=\"3\" valign =\"top\" align=\"left\" width=\"10%\"><strong><h5>LAMPIRAN V  :</h6></strong></td>
                         <td colspan=\"2\" align=\"left\" width=\"30%\"><strong><h5>PERATURAN DAERAH</strong></h5></td>
                    </tr>
                    <tr> 
                         <td align=\"left\" width=\"10%\"><h5>NOMOR</h5></td><td width=\"20%\" align=\"left\" ><h5>: $no_qanun</h5></td>
                    </tr>
                    <tr>
                        <td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"10%\"><h5>TANGGAL</h5></td><td style=\"border-bottom: solid 1px black;\" align=\"left\" width=\"20%\"><h5>: $tgl_qanun</h5></td>
                    </tr>
                                         
                   
                  </table>
				<br>";
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>REKAPITULASI REALISASI BELANJA DAERAH UNTUK KESELARASAN DAN KETERPADUAN URUSAN PEMERINTAHAN DAERAH DAN FUNGSI DALAM KERANGKA PENGELOLAAN KEUANGAN NEGARA </strong></td>
                    </tr>
                    
                    <tr>
                         <td align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>

                  </table><br>";  
        
        $cRet .= "<table style=\"border-collapse:collapse; font-size:14;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"8%\" align=\"center\"><b>Kode</b></td>                            
                            <td rowspan=\"2\" bgcolor=\"#CCCCCC\" width=\"28%\" align=\"center\"><b>Uraian</b></td>                            
                            <td colspan=\"4\" bgcolor=\"#CCCCCC\" width=\"39%\" align=\"center\"><b>Jenis Belanja</b></td>
							<td colspan=\"4\" bgcolor=\"#CCCCCC\" width=\"39%\" align=\"center\"><b>Realisasi Belanja</b></td>
                            </tr>
                        <tr>
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Pegawai</b></td>
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Barang dan Jasa</b></td>
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Modal</b></td>
							 <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Jumlah</b></td>
							  <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Pegawai</b></td>
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Barang dan Jasa</b></td>
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Modal</b></td>
							 <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\"><b>Jumlah</b></td>
                        </tr>  
						<tr>
							<td bgcolor=\"#CCCCCC\" width=\"8%\" align=\"center\">1</td>   
                            <td bgcolor=\"#CCCCCC\" width=\"28%\" align=\"center\">2</td> 
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">3</td>
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">4</td>
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">5</td>
							 <td  bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">6 = 3+4+5</td>
							 <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">7</td>
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">8</td>
                             <td width=\"10%\" bgcolor=\"#CCCCCC\" align=\"center\">9</td>
							 <td  bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\">10 = 7+8+9</td>
                        </tr> 
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
							<td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>     
                         </tr>
                    </tfoot>";
                 $sql1="   SELECT 
							a.kd_fungsi AS kode, 
							a.nm_fungsi AS nama,
							SUM(IF(LEFT(b.kd_rek5,3)='521',b.anggaran,0)) AS bpeg,
							SUM(IF(LEFT(b.kd_rek5,3)='522',b.anggaran,0)) AS bbj,
							SUM(IF(LEFT(b.kd_rek5,3)='523',b.anggaran,0)) AS bm,
							SUM(IF(LEFT(b.kd_rek5,2)='52',b.anggaran,0))  AS jumlah,
							SUM(IF(LEFT(b.kd_rek5,3)='521',b.real_spj,0)) AS rbpeg,
							SUM(IF(LEFT(b.kd_rek5,3)='522',b.real_spj,0)) AS rbbj,
							SUM(IF(LEFT(b.kd_rek5,3)='523',b.real_spj,0)) AS rbm,
							SUM(IF(LEFT(b.kd_rek5,2)='52',b.real_spj,0))  AS rjumlah
							FROM realisasi_bulan b 
							INNER JOIN ms_skpd c ON c.kd_skpd=b.kd_skpd
							LEFT JOIN ms_fungsi a ON a.kd_fungsi=c.kd_fungsi 
							GROUP BY  a.kd_fungsi , a.nm_fungsi ORDER BY kode";
                 
                 $query = $this->db->query($sql1);
                 //$query = $this->skpd_model->getAllc();
                 $coba=0;$tot1=0;$tot2=0;$tot3=0;$tot4=0;$tot5=0;$tot6=0;$tot7=0;$tot8=0;                                 
                foreach ($query->result() as $row)
                {
                    $kode=$row->kode;
                    $nama=$row->nama;
                 
					 $bpegx= $row->bpeg;
					 $bbjx= $row->bbj;
					 $bmx= $row->bm;
					 $jumx= $row->jumlah;
					 $rbpegx= $row->rbpeg;
					 $rbbjx= $row->rbbj;
					 $rbmx= $row->rbm;
					 $rjumx= $row->rjumlah;
						
				$cRet .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"8%\" align=\"left\"><b>&nbsp;</b></td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"28%\"><b>&nbsp;</b></td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>&nbsp;</b></td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>&nbsp;</b></td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>&nbsp;</b></td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>&nbsp;</b></td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>&nbsp;</b></td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>&nbsp;</b></td>
							<td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>&nbsp;</b></td>
							 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>&nbsp;</b></td>
						</tr>
							 ";
                        
				   $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"8%\" align=\"left\"><b>$kode</b></td>      
							 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"28%\"><b>$nama</b></td>
							 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($bpegx,2,',','.')."</b></td>
							 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($bbjx,2,',','.')."</b></td>
							 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($bmx,2,',','.')."</b></td>
							 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($jumx,2,',','.')."</b></td>
							 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($rbpegx,2,',','.')."</b></td>
							 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($rbbjx,2,',','.')."</b></td>
							 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($rbmx,2,',','.')."</b></td>
							 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\"><b>".number_format($rjumx,2,',','.')."</b></td>
						</tr>
							 ";
									 
						 $sql2="SELECT b.kd_urusan AS kode,b.nm_urusan AS nama,
								SUM(IF(LEFT(d.kd_rek5,3)='521',d.anggaran,0))AS bpeg,
								SUM(IF(LEFT(d.kd_rek5,3)='522',d.anggaran,0))AS bbj,
								SUM(IF(LEFT(d.kd_rek5,3)='523',d.anggaran,0))AS bm,
								SUM(IF(LEFT(d.kd_rek5,2)='52',d.anggaran,0)) AS jumlah,
								SUM(IF(LEFT(d.kd_rek5,3)='521',d.real_spj,0))AS rbpeg,
								SUM(IF(LEFT(d.kd_rek5,3)='522',d.real_spj,0))AS rbbj,
								SUM(IF(LEFT(d.kd_rek5,3)='523',d.real_spj,0))AS rbm,
								SUM(IF(LEFT(d.kd_rek5,2)='52',d.real_spj,0)) AS rjumlah
								FROM ms_fungsi a  
								INNER JOIN ms_urusan b ON a.kd_fungsi=b.kd_fungsi 
								INNER JOIN ms_skpd c ON c.kd_urusan=b.kd_urusan 
								LEFT JOIN realisasi_bulan d ON c.kd_skpd=d.kd_skpd 
								WHERE a.kd_fungsi='$kode' GROUP BY b.kd_urusan ORDER BY a.kd_fungsi,b.kd_urusan
								";
                 
							 $query2 = $this->db->query($sql2);
							
															  
							foreach ($query2->result() as $row2)
							{
								$kode1=$row2->kode;
								$nama1=$row2->nama;
								$bpeg1= number_format($row2->bpeg,"2",",",".");
								$bbj1= number_format($row2->bbj,"2",",",".");
								$bm1= number_format($row2->bm,"2",",",".");
								$jum1= number_format($row2->jumlah,"2",",",".");
								$rbpeg1= number_format($row2->rbpeg,"2",",",".");
								$rbbj1= number_format($row2->rbbj,"2",",",".");
								$rbm1= number_format($row2->rbm,"2",",",".");
								$rjum1= number_format($row2->rjumlah,"2",",",".");
								
								
							 $cRet    .= " <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"8%\" align=\"left\">$kode.$kode1</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"28%\">$nama1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$bpeg1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$bbj1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$bm1</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$jum1</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rbpeg1</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rbbj1</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rbm1</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"10%\" align=\"right\">$rjum1</td>
									</tr>
                                     ";	
								
							}
									 
							
                                  
        
                  }  
                  
        $cRet .=       " </table>";
           $date=date('Y-m-t');
        $cRet .= "<br><table width=\"100%\" border=\"0\" cellpading = \"8\">
                                <tr>
                                    <td width=\"60%\" align=\"left\">&nbsp;<br>&nbsp;
                                        <br>&nbsp;
                                        &nbsp;<br>
                                        &nbsp;<br>
                                        &nbsp;<br>
                                        &nbsp;	
                                    </td>
                                    <td width=\"40%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($date)."
                                        <p><b>BUPATI MAMBERAMO TENGAH</b></p>
                                        <p>&nbsp;</p>
                                        <br><br>
                                        <br><b>$bupati</b>
                                        <br></b>
                                    </td>
                                </tr>";
         $cRet .=       " </table>";
        $data['prev']= $cRet;
        $this->template->set('title', 'CETAK PERDA LAMPIRAN V');        
       switch($cetak) {
        case 1;
             $this->tukd_model->_mpdf('',$cRet,10,10,10,'1');
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $judul.xls");
            
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        case 3;     
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-word");
            header("Content-Disposition: attachment; filename= $judul.doc");
           $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        }        
    }


    function cetak_perkada1_real( $ctk = '',$lap = '', $skpd = ''){
        $id = $skpd;
        $cetak = $ctk;
        $laporan = $lap;

		$ww=$this->cetak_perkada1_semester('1',$laporan,$id);
        
    }

	function cetak_perkada1_semester($ctk = '',$lap = '', $skpd = ''){
        $id = $skpd;
        $cetak = 1;
        $laporan = $lap;

        if ($laporan <> '2')
        {
            $sts = '';
            $jurnal = '';
		    $zz=$this->cetak_perkada_1('1','','','1');
        }
	 }

	 function cetak_perkada_1($cetak='', $bulan='',$hari='',$perkada=''){
		$thnx=$this->session->userdata('pcThang');
		if($bulan==''){
			$b=date('m');
			$bulanx=$thnx.'-'.$b.'-01';
		}else{
			$bulanx=$thnx.'-'.$bulan.'-01';
		}
		$date=date('Y-m-t',strtotime($bulanx));
		$last= strtoupper($this->tukd_model->tanggal_format_indonesia($date));
       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang, no_qanun, tgl_qanun, no_perbup, tgl_perbup, bupati FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl     = $rowsc->tgl_rka;
                    $tanggal = $this->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                    
                    $bupati     = $rowsc->bupati;
                    $no_qanun   = $rowsc->no_qanun;
                    $tgl_qanun  = $this->tukd_model->tanggal_format_indonesia($rowsc->tgl_qanun);
                    $no_perbup  = $rowsc->no_perbup;
                    $tgl_perbup = $rowsc->tgl_perbup;
                } 
        $cRet='';
       if($perkada=="2"){ 
        $cRet .="<table width=\"100%\" align=\"center\" border=\"0\">
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">LAMPIRAN I : PERATURAN BUPATI MAMBERAMO TENGAH</td>
                    </tr>
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">NOMOR : $no_perbup</td>
                    </tr>
                    
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">TANGGAL : ".$this->tukd_model->tanggal_format_indonesia($tgl_perbup)."</td>
                    </tr>

                  </table>
				  <br>";
            
        $cRet .="<table style=\"border-collapse:collapse;  style=\"font-size:12\"\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>LAPORAN REALISASI PENJABARAN ANGGARAN </strong></td>
                    </tr>
                    
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>TAHUN ANGARAN $thn</strong></td>
                    </tr>

                  </table>"; 
				 $tanggal= $this->tukd_model->tanggal_format_indonesia($tgl_perbup);
	   }else{
		$cRet .="<table width=\"100%\" align=\"center\" border=\"0\">
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">LAMPIRAN I : PERATURAN BUPATI MAMBERAMO TENGAH</td>
                    </tr>
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">NOMOR : $no_qanun</td>
                    </tr>
                    
                    <tr>
                         <td colspan=\"6\" align=\"right\" style=\"font-size:10\">TANGGAL : $tgl_qanun</td>
                    </tr>

                  </table>
				  <br>";
            
        $cRet .="<table style=\"border-collapse:collapse;  style=\"font-size:12\"\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>$kab</strong></td>
                         
                    </tr>
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>LAPORAN REALISASI ANGGARAN </strong></td>
                    </tr>
                    
                    <tr>
                         <td colspan=\"6\" align=\"center\"><strong>PER $last</strong></td>
                    </tr>

                  </table>"; 
				  $tanggal= $tgl_qanun;
	   	   }
        $cRet .= "<table style=\"border-collapse:collapse; font-size:14;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NOMOR URUT</b></td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"45%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>ANGGARAN</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>REALISASI</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>LEBIH<br>(KURANG)</b></td>
							<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>%</b></td>
						</tr>
                     </thead>
					  <tfoot>
                        <tr><td style=\"border-bottom: none; border-left:none;border-right:none;\" colspan=\"6\"></td>
                     </tfoot>";
                 $sql1="SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
						IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek1 a INNER JOIN realisasi_bulan b
						ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='4'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
						UNION ALL
						SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
						IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek2 a 
						LEFT JOIN realisasi_bulan b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='4' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
						IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek3 a 
						LEFT JOIN realisasi_bulan b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='4'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3 
						ORDER BY kd_rek";
                 $query = $this->db->query($sql1);
                                                  
                foreach ($query->result() as $row)
                {
                    $coba1=$row->rek;
                    $coba2=ucwords(strtolower($row->nm_rek));
                    $coba3= number_format($row->anggaran,"2",",",".");
					$coba3x= number_format($row->realy,"2",",",".");
					$coba3xx=$row->anggaran - $row->realy;
					$coba3xx= number_format($coba3xx,"2",",",".");
					
					if ($row->anggaran==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$row->anggaran;
						$per1 = ($row->realy!=0)?( $row->realy /  $row->anggaran ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);
                    if(strlen($coba1)<=3){
                        $coba1_= strtoupper($coba1);
                        $coba2_= strtoupper($coba2);
                        
                        $cRet .= "<tr>
									<td width=\"10%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
                                    <td width=\"45%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
                                    <td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"5%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
								</tr>";
                        
                        $cRet    .= " <tr>
										<td  width=\"10%\" align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba1_</b></td>
										<td width=\"45%\" style=\"border-top:none;border-bottom:none;\"><b>$coba2_</b></td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba3</b></td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba3x</b></td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba3xx</b></td>
										<td width=\"5%\" align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$persen1</b></td>
									</tr>";
                    }else{
                        $cRet    .= " <tr>
										<td width=\"10%\" align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba1</td>
										<td width=\"45%\" style=\"border-top:none;border-bottom:none;\">$coba2</td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba3</td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba3x</td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba3xx</td>
										<td width=\"5%\" align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$persen1</td>
									</tr>";
                    }
                    
                }
                $sqltp="SELECT SUM(anggaran) AS totp,sum(real_spj)as realp FROM realisasi_bulan WHERE LEFT(kd_rek5,1)='4'";
                 $sqlp=$this->db->query($sqltp);
                 foreach ($sqlp->result() as $rowp)
                {
                   $coba4=number_format($rowp->totp,"2",",",".");
                    $cob1=$rowp->totp;
					$cob1x=$rowp->realp;
					$coba4x=number_format($rowp->realp,"2",",",".");
					$cob1xx=$cob1-$cob1x;
					$cob1xxx=number_format($cob1xx,"2",",",".");
					if ($cob1==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$cob1;
						$per1 = ($cob1x!=0)?( $cob1x /  $cob1 ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                    $cRet    .= " <tr><td idth=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"45%\" align=\"right\"><b>JUMLAH PENDAPATAN&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba4</b></td>
									 <td width=\"15%\" align=\"right\"><b>$coba4x</b></td>
									 <td width=\"15%\" align=\"right\"><b>$cob1xxx</b></td>
									 <td width=\"5%\" align=\"center\"><b>$persen1</b></td>
								  </tr>";
                 } 
				
                $sql2="SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
					IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek1 a INNER JOIN realisasi_bulan b
					ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='5'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
					UNION ALL 
					SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
					IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy  FROM ms_rek2 a LEFT JOIN realisasi_bulan b
					ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,1)='5' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
					UNION ALL 
					SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
					IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek3 a LEFT JOIN realisasi_bulan b
					ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,1)='5'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3 ORDER BY kd_rek";
                 
                 $query1 = $this->db->query($sql2);
                 foreach ($query1->result() as $row1)
                {
                    $coba5=$row1->rek;
                    $coba6=ucwords(strtolower($row1->nm_rek));
                    $coba7= number_format($row1->anggaran,"2",",",".");
					$coba7x= number_format($row1->realy,"2",",",".");
					$coba7xx=$row1->anggaran - $row1->realy;
					$coba7xxx= number_format($coba7xx,"2",",",".");

					if ($row1->anggaran==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$row1->anggaran;
						$per1 = ($row1->realy!=0)?($row1->realy /  $row1->anggaran ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                    if(strlen($coba5)<=3){
                        $coba5_= strtoupper($coba5);
                        $coba6_= strtoupper($coba6);
                        
                        $cRet .= "<tr><td width=\"10%\" align=\"center\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
										<td width=\"45%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
										<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
										<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
										<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
										<td width=\"5%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
								</tr>";
                        
                         $cRet    .= " <tr>
										<td width=\"10%\" align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba5_</b></td>
										<td width=\"45%\" align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba6_</b></td>
                                        <td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba7</b></td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba7x</b></td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba7xxx</b></td>
										<td width=\"5%\" align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$persen1</b></td>
									</tr>";
                    }else{
                         $cRet    .= " <tr><td width=\"10%\" align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba5</td>                                     
										<td width=\"45%\" align=\"left\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba6</td>
										<td width=\"20%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba7</td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba7x</td>
										<td width=\"15%\" align=\"right\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba7xxx</td>
										<td width=\"5%\" align=\"center\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$persen1</td>
									</tr>";
                    }
                    
                }
                
                    $sqltb="SELECT SUM(anggaran) AS totb,sum(real_spj)as realb FROM realisasi_bulan WHERE LEFT(kd_rek5,1)='5'";
                    $sqlb=$this->db->query($sqltb);
                 foreach ($sqlb->result() as $rowb)
                {
                   $coba8=number_format($rowb->totb,"2",",",".");
                    $cob=$rowb->totb;
					$coba8x=number_format($rowb->realb,"2",",",".");
                    $cobx=$rowb->realb;
					$cobxx= $cob - $cobx;
					$cobxxx = number_format($cobxx,"2",",",".");

					if ($cob==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$cob;
						$per1 = ($cobx!=0)?($cobx /  $cob ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"45%\" align=\"right\"><b>JUMLAH BELANJA&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba8</b></td>
									<td width=\"15%\" align=\"right\"><b>$coba8x</b></td>
									<td width=\"15%\" align=\"right\"><b>$cobxxx</b></td>
									<td width=\"5%\" align=\"center\"><b>$persen1</b></td>
								</tr>";
                 } 
                  
                  $suplus=$cob1-$cob; 
                  if ($suplus < 0){
                	$x1="(";
                	$suplus=$suplus*-1;
                	$y1=")";}
                  else {
                	$x1="";
	                $y1="";}
                 $surp=number_format($suplus,2,',','.');

				  $suplusx=$cob1x-$cobx; 
                  if ($suplusx < 0){
                	$xx1="(";
                	$suplusx=$suplusx*-1;
                	$yy1=")";}
                  else {
                	$xx1="";
	                $yy1="";}
                 $surpx=number_format($suplusx,2,',','.');

				 $suplusxx=$cob1xx-$cobxx; 
                  if ($suplusxx < 0){
                	$xxx1="(";
                	$suplusxx=$suplusxx*-1;
                	$yyy1=")";}
                  else {
                	$xxx1="";
	                $yyx1="";}
                 $surpxx=number_format($suplusxx,2,',','.');
					
				 if ($suplus==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$suplus;
						$per1 = ($suplusx!=0)?($suplusx /  $suplus ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"45%\" align=\"right\"><b>SURPLUS/DEFISIT</b> &nbsp;&nbsp;&nbsp;&nbsp;</td>
                                     <td width=\"15%\" align=\"right\"><b>$x1$surp$y1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$xx1$surpx$yy1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$xxx1$surpxx$yyy1</b></td>
									 <td width=\"5%\" align=\"center\"><b></b></td>
									</tr>";
                   
                    $sql3="SELECT a.kd_rek1 AS kd_rek,a.lra AS rek, a.nm_rek1 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
							IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek1 a INNER JOIN realisasi_bulan b
							ON a.kd_rek1=LEFT(b.kd_rek5,(LENGTH(a.kd_rek1))) WHERE LEFT(a.kd_rek1,1)='6'  GROUP BY a.kd_rek1,a.lra, a.nm_rek1
							UNION ALL 
							SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
							IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek2 a LEFT JOIN realisasi_bulan b
							ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='61' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
							UNION ALL 
							SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
							IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek3 a LEFT JOIN realisasi_bulan b
							ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='61'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3 ORDER BY kd_rek";
                 
                 $query3 = $this->db->query($sql3);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query3->result() as $row3)
                {
                    $coba9=$row3->rek;
                    $coba10=ucwords(strtolower($row3->nm_rek));
                    $coba11= number_format($row3->anggaran,"2",",",".");
					$coba11x=number_format($row3->realy,"2",",",".");
					$coba11xx=$row3->anggaran - $row3->realy;
					$coba11xxx=number_format($coba11xx,"2",",",".");

					if ($row3->anggaran==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$row3->anggaran;
						$per1 = ($row3->realy!=0)?($row3->realy /  $row3->anggaran ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                   if(strlen($coba9)<=3){
                        $coba9_= strtoupper($coba9);
                        $coba10_= strtoupper($coba10);
                        
                        $cRet .= "<tr><td width=\"10%\" valign=\"top\" align=\"center\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
									   <td width=\"45%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									   <td width=\"15%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									   <td width=\"15%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									   <td width=\"15%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									   <td width=\"5%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									</tr>";
                        if(strlen($coba9)==1){
                            $cRet    .= " <tr><td  width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"><b>$coba9_</b></td>                                     
                                     <td width=\"45%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba10_</b></td>
                                     <td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>&nbsp;</b></td>
										<td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>&nbsp;</b></td>
									   <td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>&nbsp;</b></td>
									   <td width=\"5%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>&nbsp;</b></td>
									 </tr>";
                        }else{
                            $cRet    .= " <tr>
										<td  width=\"10%\" valign=\"top\" align=\"left\" style=\"border-top:none;border-bottom:none;\"><b>$coba9_</b></td>
										<td width=\"45%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\"><b>$coba10_</b></td>
										<td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba11</b></td>
										<td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba11x</b></td>
										<td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba11xxx</b></td>
										<td width=\"5%\" valign=\"top\" align=\"center\" style=\"border-top:none;border-bottom:none;\"><b>$persen1</b></td>
										</tr>";
                        }
                   }else{
                       $cRet    .= " <tr>
									<td  width=\"10%\" valign=\"top\" align=\"left\" style=\"border-top:none;border-bottom:none;\">$coba9</td>
									<td width=\"45%\" valign=\"top\" style=\"border-top:none;border-bottom:none;\">$coba10</td>
                                     <td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba11</td>
									 <td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba11x</td>
									 <td width=\"15%\" valign=\"top\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba11xxx</td>
									 <td width=\"5%\" valign=\"top\" align=\"center\" style=\"border-top:none;border-bottom:none;\">$persen1</td>
									</tr>";
                   }
                     
                }
                $sqltpm="SELECT SUM(anggaran) AS totpm, SUM(real_spj) AS realpm FROM realisasi_bulan WHERE LEFT(kd_rek5,2)='61'";
                 $sqlpm=$this->db->query($sqltpm);
                 foreach ($sqlpm->result() as $rowpm)
                {
                   $coba12=number_format($rowpm->totpm,"2",",",".");
                    $cob3=$rowpm->totpm;
					$cob3x=$rowpm->realpm;
				    $coba12x=number_format($cob3x,"2",",",".");
					$cob3xx=$cob3 - $cob3x;
					$cob3xxx=number_format($cob3xx,"2",",",".");
                   if ($cob3==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$cob3;
						$per1 = ($cob3x!=0)?($cob3x /  $cob3 ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);
                    $cRet    .= " <tr><td width=\"10%\" valign=\"top\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                      <td width=\"45%\" valign=\"top\" align=\"right\"><b>JUMLAH PEMBIAYAAN MASUK&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                      <td width=\"15%\" valign=\"top\" align=\"right\"><b>$coba12</b></td>
									  <td width=\"15%\" valign=\"top\" align=\"right\"><b>$coba12x</b></td>
									  <td width=\"15%\" valign=\"top\" align=\"right\"><b>$cob3xxx</b></td>
									  <td width=\"5%\" valign=\"top\" align=\"center\"><b>$persen1</b></td>
									</tr>";
                 }
                  
                $sql4="SELECT a.kd_rek2 AS kd_rek,a.lra AS rek,a.nm_rek2 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
						IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek2 a LEFT JOIN realisasi_bulan b
						ON a.kd_rek2=LEFT(b.kd_rek5,(LENGTH(a.kd_rek2))) WHERE LEFT(a.kd_rek2,2)='62' GROUP BY a.kd_rek2,a.lra,a.nm_rek2 
						UNION ALL 
						SELECT a.kd_rek3 AS kd_rek,a.lra AS rek,a.nm_rek3 AS nm_rek ,IF(SUM(b.anggaran) IS NULL, 0 , SUM(b.anggaran)) AS anggaran,
						IF(SUM(b.real_spj) IS NULL, 0 , SUM(b.real_spj)) AS realy FROM ms_rek3 a LEFT JOIN realisasi_bulan b
						ON a.kd_rek3=LEFT(b.kd_rek5,(LENGTH(a.kd_rek3))) WHERE LEFT(a.kd_rek3,2)='62'  GROUP BY a.kd_rek3,a.lra, a.nm_rek3 ORDER BY kd_rek";
                 
                 $query4 = $this->db->query($sql4);
                 //$query = $this->skpd_model->getAllc();
                                                  
                foreach ($query4->result() as $row4)
                {
                    $coba13=$row4->rek;
                    $coba14=ucwords(strtolower($row4->nm_rek));
                    $coba15= number_format($row4->anggaran,"2",",",".");
					$coba15x= number_format($row4->realy,"2",",",".");
					$coba15xx=$row4->anggaran - $row4->realy;
					$coba15xxx=number_format($coba15xx,"2",",",".");

					 if ($row4->anggaran==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$row4->anggaran;
						$per1 = ($row4->realy!=0)?($row4->realy /  $row4->anggaran ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                   if(strlen($coba13)<=3){
                        $coba13_= strtoupper($coba13);
                        $coba14_= strtoupper($coba14);

                        $cRet .= "<tr><td width=\"10%\" align=\"center\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
									<td width=\"45%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"5%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
								</tr>";
                        
                       $cRet    .= " <tr>
									<td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"><b>$coba13_</b></td>
                                     <td width=\"45%\" style=\"border-top:none;border-bottom:none;\"><b>$coba14_</b></td>
                                     <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba15</b></td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba15x</b></td>
									 <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\"><b>$coba15xxx</b></td>
									 <td width=\"5%\"  align=\"center\" style=\"border-top:none;border-bottom:none;\"><b>$persen1</b></td>
									</tr>";
                   }else{
                       $cRet    .= " <tr>
									<td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\">$coba13</td>                          
                                     <td width=\"45%\" style=\"border-top:none;border-bottom:none;\">$coba14</td>
                                     <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba15</td>
									<td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba15x</td>                          
                                     <td width=\"15%\" align=\"right\" style=\"border-top:none;border-bottom:none;\">$coba15xxx</td>
                                     <td width=\"5%\" align=\"center\" style=\"border-top:none;border-bottom:none;\">$persen1</td>
									 </tr>";
                   }
                     
                }
                $sqltpk="SELECT SUM(anggaran) AS totpk,SUM(real_spj) AS realpk FROM realisasi_bulan WHERE LEFT(kd_rek5,2)='62'";
                 $sqlpk=$this->db->query($sqltpk);
                 foreach ($sqlpk->result() as $rowpk)
                {
                   $coba16=number_format($rowpk->totpk,"2",",",".");
				   $coba16x=number_format($rowpk->realpk,"2",",",".");
                    $cob4=$rowpk->totpk;
					$cob4x=$rowpk->realpk;
					$cob4xx=$cob4 - $cob4x;
					$cob4xxx=number_format($cob4xx,"2",",",".");

					if ($cob4==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$cob4;
						$per1 = ($cob4!=0)?($cob4x /  $cob4 ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);
                   
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"45%\" align=\"right\"><b>JUMLAH PEMBIAYAAN KELUAR&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$coba16</b></td>
									 <td width=\"15%\" align=\"right\"><b>$coba16x</b></td>
									 <td width=\"15%\" align=\"right\"><b>$cob4xxx</b></td>
									 <td width=\"5%\" align=\"center\"><b>$persen1</b></td>
									 </tr>";
                 }  
                  
                  $netto=$cob3-$cob4; 
                  if ($netto < 0){
                	$a1="(";
                	$netto=$netto*-1;
                	$b1=")";}
                  else {
                	$a1="";
	                $b1="";}
                 $nett=number_format($netto,2,',','.');
				 
				 $nettox=$cob3x-$cob4x; 
                  if ($nettox < 0){
                	$aa1="(";
                	$nettox=$nettox*-1;
                	$bb1=")";}
                  else {
                	$aa1="";
	                $bb1="";}
                 $nettx=number_format($nettox,2,',','.');

				 $nettoxx=$cob3xx-$cob4xx; 
                  if ($nettox < 0){
                	$aaa1="(";
                	$nettoxx=$nettoxx*-1;
                	$bbb1=")";}
                  else {
                	$aaa1="";
	                $bbb1="";}
                 $nettxx=number_format($nettoxx,2,',','.');
					
					if ($netto==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$netto;
						$per1 = ($nettox!=0)?($nettox /  $netto ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                    $cRet .= "<tr><td width=\"10%\" align=\"center\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>                            
									<td width=\"45%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"15%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
									<td width=\"5%\" style=\"border-top:none;border-bottom:none;\">&nbsp;</td>
							  </tr>";
                 
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\" style=\"border-top:none;border-bottom:none;\"></td>                                     
                                     <td width=\"45%\" align=\"right\"><b>PEMBIAYAAN NETTO&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$a1$nett$b1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$aa1$nettx$bb1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$aaa1$nettxx$bbb1</b></td>
									 <td width=\"5%\" align=\"center\"><b>$persen1</b></td>
								</tr>";
                    $silpa=($cob1+$cob3)-($cob+$cob4);
                     if ($silpa < 0){
						$c1="(";
						$silpa=$silpa*-1;
						$d1=")";}
                    else {
						$c1="";
						$d1="";}
					$silp=number_format($silpa,2,',','.'); 
					
					$silpax=($cob1x+$cob3x)-($cobx+$cob4x);
                     if ($silpax < 0){
						$cc1="(";
						$silpax=$silpax*-1;
						$dd1=")";}
                    else {
						$cc1="";
						$dd1="";}
					$silpx=number_format($silpax,2,',','.'); 

					$silpaxx=($cob1xx+$cob3xx)-($cobxx+$cob4xx);
                     if ($silpaxx < 0){
						$ccc1="(";
						$silpaxx=$silpaxx*-1;
						$ddd1=")";}
                    else {
						$ccc1="";
						$ddd1="";}
					$silpxx=number_format($silpaxx,2,',','.'); 
					
					if ($silpa==0){
                        $tmp=1;
						$per1=0;
                    }else{
                        $tmp=$silpa;
						$per1 = ($silpax!=0)?($silpax /  $silpa ) * 100:0; 
                    }
					$persen1  = number_format($per1,2);

                    $cRet .= "<tr><td width=\"10%\" align=\"center\">&nbsp;</td>                            
								<td width=\"45%\">&nbsp;</td>
								<td width=\"15%\">&nbsp;</td>
								<td width=\"15%\">&nbsp;</td>
								<td width=\"15%\">&nbsp;</td>
								<td width=\"5%\">&nbsp;</td>
							</tr>";
                    
                    $cRet    .= " <tr><td width=\"10%\" align=\"left\"><b>3.3</b></td>                                     
                                     <td width=\"45%\" ><b>SISA LEBIH PEMBIAYAAN ANGGARAN TAHUN BERKENAAN (SILPA)&nbsp;&nbsp;&nbsp;&nbsp;</b></td>
                                     <td width=\"15%\" align=\"right\"><b>$c1$silp$d1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$cc1$silpx$dd1</b></td>
									 <td width=\"15%\" align=\"right\"><b>$ccc1$silpxx$ddd1</b></td>
									 <td width=\"5%\" align=\"center\"><b></b></td>
									</tr>";
                    $cRet .="<tr>
                                <td width=\"100%\" align=\"left\" colspan=\"6\">
                                                    <table border=\"0\" cellpading = \"8\" width=\"100%\">
                                                        <tr>
                                                            <td width=\"90%\" align=\"left\">&nbsp;<br>&nbsp;
								<br>&nbsp;
								&nbsp;<br>
                                                                &nbsp;<br>
                                                                &nbsp;<br>
								&nbsp;	
                                                            </td> 
                                             <td width=\"30%\" align=\"center\">".ucwords(strtolower($daerah)).",   ".$last."
                                                                <p>BUPATI MAMBERAMO TENGAH</p>
                                                                <p>&nbsp;</p>
                                                                <br><br>
                                                                <br><b>$bupati</b>
                                                                <br>
                                                            </td>
                                                        </tr>
                                                    </table></td>
                             </tr>";
                    
        $cRet    .= "</table>";
        $data['prev']= $cRet;
        $this->template->set('title', 'CETAK PERDA');
       // $this->_mpdf1('',$cRet,25,10,10,'P','',$hal);
        switch($cetak) {
			case 0;
				 echo ("<title>L R A</title>"); 
				 echo $cRet;
			break;		
			case 1;
				 $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
			break;
			case 2;        
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-excel");
				header("Content-Disposition: attachment; filename= $judul.xls");
				
				$this->load->view('anggaran/rka/perkadaII', $data);
			break;
			case 3;     
				header("Cache-Control: no-cache, no-store, must-revalidate");
				header("Content-Type: application/vnd.ms-word");
				header("Content-Disposition: attachment; filename= $judul.doc");
				$this->load->view('anggaran/rka/perkadaII', $data);
			break;
        
        }
    }

    function prognosis_skpkd(){
       $data['page_title'] = 'PROGNOSIS SKPKD';
        $this->template->set('title', 'PROGNOSIS SKPKD');
        $this->template->load('template', 'akuntansi/prognosis_skpkd', $data);
    }

    function cetak_perda1_semester_skpkd(){
	
        $id 	   = '1.20.06.00'; 
        $thn_ang   = $this->session->userdata('pcThang');
       // $tgl_ttd   = $_REQUEST['tgl_ctk'];
		$hala  = $_REQUEST['posx'];
       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
				
       $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk 
                    FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
     
        $sql="SELECT 
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='1.20.06.00'
AND LEFT(c.kd_rek64,1)='4'),0) AS angpen,
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='1.20.06.00'
AND LEFT(c.kd_rek64,1)='5'),0) AS angbel,
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='1.20.06.00'
AND LEFT(c.kd_rek64,1)='6'),0) AS angtansfer,
IFNULL((SELECT SUM(b.kredit)-SUM(b.debet) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE b.kd_skpd='1.20.06.00' AND LEFT(b.kd_rek5,1)='4' AND MONTH(a.tgl_voucher)<='6'),0) AS totpen,
IFNULL((SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE b.kd_skpd='1.20.06.00' AND LEFT(b.kd_rek5,1)='5' AND MONTH(a.tgl_voucher)<='6'),0) AS totbel,
IFNULL((SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE b.kd_skpd='1.20.06.00' AND LEFT(b.kd_rek5,1)='6' AND MONTH(a.tgl_voucher)<='6'),0) AS tottransfer
";    
                                                
                    $query   = $this->db->query($sql);
                    $hasil   = $query->row();
                    $angpen  = $hasil->angpen;
                    $angbel  = $hasil->angbel;
                    $angtf   = $hasil->angtansfer;
                    
                    $totpen  = $hasil->totpen;
                    $totbel  = $hasil->totbel;
                    $tottf   = $hasil->tottransfer;                 
              //total belanja + total transfer
        //anggaran
        $astaga=$angbel+$angtf;
        $astaga1= number_format($astaga,"2",".",",");
        //nilai
        $abdi=$totbel+$tottf;
        $abdi1= number_format($abdi,"2",".",",");

//sisa
        $sesana = $astaga-$abdi;
        if ($sesana < 0){
                    	$ac1="("; 
                        $sesana=$sesana*-1; 
                        $ca1=")";
                        }else{
                    	$ac1="";
                        $sesana=$sesana*1; 
                        $ca1="";
                        }
		$sesana1= number_format($sesana,"2",".",",");		

		//surplus = pendapatan -(total belanja + total transfer)
		//angaran
		$surplusacf=$angpen-$astaga;
        if ($surplusacf < 0){
                    	$x1="("; 
                        $surplusacf=$surplusacf*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $surplusacf=$surplusacf*1; 
                        $y1="";
                        }
		$surplusacf1= number_format($surplusacf,"2",".",",");			
		//surplus = pendapatan -(total belanja + total transfer)
		//nilai
		$surplusnilai=$totpen-$abdi;
		if ($surplusnilai < 0){
                    	$xx1="("; 
                        $surplusnilai=$surplusnilai*-1; 
                        $yy1=")";
                        }else{
                    	$xx1="";
                        $surplusnilai=$surplusnilai*1; 
                        $yy1="";
                        }
		$surplusnilai1= number_format($surplusnilai,"2",".",",");			

		$surplussisa=$surplusacf-$surplusnilai;
		if ($surplussisa < 0){
                    	$xxx1="("; 
                        $surplussisa=$surplussisa*-1; 
                        $yyy1=")";
                        }else{
                    	$xxx1="";
                        $surplussisa=$surplussisa*1; 
                        $yyy1="";
                        }
		$surplussisa1= number_format($surplussisa,"2",".",",");			




		$sqltotalitasah="SELECT 
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='1.20.06.00'
AND LEFT(c.kd_rek64,2)='71'),0) AS totpenbim,
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='1.20.06.00'
AND LEFT(c.kd_rek64,2)='72'),0) AS totpengbin,
IFNULL((SELECT SUM(b.kredit)-SUM(b.debet) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE b.kd_skpd='1.20.06.00' AND LEFT(b.kd_rek5,2) IN ('71','72') AND MONTH(a.tgl_voucher)<='6'),0) AS totpenil";
	$sqltotalitasah1=$this->db->query($sqltotalitasah);
                 foreach ($sqltotalitasah1->result() as $rowasa)
                {
                    $totpenbim=$rowasa->totpenbim;                    
                    $totpengbin= $rowasa->totpengbin;
                    $totpenil  = $rowasa->totpenil;
                    
                } 

	$lembur=$totpenbim-$totpengbin;
	$sisak=$lembur-$totpenil;
		
	$lembur1= number_format($lembur,"2",".",",");
	$sisak1= number_format($sisak,"2",".",",");
//anggran
	$silpaade=$surplusacf+$lembur;
	$silpaade1= number_format($silpaade,"2",".",",");
	$totpenil1=number_format($totpenil,"2",".",",");
	$sisanyaaja=($silpaade-$totpenil);
$sisanyaaja1= number_format($sisanyaaja,"2",".",",");

//nilai
	$silpaadenilai=$surplusnilai+$totpenil;
	$silpaadenilai1= number_format($silpaadenilai,"2",".",",");
//sisa
	$silpasisa=$silpaade-$silpaadenilai;
	if ($silpasisa < 0){
                    	$a12="("; 
                        $silpasisa=$silpasisa*-1; 
                        $c12=")";
                        }else{
                    	$a12="";
                        $silpasisa=$silpasisa*1; 
                        $c12="";
                        }
    $silpasisa= number_format($silpasisa,"2",".",",");

$angaransilpa=$angpen-($angbel+$angtf)+($lembur);

if ($angaransilpa < 0){
                    	$a12="("; 
                        $angaransilpa=$angaransilpa*-1; 
                        $c12=")";
                        }else{
                    	$a12="";
                        $angaransilpa=$angaransilpa*1; 
                        $c12="";
                        }
$angaransilpa1= number_format($angaransilpa,"2",".",",");
                    





       
        $cRet='';       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>LAPORAN REALISASI SEMESTER PERTAMA PENDAPATAN DAN BELANJA SKPD<br>SERTA PROGNOSIS 6 (ENAM) BULAN BERIKUTNYA</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>                         
                    </tr>                                       
                    <tr>
                         <td align=\"center\"><strong>Tahun Anggaran $thn_ang</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"1%\" align=\"center\"><b>NO</b></td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"11%\" align=\"center\"><b>Jumlah Anggaran</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Realisasi Semester Pertama</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\" ><b>Sisa Anggaran<br>s.d<br>Semester Pertama</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\" ><b>Prognosis</b></td>  
							<td bgcolor=\"#CCCCCC\" width=\"3%\" align=\"center\" ><b>Keterangan</b></td> 
                        </tr>  
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td> 
							<td style=\"border-top: none;\"></td>
                         </tr>
                     </tfoot>";

                 $sql4 ="SELECT nor,uraian,seq,
(SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='1.20.06.00' 
AND (LEFT(c.kd_rek64,5)=a.kode_1 OR LEFT(c.kd_rek64,4)=a.kode_1 OR LEFT(c.kd_rek64,3)=a.kode_1 OR LEFT(c.kd_rek64,2)=a.kode_1 OR LEFT(c.kd_rek64,1)=a.kode_1)) AS anggaran,

(SELECT SUM(debet) AS debet FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE b.kd_skpd='1.20.06.00' AND MONTH(a.tgl_voucher)<='6' 
AND (LEFT(b.kd_rek5,5)=a.kode_1 OR LEFT(b.kd_rek5,4)=a.kode_1 OR LEFT(b.kd_rek5,3)=a.kode_1 OR LEFT(b.kd_rek5,2)=a.kode_1 OR LEFT(b.kd_rek5,1)=a.kode_1)) AS debet,

(SELECT SUM(kredit) AS kredit FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE b.kd_skpd='1.20.06.00' AND MONTH(a.tgl_voucher)<='6' 
AND (LEFT(b.kd_rek5,5)=a.kode_1 OR LEFT(b.kd_rek5,4)=a.kode_1 OR LEFT(b.kd_rek5,3)=a.kode_1 OR LEFT(b.kd_rek5,2)=a.kode_1 OR LEFT(b.kd_rek5,1)=a.kode_1)) AS kredit	
FROM map_lra_ppkd_kab a ORDER BY CAST(nor AS SIGNED)";
                            
                $query4 = $this->db->query($sql4);                                  
                foreach ($query4->result() as $row4)
                {
                    $no         = $row4->nor;
                    $nama       = $row4->uraian;   
                    $anggaran   = $row4->anggaran;
                    $debet      = $row4->debet;
                    $kredit     = $row4->kredit;
                    $seq        = $row4->seq;
                    
                    $angg  = number_format($anggaran,"2",".",",");
                    if($row4->seq<'166'){
                      $nilai = $kredit-$debet;
                    }else{
                      $nilai = $debet-$kredit;    
                    }
                    
					
					if ($nilai < 0){
                    	$x='('; 
                        $nilai=$nilai*-1; 
                        $y=')';
                        }else {
                    	$x='';
                        $nilai=$nilai*1; 
                        $y='';
                        } 

                $nil  = number_format($nilai,"2",".",",");





					$sisa = $anggaran - $nilai;
					if ($sisa < 0){
                    	$x='('; 
                        $sisa=$sisa*-1; 
                        $y=')';
                        }else {
                    	$x='';
                        $sisa=$sisa*1; 
                        $y='';
                        } 

					$sisaangg  = number_format($sisa,"2",".",",");
					
                    switch ($row4->seq) {
                    case 5:
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
					 case 10:
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                        //JUMLAH
                    case 35:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 45 :
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
					 case 50:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                    case 75:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 85:
                        $cRet    .= "<tr>
                                          <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;                                         
                    case 105:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 115:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";

                        break;
                        case 135:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>";
                        break;

                   case 145:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";

                        break;

                 
                    case 145:
                        $cRet    .= "<tr>
                                        <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                         case 165:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						case 170:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						
                        
                          case 180:
                        $cRet    .= "<tr>
                                        <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
						
							case 205:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						case 215:
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
					 case 220:
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
						case 255:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> $x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
					  
					  
                       
                          
                         //header
                         case 310:
                        $cRet    .= "<tr>
                                        <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                        
                        //jumlah
                        case 320:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						case 325:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                         //header
                         case 335:
                        $cRet    .= "<tr>
                                        <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                       
                       
                         //jumlah
                        case 360:

                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						
						  //header
                         case 370:
                        $cRet    .= "<tr>
                                        <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                       
						
						   case 390:

                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						
						
						  case 395:

                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						
						
						
                         //belanja + transfer
                        case 400:
		
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$astaga1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$abdi1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$ac1$sesana1$ca1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$ac1$sesana1$ca1</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                       
         
		   case 410:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$surplusacf1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$xx1$surplusnilai1$yy1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$xxx1$surplussisa1$yyy1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$xxx1$surplussisa1$yyy1</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
		   //header
                         case 420:
                        $cRet    .= "<tr>
                                        <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
						
						              case 430:
                        $cRet    .= "<tr>
                                        <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
						
							case 495:

                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;

                        case 505:
                        $cRet    .= "<tr>
                                        <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
						
                         //jumlah
                        case 570:

                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						
						
						        case 575:

                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$lembur1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$totpenil1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$sisak1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$sisak1</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						
						
						
						
						case 585:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angaransilpa1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$silpaadenilai1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$a12 $silpasisa $c12</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$a12 $silpasisa $c12</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
						
						

                    default:
					if($nama <> ''){
                    $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$angg</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nil</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$x$sisaangg$y</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$x$sisaangg$y</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";
					}else{
					 $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";	
					}
                }         
                }

        $cRet .=       " </table>";
		$cRet .= " <br><br>";
 
	$skpdx=$kd_skpd.' '.$nm_skpd;
		
		 
		
		
			$ctk = $this->uri->segment(3);
		   $data['prev']= $cRet;
            switch($ctk) {        
                case 1;
                       $this->_mpdf1('',$cRet,25,10,10,'P',$skpdx,$hala);
                break;
                case 2;        
                    header("Cache-Control: no-cache, no-store, must-revalidate");
                    header("Content-Type: application/vnd.ms-excel");
                    header("Content-Disposition: attachment; filename=skpkd.xls");
                    $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            } 

                 
    }


    function cetak_lra_skpd(){
        $id        = $_REQUEST['kdskpd']; 
        $thn_ang   = $this->session->userdata('pcThang');
        $bul       = $_REQUEST['bulan'];
        $bulan     = $this->tukd_model->getBulan($bul); 
        $tgl_ttd   = $_REQUEST['tgl_ctk'];       
        $thn_ang_1 = $thn_ang-1;  
	
		if($id=='1.20.06.00'){
			//ppkd
		$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
			$sqlsclient=$this->db->query($sqlsc);
			foreach ($sqlsclient->result() as $rowsc){
				$tgl=$rowsc->tgl_rka;
				$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
				$kab     = $rowsc->kab_kota;
				$daerah  = $rowsc->daerah;
				$thn     = $rowsc->thn_ang;
			}  
     
        $sql="SELECT 
					(SELECT IFNULL(SUM(nilai_ubah),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,1)='4' AND b.kd_skpd='$id') AS angpen,
					(SELECT IFNULL(SUM(nilai_ubah),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,1)='5' AND b.kd_skpd='$id') AS angbel,
					(SELECT IFNULL(SUM(nilai_ubah),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='61' AND b.kd_skpd='$id') AS angpentrans,
					(SELECT IFNULL(SUM(nilai_ubah),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='62' AND b.kd_skpd='$id') AS angbeltrans,
					(SELECT IFNULL(SUM(nilai_ubah),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='71' AND b.kd_skpd='$id') AS angpenepemb,
					(SELECT IFNULL(SUM(nilai_ubah),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='72' AND b.kd_skpd='$id') AS angpengpemb,
					
					(SELECT IFNULL(SUM(b.kredit)-SUM(b.debet),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,1)='4' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang' AND a.kd_skpd='$id' AND b.kd_skpd='$id') AS totpen,
					(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,1)='5' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang' AND a.kd_skpd='$id' AND b.kd_skpd='$id') AS totbel,
					(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,2)='61' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang' AND a.kd_skpd='$id' AND b.kd_skpd='$id') AS totpentrans,
					(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0)  AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,2)='62' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang' AND a.kd_skpd='$id' AND b.kd_skpd='$id')AS totbeltrans,
					(SELECT IFNULL(SUM(b.kredit)-SUM(b.debet),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,2)='71' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang' AND a.kd_skpd='$id' AND b.kd_skpd='$id') AS totpenepemb,
					(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
						WHERE LEFT(b.kd_rek5,2)='72' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang' AND a.kd_skpd='$id' AND b.kd_skpd='$id') AS totpengpemb,



(SELECT IFNULL(SUM(b.kredit)-SUM(b.debet),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
WHERE LEFT(b.kd_rek5,1)='4' and tgl_voucher='2015-12-31'  AND a.kd_skpd='$id' AND b.kd_skpd='$id') AS totpenlalu,
(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
WHERE LEFT(b.kd_rek5,1)='5' and tgl_voucher='2015-12-31' AND a.kd_skpd='$id' AND b.kd_skpd='$id') AS totbellalu,
(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
WHERE LEFT(b.kd_rek5,2)='61' and tgl_voucher='2015-12-31' AND a.kd_skpd='$id' AND b.kd_skpd='$id') AS totpentranslalu,
(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0)  AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
WHERE LEFT(b.kd_rek5,2)='62'and tgl_voucher='2015-12-31'  AND a.kd_skpd='$id' AND b.kd_skpd='$id')AS totbeltranslalu,
(SELECT IFNULL(SUM(b.kredit)-SUM(b.debet),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
WHERE LEFT(b.kd_rek5,2)='71' and tgl_voucher='2015-12-31' AND a.kd_skpd='$id' AND b.kd_skpd='$id') AS totpenepemblalu,
(SELECT IFNULL(SUM(b.debet)-SUM(b.kredit),0) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
WHERE LEFT(b.kd_rek5,2)='72' and tgl_voucher='2015-12-31' AND a.kd_skpd='$id' AND b.kd_skpd='$id') AS totpengpemblalu


";    
			 
				$query   = $this->db->query($sql);
				$hasil   = $query->row();
				$angpen  = $hasil->angpen;
				$angbel  = $hasil->angbel;
				$angpentrans = $hasil->angpentrans;
				$angbeltrans = $hasil->angbeltrans;
				$angtrans = $hasil->angpentrans+$hasil->angbeltrans;
				$angpenepemb = $hasil->angpenepemb;
				$angpengpemb = $hasil->angpengpemb;
				$silang	= $hasil->angpenepemb-$hasil->angpengpemb;




				$totpen  = $hasil->totpen;
				$totbel  = $hasil->totbel;
				$totpentrans = $hasil->totpentrans;
				$totbeltrans = $hasil->totbeltrans;
				$tottrans = $hasil->totpentrans+$hasil->totbeltrans;
				$totpenepemb = $hasil->totpenepemb;
				$totpengpemb = $hasil->totpengpemb;
				$silreal = $hasil->totpenepemb-$hasil->totpengpemb;




				$totpenlalu  = $hasil->totpenlalu;
				$totbellalu  = $hasil->totbellalu;
				$totpentranslalu = $hasil->totpentranslalu;
				$totbeltranslalu = $hasil->totbeltranslalu;
				$tottranslalu = $hasil->totpentranslalu+$hasil->totbeltranslalu;
				$totpenepemblalu = $hasil->totpenepemblalu;
				$totpengpemblalu = $hasil->totpengpemblalu;
				$silreallalu = $hasil->totpenepemblalu-$hasil->totpengpemblalu;

	//**--------------------------------transfer-----------------------------------------------	
		$abeltrans = $angbel+$angtrans;
		if($abeltrans < 0){$q1="(";$abeltrans=$abeltrans*-1;$q2=")";}else{$q1="";$abeltrans=$abeltrans;$q2="";}
        $abeltrans1 = number_format($abeltrans,"2",".",",");
		
		$rbeltrans = $totbel+$tottrans;
		if($rbeltrans < 0){$q3="(";$rbeltrans=$rbeltrans*-1;$q4=")";}else{$q3="";$rbeltrans=$rbeltrans;$q4="";}
        $rbeltrans1 = number_format($rbeltrans,"2",".",",");



//lalu
        $rbeltranslalu = $totbellalu+$tottranslalu;
		if($rbeltranslalu < 0){$q3lalu="(";$rbeltranslalu=$rbeltranslalu*-1;$q4lalu=")";}else{$q3lalu="";$rbeltranslalu=$rbeltranslalu;$q4lalu="";}
        $rbeltranslalu1 = number_format($rbeltranslalu,"2",".",",");





		
		if ($abeltrans<>0){$per4 = ($abeltrans!=0)?($rbeltrans/$abeltrans)*100:0;}else if($abeltrans==0 and $rbeltrans!=0){$per4=100;} else{$per4=0;}                
		$persen4 = number_format($per4,"2",".",",");			
	//**--------------------------------surplus------------------------------------------------
        $surang = $angpen-($angbel+$angtrans);
        if ($surang < 0){$w1="(";$surang=$surang*-1;$w2=")";}else{$w1="";$surang=$surang;$w2="";}						
        $surang1= number_format($surang,"2",".",",");
        
        $surrel = $totpen-($totbel+$tottrans);
        if ($surrel < 0){$w3="(";$surrel=$surrel*-1;$w4=")";}else{$w3="";$surrel=$surrel;$w4="";}				
        $surrel1= number_format($surrel,"2",".",",");	

//lalu

        $surrellalu = $totpenlalu-($totbellalu+$tottranslalu);
        if ($surrellalu < 0){$w3lalu="(";$surrellalu=$surrellalu*-1;$w4lalu=")";}else{$w3lalu="";$surrellalu=$surrellalu;$w4lalu="";}				
        $surrellalu1= number_format($surrellalu,"2",".",",");	



		if ($surang<>0){$per5 = ($surang!=0)?($surrel/$surang)*100:0;}else if($surang==0 and $surrel!=0){$per5=100;} else{$per5=0;}                
		$persen5 = number_format($per5,"2",".",",");		
	//**------------------------------netto Pemby------------------------------------------------	
		if($silang < 0){$e1="(";$silang=$silang*-1;$e2=")";}else{$e1="";$silang=$silang;$e2="";}
        $apemb1 = number_format($silang,"2",".",",");
		
		if($silreal < 0){$e3="(";$silreal=$silreal*-1;$e4=")";}else{$e3="";$silreal=$silreal;$e4="";}
        $rpemb1 = number_format($silreal,"2",".",",");


//lalu

		if($silreallalu < 0){$e3lalu="(";$silreallalu=$silreallalu*-1;$e4lalu=")";}else{$e3lalu="";$silreallalu=$silreallalu;$e4lalu="";}
        $rpemblalu1 = number_format($silreallalu,"2",".",",");



		
		if ($silang<>0){$per2 = ($silang!=0)?($silreal/$silang)*100:0;}else if($silang==0 and $silreal!=0){$per2=100;} else{$per2=0;}                
		$persen2 = number_format($per2,"2",".",",");
	//**-----------------------------Silpa------------------------------------------------				
		$apemby = ($angpen+$silang)-($angbel+$angtrans);
		if($apemby < 0){$r1="(";$apemby=$apemby*-1;$r2=")";}else{$r1="";$apemby=$apemby;$r2="";}
        $apemby1 = number_format($apemby,"2",".",",");
		
		$rpemby = ($totpen+$silreal)-($totbel+$tottrans);
		if($rpemby < 0){$r3="(";$rpemby=$rpemby*-1;$r4=")";}else{$r3="";$rpemby=$rpemby;$r4="";}
        $rpemby1 = number_format($rpemby,"2",".",",");



//lalu
     $rpembylalu = ($totpenlalu+$silreallalu)-($totbellalu+$tottranslalu);
		if($rpembylalu < 0){$r3lalu="(";$rpembylalu=$rpembylalu*-1;$r4lalu=")";}else{$r3lalu="";$rpembylalu=$rpembylalu;$r4lalu="";}
         $rpembylalu1  = number_format($rpembylalu,"2",".",",");


		
		if ($apemby<>0){$per3 = ($apemby!=0)?($rpemby/$apemby)*100:0;}else if($apemby==0 and $rpemby!=0){$per3=100;}else{$per3=0;}                
		$persen3 = number_format($per3,"2",".",",");		
	
        $cRet='';
		$lastmoth=$thn.'-'.$bul.'-'.'01';
		$lastyear=date('Y-m-t',strtotime($lastmoth)); 
		$str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));		
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td style=\"font-size:18px;\" align=\"center\"><strong>&nbsp;</strong></td>                         
                    </tr>                    
					<tr>
                         <td style=\"font-size:18px;\" align=\"center\"><strong>$kab</strong></td>                         
                    </tr>
					<tr>
                         <td style=\"font-size:16px;\" align=\"center\"><strong>PPKD</strong></td>                         
                    </tr> 					
					<tr>
                         <td style=\"font-size:16px;\" align=\"center\"><strong>LAPORAN REALISASI ANGGARAN PENDAPATAN DAN BELANJA DAERAH</strong></td>                         
                    </tr>                                      
                    <tr>
                         <td align=\"center\"><strong>UNTUK PERIODE YANG BERAKHIR SAMPAI DENGAN<br>$str dan $thn_ang_1</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"3%\" align=\"center\"><b>NO URUT</b></td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"47%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Anggaran $thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Realisasi $thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>%</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>Realisasi $thn_ang_1</b></td>  
                        </tr>  
                        <tr><td bgcolor=\"#CCCCCC\" width=\"3%\" align=\"center\">1</td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"47%\" align=\"center\">2</td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">3</td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">4</td>
                            <td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\">5</td>
                            <td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\">6</td>  
                        </tr>
						</thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td> 
                         </tr>
                     </tfoot>";
                           
		  $sql4 ="SELECT nor,uraian,seq,normal,kode_1,
						(SELECT IFNULL(SUM(nilai_ubah),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='$id' 
						AND (LEFT(c.kd_rek64,5)=a.kode_1 OR LEFT(c.kd_rek64,3)=a.kode_1 OR LEFT(c.kd_rek64,2)=a.kode_1 OR LEFT(c.kd_rek64,1)=a.kode_1)) AS anggaran
						FROM map_lra_ppkd_kab a ORDER BY CAST(nor AS SIGNED)";

		$query4 = $this->db->query($sql4);                                  
		foreach ($query4->result() as $row4){
			$no         = $row4->nor;
			$nama       = $row4->uraian;   
			$anggaran   = $row4->anggaran;
			$angg  		= number_format($anggaran,"2",".",",");
			$seq        = $row4->seq;
			$normal     = $row4->normal;
			$kode1		= $row4->kode_1;
			
			$sqld = $this->db->query("SELECT IFNULL(SUM(debet),0) AS debet FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
					WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang'
					AND (LEFT(b.kd_rek5,5)='$kode1' OR LEFT(b.kd_rek5,3)='$kode1' OR LEFT(b.kd_rek5,2)='$kode1' OR LEFT(b.kd_rek5,1)='$kode1' OR b.kd_rek5='$kode1')");
			foreach($sqld->result() as $sqldeb){
			$debet = $sqldeb->debet ; 
}

//lalu
$sqldlalu = $this->db->query("SELECT IFNULL(SUM(debet),0) AS debet FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
					WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' and tgl_voucher='2015-12-31'
					AND (LEFT(b.kd_rek5,5)='$kode1' OR LEFT(b.kd_rek5,3)='$kode1' OR LEFT(b.kd_rek5,2)='$kode1' OR LEFT(b.kd_rek5,1)='$kode1' OR b.kd_rek5='$kode1')");
			foreach($sqldlalu->result() as $sqldeblalu){
			$debetlalu = $sqldeblalu->debet ; 
}

$sqlklalu = $this->db->query("SELECT IFNULL(SUM(kredit),0) AS kredit FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
					WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' and tgl_voucher='2015-12-31'
					AND (LEFT(b.kd_rek5,5)='$kode1' OR LEFT(b.kd_rek5,3)='$kode1' OR LEFT(b.kd_rek5,2)='$kode1' OR LEFT(b.kd_rek5,1)='$kode1' OR b.kd_rek5='$kode1')");
			foreach($sqlklalu->result() as $sqlkrelalu){
			$kreditlalu = $sqlkrelalu->kredit ; 
}



			$sqlk = $this->db->query("SELECT IFNULL(SUM(kredit),0) AS kredit FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher
					WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang'
					AND (LEFT(b.kd_rek5,5)='$kode1' OR LEFT(b.kd_rek5,3)='$kode1' OR LEFT(b.kd_rek5,2)='$kode1' OR LEFT(b.kd_rek5,1)='$kode1' OR b.kd_rek5='$kode1')");
			foreach($sqlk->result() as $sqlkre){
			$kredit = $sqlkre->kredit ; 
}
			if($normal=='K'){
			  $nilai = $kredit-$debet;
			  $nilailalu = $kreditlalu-$debetlalu;
			}else{
			  $nilai = $debet-$kredit;    
			  $nilailalu = $debetlalu-$kreditlalu;    
			}
			$nil  = number_format($nilai,"2",".",",");
			$nilailalu1  = number_format($nilailalu,"2",".",",");
			
			if ($anggaran<>0){$per1 = ($anggaran!=0)?($nilai/$anggaran)*100:0;}else if($anggaran==0 and $nilai!=0){$per1=100;} else{$per1=0;}                
			$persen1 = number_format($per1,"2",".",",");
			
			
			switch ($row4->seq) {
				case (($row4->seq==5)||($row4->seq==10)||($row4->seq==45)||($row4->seq==50)||($row4->seq==85)||($row4->seq==115)
					 ||($row4->seq==145)||($row4->seq==180)||($row4->seq==215)||($row4->seq==220)||($row4->seq==265)
					 ||($row4->seq==310)||($row4->seq==335)||($row4->seq==340)||($row4->seq==370)||($row4->seq==420)
					 ||($row4->seq==430)||($row4->seq==505)):
					 $cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
								 </tr>";
					break;
				case (($row4->seq==35)||($row4->seq==75)||($row4->seq==105)||($row4->seq==135)||($row4->seq==165)||($row4->seq==170)
					 ||($row4->seq==200)||($row4->seq==205)
					 ||($row4->seq==255)||($row4->seq==300)||($row4->seq==320)||($row4->seq==325)||($row4->seq==360)||($row4->seq==390)
					 ||($row4->seq==395)||($row4->seq==495)||($row4->seq==570)):
					$cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen1</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilailalu1</b></td>
								 </tr>";
					break;	
				case 400:
					$cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$q1$abeltrans1$q2</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$q3$rbeltrans1$q4</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen4</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$q3lalu$rbeltranslalu1$q4lalu</b></td>
								 </tr>";
					break;		
				case 410:
					$cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$w1$surang1$w2</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$w3$surrel1$w4</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen5</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$w3lalu$surrellalu1$w4lalu</b></td>
								 </tr>";
					break;		
				case 575:
					$cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$e1$apemb1$e2</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$e3$rpemb1$e4</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen2</b></td>
											<td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$e3lalu$rpemblalu1$e4lalu</b></td>
								 </tr>";
					break;		
				case 585:
					$cRet    .= "<tr>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$r1$apemby1$r2</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$r3$rpemby1$r4</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen3</b></td>
									 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$r3lalu $rpembylalu1 $r4lalu</b></td>
								 </tr>";
					break;						
				default:
				if($nama <> ''){
				$cRet    .= "<tr>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$angg</td>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nil</td>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$persen1</td>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nilailalu1</td>
							 </tr>";
				}else{
				 $cRet    .= "<tr>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
								 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
							 </tr>";	
				}
			}         
		}

        $cRet .=       " </table>";
		$cRet .= " <br><br>";
		$sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id' and kode='PA'");
		foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	    }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>$jabatan<b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>NIP. $nip</b></td>
                        </tr>
                    </table>"; 

              //  $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');			


		$ctk = $this->uri->segment(3);
		   $data['prev']= $cRet;
            switch($ctk) {        
                case 1;
       $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');			


                break;
                case 2;        
                    header("Cache-Control: no-cache, no-store, must-revalidate");
                    header("Content-Type: application/vnd.ms-excel");
                    header("Content-Disposition: attachment; filename=lra.xls");
                    $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            } 
		}else{
			//skpd
			 $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk 
						FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
					$sqlskpd=$this->db->query($sqldns);
					foreach ($sqlskpd->result() as $rowdns){
						$kd_urusan=$rowdns->kd_u;                    
						$nm_urusan= $rowdns->nm_u;
						$kd_skpd  = $rowdns->kd_sk;
						$nm_skpd  = $rowdns->nm_sk;
					} 
		 
			$sql="SELECT 
					(SELECT SUM(nilai_ubah) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='$id' 
					AND LEFT(c.kd_rek64,1)='4') AS angpen,
					(SELECT SUM(nilai_ubah) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='$id' 
					AND LEFT(c.kd_rek64,1)='5') AS angbel,
					(SELECT SUM(b.kredit)-SUM(b.debet) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' AND LEFT(b.kd_rek5,1)='4' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang') AS totpen,
					(SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' AND LEFT(b.kd_rek5,1)='5' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang') AS totbel,

					(SELECT SUM(b.kredit)-SUM(b.debet) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' AND LEFT(b.kd_rek5,1)='4' and tgl_voucher='2015-12-31') AS totpenlalu,
					(SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' AND LEFT(b.kd_rek5,1)='5' and tgl_voucher='2015-12-31') AS totbellalu			
				 ";    
													
						$query   = $this->db->query($sql);
						$hasil   = $query->row();
						$angpen  = $hasil->angpen;
						$angbel  = $hasil->angbel;
						$totpen  = $hasil->totpen;
						$totbel  = $hasil->totbel;                    
						$totpenlalu  = $hasil->totpenlalu;
						$totbellalu  = $hasil->totbellalu;   


$surrellalu = $totpenlalu-$totbellalu;
			if ($surrellalu < 0){
							$xlalu="("; 
							$surrellalu=$surrellalu*-1; 
							$ylalu=")";
							}else {
							$xlalu="";
							$surrellalu=$surrellalu*1; 
							$ylalu="";
							}
							
			$surrellalu1= number_format($surrellalu,"2",".",",");


					 
			$surang =  $angpen-$angbel;
			if ($surang < 0){
							$xa="("; 
							$surang=$surang*-1; 
							$ya=")";
							}else {
							$xa="";
							$surang=$surang*1; 
							$ya="";
							}   
			$surang1= number_format($surang,"2",".",",");
			
			$surrel = $totpen-$totbel;
			if ($surrel < 0){
							$x="("; 
							$surrel=$surrel*-1; 
							$y=")";
							}else {
							$x="";
							$surrel=$surrel*1; 
							$y="";
							}
							
			$surrel1= number_format($surrel,"2",".",",");
			
			$per    = ($surrel!=0)?($surrel/$surang)*100:0; 
			$persen = number_format($per,"2",".",",");                       

			$sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
			$sqlsclient=$this->db->query($sqlsc);
			foreach ($sqlsclient->result() as $rowsc){
				$tgl=$rowsc->tgl_rka;
				$tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
				$kab     = $rowsc->kab_kota;
				$daerah  = $rowsc->daerah;
				$thn     = $rowsc->thn_ang;
			} 
			
			$cRet='';
			$lastmoth=$thn.'-'.$bul.'-'.'01';
			$lastyear=date('Y-m-t',strtotime($lastmoth)); 
			$str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));
			
			$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
						<tr>
							<td align=\"center\"><strong>$kab</strong></td>                         
						</tr>
						<tr>
							<td align=\"center\"><strong>$nm_skpd</strong></td>                         
						</tr>                    
						<tr>
							<td align=\"center\"><strong>LAPORAN REALISASI ANGGARAN PENDAPATAN  DAN BELANJA</strong></td>
						</tr>                    
						<tr>
							<td align=\"center\"><strong>UNTUK PERIODE YANG BERAKHIR SAMPAI DENGAN<br>$str dan $thn_ang_1</strong></td>
						</tr>
						<tr>
							<td align=\"center\">&nbsp;</td>
						</tr>
					  </table>";        
			
			$cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
						 <thead>                       
							<tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
								<td bgcolor=\"#CCCCCC\" width=\"45%\" align=\"center\"><b>URAIAN</b></td>
								<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Anggaran $thn_ang</b></td>
								<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\"><b>Realisasi $thn_ang</b></td>
								<td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\" ><b>(%)</b></td>
								<td bgcolor=\"#CCCCCC\" width=\"15%\" align=\"center\" ><b>Realisasi $thn_ang_1</b></td>   
							</tr>  
						 </thead>
						 <tfoot>
							<tr>
								<td style=\"border-top: none;\"></td>
								<td style=\"border-top: none;\"></td>
								<td style=\"border-top: none;\"></td>
								<td style=\"border-top: none;\"></td>
								<td style=\"border-top: none;\"></td>
								<td style=\"border-top: none;\"></td>                           
							 </tr>
						 </tfoot>";

					 $sql4 ="SELECT nor,uraian,seq,
								(SELECT SUM(nilai_ubah) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='$id' 
								AND (LEFT(c.kd_rek64,3)=a.kode_1 OR LEFT(c.kd_rek64,2)=a.kode_1 OR LEFT(c.kd_rek64,1)=a.kode_1)) AS anggaran,
								(SELECT SUM(debet) AS debet FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
								WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang' 
								AND (LEFT(b.kd_rek5,3)=a.kode_1 OR LEFT(b.kd_rek5,2)=a.kode_1 OR LEFT(b.kd_rek5,1)=a.kode_1)) AS debet,
								(SELECT SUM(kredit) AS kredit FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
								WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' AND MONTH(a.tgl_voucher)<='$bul' AND YEAR(a.tgl_voucher)='$thn_ang'
								AND (LEFT(b.kd_rek5,3)=a.kode_1 OR LEFT(b.kd_rek5,2)=a.kode_1 OR LEFT(b.kd_rek5,1)=a.kode_1)) AS kredit,
(SELECT SUM(debet) AS debet FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' AND tgl_voucher='2015-12-31'
AND (LEFT(b.kd_rek5,3)=a.kode_1 OR LEFT(b.kd_rek5,2)=a.kode_1 OR LEFT(b.kd_rek5,1)=a.kode_1)) AS debetlalu,

(SELECT SUM(kredit) AS kredit FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE a.kd_skpd='$id' AND b.kd_skpd='$id' AND tgl_voucher='2015-12-31'
AND (LEFT(b.kd_rek5,3)=a.kode_1 OR LEFT(b.kd_rek5,2)=a.kode_1 OR LEFT(b.kd_rek5,1)=a.kode_1)) AS kreditlalu	

								FROM map_lra_skpd a ORDER BY nor";
								
				$query4 = $this->db->query($sql4);                                  
				foreach ($query4->result() as $row4){
					$no         = $row4->nor;
					$nama       = $row4->uraian;   
					$anggaran   = $row4->anggaran;
					$debet      = $row4->debet;
					$kredit     = $row4->kredit;
					$debetlalu      = $row4->debetlalu;
					$kreditlalu     = $row4->kreditlalu;
					$seq        = $row4->seq;
					
					$angg  = number_format($anggaran,"2",".",",");
					
					if($row4->seq<'50'){
					  $nilai = $kredit-$debet;
					  $nilailalu = $kreditlalu-$debetlalu;

					}else{
					  $nilai = $debet-$kredit;    
					  $nilailalu = $debetlalu-$kreditlalu;
					}
					$nil  = number_format($nilai,"2",".",",");
					$nillalu1  = number_format($nilailalu,"2",".",",");
					
					if ($anggaran<>0){
						$per1    = ($anggaran!=0)?($nilai/$anggaran)*100:0;
					}else if($anggaran==0 and $nilai!=0){ 
						$per1=100;

					} else{
						$per1=0;
					}                
					$persen1 = number_format($per1,"2",".",",");
					
					switch ($row4->seq){
						case 5:
							 $cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 </tr>";
							break;
						 case 10:
							 $cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 </tr>";
							break;
						case 30:
							$cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen1</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nillalu1</b></td>
										 </tr>";
							break;
						case 40:
							$cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen1</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nillalu1</b></td>
										 </tr>";
							break;
						 case 50:
							$cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 </tr>";
							break;
						case 55:
							$cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
										 </tr>";
							break;
						case 70:
							$cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen1</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nillalu1</b></td>
										 </tr>";
							break;                                         
						case 80:
							$cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
										 </tr>";
							break;
						case 115:
							$cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen1</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nillalu1</b></td>
										 </tr>";
							break;
						case 125:
							$cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen1</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nillalu1</b></td>
										 </tr>";
							break;
						case 135:
							$cRet    .= "<tr>
											 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$xa$surang1$ya</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$surrel1$y</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persen</b></td>
											 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$xlalu$surrellalu1$ylalu</b></td>
										 </tr>";
							break;                                                                          
						default:
						if($nama <> ''){
						$cRet    .= "<tr>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$angg</td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nil</td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$persen1</td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nillalu1</td>
									 </tr>";
						}else{
						 $cRet    .= "<tr>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
									 </tr>";	
						}

					}         
					
				}
			$cRet .= " </table>";
			$cRet .= " <br><br>";
			$sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id' and kode='PA'");
			foreach($sqlttd->result() as $ttd){
				$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
				$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
				$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
			}

			$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
							<tr>
								<td width=\"25%\" align=\"center\"></td>
								<td width=\"25%\">&nbsp;</td>
								<td width=\"50%\">&nbsp;</td>
							</tr>
							<tr>
								<td width=\"25%\" align=\"center\"></td>
								<td width=\"25%\">&nbsp;</td>
								<td width=\"50%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
							</tr>
							<tr>
								<td width=\"25%\" align=\"center\"></td>
								<td width=\"25%\">&nbsp;</td>
								<td width=\"50%\" align=\"center\">$jabatan</td>
							</tr>
							<tr>
								<td width=\"25%\" align=\"center\"></td>
								<td width=\"25%\">&nbsp;</td>
								<td width=\"50%\">&nbsp;</td>
							</tr>
							<tr>
								<td width=\"25%\" align=\"center\"></td>
								<td width=\"25%\">&nbsp;</td>
								<td width=\"50%\">&nbsp;</td>
							</tr>
							<tr>
								<td width=\"25%\" align=\"center\"></td>
								<td width=\"25%\">&nbsp;</td>
								<td width=\"50%\">&nbsp;</td>
							</tr>
							<tr>
								<td width=\"25%\" align=\"center\"><b></b></td>
								<td width=\"25%\">&nbsp;</td>
								<td width=\"50%\" align=\"center\"><b><u>$nama</u></b></td>
							</tr>
							<tr>
								<td width=\"25%\" align=\"center\"><b></b></td>
								<td width=\"25%\">&nbsp;</td>
								<td width=\"50%\" align=\"center\"><b>NIP. $nip</b></td>
							</tr>
				</table>"; 
			$this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
		}
    }

    function ctk_lra_lo_ppkd($pilih=1){
     	$cetak='1'; 
        //$id        = $this->session->userdata('kdskpd');
        $id='1.20.06.00';
        $thn_ang   = $this->session->userdata('pcThang');
        $bul       = $_REQUEST['tgl1'];
        $bulan     = $this->tukd_model->getBulan($bul); 
        $tgl_ttd   = $_REQUEST['tgl_ttd'];       
        $thn_ang_1 = $thn_ang-1;
        $reallalu  = number_format(0,"2",".",",");  
	$cetak = $this->uri->segment(3);
		
		
		
       $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk 
                    FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 


$sql84="SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(a.kd_rek5,1)='84' AND b.kd_skpd='$id' and YEAR(tgl_voucher)='$thn_ang'";
                    $query84   = $this->db->query($sql84);
                    $jmlp84    = $query84->row();
                    $jmlpend84 = $jmlp84->nilai;               

$sql93="SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(kd_rek5,3) IN ('931','932','933')  AND b.kd_skpd='$id' and YEAR(tgl_voucher)='$thn_ang'";                                            
                    $query93   = $this->db->query($sql93);
                    $jmlb93    = $query93->row();
                    $jmlbel93  = $jmlb93->nilai;
        $surplus8493 =  ($jmlpend84-$jmlbel93);
//thn lalu



$sql84lalu="SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE LEFT(a.kd_rek5,1)='84' AND b.kd_skpd='$id' and tgl_voucher='2015-12-31'";
                    $query84lalu   = $this->db->query($sql84lalu);
                    $jmlp84lalu    = $query84lalu->row();
                    $jmlpend84lalu = $jmlp84lalu->nilai;               

$sql93lalu="SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE LEFT(kd_rek5,3) IN ('931','932','933')  AND b.kd_skpd='$id' and tgl_voucher='2015-12-31'";                                            
                    $query93lalu   = $this->db->query($sql93lalu);
                    $jmlb93lalu    = $query93lalu->row();
                    $jmlbel93  = $jmlb93lalu->nilai;
        $surplus8493lalu =  ($jmlpend84lalu-$jmlbel93);

 
 
//akhir===============================================================================================================================================




            
        $sql851="SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(a.kd_rek5,3)='851' AND b.kd_skpd='$id' and YEAR(tgl_voucher)='$thn_ang'";
                    $query851   = $this->db->query($sql851);
                    $jmlp851    = $query851->row();
                    $jmlpend851 = $jmlp851->nilai;               

       $sql941="SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(kd_rek5,3) IN ('941')  AND b.kd_skpd='$id' and YEAR(tgl_voucher)='$thn_ang'";                                            
                    $query941   = $this->db->query($sql941);
                    $jmlb941    = $query941->row();
                    $jmlbel941  = $jmlb941->nilai;
                
        $surplus89 =  $jmlpend851-$jmlbel941;

 //awal===============================================================================================================================================

    $sql851lalu="SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE LEFT(a.kd_rek5,3)='851' AND b.kd_skpd='$id' and tgl_voucher='2015-12-31'";
                    $query851lalu   = $this->db->query($sql851lalu);
                    $jmlp851lalu    = $query851lalu->row();
                    $jmlpend851lalu = $jmlp851lalu->nilai;               

       $sql941lalu="SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE LEFT(kd_rek5,3) IN ('941')  AND b.kd_skpd='$id' and tgl_voucher='2015-12-31'";                                            
                    $query941lalu   = $this->db->query($sql941lalu);
                    $jmlb941lalu    = $query941lalu->row();
                    $jmlbel941lalu  = $jmlb941lalu->nilai;
                
        $surplus89lalu =  $jmlpend851lalu-$jmlbel941lalu;
    

//akhir===============================================================================================================================================


        
        $sql81="SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE MONTH(b.tgl_voucher)<='$bul' AND LEFT(kd_rek5,2) IN ('81','82','83') AND b.kd_skpd='$id' and YEAR(tgl_voucher)='$thn_ang'";
                    $query81   = $this->db->query($sql81);
                    $jmlp81    = $query81->row();
                    $jmlpend81 = $jmlp81->nilai;               

       $sql91="SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE MONTH(b.tgl_voucher)<='$bul' and LEFT(kd_rek5,2) IN ('91','92') AND left(kd_rek5,3) not in ('912','913') AND b.kd_skpd='$id' and YEAR(tgl_voucher)='$thn_ang'";                                            
                    $query91   = $this->db->query($sql91);
                    $jmlb91    = $query91->row();
                    $jmlbel91  = $jmlb91->nilai;
                
        $surplus89a =  ($jmlpend81-$jmlbel91);
  



//awal===============================================================================================================================================
        $sql81lalu="SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE  LEFT(kd_rek5,2) IN ('81','82','83') AND b.kd_skpd='$id' and tgl_voucher='2015-12-31'";
                    $query81lalu   = $this->db->query($sql81lalu);
                    $jmlp81lalu    = $query81lalu->row();
                    $jmlpend81lalu = $jmlp81lalu->nilai;               

       $sql91lalu="SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                    WHERE  LEFT(kd_rek5,2) IN ('91','92') AND left(kd_rek5,3) not in ('912','913') AND b.kd_skpd='$id' and tgl_voucher='2015-12-31'";                                            
                    $query91lalu   = $this->db->query($sql91lalu);
                    $jmlb91lalu    = $query91lalu->row();
                    $jmlbel91lalu  = $jmlb91lalu->nilai;
                
        $surplus89alalu =  ($jmlpend81lalu-$jmlbel91lalu);
     

//akhir===============================================================================================================================================
        
        $surplus89aa =  $surplus8493+$surplus89a;
       

//awal===============================================================================================================================================
        
        $surplus89aalalu =  $surplus8493lalu+$surplus89alalu;
      


//akhir===============================================================================================================================================


                       
        $surplus =  $surplus89aa+$surplus89;
     
        
//awal===============================================================================================================================================
                     
        $surpluslalu =  $surplus89aalalu+$surplus89lalu;
     
   //akhir===============================================================================================================================================
           
                      
       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
        
        $cRet='';
        $lastmoth=$thn.'-'.$bul.'-'.'01';
		$lastyear=date('Y-m-t',strtotime($lastmoth)); 
		$str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));
        
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>PPKD</strong></td>                         
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>LAPORAN OPERASIONAL </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK PERIODE YANG BERAKHIR SAMPAI DENGAN<br> $str</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"5%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"45%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>$thn_ang</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>$thn_ang_1</b></td>
                         <td bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>Kenaikan (Penurunan)</b></td>


                            <td  bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\" ><b>%</b></td>   
                        </tr>  
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                             <td style=\"border-top: none;\"></td>
                             <td style=\"border-top: none;\"></td>
                             <td style=\"border-top: none;\"></td>
                 
                           
                                            
                         </tr>
                     </tfoot>
                   
                     <tr><td style=\"vertical-align:top;border-top: none;border-bottom: none;\"  align=\"center\">&nbsp;</td>                            
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" >&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" >&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" >&nbsp;</td>
                              <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" >&nbsp;</td>
                            <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" >&nbsp;</td>
                          
                        </tr>";

                 $sql4="SELECT IFNULL(a.kode,'')AS kode,a.seq AS seq,a.nor,a.uraian AS uraian ,IFNULL(a.kode_1,\"''\") as kode_1,kre_deb as kre
                                FROM map_lo_ppkd_kab a GROUP BY a.nor,a.uraian,a.kode_1 ORDER BY a.nor";
                 $query4 = $this->db->query($sql4);
                $no=0;                                  
                foreach ($query4->result() as $row4)
                {
                    $kode   = $row4->kode;
                    $nama   = $row4->uraian;   
                    $n      = $row4->kode_1;
                    $nor    = $row4->nor;
                     $kre    = $row4->kre;
					  $seqi    = $row4->seq;
                    	$seq=$row4->seq;
                    $test1 = '';
					if($n <> ''){
						$test  = explode(',',$n);
						$test1 = strlen($test[0]);
					}
                    
                   if($row4->kre=='K'){

	                  $sql5="SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                   WHERE MONTH(b.tgl_voucher)<='$bul' AND  substr(kd_rek5,1,$test1) IN (".$n.") AND a.kd_skpd='$id'  AND YEAR(tgl_voucher)='2016'";
                   	                  $sql5lalu="SELECT sum(kredit)-sum(debet) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                   WHERE   substr(kd_rek5,1,$test1) IN (".$n.") AND a.kd_skpd='$id'   and tgl_voucher='2015-12-31'";
                    }else{
                                                                                   
	                $sql5="SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                   WHERE MONTH(b.tgl_voucher)<='$bul' AND substr(kd_rek5,1,$test1) IN (".$n.") AND a.kd_skpd='$id' AND YEAR(tgl_voucher)='2016'";
                      $sql5lalu="SELECT sum(debet)-sum(kredit) AS nilai FROM trdju_pkd a INNER JOIN trhju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
                   WHERE  substr(kd_rek5,1,$test1) IN (".$n.") AND a.kd_skpd='$id'  and tgl_voucher='2015-12-31'";  
                    }    
                    
                    $query5 = $this->db->query($sql5);
                    $trh    = $query5->row();
                    $nil    = $trh->nilai;
                    $nilai  = number_format($trh->nilai,"2",".",",");

				

  $query5lalu = $this->db->query($sql5lalu);
                    $trhlalu    = $query5lalu->row();
                    $nillalu    = $trhlalu->nilai;
                    $nilailalu  = number_format($trhlalu->nilai,"2",".",",");



                    $real_s = $nil-$nillalu ;
                  $selisih =  $this->angka($real_s);




                    if ($trh->nilai==0){
                        $tmp=1;
                    }else{
                        $tmp=$trh->nilai;
                    }
                    
                    $per1   = ($real_s!=0)?($real_s / $tmp ) * 100:0; 
                    $persen1= number_format($per1);
                    $no=$no+1;
                    
                        
                    $surp = $surplus-$surpluslalu ;
                        $surp1 = number_format($surp,"2",".",",");
                        if ($surp==0){
                            $tmp=1;
                        }else{
                            $tmp=$surp;
                        }
                        $per4   = ($surp!=0)?($surp / $tmp ) * 100:0; 
                        $persen4= number_format($per4);
                    
                    $tpad=$trh->nilai-$nilailalu;
                    $totpad=number_format($tpad,"2",".",",");
                    
                    if ($tpad==0){
                            $tmp=1;
                        }else{
                            $tmp=$tpad;
                        }

                        $perp   = ($tpad!=0)?($tpad / $trh->nilai ) * 100:0; 
                        $persenp= number_format($perp);
                        
                    $tsur=$surplus89a-$surplus89alalu;
                    $totsur=number_format($tsur,"2",".",",");
                    if ($tsur==0){
                            $tmp=1;
                        }else{
                            $tmp=$tsur;
                        }
                        $persu   = ($tsur!=0)?($tsur / $surplus89a ) * 100:0; 
                        $persensu= number_format($persu);
                        
                    $tsur8493=$surplus8493-$surplus8493lalu;
                    $totsur8493=number_format($tsur8493,"2",".",",");
                    if ($tsur8493==0){
                            $tmp=1;
                        }else{
                            $tmp=$tsur8493;
                        }
                        $persu8493   = ($tsur8493!=0)?($tsur8493 / $surplus8493 ) * 100:0; 
                        $persensu8493= number_format($persu8493);
                        
                    $tsur89=$surplus89aa-$surplus89aalalu;
                    $totsur89=number_format($tsur89,"2",".",",");
                    if ($tsur89==0){
                            $tmp=1;
                        }else{
                            $tmp=$tsur89;
                        }
                        $persu89   = ($tsur89!=0)?($tsur89 / $surplus89aa ) * 100:0; 
                        $persensu89= number_format($persu89);
                        
                     $tsurp89=$surplus89-$surplus89lalu;
                    $totsurp89=number_format($tsurp89,"2",".",",");
                    if ($tsurp89==0){
                            $tmp=1;
                        }else{
                            $tmp=$tsurp89;
                        }



	if($surplus89 <> 0){
				  $persurp89   = ($tsurp89!=0)?($tsurp89 / $surplus89 ) * 100:0; 
			}else if($tsurp89==0){
				$persurp89=0;
			}else{
				$persurp89=100;
			}



                      
                        $persensup89= number_format($persurp89);
                        
                    $tsurp=$surplus-$surpluslalu;
                    $totsurp=number_format($tsurp,"2",".",",");
                    if ($tsurp==0){
                            $tmp=1;
                        }else{
                            $tmp=$tsurp;
                        }
                        $persurp   = ($tsurp!=0)?($tsurp / $surplus ) * 100:0; 
                        $persensup= number_format($persurp);
                    
                        
                    switch ($seq) {
              case ($seq==5||$seq==10||$seq==45||$seq==50||$seq==85||$seq==110||$seq==127||$seq==140||$seq==170||$seq==175||$seq==230||$seq==285
              	||$seq==290||$seq==320||$seq==365||$seq==370||$seq==390):         
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                        <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
					
                  case ($seq==35||$seq==75||$seq==100||$seq==125||$seq==128||$seq==130||$seq==155||$seq==160||$seq==220||$seq==260||$seq==265||$seq==310
              	||$seq==340||$seq==380||$seq==400):  
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilai</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nilailalu</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$selisih</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persenp</b></td>
                                    </tr>";
                        break;
              
				                       
					
				
			
                    
					 case 275:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus89a)."</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus89alalu)."</b></td>
                           <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus89a-$surplus89alalu)."</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persensu</b></td>
                                    </tr>";
                        break; 
				
				
				
					 case 345:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b> ".$this->angka($surplus8493)."</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus8493lalu)."</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus8493-$surplus8493lalu)."</b></td>
                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persensu8493</b></td>
                                    </tr>";
                        break; 
					 case 355:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus89aa)."</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus89aalalu)."</b></td>
 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus89aa-$surplus89aalalu)."</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persensu89</b></td>
                                    </tr>";
                        break; 
			
					
					 case 405:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus89)."</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus89lalu)."</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus89-$surplus89lalu)."</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persensup89</b></td>
                                    </tr>";
                        break;  
					 case 415:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus)."</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surpluslalu)."</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>".$this->angka($surplus-$surpluslalu)."</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$persensup</b></td>
                                    </tr>";
                        break;                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                					 
                    default:
					if($nama<>''){
                    $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nilai</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nilailalu</td>
                                 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$selisih</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$persen1</td>
                                 </tr>";
					}else{
					 $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nor</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";	
					
					}

                }         
                    
                }
               $cRet .=       " </table>";
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id' and kode='PPK'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">$jabatan</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>$nip</b></td>
                        </tr>

                    </table>"; 

           
			 
			  $data['prev']= $cRet;    
        //$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
        switch($cetak) {        
        case 1;
             $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename=lo.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        }
    }

    function ctk_lpe_ppkd($cetak = 1){
        $thn_ang   = $this->session->userdata('pcThang');
        $id1       = $this->session->userdata('kdskpd');
        $nmskpd    = $this->tukd_model->get_nama($id1,'nm_skpd','ms_skpd','kd_skpd');
        $nmskpd    = strtoupper($nmskpd);
        $thn_ang_1 = $thn_ang-1;  
		$cetak=1;
        $bul       = $_REQUEST['tgl1'];
        $bulan     = $this->tukd_model->getBulan($bul); 
        $tgl_ttd   = $_REQUEST['tgl_ttd'];               
        
        $sqlsawal = "SELECT *  FROM map_lpe  where nor='7'";
        $queryawal = $this->db->query($sqlsawal);
        $jmlsaldo = $queryawal->row();
        $jmlsal = $jmlsaldo->thn_m1;


    $nnllu1=0;


        $eku = "SELECT SUM(kredit)-SUM(debet) AS nilai  FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd 
AND kd_rek5='3110101' AND a.kd_skpd='$id1' AND tgl_voucher='2015-12-31'";
        $eku1 = $this->db->query($eku);
        $eku2 = $eku1->row();
        $eku2e = $eku2->nilai;



        $sql41 = "SELECT SUM(kredit)-SUM(debet) AS nilai  FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd 
AND LEFT(kd_rek5,1)='8' AND a.kd_skpd='$id1' and  MONTH(tgl_voucher)<='$bul'  AND YEAR(tgl_voucher)='$thn_ang'";
        $query41 = $this->db->query($sql41);
        $jmlp = $query41->row();
        $jmlpendapatan = $jmlp->nilai;
        
        $sql51 = "SELECT SUM(debet)-SUM(kredit) AS nilai  FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd 
AND LEFT(kd_rek5,2) in ('91','92') and left(kd_rek5,3) not in ('911','912','913','941') AND a.kd_skpd='$id1' and  MONTH(tgl_voucher)<='$bul'  AND YEAR(tgl_voucher)='$thn_ang'";
        $query51 = $this->db->query($sql51);
        $jmlb = $query51->row();
        $jmlbelanja = $jmlb->nilai;

//THN LALU 
        $sql41lalu = "SELECT SUM(kredit)-SUM(debet) AS nilai  FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd 
AND LEFT(kd_rek5,1)='8' AND a.kd_skpd='$id1' AND tgl_voucher='2015-12-31'";
        $query41lalu = $this->db->query($sql41lalu);
        $jmlplalu = $query41lalu->row();
        $jmlpendapatanlalu = $jmlplalu->nilai;
        
        $sql51lalu = "SELECT SUM(debet)-SUM(kredit) AS nilai  FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd 
AND LEFT(kd_rek5,2) in ('91','92') and left(kd_rek5,3) not in ('911','912','913','941') AND a.kd_skpd='$id1' AND tgl_voucher='2015-12-31'";
        $query51lalu = $this->db->query($sql51lalu);
        $jmlblalu = $query51lalu->row();
        $jmlbelanjalalu = $jmlblalu->nilai;
//AKHIR
        
		

		$sql851x="SELECT SUM(kredit)-SUM(debet) AS nilai  FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd 
AND LEFT(kd_rek5,3) IN ('851') AND a.kd_skpd='$id1' and  MONTH(tgl_voucher)<='$bul'  AND YEAR(tgl_voucher)='$thn_ang'";				
                    $query851x   = $this->db->query($sql851x);					
                    $jmlp851x    = $query851x->row();					
                    $jmlpend851x = $jmlp851x->nilai;               					
					
       $sql941x="SELECT SUM(debet)-SUM(kredit) AS nilai  FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd 
AND  LEFT(kd_rek5,3) IN ('941') AND a.kd_skpd='$id1' and  MONTH(tgl_voucher)<='$bul'  AND YEAR(tgl_voucher)='$thn_ang'";                                            				
                    $query941x   = $this->db->query($sql941x);					
                    $jmlb941x    = $query941x->row();					
                    $jmlbel941x  = $jmlb941x->nilai;					
                					


//thn lalu


	$sql851xlalu="SELECT SUM(kredit)-SUM(debet) AS nilai  FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd 
AND LEFT(kd_rek5,3) IN ('851') AND a.kd_skpd='$id1' and  MONTH(tgl_voucher)<='$bul'  AND YEAR(tgl_voucher)='$thn_ang'";				
                    $query851xlalu   = $this->db->query($sql851xlalu);					
                    $jmlp851xlalu    = $query851xlalu->row();					
                    $jmlpend851xlalu = $jmlp851xlalu->nilai;               					
					
       $sql941xlalu="SELECT SUM(debet)-SUM(kredit) AS nilai  FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd 
AND  LEFT(kd_rek5,3) IN ('941') AND a.kd_skpd='$id1' and  MONTH(tgl_voucher)<='$bul'  AND YEAR(tgl_voucher)='$thn_ang'";                                            				
                    $query941xlalu   = $this->db->query($sql941xlalu);					
                    $jmlb941xlalu    = $query941xlalu->row();					
                    $jmlbel941xlalu  = $jmlb941xlalu->nilai;					
                					
 //akhir





        $surplus89x =  $jmlpend851x-$jmlbel941x;					
        if ($surplus89x < 0){					
                    	$x="("; 				
                        $surplus89x=$surplus89x*-1; 					
                        $y=")";					
                        }else {					
                    	$x="";				
                        $surplus89x=$surplus89x*1; 					
                        $y="";					
                        }					
        $surplus891x = number_format($surplus89x,"2",",",".");					

		//lama
        //$surplus = $jmlpendapatan-$jmlbelanja;
		$surplus = ($jmlpendapatan-$jmlbelanja)-$surplus89x;
     


//thn lalu
 $surplus89xlalu =  $jmlpend851xlalu-$jmlbel941xlalu;					
        if ($surplus89xlalu < 0){					
                    	$x="("; 				
                        $surplus89xlalu=$surplus89xlalu*-1; 					
                        $y=")";					
                        }else {					
                    	$x="";				
                        $surplus89xlalu=$surplus89xlalu*1; 					
                        $y="";					
                        }					
        $surplus891x = number_format($surplus89xlalu,"2",",",".");					


		$surpluslalu = ($jmlpendapatanlalu-$jmlbelanjalalu)-$surplus89xlalu;
        





//akhir

    
 		$ekuitasakhirlalu=$surpluslalu+$eku2e;
        $ekuitasakhir=$surplus+$ekuitasakhirlalu;




   
        if ($surplus < 0){
    	$x="("; 
        $surplus=$surplus*-1; 
        $y=")";
        }else{
    	$x="";
        $surplus=$surplus; 
        $y="";}



        if ($surpluslalu < 0){
    	$xlalu="("; 
        $surpluslalu=$surpluslalu*-1; 
        $ylalu=")";
        }else{
    	$xlalu="";
        $surpluslalu=$surpluslalu; 
        $ylalu="";}

       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
    
        $cRet = '';
        $lastmoth=$thn.'-'.$bul.'-'.'01';
		$lastyear=date('Y-m-t',strtotime($lastmoth)); 
		$str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>                         
                    </tr> 
                    <tr>
                         <td align=\"center\"><strong>PPKD</strong></td>                         
                    </tr>                  
                    <tr>
                         <td align=\"center\"><strong>LAPORAN PERUBAHAN EKUITAS </strong></td>
                    </tr>                    
                    <tr>
                         <td align=\"center\"><strong>UNTUK PERIODE YANG BERAKHIR SAMPAI DENGAN<br>$str</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"10%\" align=\"center\"><b>NO</b></td>                            
                            <td  bgcolor=\"#CCCCCC\" width=\"30%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Saldo $thn_ang</b></td>
 							<td bgcolor=\"#CCCCCC\" width=\"20%\" align=\"center\"><b>Saldo $thn_ang_1</b></td>
                          
                        </tr>  
                     </thead>";                   

					    $sql2 ="SELECT sum(nilai_tamp) as n from ms_lpe_skpd_tamp where kd_skpd='$id1'";

   					$nr=0;
                    $hasil2 = $this->db->query($sql2); 
                    foreach ($hasil2->result() as $row)
                    {                    
                       $nr    =$row->n;
					}	
					 
					 
					 
                    $sql = "SELECT * FROM map_lpe_ppkd ORDER BY seq";               
                    $hasil = $this->db->query($sql); 
                    $nawal = 0 ;
                    foreach ($hasil->result() as $row)
                    {                     
                       $kd_rek   =$row->nor ;
                       $parent   =$row->parent;
                       $nama     =$row->uraian;
                       $nilai_1    =$row->thn_m1;
                          $seque   =$row->seq;
					   
					   		   
					    $sql1 ="SELECT * from ms_lpe_skpd_tamp where kd_skpd='$id1' and seq='$seque'";
                    $hasil1 = $this->db->query($sql1); 
					   $nilai_tamp=0;
					   $nilai_tamp1=0;
                    foreach ($hasil1->result() as $row)
                    {                    
                       $nilai_tamp    =$row->nilai_tamp;
					}	

 if ($nilai_tamp < 0){
    	$xxx="("; 
        $nilai_tamp1=$nilai_tamp*-1; 
        $yyy=")";
        }else{
    	$xxx="";
        $nilai_tamp1=$nilai_tamp; 
        $yyy="";}
		
                               switch ($kd_rek)
                                {
                                    case 1:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>".number_format($eku2e, "2",".",",")."</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>".number_format(0, "2",".",",")."</b></td>
                                                   
                                                     </tr>";
                                            
                                    break; 
                                    case 2:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$x".number_format($surplus,"2",".",",")."$y</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$xlalu".number_format($surpluslalu,"2",".",",")."$ylalu</b></td>
                                                  
                                                     </tr>";
                                            
                                    break; 
                                     case 3:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     </tr>";
                                            
                                    break; 
                                     
									   case 4:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     </tr>";
                                            
                                    break; 
									  case 5:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     </tr>";
                                            
                                    break; 
									  case 6:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"></td>
                                                     </tr>";
                                            
                                    break; 
                                    case 7:
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b></b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b></b></td>
                                                    
                                                     </tr>";
                                            
                                    break; 
                                    default:  
                                            $cRet .="<tr>
                                                      <td valign=\"top\"  width=\"5%\" align=\"center\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$kd_rek</b></td>
                                                      <td valign=\"top\"  width=\"65%\"  align=\"left\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$nama</b></td>
                                                      <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$x".number_format($ekuitasakhir+$nr,"2",".",",")."$y</b></td>
                                                    <td valign=\"top\"  width=\"15%\" align=\"right\" style=\"font-size:14px;border-bottom:none;border-top:none\"><b>$x".number_format($ekuitasakhirlalu,"2",".",",")."$y</b></td>
                                                     </tr>";                      
                                } 
                    }
 
           $cRet .="<tr>
                    <td align=\"center\" width=\"5%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\" >&nbsp;</td>
                    <td align=\"center\" width=\"65%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td>
                    <td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td> 
         <td align=\"center\" width=\"15%\" style=\"font-size:14px;border-bottom:solid 1px black;border-top:none\">&nbsp;</td> 
        
                    </tr>"; 
                    
        $cRet .= " </table>";
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id1' and kode='PPK'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">$jabatan</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>NIP. $nip</b></td>
                        </tr>";                                               

         $cRet .='</table>';               
         
                 $cetak=$this->uri->segment(3);
     $data['prev']= $cRet;
		$this->template->set('title', 'CETAK lpe PPKD');        
        
        switch($cetak) {
        case 1;
	//		$this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
            $this->tukd_model->_mpdf('', $cRet, 10, 5, 10, '0');
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= Lpe_PPKD.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        
        }
    }

    function rpt_neraca_ppkd_edit($cetak=1){
	        $skpd     = $this->session->userdata('kdskpd');
			$thi      = $this->session->userdata('pcThang');
            $th1      = $thi-1;
            $bul      = $_REQUEST['tgl1'];
            $bulan    = $this->tukd_model->getBulan($bul); 
            $tgl_ttd  = $_REQUEST['tgl_ttd'];  
            	$thn_ang      = $this->session->userdata('pcThang');
            
            $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                   
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
                            
            $lastmoth = $thn.'-'.$bul.'-'.'01';
            $lastyear = date('Y-m-t',strtotime($lastmoth)); 
            $str=strtoupper($this->tukd_model->tanggal_format_indonesia($lastyear));               
             
            $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk 
                        FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$skpd'";
                     $sqlskpd=$this->db->query($sqldns);
                     foreach ($sqlskpd->result() as $rowdns)
                    {
                        $kd_urusan=$rowdns->kd_u;                    
                        $nm_urusan= $rowdns->nm_u;
                        $kd_skpd  = $rowdns->kd_sk;
                        $nm_skpd  = $rowdns->nm_sk;
                    }             
            
			$cRet ='<TABLE width="100%">
                    <tr>        
						<td align="center" ><b>'.$kab.'</b></td>
					</tr>
					<tr>
						<td align="center" ><b>PPKD</b></td>
					</tr>                    
					<TR>
						<TD align="center" ><b>LAPORAN NERACA</b></TD>
					</TR>
					<TR>
						<TD align="center" ><b>PER '.$str.' dan '.$th1.'</b></TD>
					</TR>
					</TABLE><br><br><br>';


			$cRet .='<TABLE border="1" cellspacing="0" cellpadding="0" width="100%" >
					 <thead>
                     <TR>
                        <TD width="5%" align="center" ><b>NO</b></TD>
						<TD width="45%" align="center" ><b>URAIAN</b></TD>
						<TD width="25%" align="center" ><b>'.$thi.'</b></TD>
						<TD width="25%" align="center" ><b>'.$th1.'</b></TD>
					 </TR>
                     </thead>
                     <tfoot>
                     <TR>
                        <TD width="5%" align="center" ><b></b></TD>
						<TD width="45%" align="center" ><b></b></TD>
						<TD width="25%" align="center" ><b></b></TD>
						<TD width="25%" align="center" ><b></b></TD>
					 </TR>
					
				</tfoot>';
				
				$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                    </tr>";
			//aset
			$total_aset_lncr = 0;
			$total_aset_lncr_llu = 0;	
			$total_inves_per = 0;
			$total_inves_per_llu = 0;								
			$total_inves_nonper = 0;
			$total_inves_nonper_llu = 0;
			$total_dana = 0;
			$total_dana_llu =0;
			$total_aset_lain =0;
			$total_aset_lain_ll = 0;
			$total_inves_jkpjg = 0;		
			$total_inves_jkpjg_lalu	= 0;		
			
			//kewajiban			
			$total_kew_jpen = 0;
			$total_kew_jpen_llu = 0;
			$total_kew_jpan = 0;
			$total_kew_jpan_llu = 0;
			$total_kew = 0;
			$total_kew_llu =0;
			$total_ekui = 0;
			$total_ekui_llu = 0;
			$total_kew_ek = 0;
			$total_kew_ek_llu = 0;
			
			$query = $this->db->query("SELECT * FROM map_neraca_ppkd  ORDER BY kode");  
			foreach($query->result_array() as $res){
				
				$kode   = $res['kode'];
				$uraian = $res['uraian'];
				$seq    = $res['seq'];
				$parent = $res['parent'];
				$normal = $res['normal'];
				$nilai_lalu = $res['nilai_lalu'];				
				$kode_1 = $res['kode_1'];
				$bold = $res['bold'];						
								
			switch ($bold){
                case 4:
				
					$cek_kd5 = strlen($kode_1);
					if ($cek_kd5=='5'){
							$q = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
							ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd AND a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$skpd' and (month(b.tgl_voucher)<='$bul' OR tgl_voucher='2015-12-31') AND
							LEFT(kd_rek5,3) IN (".$kode_1.")");




							$qlalu = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
							ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd AND a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$skpd' and tgl_voucher='2015-12-31' and
							LEFT(kd_rek5,3) IN (".$kode_1.")");

					}else if ($cek_kd5=='4'){
							/*$q = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
							ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd AND a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$skpd' AND MONTH(b.tgl_voucher)<='$bul' AND
							(LEFT(kd_rek5,2) IN (".$kode_1.") OR a.kd_rek5='0000000')");*/
							$q = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
							ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd AND a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$skpd' and (month(b.tgl_voucher)<='$bul' OR tgl_voucher='2015-12-31') AND
							(LEFT(kd_rek5,2) IN (".$kode_1.") OR left(a.kd_rek5,1)='8' OR (left(a.kd_rek5,1)='9'))");

														$qlalu = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
							ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd AND a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$skpd' and tgl_voucher='2015-12-31' and
							(LEFT(kd_rek5,2) IN (".$kode_1.") OR left(a.kd_rek5,1)='8' OR (left(a.kd_rek5,1)='9'))");
					}
					else if ($cek_kd5=='7'){
							$q = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
							ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd AND a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$skpd' and (month(b.tgl_voucher)<='$bul' OR tgl_voucher='2015-12-31') AND
							LEFT(kd_rek5,5) IN (".$kode_1.")");


							$qlalu = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
							ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd AND a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$skpd' and tgl_voucher='2015-12-31' and
							LEFT(kd_rek5,5) IN (".$kode_1.")");
					}else if ($cek_kd5=='9'){
							$q = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
							ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd AND a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$skpd' and (month(b.tgl_voucher)<='$bul' OR tgl_voucher='2015-12-31') AND
							LEFT(kd_rek5,7) IN (".$kode_1.")");


														$qlalu = $this->db->query("SELECT SUM(a.debet) AS debet,SUM(a.kredit) AS kredit FROM trdju_pkd a INNER JOIN trhju_pkd b 
							ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd AND a.kd_skpd=b.kd_skpd WHERE b.kd_skpd='$skpd' and tgl_voucher='2015-12-31' and
							LEFT(kd_rek5,7) IN (".$kode_1.")");

					}											
				
				 foreach($q->result_array() as $r){
					$debet  = $r['debet'];
					$kredit = $r['kredit'];
				 }

				 	 foreach($qlalu->result_array() as $rlalu){
					$debetlalu  = $rlalu['debet'];
					$kreditlalu = $rlalu['kredit'];
				 }
				
				
				if ($debet=='') $debet=0;
				if ($kredit=='') $kredit=0;


				if ($debetlalu=='') $debetlalu=0;
				if ($kreditlalu=='') $kreditlalu=0;

				if ($normal=='D'){
					$nilai=$debet-$kredit;

					$nilailaluaaa=$debetlalu-$kreditlalu;
				}else{
					$nilai=$kredit-$debet;

					$nilailaluaaa=$kreditlalu-$debetlalu;				
				}
                
                $nil= number_format($nilai,2);
				$nil_lalu = number_format($nilailaluaaa,2);	
									
                         $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\">$uraian</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\">$nil</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\">$nil_lalu</td>
                                    </tr>";
									
							if($parent=='41'){
								$total_aset_lncr = $total_aset_lncr + $nilai;
								$total_aset_lncr_llu = 	$total_aset_lncr_llu + $nilailaluaaa;
							}else if($parent=='42'){
								if($seq=='28' || $seq=='29' || $seq=='30'){
									$total_inves_per = $total_inves_per + $nilai;
									$total_inves_per_llu = $total_inves_per_llu + $nilailaluaaa;
								}else{
									$total_inves_nonper = $total_inves_nonper + $nilai;
									$total_inves_nonper_llu = $total_inves_nonper_llu + $nilailaluaaa;
								}
							}else if($parent=='44'){
								$total_dana = $total_dana + $nilai;
								$total_dana_llu = $total_dana_llu + $nilailaluaaa;
							}else if($parent=='45'){
								$total_aset_lain = $total_aset_lain + $nilai;
								$total_aset_lain_ll = $total_aset_lain_ll + $nilailaluaaa;
							}else if($parent=='46'){
								$total_kew_jpen = $total_kew_jpen + $nilai;
								$total_kew_jpen_llu = $total_kew_jpen_llu + $nilailaluaaa;
							}else if($parent=='47'){
								$total_kew_jpan = $total_kew_jpan + $nilai;
								$total_kew_jpan_llu = $total_kew_jpan_llu + $nilailaluaaa;
							}else if($parent=='48'){
								$total_ekui = $total_ekui + $nilai;
								$total_ekui_llu = $total_ekui_llu + $nilailaluaaa;
							}			
																				
							
                        break; 																					                                   
						case 3:
								
								if ($kode=='14'){
									$n_aset_lnr = number_format($total_aset_lncr,2);
									$n_aset_lnr_llu = number_format($total_aset_lncr_llu,2);
							
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_aset_lnr</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_aset_lnr_llu</b></td>
                                    </tr>";
								}else if ($kode=='22'){
									$n_invs_non = number_format($total_inves_nonper,2);
									$n_invs_non_llu = number_format($total_inves_nonper_llu,2);
							
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_invs_non</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_invs_non_llu</b></td>
                                    </tr>";
								
								}else if ($kode=='26'){
									$n_invs_per = number_format($total_inves_per,2);
									$n_invs_per_llu = number_format($total_inves_per_llu,2);
							
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_invs_per</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_invs_per_llu</b></td>
                                    </tr>";
								
								}else if ($kode=='27'){
									$total_inves_jkpjg = $total_inves_nonper + $total_inves_per;
									$total_inves_jkpjg_lalu = $total_inves_nonper_llu + $total_inves_per_llu;
									
									$ttl_inves = number_format($total_inves_jkpjg,2);
									$ttl_inves_llu = number_format($total_inves_jkpjg_lalu,2);
							
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$ttl_inves</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$ttl_inves_llu</b></td>
                                    </tr>";
								
								}else if ($kode=='31'){									
									$n_dana = number_format($total_dana,2);
									$n_dana_lalu = number_format($total_dana_llu,2);
							
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_dana</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_dana_lalu</b></td>
                                    </tr>";
								
								}else if ($kode=='38'){				
							
									$n_aset_l = number_format($total_aset_lain,2);
									$n_aset_llalu = number_format($total_aset_lain_ll,2);
							
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_aset_l</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_aset_llalu</b></td>
                                    </tr>";
								
								}else if ($kode=='40'){																				
									
									$total_asetn = $total_aset_lncr + $total_inves_jkpjg + $total_dana + $total_aset_lain;
									$total_asetn_lain = $total_aset_lncr_llu + $total_inves_jkpjg_lalu + $total_dana_llu + $total_aset_lain_ll;
									
									$n_aset_a = number_format($total_asetn,2);
									$n_aset_a_lalu = number_format($total_asetn_lain,2);
									
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_aset_a</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_aset_a_lalu</b></td>
                                    </tr>";
								
								}else if ($kode=='50'){																															
									
									$n_kew_jpen = number_format($total_kew_jpen,2);
									$n_kew_jpen_lalu = number_format($total_kew_jpen_llu,2);
									
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_kew_jpen </b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_kew_jpen_lalu</b></td>
                                    </tr>";								
								}else if ($kode=='57'){																															
												
									$n_kew_jpan = number_format($total_kew_jpan,2);
									$n_kew_jpan_lalu = number_format($total_kew_jpan_llu,2);
									
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_kew_jpan </b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_kew_jpan_lalu</b></td>
                                    </tr>";								
								}else if ($kode=='59'){																															
									
									$total_kew = $total_kew_jpen + $total_kew_jpan;
									$total_kew_llu = $total_kew_jpen_llu + $total_kew_jpan_llu;
									
									$n_kew = number_format($total_kew,2);
									$n_kew_lalu = number_format($total_kew_llu,2);
									
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_kew </b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_kew_lalu</b></td>
                                    </tr>";								
								}else if ($kode=='65'){																															
																		
									$n_ekui = number_format($total_ekui,2);
									$n_ekui_lalu = number_format($total_ekui_llu,2);
									
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_ekui</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_ekui_lalu</b></td>
                                    </tr>";								
								}else if ($kode=='67'){																															
									
									$total_kew_ek = $total_kew + $total_ekui;
									$total_kew_ek_llu = $total_kew_llu + $total_ekui_llu;			
										
									$n_kew_ek = number_format($total_kew_ek,2);
									$n_kew_ek_lalu = number_format($total_kew_ek_llu,2);
									
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_kew_ek</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$n_kew_ek_lalu</b></td>
                                    </tr>";								
								}
								else{
								
								$cRet    .= "
                                   <tr>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$nil</b></td>
                                     <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" width=\"25%\" align=\"right\"><b>$nil_lalu</b></td>
                                    </tr>";							
								}
								
						break;
						case 2:
								$cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"><b></b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                    </tr>";
						break;						
						case 1:
							  $cRet    .= "
                                    <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\"><b>$uraian</b></td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"><b></b></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                    </tr>";
						break;
                    default:
                if($uraian <> ''){
                    $cRet    .= "
                                <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>  
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\">$uraian</td>                                   
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\">$nil</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\">$nil_lalu</td>
                                 </tr>";
                }else{
					 $cRet    .= "
                                <tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"5%\" align=\"left\">$kode</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"45%\" align=\"left\">$uraian</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" width=\"25%\" align=\"right\"></td>
                                 </tr>";	
				}

                }
                
			}
            
			$cRet .='</TABLE>';	
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$skpd' and kode='PA'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td  width=\"30%\" align=\"center\"></td>
                            
                            <td colspan=\"2\" width=\"30%\">&nbsp;</td>
                        </tr>
						<tr>
							<td  width=\"30%\" align=\"center\"></td>
                            
                            <td colspan=\"2\" width=\"30%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td  width=\"30%\" align=\"center\"></td>
                            
                            <td colspan=\"2\" width=\"30%\" align=\"center\"><b>$jabatan</b></td>
                        </tr>
						<tr>
							<td width=\"30%\" align=\"center\"></td>
                            <td width=\"40%\">&nbsp;</td>
                            <td width=\"30%\">&nbsp;</td>
                        </tr>
						<tr>
							<td  width=\"30%\" align=\"center\"></td>
                            
                            <td colspan=\"2\" width=\"30%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"30%\" align=\"center\"></td>
                            <td width=\"40%\">&nbsp;</td>
                            <td width=\"30%\">&nbsp;</td>
                        </tr>
						<tr>
							<td  width=\"30%\" align=\"center\"><b></b></td>
                            
                            <td colspan=\"2\" width=\"30%\" align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td  width=\"30%\" align=\"center\"><b></b></td>
                            
                            <td colspan=\"2\" width=\"30%\" align=\"center\"><b>NIP. $nip</b></td>
                        </tr>

                    </table>";             
            	 
		 	$cetak = $this->uri->segment(3);
      
        $data['prev']= $cRet;
		$this->template->set('title', 'CETAK LO PPKD');        
        
        switch($cetak) {
        case 1;
	//		$this->tukd_model->_mpdf('',$cRet,10,10,10,'1');
            $this->tukd_model->_mpdf('',$cRet,10,10,10,'0');
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= neraca_ppkd.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        
        }

	} 


	function cetak_perda1_semester_pemda(){
		$id   = $this->session->userdata('kdskpd');	
        $thn_ang   = $this->session->userdata('pcThang');
        $tgl_ttd   = $_REQUEST['tgl_ctk'];
		$mry   = $_REQUEST['halamanwehgeus'];		

       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                }  
     
        $sql="SELECT 
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,1)='4'),0) AS angpen,
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,1)='5'),0) AS angbel,
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='61'),0) AS angpentrans,
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='62'),0) AS angbeltrans,
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='71'),0) AS angpenepemb,
IFNULL((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE LEFT(c.kd_rek64,2)='72'),0) AS angpengpemb,
IFNULL((SELECT SUM(b.kredit)-SUM(b.debet) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE LEFT(b.kd_rek5,1)='4' AND MONTH(a.tgl_voucher)<='6'),0) AS totpen,
IFNULL((SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE LEFT(b.kd_rek5,1)='5' AND MONTH(a.tgl_voucher)<='6'),0) AS totbel,
IFNULL((SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE LEFT(b.kd_rek5,2)='61' AND MONTH(a.tgl_voucher)<='6'),0) AS totpentrans,
IFNULL((SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE LEFT(b.kd_rek5,2)='62' AND MONTH(a.tgl_voucher)<='6'),0) AS totbeltrans,
IFNULL((SELECT SUM(b.kredit)-SUM(b.debet) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE LEFT(b.kd_rek5,2)='71' AND MONTH(a.tgl_voucher)<='6'),0) AS totpenepemb,
IFNULL((SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
WHERE LEFT(b.kd_rek5,2)='72' AND MONTH(a.tgl_voucher)<='6'),0) AS totpengpemb";    
			 
                    $query   = $this->db->query($sql);
                    $hasil   = $query->row();
                    $angpen  = $hasil->angpen;
                    $angbel  = $hasil->angbel;
					$angpentrans = $hasil->angpentrans;
					$angbeltrans = $hasil->angbeltrans;
					$angpenepemb = $hasil->angpenepemb;
					$angpengpemb = $hasil->angpengpemb;
                    $totpen  = $hasil->totpen;
                    $totbel  = $hasil->totbel;
					$totpentrans = $hasil->totpentrans;
					$totbeltrans = $hasil->totbeltrans;
					$totpenepemb = $hasil->totpenepemb;
					$totpengpemb = $hasil->totpengpemb;

		$apemby = $angpen-($angbel+$angpentrans+$angbeltrans)+($angpenepemb-$angpengpemb);
		if($apemby < 0) {
                    	$x1="("; 
                        $apemby=$apemby*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $apemby=$apemby*1; 
                        $y1="";
                        }
        $apemby1 = number_format($apemby,"2",".",",");
		
		$rpemby = $totpen-($totbel+$totpentrans+$totbeltrans)+($totpenepemb-$totpengpemb);
		if($rpemby < 0) {
                    	$x1="("; 
                        $rpemby=$rpemby*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $rpemby=$rpemby*1; 
                        $y1="";
                        }
        $rpemby1 = number_format($rpemby,"2",".",",");	

		$silpa = $apemby-$rpemby;
			if($silpa < 0) {
                    	$aw="("; 
                        $silpa=$silpa*-1; 
                        $ah=")";
                        }else{
                    	$aw="";
                        $silpa=$silpa*1; 
                        $ah="";
                        }
		$silpa1 = number_format($silpa,"2",".",",");
		
		$apemb = $angpenepemb - $angpengpemb;
		if($apemb < 0) {
                    	$x1="("; 
                        $apemb=$apemb*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $apemb=$apemb*1; 
                        $y1="";
                        }
        $apemb1 = number_format($apemb,"2",".",",");
		
		$rpemb = $totpenepemb - $totpengpemb;
		if($rpemb < 0) {
                    	$x1="("; 
                        $rpemb=$rpemb*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $rpemb=$rpemb*1; 
                        $y1="";
                        }
        $rpemb1 = number_format($rpemb,"2",".",",");	

		$neto = $apemb-$rpemb;
		if($neto < 0) {
                    	$x="("; 
                        $neto=$neto*-1; 
                        $y=")";
                        }else{
                    	$x="";
                        $neto=$neto*1; 
                        $y="";
                        }		
		$neto1 = number_format($neto,"2",".",",");		
		
		$abeltrans = $angbel + ($angpentrans + $angpentrans);
		if($abeltrans < 0) {
                    	$x1="("; 
                        $abeltrans=$abeltrans*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $abeltrans=$abeltrans*1; 
                        $y1="";
                        }
        $abeltrans1 = number_format($abeltrans,"2",".",",");

		$rbeltrans = $totbel + ($totpentrans + $totbeltrans);
		if($rbeltrans < 0) {
                    	$x1="("; 
                        $rbeltrans=$rbeltrans*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $rbeltrans=$rbeltrans*1; 
                        $y1="";
                        }
        $rbeltrans1 = number_format($rbeltrans,"2",".",",");
		
		$sisarbeltrans = $abeltrans-$rbeltrans;
		if($sisarbeltrans < 0) {
                    	$x="("; 
                        $sisarbeltrans=$sisarbeltrans*-1; 
                        $y=")";
                        }else{
                    	$x="";
                        $sisarbeltrans=$sisarbeltrans*1; 
                        $y="";
                        }		
		$sisarbeltrans1 = number_format($sisarbeltrans,"2",".",",");
		
        $surang = $angpen-($angbel+$angpentrans+$angbeltrans);
        if ($surang < 0){
                    	$x1="("; 
                        $surang=$surang*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $surang=$surang*1; 
                        $y1="";
                        }
						
        $surang1= number_format($surang,"2",".",",");
        
        $surrel = $totpen-($totbel+$totpentrans+$totbeltrans);
        if ($surrel < 0){
                    	$x1="("; 
                        $surrel=$surrel*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $surrel=$surrel*1; 
                        $y1="";
                        }  
						
        $surrel1= number_format($surrel,"2",".",",");
		
		$sursisa = $surang - $surrel;
		if($sursisa < 0) {
                    	$x2="("; 
                        $sursisa=$sursisa*-1; 
                        $y2=")";
                        }else{
                    	$x2="";
                        $sursisa=$sursisa*1; 
                        $y2="";
                        }			
		$sursisa1  = number_format($sursisa,"2",".",",");			
        
        $cRet='';       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>LAPORAN REALISASI SEMESTER PERTAMA PENDAPATAN DAN BELANJA SKPD<br>SERTA PROGNOSIS 6 (ENAM) BULAN BERIKUTNYA</strong></td>                         
                    </tr>                                      
                    <tr>
                         <td align=\"center\"><strong>Tahun Anggaran $thn_ang</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"3%\" align=\"center\"><b>NO</b></td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"37%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\"><b>Jumlah Anggaran</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\"><b>Realisasi Semester Pertama</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\" ><b>Sisa Anggaran<br>s.d<br>Semester Pertama</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\" ><b>Prognosis</b></td>  
							<td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\" ><b>Keterangan</b></td> 
                        </tr>  
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td> 
							<td style=\"border-top: none;\"></td>
                         </tr>
                     </tfoot>";

                 $sql4 ="SELECT nor,uraian,seq,normal,
(SELECT IFNULL(SUM(nilai),0) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE 
(LEFT(c.kd_rek64,5)=a.kode_1 OR LEFT(c.kd_rek64,3)=a.kode_1 OR LEFT(c.kd_rek64,2)=a.kode_1 OR LEFT(c.kd_rek64,1)=a.kode_1)) AS anggaran,
(SELECT IFNULL(SUM(debet),0) AS debet FROM trdju_pkd
WHERE (LEFT(kd_rek5,5)=a.kode_1 OR LEFT(kd_rek5,3)=a.kode_1 OR LEFT(kd_rek5,2)=a.kode_1 OR LEFT(kd_rek5,1)=a.kode_1) 
AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='6')) AS debet,
(SELECT IFNULL(SUM(kredit),0) AS kredit FROM trdju_pkd
WHERE (LEFT(kd_rek5,5)=a.kode_1 OR LEFT(kd_rek5,3)=a.kode_1 OR LEFT(kd_rek5,2)=a.kode_1 OR LEFT(kd_rek5,1)=a.kode_1) 
AND no_voucher IN(SELECT no_voucher FROM trhju_pkd WHERE MONTH(tgl_voucher)<='6')) AS kredit		
FROM map_lra_kab1 a ORDER BY CAST(nor AS SIGNED)";
                            
                $query4 = $this->db->query($sql4);                                  
                foreach ($query4->result() as $row4)
                {
                    $no         = $row4->nor;
                    $nama       = $row4->uraian;   
                    $anggaran   = $row4->anggaran;
                    $debet      = $row4->debet;
                    $kredit     = $row4->kredit;
                    $seq        = $row4->seq;
                    $normal        = $row4->normal;
                    
                    $angg  = number_format($anggaran,"2",".",",");
                    /*if($row4->seq<'170' or ($row4->seq>'290' and $row4->seq<'325') 
							or ($row4->seq>'370' and $row4->seq<'455')){
                      $nilai = $kredit-$debet;
                    }else{
                      $nilai = $debet-$kredit;    
                    }*/

                    	if($normal=='K'){
			  $nilai = $kredit-$debet;
			}else{
			  $nilai = $debet-$kredit;    
			}

                    $nil  = number_format($nilai,"2",".",",");
					
					$sisa = $anggaran - $nilai;
					if ($sisa < 0){
                    	$x="("; 
                        $sisa=$sisa*-1; 
                        $y=")";
                        }else {
                    	$x="";
                        $sisa=$sisa*1; 
                        $y="";
                        } 

					$sisaangg  = number_format($sisa,"2",".",",");
					
                    switch ($row4->seq) {

                    	    case (($row4->seq==5)||($row4->seq==10)||($row4->seq==45)||($row4->seq==50)||($row4->seq==85)||($row4->seq==115)
						 ||($row4->seq==145)||($row4->seq==180)||($row4->seq==215)||($row4->seq==220)||($row4->seq==265)
						 ||($row4->seq==310)||($row4->seq==335)||($row4->seq==340)||($row4->seq==370)||($row4->seq==420)
						 ||($row4->seq==430)||($row4->seq==505)):
                          $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                    case (($row4->seq==35)||($row4->seq==75)||($row4->seq==105)||($row4->seq==135)||($row4->seq==165)||($row4->seq==170)
						 ||($row4->seq==200)||($row4->seq==205)
						 ||($row4->seq==255)||($row4->seq==300)||($row4->seq==320)||($row4->seq==325)||($row4->seq==360)||($row4->seq==390)
						 ||($row4->seq==395)||($row4->seq==495)||($row4->seq==570)):
                   $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;	


                    case 400:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$abeltrans1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$rbeltrans1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisarbeltrans1$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisarbeltrans1$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;		
                    case 410:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$surang1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$surrel1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sursisa1$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sursisa1$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;	
                 		
                    case 575:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$apemb1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$rpemb1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$neto1$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$neto1$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;		
                    case 585:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$apemby1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$rpemby1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$aw$silpa1$ah</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$aw$silpa1$ah</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;						
                    default:
					if($nama <> ''){
                    $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$angg</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nil</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$x$sisaangg$y</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$x$sisaangg$y</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";
					}else{
					 $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";	
					}
                }         
                }

        $cRet .=       " </table>";
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id' and kode='PA'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }

		$cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"left\" border=\"0\">
                        <tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\">".ucwords(strtolower($daerah)).", ".$this->tukd_model->tanggal_format_indonesia($tgl_ttd)."</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>$jabatan<b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\">&nbsp;</td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b><u>$nama</u></b></td>
                        </tr>
						<tr>
							<td width=\"25%\" align=\"center\"><b></b></td>
                            <td width=\"25%\">&nbsp;</td>
                            <td width=\"50%\" align=\"center\"><b>$nip</b></td>
                        </tr>
                    </table>"; 

             $this->template->set('title', 'CETAK');    
     
		
		
		$ctk = $this->uri->segment(3);
		   $data['prev']= $cRet;
            switch($ctk) {        
                case 1;
        $this->_mpdf1('',$cRet,25,10,10,'P','',1);

                break;
                case 2;        
                    header("Cache-Control: no-cache, no-store, must-revalidate");
                    header("Content-Type: application/vnd.ms-excel");
                    header("Content-Disposition: attachment; filename=keseluruhan.xls");
                    $this->load->view('anggaran/rka/perkadaII', $data);
                break;
            } 
                 
    }

     function cetak_perda1_semester_skpd(){ 
        $id 	    = $_REQUEST['kdskpd']; 
        $thn_ang    = $this->session->userdata('pcThang');
		$total_segment= $this->uri->total_segments();
		$hal = $this->uri->segment($total_segment);

		$mry=$_REQUEST['halamanwehgeus'];

       $sqlsc="SELECT tgl_rka,provinsi,kab_kota,daerah,thn_ang FROM sclient";
                 $sqlsclient=$this->db->query($sqlsc);
                 foreach ($sqlsclient->result() as $rowsc)
                {
                    $tgl=$rowsc->tgl_rka;
                    $tanggal = $this->tukd_model->tanggal_format_indonesia($tgl);
                    $kab     = $rowsc->kab_kota;
                    $daerah  = $rowsc->daerah;
                    $thn     = $rowsc->thn_ang;
                } 
				
       $sqldns="SELECT a.kd_urusan as kd_u,b.nm_urusan as nm_u,a.kd_skpd as kd_sk,a.nm_skpd as nm_sk 
                    FROM ms_skpd a INNER JOIN ms_urusan b ON a.kd_urusan=b.kd_urusan WHERE kd_skpd='$id'";
                 $sqlskpd=$this->db->query($sqldns);
                 foreach ($sqlskpd->result() as $rowdns)
                {
                    $kd_urusan=$rowdns->kd_u;                    
                    $nm_urusan= $rowdns->nm_u;
                    $kd_skpd  = $rowdns->kd_sk;
                    $nm_skpd  = $rowdns->nm_sk;
                } 
     
        $sql="SELECT 
					ifnull((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='$id'
					AND LEFT(c.kd_rek64,1)='4'),0) AS angpen,
					ifnull((SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='$id'
					AND LEFT(c.kd_rek64,1)='5'),0) AS angbel,
					ifnull((SELECT SUM(b.kredit)-SUM(b.debet) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE b.kd_skpd='$id' AND LEFT(b.kd_rek5,1)='4' AND MONTH(a.tgl_voucher)<='6'),0) AS totpen,
					ifnull((SELECT SUM(b.debet)-SUM(b.kredit) AS nilai FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
					WHERE b.kd_skpd='$id' AND LEFT(b.kd_rek5,1)='5' AND MONTH(a.tgl_voucher)<='6'),0) AS totbel
             ";    
                                                
                    $query   = $this->db->query($sql);
                    $hasil   = $query->row();
                    $angpen  = $hasil->angpen;
                    $angbel  = $hasil->angbel;
                    $totpen  = $hasil->totpen;
                    $totbel  = $hasil->totbel;                    
                 
        $surang = $angpen - $angbel;
        if ($surang < 0){
                    	$x1="("; 
                        $surang=$surang*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $surang=$surang*1; 
                        $y1="";
                        }
						
        $surang1= number_format($surang,"2",".",",");
        
        $surrel = $totpen - $totbel;
        if ($surrel < 0){
                    	$x1="("; 
                        $surrel=$surrel*-1; 
                        $y1=")";
                        }else{
                    	$x1="";
                        $surrel=$surrel*1; 
                        $y1="";
                        }  
						
        $surrel1= number_format($surrel,"2",".",",");
		
		$sursisa = $surang - $surrel;		
		$sursisa1  = number_format($sursisa,"2",".",",");			
        
        $cRet='';       
        $cRet .="<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"0\" cellspacing=\"0\" cellpadding=\"4\">
                    <tr>
                         <td align=\"center\"><strong>$kab</strong></td>                         
                    </tr>
					<tr>
                         <td align=\"center\"><strong>LAPORAN REALISASI SEMESTER PERTAMA PENDAPATAN DAN BELANJA SKPD<br>SERTA PROGNOSIS 6 (ENAM) BULAN BERIKUTNYA</strong></td>                         
                    </tr>
                    <tr>
                         <td align=\"center\"><strong>$nm_skpd</strong></td>                         
                    </tr>                                       
                    <tr>
                         <td align=\"center\"><strong>Tahun Anggaran $thn_ang</strong></td>
                    </tr>
                    <tr>
                         <td align=\"center\">&nbsp;</td>
                    </tr>
                  </table>";        
        
        $cRet .= "<table style=\"border-collapse:collapse;\" width=\"100%\" align=\"center\" border=\"1\" cellspacing=\"0\" cellpadding=\"4\">
                     <thead>                       
                        <tr><td bgcolor=\"#CCCCCC\" width=\"3%\" align=\"center\"><b>NO</b></td>                            
                            <td bgcolor=\"#CCCCCC\" width=\"37%\" align=\"center\"><b>URAIAN</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\"><b>Jumlah Anggaran</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\"><b>Realisasi Semester Pertama</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\" ><b>Sisa Anggaran<br>s.d<br>Semester Pertama</b></td>
                            <td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\" ><b>Prognosis</b></td>  
							<td bgcolor=\"#CCCCCC\" width=\"12%\" align=\"center\" ><b>Keterangan</b></td> 
                        </tr>  
                     </thead>
                     <tfoot>
                        <tr>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td>
                            <td style=\"border-top: none;\"></td> 
							<td style=\"border-top: none;\"></td>
                         </tr>
                     </tfoot>";

                 $sql4 ="SELECT nor,uraian,seq,
								(SELECT SUM(nilai) AS nilai FROM trdrka b INNER JOIN ms_rek5 c ON b.kd_rek5=c.kd_rek5 WHERE b.kd_skpd='$id' 
								AND (LEFT(c.kd_rek64,3)=a.kode_1 OR LEFT(c.kd_rek64,2)=a.kode_1 OR LEFT(c.kd_rek64,1)=a.kode_1)) AS anggaran,
								(SELECT SUM(debet) AS debet FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
								WHERE b.kd_skpd='$id' AND MONTH(a.tgl_voucher)<='6' 
								AND (LEFT(b.kd_rek5,3)=a.kode_1 OR LEFT(b.kd_rek5,2)=a.kode_1 OR LEFT(b.kd_rek5,1)=a.kode_1)) AS debet,
								(SELECT SUM(kredit) AS kredit FROM trhju_pkd a INNER JOIN trdju_pkd b ON a.no_voucher=b.no_voucher AND a.kd_skpd=b.kd_skpd
								WHERE b.kd_skpd='$id' AND MONTH(a.tgl_voucher)<='6' 
								AND (LEFT(b.kd_rek5,3)=a.kode_1 OR LEFT(b.kd_rek5,2)=a.kode_1 OR LEFT(b.kd_rek5,1)=a.kode_1)) AS kredit	
								FROM map_lra_skpd a ORDER BY nor";
                            
                $query4 = $this->db->query($sql4);                                  
                foreach ($query4->result() as $row4)
                {
                    $no         = $row4->nor;
                    $nama       = $row4->uraian;   
                    $anggaran   = $row4->anggaran;
                    $debet      = $row4->debet;
                    $kredit     = $row4->kredit;
                    $seq        = $row4->seq;
                    
                    $angg  = number_format($anggaran,"2",".",",");
                    if($row4->seq<'50'){
                      $nilai = $kredit-$debet;
                    }else{
                      $nilai = $debet-$kredit;    
                    }
                    $nil  = number_format($nilai,"2",".",",");
					
					$sisa = $anggaran - $nilai;
					if ($sisa < 0){
                    	$x="("; 
                        $sisa=$sisa*-1; 
                        $y=")";
                        }else {
                    	$x="";
                        $sisa=$sisa*1; 
                        $y="";
                        } 

					$sisaangg  = number_format($sisa,"2",".",",");
					
                    switch ($row4->seq) {
                    case 5:
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
					 case 10:
                         $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                    case 30:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 40:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
					 case 50:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     </tr>";
                        break;
                    case 55:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 70:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;                                         
                    case 80:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
										 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 115:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 125:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$angg</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$nil</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x$sisaangg$y</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;
                    case 135:
                        $cRet    .= "<tr>
                                         <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"left\"><b>$nama</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$surang1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$surrel1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$sursisa1$y1</b></td>
                                         <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b>$x1$sursisa1$y1</b></td>
										 <td style=\"vertical-align:top;border-top: solid 1px black;border-bottom: solid 1px black;\" align=\"right\"><b></b></td>
                                     </tr>";
                        break;                                                                          
                    default:
					if($nama <> ''){
                    $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$angg</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$nil</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$x$sisaangg$y</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\">$x$sisaangg$y</td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";
					}else{
					 $cRet    .= "<tr>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$no</td>                                     
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"left\">$nama</td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                     <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
									 <td style=\"vertical-align:top;border-top: none;border-bottom: none;\" align=\"right\"></td>
                                 </tr>";	
					}
                }         
                }

        $cRet .=       " </table>";
		$cRet .= " <br><br>";
		 $sqlttd=$this->db->query("select nip,nama,jabatan from ms_ttd where kd_skpd='$id' and kode='PA'");
	   foreach($sqlttd->result() as $ttd){
			$nip=empty($ttd->nip) || $ttd->nip== null ?'&nbsp;' :$ttd->nip;
			$nama=empty($ttd->nama) || $ttd->nama== null ?'&nbsp;' :$ttd->nama;
			$jabatan=empty($ttd->jabatan) || $ttd->jabatan== null ?'&nbsp;' :$ttd->jabatan;
	   }
		
		$skpdx=$kd_skpd.' '.$nm_skpd;
        $this->template->set('title', 'CETAK');    
        
          
	$cetak = $this->uri->segment(3);
$data['prev']= $cRet;
	  
        switch($cetak) {        
        case 1;
        $this->_mpdf1('',$cRet,25,10,10,'P',$skpdx,$mry);
        break;
        case 2;        
            header("Cache-Control: no-cache, no-store, must-revalidate");
            header("Content-Type: application/vnd.ms-excel");
            header("Content-Disposition: attachment; filename= $skpdx.xls");
            $this->load->view('anggaran/rka/perkadaII', $data);
        break;
        }			  
                 
    }  
	



}
